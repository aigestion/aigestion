var e,t,s,i,n,a,r,o,l,c,A,h,d,u,p,g,m,f,b,x,y,v,w,I,C,E,B,Q,S,_,k,T,M,R,D,N,F,j,L,P,U,O,G,H,q,z,V,K,J=Object.defineProperty,Y=e=>{throw TypeError(e)},W=(e,t,s)=>((e,t,s)=>t in e?J(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,"symbol"!=typeof t?t+"":t,s),$=(e,t,s)=>t.has(e)||Y("Cannot "+s),X=(e,t,s)=>($(e,t,"read from private field"),s?s.call(e):t.get(e)),Z=(e,t,s)=>t.has(e)?Y("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,s),ee=(e,t,s,i)=>($(e,t,"write to private field"),i?i.call(e,s):t.set(e,s),s),te=(e,t,s)=>($(e,t,"access private method"),s),se=(e,t,s,i)=>({set _(i){ee(e,t,i,s)},get _(){return X(e,t,i)}});import{j as ie,A as ne,a as ae,R as re,C as oe,L as le,N as ce,b as Ae,c as he,F as de,S as ue,d as pe,B as ge,e as me,I as fe,f as be,g as xe,h as ye,T as ve,i as we,k as Ie,l as Ce,M as Ee,V as Be,m as Qe,P as Se,D as _e,n as ke,o as Te,p as Me,Q as Re,q as De,O as Ne,r as Fe,s as je,t as Le,u as Pe,v as Ue,w as Oe,x as Ge,y as He,z as qe,E as ze,G as Ve,H as Ke,J as Je,K as Ye,U as We,W as $e,X as Xe,Y as Ze,Z as et,_ as tt,$ as st,a0 as it,a1 as nt,a2 as at,a3 as rt,a4 as ot,a5 as lt,a6 as ct,a7 as At,a8 as ht,a9 as dt,aa as ut,ab as pt,ac as gt,ad as mt,ae as ft,af as bt,ag as xt,ah as yt,ai as vt,aj as wt,ak as It,al as Ct,am as Et,an as Bt,ao as Qt,ap as St,aq as _t,ar as kt,as as Tt,at as Mt,au as Rt,av as Dt,aw as Nt,ax as Ft,ay as jt,az as Lt,aA as Pt,aB as Ut,aC as Ot,aD as Gt,aE as Ht,aF as qt,aG as zt,aH as Vt,aI as Kt,aJ as Jt,aK as Yt,aL as Wt,aM as $t,aN as Xt,aO as Zt,aP as es,aQ as ts,aR as ss,aS as is,aT as ns,aU as as,aV as rs,aW as os,aX as ls,aY as cs,aZ as As,a_ as hs,a$ as ds,b0 as us,b1 as ps,b2 as gs,b3 as ms,b4 as fs,b5 as bs,b6 as xs,b7 as ys,b8 as vs,b9 as ws,ba as Is,bb as Cs,bc as Es,bd as Bs,be as Qs,bf as Ss,bg as _s,bh as ks,bi as Ts,bj as Ms,bk as Rs,bl as Ds,bm as Ns,bn as Fs,bo as js,bp as Ls,bq as Ps}from"./three-AQi5zF3R.js";import{r as Us,R as Os,c as Gs,b as Hs}from"./vendor-CzpUEfg8.js";import{m as qs,A as zs,u as Vs,a as Ks,b as Js,c as Ys,d as Ws}from"./framer-CvbEmNoZ.js";import{L as $s,C as Xs,X as Zs,M as ei,S as ti,a as si,B as ii,I as ni,b as ai,R as ri,c as oi,d as li,P as ci,Z as Ai,e as hi,f as di,F as ui,g as pi,h as gi,i as mi,j as fi,k as bi,l as xi,m as yi,n as vi,o as wi,p as Ii,U as Ci,q as Ei,r as Bi,s as Qi,t as Si,u as _i,T as ki,G as Ti,v as Mi,A as Ri,W as Di,w as Ni,x as Fi,y as ji,z as Li,D as Pi,E as Ui,H as Oi,J as Gi,K as Hi,N as qi,O as zi,Q as Vi}from"./lucide-DJfsIjBu.js";import{t as Ki,c as Ji}from"./utils-BpqZfnrR.js";import{c as Yi}from"./supabase-CSYDiXP0.js";function Wi(){return Wi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e},Wi.apply(this,arguments)}!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}(),(K=V||(V={})).Pop="POP",K.Push="PUSH",K.Replace="REPLACE";const $i="popstate";function Xi(e){return void 0===e&&(e={}),function(e,t,s,i){void 0===i&&(i={});let{window:n=document.defaultView,v5Compat:a=!1}=i,r=n.history,o=V.Pop,l=null,c=A();null==c&&(c=0,r.replaceState(Wi({},r.state,{idx:c}),""));function A(){return(r.state||{idx:null}).idx}function h(){o=V.Pop;let e=A(),t=null==e?null:e-c;c=e,l&&l({action:o,location:g.location,delta:t})}function d(e,t){o=V.Push;let s=sn(g.location,e,t);c=A()+1;let i=tn(s,c),h=g.createHref(s);try{r.pushState(i,"",h)}catch(d){if(d instanceof DOMException&&"DataCloneError"===d.name)throw d;n.location.assign(h)}a&&l&&l({action:o,location:g.location,delta:1})}function u(e,t){o=V.Replace;let s=sn(g.location,e,t);c=A();let i=tn(s,c),n=g.createHref(s);r.replaceState(i,"",n),a&&l&&l({action:o,location:g.location,delta:0})}function p(e){let t="null"!==n.location.origin?n.location.origin:n.location.href,s="string"==typeof e?e:nn(e);return s=s.replace(/ $/,"%20"),Zi(t,"No window.location.(origin|href) available to create URL for href: "+s),new URL(s,t)}let g={get action(){return o},get location(){return e(n,r)},listen(e){if(l)throw new Error("A history only accepts one active listener");return n.addEventListener($i,h),l=e,()=>{n.removeEventListener($i,h),l=null}},createHref:e=>t(n,e),createURL:p,encodeLocation(e){let t=p(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:d,replace:u,go:e=>r.go(e)};return g}(function(e,t){let{pathname:s,search:i,hash:n}=e.location;return sn("",{pathname:s,search:i,hash:n},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"==typeof t?t:nn(t)},0,e)}function Zi(e,t){if(!1===e||null==e)throw new Error(t)}function en(e,t){if(!e){"undefined"!=typeof console&&console.warn(t);try{throw new Error(t)}catch(s){}}}function tn(e,t){return{usr:e.state,key:e.key,idx:t}}function sn(e,t,s,i){return void 0===s&&(s=null),Wi({pathname:"string"==typeof e?e:e.pathname,search:"",hash:""},"string"==typeof t?an(t):t,{state:s,key:t&&t.key||i||Math.random().toString(36).substr(2,8)})}function nn(e){let{pathname:t="/",search:s="",hash:i=""}=e;return s&&"?"!==s&&(t+="?"===s.charAt(0)?s:"?"+s),i&&"#"!==i&&(t+="#"===i.charAt(0)?i:"#"+i),t}function an(e){let t={};if(e){let s=e.indexOf("#");s>=0&&(t.hash=e.substr(s),e=e.substr(0,s));let i=e.indexOf("?");i>=0&&(t.search=e.substr(i),e=e.substr(0,i)),e&&(t.pathname=e)}return t}var rn,on;function ln(e,t,s){return void 0===s&&(s="/"),function(e,t,s){let i="string"==typeof t?an(t):t,n=wn(i.pathname||"/",s);if(null==n)return null;let a=cn(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let s=e.length===t.length&&e.slice(0,-1).every((e,s)=>e===t[s]);return s?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(a);let r=null;for(let o=0;null==r&&o<a.length;++o){let e=vn(n);r=xn(a[o],e)}return r}(e,t,s)}function cn(e,t,s,i){void 0===t&&(t=[]),void 0===s&&(s=[]),void 0===i&&(i="");let n=(e,n,a)=>{let r={relativePath:void 0===a?e.path||"":a,caseSensitive:!0===e.caseSensitive,childrenIndex:n,route:e};r.relativePath.startsWith("/")&&(Zi(r.relativePath.startsWith(i),'Absolute route path "'+r.relativePath+'" nested under path "'+i+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),r.relativePath=r.relativePath.slice(i.length));let o=_n([i,r.relativePath]),l=s.concat(r);e.children&&e.children.length>0&&(Zi(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+o+'".'),cn(e.children,t,l,o)),(null!=e.path||e.index)&&t.push({path:o,score:bn(o,e.index),routesMeta:l})};return e.forEach((e,t)=>{var s;if(""!==e.path&&null!=(s=e.path)&&s.includes("?"))for(let i of An(e.path))n(e,t,i);else n(e,t)}),t}function An(e){let t=e.split("/");if(0===t.length)return[];let[s,...i]=t,n=s.endsWith("?"),a=s.replace(/\?$/,"");if(0===i.length)return n?[a,""]:[a];let r=An(i.join("/")),o=[];return o.push(...r.map(e=>""===e?a:[a,e].join("/"))),n&&o.push(...r),o.map(t=>e.startsWith("/")&&""===t?"/":t)}(on=rn||(rn={})).data="data",on.deferred="deferred",on.redirect="redirect",on.error="error";const hn=/^:[\w-]+$/,dn=3,un=2,pn=1,gn=10,mn=-2,fn=e=>"*"===e;function bn(e,t){let s=e.split("/"),i=s.length;return s.some(fn)&&(i+=mn),t&&(i+=un),s.filter(e=>!fn(e)).reduce((e,t)=>e+(hn.test(t)?dn:""===t?pn:gn),i)}function xn(e,t,s){let{routesMeta:i}=e,n={},a="/",r=[];for(let o=0;o<i.length;++o){let e=i[o],s=o===i.length-1,l="/"===a?t:t.slice(a.length)||"/",c=yn({path:e.relativePath,caseSensitive:e.caseSensitive,end:s},l),A=e.route;if(!c)return null;Object.assign(n,c.params),r.push({params:n,pathname:_n([a,c.pathname]),pathnameBase:kn(_n([a,c.pathnameBase])),route:A}),"/"!==c.pathnameBase&&(a=_n([a,c.pathnameBase]))}return r}function yn(e,t){"string"==typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[s,i]=function(e,t,s){void 0===t&&(t=!1);void 0===s&&(s=!0);en("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let i=[],n="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,s)=>(i.push({paramName:t,isOptional:null!=s}),s?"/?([^\\/]+)?":"/([^\\/]+)"));e.endsWith("*")?(i.push({paramName:"*"}),n+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?n+="\\/*$":""!==e&&"/"!==e&&(n+="(?:(?=\\/|$))");let a=new RegExp(n,t?void 0:"i");return[a,i]}(e.path,e.caseSensitive,e.end),n=t.match(s);if(!n)return null;let a=n[0],r=a.replace(/(.)\/+$/,"$1"),o=n.slice(1);return{params:i.reduce((e,t,s)=>{let{paramName:i,isOptional:n}=t;if("*"===i){let e=o[s]||"";r=a.slice(0,a.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[s];return e[i]=n&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{}),pathname:a,pathnameBase:r,pattern:e}}function vn(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return en(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function wn(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let s=t.endsWith("/")?t.length-1:t.length,i=e.charAt(s);return i&&"/"!==i?null:e.slice(s)||"/"}const In=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function Cn(e,t){void 0===t&&(t="/");let s,{pathname:i,search:n="",hash:a=""}="string"==typeof e?an(e):e;if(i)if(r=i,In.test(r))s=i;else{if(i.includes("//")){let e=i;i=i.replace(/\/\/+/g,"/"),en(!1,"Pathnames cannot have embedded double slashes - normalizing "+e+" -> "+i)}s=i.startsWith("/")?En(i.substring(1),"/"):En(i,t)}else s=t;var r;return{pathname:s,search:Tn(n),hash:Mn(a)}}function En(e,t){let s=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?s.length>1&&s.pop():"."!==e&&s.push(e)}),s.length>1?s.join("/"):"/"}function Bn(e,t,s,i){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(i)+"].  Please separate it out to the `to."+s+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function Qn(e,t){let s=function(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}(e);return t?s.map((e,t)=>t===s.length-1?e.pathname:e.pathnameBase):s.map(e=>e.pathnameBase)}function Sn(e,t,s,i){let n;void 0===i&&(i=!1),"string"==typeof e?n=an(e):(n=Wi({},e),Zi(!n.pathname||!n.pathname.includes("?"),Bn("?","pathname","search",n)),Zi(!n.pathname||!n.pathname.includes("#"),Bn("#","pathname","hash",n)),Zi(!n.search||!n.search.includes("#"),Bn("#","search","hash",n)));let a,r=""===e||""===n.pathname,o=r?"/":n.pathname;if(null==o)a=s;else{let e=t.length-1;if(!i&&o.startsWith("..")){let t=o.split("/");for(;".."===t[0];)t.shift(),e-=1;n.pathname=t.join("/")}a=e>=0?t[e]:"/"}let l=Cn(n,a),c=o&&"/"!==o&&o.endsWith("/"),A=(r||"."===o)&&s.endsWith("/");return l.pathname.endsWith("/")||!c&&!A||(l.pathname+="/"),l}const _n=e=>e.join("/").replace(/\/\/+/g,"/"),kn=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Tn=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",Mn=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";const Rn=["post","put","patch","delete"];new Set(Rn);const Dn=["get",...Rn];function Nn(){return Nn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e},Nn.apply(this,arguments)}new Set(Dn);const Fn=Us.createContext(null),jn=Us.createContext(null),Ln=Us.createContext(null),Pn=Us.createContext(null),Un=Us.createContext({outlet:null,matches:[],isDataRoute:!1}),On=Us.createContext(null);function Gn(){return null!=Us.useContext(Pn)}function Hn(){return Gn()||Zi(!1),Us.useContext(Pn).location}function qn(e){Us.useContext(Ln).static||Us.useLayoutEffect(e)}function zn(){let{isDataRoute:e}=Us.useContext(Un);return e?function(){let{router:e}=function(){let e=Us.useContext(Fn);return e||Zi(!1),e}(Xn.UseNavigateStable),t=ea(Zn.UseNavigateStable),s=Us.useRef(!1);return qn(()=>{s.current=!0}),Us.useCallback(function(i,n){void 0===n&&(n={}),s.current&&("number"==typeof i?e.navigate(i):e.navigate(i,Nn({fromRouteId:t},n)))},[e,t])}():function(){Gn()||Zi(!1);let e=Us.useContext(Fn),{basename:t,future:s,navigator:i}=Us.useContext(Ln),{matches:n}=Us.useContext(Un),{pathname:a}=Hn(),r=JSON.stringify(Qn(n,s.v7_relativeSplatPath)),o=Us.useRef(!1);return qn(()=>{o.current=!0}),Us.useCallback(function(s,n){if(void 0===n&&(n={}),!o.current)return;if("number"==typeof s)return void i.go(s);let l=Sn(s,JSON.parse(r),a,"path"===n.relative);null==e&&"/"!==t&&(l.pathname="/"===l.pathname?t:_n([t,l.pathname])),(n.replace?i.replace:i.push)(l,n.state,n)},[t,i,r,a,e])}()}function Vn(e,t){let{relative:s}=void 0===t?{}:t,{future:i}=Us.useContext(Ln),{matches:n}=Us.useContext(Un),{pathname:a}=Hn(),r=JSON.stringify(Qn(n,i.v7_relativeSplatPath));return Us.useMemo(()=>Sn(e,JSON.parse(r),a,"path"===s),[e,r,a,s])}function Kn(e,t){return function(e,t,s,i){Gn()||Zi(!1);let{navigator:n}=Us.useContext(Ln),{matches:a}=Us.useContext(Un),r=a[a.length-1],o=r?r.params:{};!r||r.pathname;let l=r?r.pathnameBase:"/";r&&r.route;let c,A=Hn();if(t){var h;let e="string"==typeof t?an(t):t;"/"===l||(null==(h=e.pathname)?void 0:h.startsWith(l))||Zi(!1),c=e}else c=A;let d=c.pathname||"/",u=d;if("/"!==l){let e=l.replace(/^\//,"").split("/");u="/"+d.replace(/^\//,"").split("/").slice(e.length).join("/")}let p=ln(e,{pathname:u}),g=function(e,t,s,i){var n;void 0===t&&(t=[]);void 0===s&&(s=null);void 0===i&&(i=null);if(null==e){var a;if(!s)return null;if(s.errors)e=s.matches;else{if(!(null!=(a=i)&&a.v7_partialHydration&&0===t.length&&!s.initialized&&s.matches.length>0))return null;e=s.matches}}let r=e,o=null==(n=s)?void 0:n.errors;if(null!=o){let e=r.findIndex(e=>e.route.id&&void 0!==(null==o?void 0:o[e.route.id]));e>=0||Zi(!1),r=r.slice(0,Math.min(r.length,e+1))}let l=!1,c=-1;if(s&&i&&i.v7_partialHydration)for(let A=0;A<r.length;A++){let e=r[A];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(c=A),e.route.id){let{loaderData:t,errors:i}=s,n=e.route.loader&&void 0===t[e.route.id]&&(!i||void 0===i[e.route.id]);if(e.route.lazy||n){l=!0,r=c>=0?r.slice(0,c+1):[r[0]];break}}}return r.reduceRight((e,i,n)=>{let a,A=!1,h=null,d=null;var u;s&&(a=o&&i.route.id?o[i.route.id]:void 0,h=i.route.errorElement||Yn,l&&(c<0&&0===n?(ta[u="route-fallback"]||(ta[u]=!0),A=!0,d=null):c===n&&(A=!0,d=i.route.hydrateFallbackElement||null)));let p=t.concat(r.slice(0,n+1)),g=()=>{let t;return t=a?h:A?d:i.route.Component?Us.createElement(i.route.Component,null):i.route.element?i.route.element:e,Us.createElement($n,{match:i,routeContext:{outlet:e,matches:p,isDataRoute:null!=s},children:t})};return s&&(i.route.ErrorBoundary||i.route.errorElement||0===n)?Us.createElement(Wn,{location:s.location,revalidation:s.revalidation,component:h,error:a,children:g(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):g()},null)}(p&&p.map(e=>Object.assign({},e,{params:Object.assign({},o,e.params),pathname:_n([l,n.encodeLocation?n.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?l:_n([l,n.encodeLocation?n.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),a,s,i);if(t&&g)return Us.createElement(Pn.Provider,{value:{location:Nn({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:V.Pop}},g);return g}(e,t)}function Jn(){let e=function(){var e;let t=Us.useContext(On),s=function(){let e=Us.useContext(jn);return e||Zi(!1),e}(),i=ea();if(void 0!==t)return t;return null==(e=s.errors)?void 0:e[i]}(),t=function(e){return null!=e&&"number"==typeof e.status&&"string"==typeof e.statusText&&"boolean"==typeof e.internal&&"data"in e}(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),s=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return Us.createElement(Us.Fragment,null,Us.createElement("h2",null,"Unexpected Application Error!"),Us.createElement("h3",{style:{fontStyle:"italic"}},t),s?Us.createElement("pre",{style:i},s):null,null)}const Yn=Us.createElement(Jn,null);class Wn extends Us.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?Us.createElement(Un.Provider,{value:this.props.routeContext},Us.createElement(On.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function $n(e){let{routeContext:t,match:s,children:i}=e,n=Us.useContext(Fn);return n&&n.static&&n.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=s.route.id),Us.createElement(Un.Provider,{value:t},i)}var Xn=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Xn||{}),Zn=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Zn||{});function ea(e){let t=function(){let e=Us.useContext(Un);return e||Zi(!1),e}(),s=t.matches[t.matches.length-1];return s.route.id||Zi(!1),s.route.id}const ta={};function sa(e){let{to:t,replace:s,state:i,relative:n}=e;Gn()||Zi(!1);let{future:a,static:r}=Us.useContext(Ln),{matches:o}=Us.useContext(Un),{pathname:l}=Hn(),c=zn(),A=Sn(t,Qn(o,a.v7_relativeSplatPath),l,"path"===n),h=JSON.stringify(A);return Us.useEffect(()=>c(JSON.parse(h),{replace:s,state:i,relative:n}),[c,h,n,s,i]),null}function ia(e){Zi(!1)}function na(e){let{basename:t="/",children:s=null,location:i,navigationType:n=V.Pop,navigator:a,static:r=!1,future:o}=e;Gn()&&Zi(!1);let l=t.replace(/^\/*/,"/"),c=Us.useMemo(()=>({basename:l,navigator:a,static:r,future:Nn({v7_relativeSplatPath:!1},o)}),[l,o,a,r]);"string"==typeof i&&(i=an(i));let{pathname:A="/",search:h="",hash:d="",state:u=null,key:p="default"}=i,g=Us.useMemo(()=>{let e=wn(A,l);return null==e?null:{location:{pathname:e,search:h,hash:d,state:u,key:p},navigationType:n}},[l,A,h,d,u,p,n]);return null==g?null:Us.createElement(Ln.Provider,{value:c},Us.createElement(Pn.Provider,{children:s,value:g}))}function aa(e){let{children:t,location:s}=e;return Kn(ra(t),s)}function ra(e,t){void 0===t&&(t=[]);let s=[];return Us.Children.forEach(e,(e,i)=>{if(!Us.isValidElement(e))return;let n=[...t,i];if(e.type===Us.Fragment)return void s.push.apply(s,ra(e.props.children,n));e.type!==ia&&Zi(!1),e.props.index&&e.props.children&&Zi(!1);let a={id:e.props.id||n.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(a.children=ra(e.props.children,n)),s.push(a)}),s}function oa(){return oa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e},oa.apply(this,arguments)}new Promise(()=>{});const la=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"];try{window.__reactRouterVersion="6"}catch(hv){}const ca=Os.startTransition;function Aa(e){let{basename:t,children:s,future:i,window:n}=e,a=Us.useRef();null==a.current&&(a.current=Xi({window:n,v5Compat:!0}));let r=a.current,[o,l]=Us.useState({action:r.action,location:r.location}),{v7_startTransition:c}=i||{},A=Us.useCallback(e=>{c&&ca?ca(()=>l(e)):l(e)},[l,c]);return Us.useLayoutEffect(()=>r.listen(A),[r,A]),Us.useEffect(()=>{return null==(e=i)||e.v7_startTransition,void(null==e||e.v7_relativeSplatPath);var e},[i]),Us.createElement(na,{basename:t,children:s,location:o.location,navigationType:o.action,navigator:r,future:i})}const ha="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement,da=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ua=Us.forwardRef(function(e,t){let s,{onClick:i,relative:n,reloadDocument:a,replace:r,state:o,target:l,to:c,preventScrollReset:A,viewTransition:h}=e,d=function(e,t){if(null==e)return{};var s,i,n={},a=Object.keys(e);for(i=0;i<a.length;i++)s=a[i],t.indexOf(s)>=0||(n[s]=e[s]);return n}(e,la),{basename:u}=Us.useContext(Ln),p=!1;if("string"==typeof c&&da.test(c)&&(s=c,ha))try{let e=new URL(window.location.href),t=c.startsWith("//")?new URL(e.protocol+c):new URL(c),s=wn(t.pathname,u);t.origin===e.origin&&null!=s?c=s+t.search+t.hash:p=!0}catch(hv){}let g=function(e,t){let{relative:s}=void 0===t?{}:t;Gn()||Zi(!1);let{basename:i,navigator:n}=Us.useContext(Ln),{hash:a,pathname:r,search:o}=Vn(e,{relative:s}),l=r;return"/"!==i&&(l="/"===r?i:_n([i,r])),n.createHref({pathname:l,search:o,hash:a})}(c,{relative:n}),m=function(e,t){let{target:s,replace:i,state:n,preventScrollReset:a,relative:r,viewTransition:o}=void 0===t?{}:t,l=zn(),c=Hn(),A=Vn(e,{relative:r});return Us.useCallback(t=>{if(function(e,t){return!(0!==e.button||t&&"_self"!==t||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e))}(t,s)){t.preventDefault();let s=void 0!==i?i:nn(c)===nn(A);l(e,{replace:s,state:n,preventScrollReset:a,relative:r,viewTransition:o})}},[c,l,A,i,n,s,e,a,r,o])}(c,{replace:r,state:o,target:l,preventScrollReset:A,relative:n,viewTransition:h});return Us.createElement("a",oa({},d,{href:s||g,onClick:p||a?i:function(e){i&&i(e),e.defaultPrevented||m(e)},ref:t,target:l}))});var pa,ga,ma,fa;(ga=pa||(pa={})).UseScrollRestoration="useScrollRestoration",ga.UseSubmit="useSubmit",ga.UseSubmitFetcher="useSubmitFetcher",ga.UseFetcher="useFetcher",ga.useViewTransitionState="useViewTransitionState",(fa=ma||(ma={})).UseFetcher="useFetcher",fa.UseFetchers="useFetchers",fa.UseScrollRestoration="useScrollRestoration";const ba=()=>ie.jsxs("div",{className:"fixed inset-0 -z-50 overflow-hidden pointer-events-none",children:[ie.jsx(qs.div,{animate:{scale:[1,1.2,1],rotate:[0,45,0],x:[0,100,0],y:[0,-50,0]},transition:{duration:20,repeat:1/0,ease:"easeInOut"},className:"absolute top-[-20%] left-[-10%] w-[70%] h-[70%] bg-nexus-violet/5 blur-[120px] rounded-full"}),ie.jsx(qs.div,{animate:{scale:[1.2,1,1.2],rotate:[0,-30,0],x:[0,-100,0],y:[0,50,0]},transition:{duration:25,repeat:1/0,ease:"easeInOut"},className:"absolute bottom-[-10%] right-[-10%] w-[60%] h-[60%] bg-nexus-cyan/5 blur-[100px] rounded-full"}),ie.jsx("div",{className:"absolute inset-0 bg-nexus-obsidian/40 backdrop-blur-[20px]"})]});var xa,ya={};xa=ya,function(){var e=function(){this.init()};e.prototype={init:function(){var e=this||t;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var s=this||t;if(e=parseFloat(e),s.ctx||c(),void 0!==e&&e>=0&&e<=1){if(s._volume=e,s._muted)return s;s.usingWebAudio&&s.masterGain.gain.setValueAtTime(e,t.ctx.currentTime);for(var i=0;i<s._howls.length;i++)if(!s._howls[i]._webAudio)for(var n=s._howls[i]._getSoundIds(),a=0;a<n.length;a++){var r=s._howls[i]._soundById(n[a]);r&&r._node&&(r._node.volume=r._volume*e)}return s}return s._volume},mute:function(e){var s=this||t;s.ctx||c(),s._muted=e,s.usingWebAudio&&s.masterGain.gain.setValueAtTime(e?0:s._volume,t.ctx.currentTime);for(var i=0;i<s._howls.length;i++)if(!s._howls[i]._webAudio)for(var n=s._howls[i]._getSoundIds(),a=0;a<n.length;a++){var r=s._howls[i]._soundById(n[a]);r&&r._node&&(r._node.muted=!!e||r._muted)}return s},stop:function(){for(var e=this||t,s=0;s<e._howls.length;s++)e._howls[s].stop();return e},unload:function(){for(var e=this||t,s=e._howls.length-1;s>=0;s--)e._howls[s].unload();return e.usingWebAudio&&e.ctx&&void 0!==e.ctx.close&&(e.ctx.close(),e.ctx=null,c()),e},codecs:function(e){return(this||t)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||t;if(e.state=e.ctx&&e.ctx.state||"suspended",e._autoSuspend(),!e.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(e._canPlayEvent="canplay")}catch(hv){e.noAudio=!0}else e.noAudio=!0;try{(new Audio).muted&&(e.noAudio=!0)}catch(hv){}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||t,s=null;try{s="undefined"!=typeof Audio?new Audio:null}catch(A){return e}if(!s||"function"!=typeof s.canPlayType)return e;var i=s.canPlayType("audio/mpeg;").replace(/^no$/,""),n=e._navigator?e._navigator.userAgent:"",a=n.match(/OPR\/(\d+)/g),r=a&&parseInt(a[0].split("/")[1],10)<33,o=-1!==n.indexOf("Safari")&&-1===n.indexOf("Chrome"),l=n.match(/Version\/(.*?) /),c=o&&l&&parseInt(l[1],10)<15;return e._codecs={mp3:!(r||!i&&!s.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!i,opus:!!s.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!s.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!s.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(s.canPlayType('audio/wav; codecs="1"')||s.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!s.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!s.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(s.canPlayType("audio/x-m4a;")||s.canPlayType("audio/m4a;")||s.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(s.canPlayType("audio/x-m4b;")||s.canPlayType("audio/m4b;")||s.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(s.canPlayType("audio/x-mp4;")||s.canPlayType("audio/mp4;")||s.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!(c||!s.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!(c||!s.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!s.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(s.canPlayType("audio/x-flac;")||s.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_unlockAudio:function(){var e=this||t;if(!e._audioUnlocked&&e.ctx){e._audioUnlocked=!1,e.autoUnlock=!1,e._mobileUnloaded||44100===e.ctx.sampleRate||(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var s=function(t){for(;e._html5AudioPool.length<e.html5PoolSize;)try{var i=new Audio;i._unlocked=!0,e._releaseHtml5Audio(i)}catch(c){e.noAudio=!0;break}for(var n=0;n<e._howls.length;n++)if(!e._howls[n]._webAudio)for(var a=e._howls[n]._getSoundIds(),r=0;r<a.length;r++){var o=e._howls[n]._soundById(a[r]);o&&o._node&&!o._node._unlocked&&(o._node._unlocked=!0,o._node.load())}e._autoResume();var l=e.ctx.createBufferSource();l.buffer=e._scratchBuffer,l.connect(e.ctx.destination),void 0===l.start?l.noteOn(0):l.start(0),"function"==typeof e.ctx.resume&&e.ctx.resume(),l.onended=function(){l.disconnect(0),e._audioUnlocked=!0,document.removeEventListener("touchstart",s,!0),document.removeEventListener("touchend",s,!0),document.removeEventListener("click",s,!0),document.removeEventListener("keydown",s,!0);for(var t=0;t<e._howls.length;t++)e._howls[t]._emit("unlock")}};return document.addEventListener("touchstart",s,!0),document.addEventListener("touchend",s,!0),document.addEventListener("click",s,!0),document.addEventListener("keydown",s,!0),e}},_obtainHtml5Audio:function(){var e=this||t;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var s=(new Audio).play();return s&&"undefined"!=typeof Promise&&(s instanceof Promise||"function"==typeof s.then)&&s.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(e){var s=this||t;return e._unlocked&&s._html5AudioPool.push(e),s},_autoSuspend:function(){var e=this;if(e.autoSuspend&&e.ctx&&void 0!==e.ctx.suspend&&t.usingWebAudio){for(var s=0;s<e._howls.length;s++)if(e._howls[s]._webAudio)for(var i=0;i<e._howls[s]._sounds.length;i++)if(!e._howls[s]._sounds[i]._paused)return e;return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout(function(){if(e.autoSuspend){e._suspendTimer=null,e.state="suspending";var t=function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())};e.ctx.suspend().then(t,t)}},3e4),e}},_autoResume:function(){var e=this;if(e.ctx&&void 0!==e.ctx.resume&&t.usingWebAudio)return"running"===e.state&&"interrupted"!==e.ctx.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state||"running"===e.state&&"interrupted"===e.ctx.state?(e.ctx.resume().then(function(){e.state="running";for(var t=0;t<e._howls.length;t++)e._howls[t]._emit("resume")}),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}};var t=new e,s=function(e){e.src&&0!==e.src.length?this.init(e):console.error("An array of source files must be passed with any new Howl.")};s.prototype={init:function(e){var s=this;return t.ctx||c(),s._autoplay=e.autoplay||!1,s._format="string"!=typeof e.format?e.format:[e.format],s._html5=e.html5||!1,s._muted=e.mute||!1,s._loop=e.loop||!1,s._pool=e.pool||5,s._preload="boolean"!=typeof e.preload&&"metadata"!==e.preload||e.preload,s._rate=e.rate||1,s._sprite=e.sprite||{},s._src="string"!=typeof e.src?e.src:[e.src],s._volume=void 0!==e.volume?e.volume:1,s._xhr={method:e.xhr&&e.xhr.method?e.xhr.method:"GET",headers:e.xhr&&e.xhr.headers?e.xhr.headers:null,withCredentials:!(!e.xhr||!e.xhr.withCredentials)&&e.xhr.withCredentials},s._duration=0,s._state="unloaded",s._sounds=[],s._endTimers={},s._queue=[],s._playLock=!1,s._onend=e.onend?[{fn:e.onend}]:[],s._onfade=e.onfade?[{fn:e.onfade}]:[],s._onload=e.onload?[{fn:e.onload}]:[],s._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],s._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],s._onpause=e.onpause?[{fn:e.onpause}]:[],s._onplay=e.onplay?[{fn:e.onplay}]:[],s._onstop=e.onstop?[{fn:e.onstop}]:[],s._onmute=e.onmute?[{fn:e.onmute}]:[],s._onvolume=e.onvolume?[{fn:e.onvolume}]:[],s._onrate=e.onrate?[{fn:e.onrate}]:[],s._onseek=e.onseek?[{fn:e.onseek}]:[],s._onunlock=e.onunlock?[{fn:e.onunlock}]:[],s._onresume=[],s._webAudio=t.usingWebAudio&&!s._html5,void 0!==t.ctx&&t.ctx&&t.autoUnlock&&t._unlockAudio(),t._howls.push(s),s._autoplay&&s._queue.push({event:"play",action:function(){s.play()}}),s._preload&&"none"!==s._preload&&s.load(),s},load:function(){var e=this,s=null;if(t.noAudio)e._emit("loaderror",null,"No audio support.");else{"string"==typeof e._src&&(e._src=[e._src]);for(var n=0;n<e._src.length;n++){var r,o;if(e._format&&e._format[n])r=e._format[n];else{if("string"!=typeof(o=e._src[n])){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(r=/^data:audio\/([^;,]+);/i.exec(o))||(r=/\.([^.]+)$/.exec(o.split("?",1)[0])),r&&(r=r[1].toLowerCase())}if(r||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),r&&t.codecs(r)){s=e._src[n];break}}if(s)return e._src=s,e._state="loading","https:"===window.location.protocol&&"http:"===s.slice(0,5)&&(e._html5=!0,e._webAudio=!1),new i(e),e._webAudio&&a(e),e;e._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(e,s){var i=this,n=null;if("number"==typeof e)n=e,e=null;else{if("string"==typeof e&&"loaded"===i._state&&!i._sprite[e])return null;if(void 0===e&&(e="__default",!i._playLock)){for(var a=0,r=0;r<i._sounds.length;r++)i._sounds[r]._paused&&!i._sounds[r]._ended&&(a++,n=i._sounds[r]._id);1===a?e=null:n=null}}var o=n?i._soundById(n):i._inactiveSound();if(!o)return null;if(n&&!e&&(e=o._sprite||"__default"),"loaded"!==i._state){o._sprite=e,o._ended=!1;var l=o._id;return i._queue.push({event:"play",action:function(){i.play(l)}}),l}if(n&&!o._paused)return s||i._loadQueue("play"),o._id;i._webAudio&&t._autoResume();var c=Math.max(0,o._seek>0?o._seek:i._sprite[e][0]/1e3),A=Math.max(0,(i._sprite[e][0]+i._sprite[e][1])/1e3-c),h=1e3*A/Math.abs(o._rate),d=i._sprite[e][0]/1e3,u=(i._sprite[e][0]+i._sprite[e][1])/1e3;o._sprite=e,o._ended=!1;var p=function(){o._paused=!1,o._seek=c,o._start=d,o._stop=u,o._loop=!(!o._loop&&!i._sprite[e][2])};if(!(c>=u)){var g=o._node;if(i._webAudio){var m=function(){i._playLock=!1,p(),i._refreshBuffer(o);var e=o._muted||i._muted?0:o._volume;g.gain.setValueAtTime(e,t.ctx.currentTime),o._playStart=t.ctx.currentTime,void 0===g.bufferSource.start?o._loop?g.bufferSource.noteGrainOn(0,c,86400):g.bufferSource.noteGrainOn(0,c,A):o._loop?g.bufferSource.start(0,c,86400):g.bufferSource.start(0,c,A),h!==1/0&&(i._endTimers[o._id]=setTimeout(i._ended.bind(i,o),h)),s||setTimeout(function(){i._emit("play",o._id),i._loadQueue()},0)};"running"===t.state&&"interrupted"!==t.ctx.state?m():(i._playLock=!0,i.once("resume",m),i._clearTimer(o._id))}else{var f=function(){g.currentTime=c,g.muted=o._muted||i._muted||t._muted||g.muted,g.volume=o._volume*t.volume(),g.playbackRate=o._rate;try{var n=g.play();if(n&&"undefined"!=typeof Promise&&(n instanceof Promise||"function"==typeof n.then)?(i._playLock=!0,p(),n.then(function(){i._playLock=!1,g._unlocked=!0,s?i._loadQueue():i._emit("play",o._id)}).catch(function(){i._playLock=!1,i._emit("playerror",o._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),o._ended=!0,o._paused=!0})):s||(i._playLock=!1,p(),i._emit("play",o._id)),g.playbackRate=o._rate,g.paused)return void i._emit("playerror",o._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==e||o._loop?i._endTimers[o._id]=setTimeout(i._ended.bind(i,o),h):(i._endTimers[o._id]=function(){i._ended(o),g.removeEventListener("ended",i._endTimers[o._id],!1)},g.addEventListener("ended",i._endTimers[o._id],!1))}catch(a){i._emit("playerror",o._id,a)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===g.src&&(g.src=i._src,g.load());var b=window&&window.ejecta||!g.readyState&&t._navigator.isCocoonJS;if(g.readyState>=3||b)f();else{i._playLock=!0,i._state="loading";var x=function(){i._state="loaded",f(),g.removeEventListener(t._canPlayEvent,x,!1)};g.addEventListener(t._canPlayEvent,x,!1),i._clearTimer(o._id)}}return o._id}i._ended(o)},pause:function(e){var t=this;if("loaded"!==t._state||t._playLock)return t._queue.push({event:"pause",action:function(){t.pause(e)}}),t;for(var s=t._getSoundIds(e),i=0;i<s.length;i++){t._clearTimer(s[i]);var n=t._soundById(s[i]);if(n&&!n._paused&&(n._seek=t.seek(s[i]),n._rateSeek=0,n._paused=!0,t._stopFade(s[i]),n._node))if(t._webAudio){if(!n._node.bufferSource)continue;void 0===n._node.bufferSource.stop?n._node.bufferSource.noteOff(0):n._node.bufferSource.stop(0),t._cleanBuffer(n._node)}else isNaN(n._node.duration)&&n._node.duration!==1/0||n._node.pause();arguments[1]||t._emit("pause",n?n._id:null)}return t},stop:function(e,t){var s=this;if("loaded"!==s._state||s._playLock)return s._queue.push({event:"stop",action:function(){s.stop(e)}}),s;for(var i=s._getSoundIds(e),n=0;n<i.length;n++){s._clearTimer(i[n]);var a=s._soundById(i[n]);a&&(a._seek=a._start||0,a._rateSeek=0,a._paused=!0,a._ended=!0,s._stopFade(i[n]),a._node&&(s._webAudio?a._node.bufferSource&&(void 0===a._node.bufferSource.stop?a._node.bufferSource.noteOff(0):a._node.bufferSource.stop(0),s._cleanBuffer(a._node)):isNaN(a._node.duration)&&a._node.duration!==1/0||(a._node.currentTime=a._start||0,a._node.pause(),a._node.duration===1/0&&s._clearSound(a._node))),t||s._emit("stop",a._id))}return s},mute:function(e,s){var i=this;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"mute",action:function(){i.mute(e,s)}}),i;if(void 0===s){if("boolean"!=typeof e)return i._muted;i._muted=e}for(var n=i._getSoundIds(s),a=0;a<n.length;a++){var r=i._soundById(n[a]);r&&(r._muted=e,r._interval&&i._stopFade(r._id),i._webAudio&&r._node?r._node.gain.setValueAtTime(e?0:r._volume,t.ctx.currentTime):r._node&&(r._node.muted=!!t._muted||e),i._emit("mute",r._id))}return i},volume:function(){var e,s,i,n=this,a=arguments;if(0===a.length)return n._volume;if(1===a.length||2===a.length&&void 0===a[1]?n._getSoundIds().indexOf(a[0])>=0?s=parseInt(a[0],10):e=parseFloat(a[0]):a.length>=2&&(e=parseFloat(a[0]),s=parseInt(a[1],10)),!(void 0!==e&&e>=0&&e<=1))return(i=s?n._soundById(s):n._sounds[0])?i._volume:0;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"volume",action:function(){n.volume.apply(n,a)}}),n;void 0===s&&(n._volume=e),s=n._getSoundIds(s);for(var r=0;r<s.length;r++)(i=n._soundById(s[r]))&&(i._volume=e,a[2]||n._stopFade(s[r]),n._webAudio&&i._node&&!i._muted?i._node.gain.setValueAtTime(e,t.ctx.currentTime):i._node&&!i._muted&&(i._node.volume=e*t.volume()),n._emit("volume",i._id));return n},fade:function(e,s,i,n){var a=this;if("loaded"!==a._state||a._playLock)return a._queue.push({event:"fade",action:function(){a.fade(e,s,i,n)}}),a;e=Math.min(Math.max(0,parseFloat(e)),1),s=Math.min(Math.max(0,parseFloat(s)),1),i=parseFloat(i),a.volume(e,n);for(var r=a._getSoundIds(n),o=0;o<r.length;o++){var l=a._soundById(r[o]);if(l){if(n||a._stopFade(r[o]),a._webAudio&&!l._muted){var c=t.ctx.currentTime,A=c+i/1e3;l._volume=e,l._node.gain.setValueAtTime(e,c),l._node.gain.linearRampToValueAtTime(s,A)}a._startFadeInterval(l,e,s,i,r[o],void 0===n)}}return a},_startFadeInterval:function(e,t,s,i,n,a){var r=this,o=t,l=s-t,c=Math.abs(l/.01),A=Math.max(4,c>0?i/c:i),h=Date.now();e._fadeTo=s,e._interval=setInterval(function(){var n=(Date.now()-h)/i;h=Date.now(),o+=l*n,o=Math.round(100*o)/100,o=l<0?Math.max(s,o):Math.min(s,o),r._webAudio?e._volume=o:r.volume(o,e._id,!0),a&&(r._volume=o),(s<t&&o<=s||s>t&&o>=s)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,r.volume(s,e._id),r._emit("fade",e._id))},A)},_stopFade:function(e){var s=this,i=s._soundById(e);return i&&i._interval&&(s._webAudio&&i._node.gain.cancelScheduledValues(t.ctx.currentTime),clearInterval(i._interval),i._interval=null,s.volume(i._fadeTo,e),i._fadeTo=null,s._emit("fade",e)),s},loop:function(){var e,t,s,i=this,n=arguments;if(0===n.length)return i._loop;if(1===n.length){if("boolean"!=typeof n[0])return!!(s=i._soundById(parseInt(n[0],10)))&&s._loop;e=n[0],i._loop=e}else 2===n.length&&(e=n[0],t=parseInt(n[1],10));for(var a=i._getSoundIds(t),r=0;r<a.length;r++)(s=i._soundById(a[r]))&&(s._loop=e,i._webAudio&&s._node&&s._node.bufferSource&&(s._node.bufferSource.loop=e,e&&(s._node.bufferSource.loopStart=s._start||0,s._node.bufferSource.loopEnd=s._stop,i.playing(a[r])&&(i.pause(a[r],!0),i.play(a[r],!0)))));return i},rate:function(){var e,s,i,n=this,a=arguments;if(0===a.length?s=n._sounds[0]._id:1===a.length?n._getSoundIds().indexOf(a[0])>=0?s=parseInt(a[0],10):e=parseFloat(a[0]):2===a.length&&(e=parseFloat(a[0]),s=parseInt(a[1],10)),"number"!=typeof e)return(i=n._soundById(s))?i._rate:n._rate;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"rate",action:function(){n.rate.apply(n,a)}}),n;void 0===s&&(n._rate=e),s=n._getSoundIds(s);for(var r=0;r<s.length;r++)if(i=n._soundById(s[r])){n.playing(s[r])&&(i._rateSeek=n.seek(s[r]),i._playStart=n._webAudio?t.ctx.currentTime:i._playStart),i._rate=e,n._webAudio&&i._node&&i._node.bufferSource?i._node.bufferSource.playbackRate.setValueAtTime(e,t.ctx.currentTime):i._node&&(i._node.playbackRate=e);var o=n.seek(s[r]),l=1e3*((n._sprite[i._sprite][0]+n._sprite[i._sprite][1])/1e3-o)/Math.abs(i._rate);!n._endTimers[s[r]]&&i._paused||(n._clearTimer(s[r]),n._endTimers[s[r]]=setTimeout(n._ended.bind(n,i),l)),n._emit("rate",i._id)}return n},seek:function(){var e,s,i=this,n=arguments;if(0===n.length?i._sounds.length&&(s=i._sounds[0]._id):1===n.length?i._getSoundIds().indexOf(n[0])>=0?s=parseInt(n[0],10):i._sounds.length&&(s=i._sounds[0]._id,e=parseFloat(n[0])):2===n.length&&(e=parseFloat(n[0]),s=parseInt(n[1],10)),void 0===s)return 0;if("number"==typeof e&&("loaded"!==i._state||i._playLock))return i._queue.push({event:"seek",action:function(){i.seek.apply(i,n)}}),i;var a=i._soundById(s);if(a){if(!("number"==typeof e&&e>=0)){if(i._webAudio){var r=i.playing(s)?t.ctx.currentTime-a._playStart:0,o=a._rateSeek?a._rateSeek-a._seek:0;return a._seek+(o+r*Math.abs(a._rate))}return a._node.currentTime}var l=i.playing(s);l&&i.pause(s,!0),a._seek=e,a._ended=!1,i._clearTimer(s),i._webAudio||!a._node||isNaN(a._node.duration)||(a._node.currentTime=e);var c=function(){l&&i.play(s,!0),i._emit("seek",s)};if(l&&!i._webAudio){var A=function(){i._playLock?setTimeout(A,0):c()};setTimeout(A,0)}else c()}return i},playing:function(e){var t=this;if("number"==typeof e){var s=t._soundById(e);return!!s&&!s._paused}for(var i=0;i<t._sounds.length;i++)if(!t._sounds[i]._paused)return!0;return!1},duration:function(e){var t=this,s=t._duration,i=t._soundById(e);return i&&(s=t._sprite[i._sprite][1]/1e3),s},state:function(){return this._state},unload:function(){for(var e=this,s=e._sounds,i=0;i<s.length;i++)s[i]._paused||e.stop(s[i]._id),e._webAudio||(e._clearSound(s[i]._node),s[i]._node.removeEventListener("error",s[i]._errorFn,!1),s[i]._node.removeEventListener(t._canPlayEvent,s[i]._loadFn,!1),s[i]._node.removeEventListener("ended",s[i]._endFn,!1),t._releaseHtml5Audio(s[i]._node)),delete s[i]._node,e._clearTimer(s[i]._id);var a=t._howls.indexOf(e);a>=0&&t._howls.splice(a,1);var r=!0;for(i=0;i<t._howls.length;i++)if(t._howls[i]._src===e._src||e._src.indexOf(t._howls[i]._src)>=0){r=!1;break}return n&&r&&delete n[e._src],t.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,t,s,i){var n=this["_on"+e];return"function"==typeof t&&n.push(i?{id:s,fn:t,once:i}:{id:s,fn:t}),this},off:function(e,t,s){var i=this,n=i["_on"+e],a=0;if("number"==typeof t&&(s=t,t=null),t||s)for(a=0;a<n.length;a++){var r=s===n[a].id;if(t===n[a].fn&&r||!t&&r){n.splice(a,1);break}}else if(e)i["_on"+e]=[];else{var o=Object.keys(i);for(a=0;a<o.length;a++)0===o[a].indexOf("_on")&&Array.isArray(i[o[a]])&&(i[o[a]]=[])}return i},once:function(e,t,s){return this.on(e,t,s,1),this},_emit:function(e,t,s){for(var i=this,n=i["_on"+e],a=n.length-1;a>=0;a--)n[a].id&&n[a].id!==t&&"load"!==e||(setTimeout(function(e){e.call(this,t,s)}.bind(i,n[a].fn),0),n[a].once&&i.off(e,n[a].fn,n[a].id));return i._loadQueue(e),i},_loadQueue:function(e){var t=this;if(t._queue.length>0){var s=t._queue[0];s.event===e&&(t._queue.shift(),t._loadQueue()),e||s.action()}return t},_ended:function(e){var s=this,i=e._sprite;if(!s._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(s._ended.bind(s,e),100),s;var n=!(!e._loop&&!s._sprite[i][2]);if(s._emit("end",e._id),!s._webAudio&&n&&s.stop(e._id,!0).play(e._id),s._webAudio&&n){s._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=t.ctx.currentTime;var a=1e3*(e._stop-e._start)/Math.abs(e._rate);s._endTimers[e._id]=setTimeout(s._ended.bind(s,e),a)}return s._webAudio&&!n&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,s._clearTimer(e._id),s._cleanBuffer(e._node),t._autoSuspend()),s._webAudio||n||s.stop(e._id,!0),s},_clearTimer:function(e){var t=this;if(t._endTimers[e]){if("function"!=typeof t._endTimers[e])clearTimeout(t._endTimers[e]);else{var s=t._soundById(e);s&&s._node&&s._node.removeEventListener("ended",t._endTimers[e],!1)}delete t._endTimers[e]}return t},_soundById:function(e){for(var t=this,s=0;s<t._sounds.length;s++)if(e===t._sounds[s]._id)return t._sounds[s];return null},_inactiveSound:function(){var e=this;e._drain();for(var t=0;t<e._sounds.length;t++)if(e._sounds[t]._ended)return e._sounds[t].reset();return new i(e)},_drain:function(){var e=this,t=e._pool,s=0,i=0;if(!(e._sounds.length<t)){for(i=0;i<e._sounds.length;i++)e._sounds[i]._ended&&s++;for(i=e._sounds.length-1;i>=0;i--){if(s<=t)return;e._sounds[i]._ended&&(e._webAudio&&e._sounds[i]._node&&e._sounds[i]._node.disconnect(0),e._sounds.splice(i,1),s--)}}},_getSoundIds:function(e){if(void 0===e){for(var t=[],s=0;s<this._sounds.length;s++)t.push(this._sounds[s]._id);return t}return[e]},_refreshBuffer:function(e){return e._node.bufferSource=t.ctx.createBufferSource(),e._node.bufferSource.buffer=n[this._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,t.ctx.currentTime),this},_cleanBuffer:function(e){var s=t._navigator&&t._navigator.vendor.indexOf("Apple")>=0;if(!e.bufferSource)return this;if(t._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),s))try{e.bufferSource.buffer=t._scratchBuffer}catch(hv){}return e.bufferSource=null,this},_clearSound:function(e){/MSIE |Trident\//.test(t._navigator&&t._navigator.userAgent)||(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var i=function(e){this._parent=e,this.init()};i.prototype={init:function(){var e=this,s=e._parent;return e._muted=s._muted,e._loop=s._loop,e._volume=s._volume,e._rate=s._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++t._counter,s._sounds.push(e),e.create(),e},create:function(){var e=this,s=e._parent,i=t._muted||e._muted||e._parent._muted?0:e._volume;return s._webAudio?(e._node=void 0===t.ctx.createGain?t.ctx.createGainNode():t.ctx.createGain(),e._node.gain.setValueAtTime(i,t.ctx.currentTime),e._node.paused=!0,e._node.connect(t.masterGain)):t.noAudio||(e._node=t._obtainHtml5Audio(),e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(t._canPlayEvent,e._loadFn,!1),e._endFn=e._endListener.bind(e),e._node.addEventListener("ended",e._endFn,!1),e._node.src=s._src,e._node.preload=!0===s._preload?"auto":s._preload,e._node.volume=i*t.volume(),e._node.load()),e},reset:function(){var e=this,s=e._parent;return e._muted=s._muted,e._loop=s._loop,e._volume=s._volume,e._rate=s._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++t._counter,e},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var e=this,s=e._parent;s._duration=Math.ceil(10*e._node.duration)/10,0===Object.keys(s._sprite).length&&(s._sprite={__default:[0,1e3*s._duration]}),"loaded"!==s._state&&(s._state="loaded",s._emit("load"),s._loadQueue()),e._node.removeEventListener(t._canPlayEvent,e._loadFn,!1)},_endListener:function(){var e=this,t=e._parent;t._duration===1/0&&(t._duration=Math.ceil(10*e._node.duration)/10,t._sprite.__default[1]===1/0&&(t._sprite.__default[1]=1e3*t._duration),t._ended(e)),e._node.removeEventListener("ended",e._endFn,!1)}};var n={},a=function(e){var t=e._src;if(n[t])return e._duration=n[t].duration,void l(e);if(/^data:[^;]+;base64,/.test(t)){for(var s=atob(t.split(",")[1]),i=new Uint8Array(s.length),a=0;a<s.length;++a)i[a]=s.charCodeAt(a);o(i.buffer,e)}else{var c=new XMLHttpRequest;c.open(e._xhr.method,t,!0),c.withCredentials=e._xhr.withCredentials,c.responseType="arraybuffer",e._xhr.headers&&Object.keys(e._xhr.headers).forEach(function(t){c.setRequestHeader(t,e._xhr.headers[t])}),c.onload=function(){var t=(c.status+"")[0];"0"===t||"2"===t||"3"===t?o(c.response,e):e._emit("loaderror",null,"Failed loading audio file with status: "+c.status+".")},c.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete n[t],e.load())},r(c)}},r=function(e){try{e.send()}catch(hv){e.onerror()}},o=function(e,s){var i=function(){s._emit("loaderror",null,"Decoding audio data failed.")},a=function(e){e&&s._sounds.length>0?(n[s._src]=e,l(s,e)):i()};"undefined"!=typeof Promise&&1===t.ctx.decodeAudioData.length?t.ctx.decodeAudioData(e).then(a).catch(i):t.ctx.decodeAudioData(e,a,i)},l=function(e,t){t&&!e._duration&&(e._duration=t.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},c=function(){if(t.usingWebAudio){try{"undefined"!=typeof AudioContext?t.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?t.ctx=new webkitAudioContext:t.usingWebAudio=!1}catch(hv){t.usingWebAudio=!1}t.ctx||(t.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(t._navigator&&t._navigator.platform),s=t._navigator&&t._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),i=s?parseInt(s[1],10):null;if(e&&i&&i<9){var n=/safari/.test(t._navigator&&t._navigator.userAgent.toLowerCase());t._navigator&&!n&&(t.usingWebAudio=!1)}t.usingWebAudio&&(t.masterGain=void 0===t.ctx.createGain?t.ctx.createGainNode():t.ctx.createGain(),t.masterGain.gain.setValueAtTime(t._muted?0:t._volume,t.ctx.currentTime),t.masterGain.connect(t.ctx.destination)),t._setup()}};xa.Howler=t,xa.Howl=s,void 0!==Gs?(Gs.HowlerGlobal=e,Gs.Howler=t,Gs.Howl=s,Gs.Sound=i):"undefined"!=typeof window&&(window.HowlerGlobal=e,window.Howler=t,window.Howl=s,window.Sound=i)}(),function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var t=this;if(!t.ctx||!t.ctx.listener)return t;for(var s=t._howls.length-1;s>=0;s--)t._howls[s].stereo(e);return t},HowlerGlobal.prototype.pos=function(e,t,s){var i=this;return i.ctx&&i.ctx.listener?(t="number"!=typeof t?i._pos[1]:t,s="number"!=typeof s?i._pos[2]:s,"number"!=typeof e?i._pos:(i._pos=[e,t,s],void 0!==i.ctx.listener.positionX?(i.ctx.listener.positionX.setTargetAtTime(i._pos[0],Howler.ctx.currentTime,.1),i.ctx.listener.positionY.setTargetAtTime(i._pos[1],Howler.ctx.currentTime,.1),i.ctx.listener.positionZ.setTargetAtTime(i._pos[2],Howler.ctx.currentTime,.1)):i.ctx.listener.setPosition(i._pos[0],i._pos[1],i._pos[2]),i)):i},HowlerGlobal.prototype.orientation=function(e,t,s,i,n,a){var r=this;if(!r.ctx||!r.ctx.listener)return r;var o=r._orientation;return t="number"!=typeof t?o[1]:t,s="number"!=typeof s?o[2]:s,i="number"!=typeof i?o[3]:i,n="number"!=typeof n?o[4]:n,a="number"!=typeof a?o[5]:a,"number"!=typeof e?o:(r._orientation=[e,t,s,i,n,a],void 0!==r.ctx.listener.forwardX?(r.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),r.ctx.listener.forwardY.setTargetAtTime(t,Howler.ctx.currentTime,.1),r.ctx.listener.forwardZ.setTargetAtTime(s,Howler.ctx.currentTime,.1),r.ctx.listener.upX.setTargetAtTime(i,Howler.ctx.currentTime,.1),r.ctx.listener.upY.setTargetAtTime(n,Howler.ctx.currentTime,.1),r.ctx.listener.upZ.setTargetAtTime(a,Howler.ctx.currentTime,.1)):r.ctx.listener.setOrientation(e,t,s,i,n,a),r)},Howl.prototype.init=function(e){return function(t){var s=this;return s._orientation=t.orientation||[1,0,0],s._stereo=t.stereo||null,s._pos=t.pos||null,s._pannerAttr={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:360,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:360,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:0,distanceModel:void 0!==t.distanceModel?t.distanceModel:"inverse",maxDistance:void 0!==t.maxDistance?t.maxDistance:1e4,panningModel:void 0!==t.panningModel?t.panningModel:"HRTF",refDistance:void 0!==t.refDistance?t.refDistance:1,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:1},s._onstereo=t.onstereo?[{fn:t.onstereo}]:[],s._onpos=t.onpos?[{fn:t.onpos}]:[],s._onorientation=t.onorientation?[{fn:t.onorientation}]:[],e.call(this,t)}}(Howl.prototype.init),Howl.prototype.stereo=function(t,s){var i=this;if(!i._webAudio)return i;if("loaded"!==i._state)return i._queue.push({event:"stereo",action:function(){i.stereo(t,s)}}),i;var n=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===s){if("number"!=typeof t)return i._stereo;i._stereo=t,i._pos=[t,0,0]}for(var a=i._getSoundIds(s),r=0;r<a.length;r++){var o=i._soundById(a[r]);if(o){if("number"!=typeof t)return o._stereo;o._stereo=t,o._pos=[t,0,0],o._node&&(o._pannerAttr.panningModel="equalpower",o._panner&&o._panner.pan||e(o,n),"spatial"===n?void 0!==o._panner.positionX?(o._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),o._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),o._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):o._panner.setPosition(t,0,0):o._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),i._emit("stereo",o._id)}}return i},Howl.prototype.pos=function(t,s,i,n){var a=this;if(!a._webAudio)return a;if("loaded"!==a._state)return a._queue.push({event:"pos",action:function(){a.pos(t,s,i,n)}}),a;if(s="number"!=typeof s?0:s,i="number"!=typeof i?-.5:i,void 0===n){if("number"!=typeof t)return a._pos;a._pos=[t,s,i]}for(var r=a._getSoundIds(n),o=0;o<r.length;o++){var l=a._soundById(r[o]);if(l){if("number"!=typeof t)return l._pos;l._pos=[t,s,i],l._node&&(l._panner&&!l._panner.pan||e(l,"spatial"),void 0!==l._panner.positionX?(l._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(s,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(i,Howler.ctx.currentTime)):l._panner.setPosition(t,s,i)),a._emit("pos",l._id)}}return a},Howl.prototype.orientation=function(t,s,i,n){var a=this;if(!a._webAudio)return a;if("loaded"!==a._state)return a._queue.push({event:"orientation",action:function(){a.orientation(t,s,i,n)}}),a;if(s="number"!=typeof s?a._orientation[1]:s,i="number"!=typeof i?a._orientation[2]:i,void 0===n){if("number"!=typeof t)return a._orientation;a._orientation=[t,s,i]}for(var r=a._getSoundIds(n),o=0;o<r.length;o++){var l=a._soundById(r[o]);if(l){if("number"!=typeof t)return l._orientation;l._orientation=[t,s,i],l._node&&(l._panner||(l._pos||(l._pos=a._pos||[0,0,-.5]),e(l,"spatial")),void 0!==l._panner.orientationX?(l._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),l._panner.orientationY.setValueAtTime(s,Howler.ctx.currentTime),l._panner.orientationZ.setValueAtTime(i,Howler.ctx.currentTime)):l._panner.setOrientation(t,s,i)),a._emit("orientation",l._id)}}return a},Howl.prototype.pannerAttr=function(){var t,s,i,n=this,a=arguments;if(!n._webAudio)return n;if(0===a.length)return n._pannerAttr;if(1===a.length){if("object"!=typeof a[0])return(i=n._soundById(parseInt(a[0],10)))?i._pannerAttr:n._pannerAttr;t=a[0],void 0===s&&(t.pannerAttr||(t.pannerAttr={coneInnerAngle:t.coneInnerAngle,coneOuterAngle:t.coneOuterAngle,coneOuterGain:t.coneOuterGain,distanceModel:t.distanceModel,maxDistance:t.maxDistance,refDistance:t.refDistance,rolloffFactor:t.rolloffFactor,panningModel:t.panningModel}),n._pannerAttr={coneInnerAngle:void 0!==t.pannerAttr.coneInnerAngle?t.pannerAttr.coneInnerAngle:n._coneInnerAngle,coneOuterAngle:void 0!==t.pannerAttr.coneOuterAngle?t.pannerAttr.coneOuterAngle:n._coneOuterAngle,coneOuterGain:void 0!==t.pannerAttr.coneOuterGain?t.pannerAttr.coneOuterGain:n._coneOuterGain,distanceModel:void 0!==t.pannerAttr.distanceModel?t.pannerAttr.distanceModel:n._distanceModel,maxDistance:void 0!==t.pannerAttr.maxDistance?t.pannerAttr.maxDistance:n._maxDistance,refDistance:void 0!==t.pannerAttr.refDistance?t.pannerAttr.refDistance:n._refDistance,rolloffFactor:void 0!==t.pannerAttr.rolloffFactor?t.pannerAttr.rolloffFactor:n._rolloffFactor,panningModel:void 0!==t.pannerAttr.panningModel?t.pannerAttr.panningModel:n._panningModel})}else 2===a.length&&(t=a[0],s=parseInt(a[1],10));for(var r=n._getSoundIds(s),o=0;o<r.length;o++)if(i=n._soundById(r[o])){var l=i._pannerAttr;l={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:l.coneInnerAngle,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:l.coneOuterAngle,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:l.coneOuterGain,distanceModel:void 0!==t.distanceModel?t.distanceModel:l.distanceModel,maxDistance:void 0!==t.maxDistance?t.maxDistance:l.maxDistance,refDistance:void 0!==t.refDistance?t.refDistance:l.refDistance,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:l.rolloffFactor,panningModel:void 0!==t.panningModel?t.panningModel:l.panningModel};var c=i._panner;c||(i._pos||(i._pos=n._pos||[0,0,-.5]),e(i,"spatial"),c=i._panner),c.coneInnerAngle=l.coneInnerAngle,c.coneOuterAngle=l.coneOuterAngle,c.coneOuterGain=l.coneOuterGain,c.distanceModel=l.distanceModel,c.maxDistance=l.maxDistance,c.refDistance=l.refDistance,c.rolloffFactor=l.rolloffFactor,c.panningModel=l.panningModel}return n},Sound.prototype.init=function(e){return function(){var t=this,s=t._parent;t._orientation=s._orientation,t._stereo=s._stereo,t._pos=s._pos,t._pannerAttr=s._pannerAttr,e.call(this),t._stereo?s.stereo(t._stereo):t._pos&&s.pos(t._pos[0],t._pos[1],t._pos[2],t._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var t=this,s=t._parent;return t._orientation=s._orientation,t._stereo=s._stereo,t._pos=s._pos,t._pannerAttr=s._pannerAttr,t._stereo?s.stereo(t._stereo):t._pos?s.pos(t._pos[0],t._pos[1],t._pos[2],t._id):t._panner&&(t._panner.disconnect(0),t._panner=void 0,s._refreshBuffer(t)),e.call(this)}}(Sound.prototype.reset);var e=function(e,t){"spatial"===(t=t||"spatial")?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,void 0!==e._panner.positionX?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),void 0!==e._panner.orientationX?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}}();const va=Us.createContext(void 0),wa=({children:e})=>{const[t,s]=Us.useState(()=>{const e=localStorage.getItem("nexus-audio-muted");return!!e&&JSON.parse(e)}),[i,n]=Us.useState(()=>{const e=localStorage.getItem("nexus-audio-volume");return e?JSON.parse(e):.5});Us.useEffect(()=>{localStorage.setItem("nexus-audio-muted",JSON.stringify(t))},[t]),Us.useEffect(()=>{localStorage.setItem("nexus-audio-volume",JSON.stringify(i))},[i]);const a=Us.useCallback(()=>s(e=>!e),[]),r=Us.useCallback(e=>n(e),[]),o=Us.useCallback(e=>{t||console.log(`[SoundContext] Playing: ${e}`)},[t]);return ie.jsx(va.Provider,{value:{isMuted:t,volume:i,toggleMute:a,setGlobalVolume:r,playSfx:o},children:e})},Ia="/sounds/hover_glass.mp3",Ca="/sounds/click_activate.mp3",Ea="/sounds/success_chime.mp3",Ba="/sounds/menu_open.mp3",Qa="/sounds/data_pulse.mp3",Sa="/sounds/error_buzzer.mp3",_a="/sounds/menu_open.mp3",ka=(e,t)=>{const s=Us.useRef(null);Us.useEffect(()=>(s.current=new ya.Howl({src:[e],preload:!0,volume:t.volume}),()=>{var e;null==(e=s.current)||e.unload()}),[e]),Us.useEffect(()=>{s.current&&s.current.volume(t.volume)},[t.volume]);return[Us.useCallback(()=>{t.soundEnabled&&s.current&&s.current.play()},[t.soundEnabled])]},Ta=()=>{const{isMuted:e,volume:t}=(()=>{const e=Us.useContext(va);if(!e)throw new Error("useSoundContext must be used within a SoundProvider");return e})(),[s]=ka(Ia,{volume:.2*t,soundEnabled:!e}),[i]=ka(Ca,{volume:.4*t,soundEnabled:!e}),[n]=ka(Ea,{volume:.3*t,soundEnabled:!e}),[a]=ka(Ba,{volume:.15*t,soundEnabled:!e}),[r]=ka(Qa,{volume:.25*t,soundEnabled:!e}),[o]=ka(Sa,{volume:.4*t,soundEnabled:!e}),[l]=ka(_a,{volume:.2*t,soundEnabled:!e});return{playHover:s,playClick:i,playSuccess:n,playWhoosh:a,playPop:r,playError:o,playToggle:l}},Ma=()=>{const[e,t]=Us.useState(!1),{playWhoosh:s,playPop:i}=Ta(),[n,a]=Us.useState(""),[r,o]=Us.useState(["SISTEMA OPERATIVO AIGESTION v2.6","Consola de comandos autorizada.",'Escribe "help" para ver opciones.']),l=Us.useRef(null);Us.useEffect(()=>{const n=n=>{n.ctrlKey&&"`"===n.key&&(e?i():s(),t(e=>!e)),"Escape"===n.key&&e&&t(!1)};return window.addEventListener("keydown",n),()=>window.removeEventListener("keydown",n)},[e]),Us.useEffect(()=>{e&&setTimeout(()=>{var e;return null==(e=l.current)?void 0:e.focus()},100)},[e]);return ie.jsx(zs,{children:e&&ie.jsx(qs.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"fixed inset-x-0 top-0 z-[100] p-4 font-mono",children:ie.jsxs("div",{className:"max-w-4xl mx-auto premium-glass border-nexus-cyan/30 bg-black/95 rounded-b-2xl overflow-hidden shadow-[0_0_50px_rgba(0,245,255,0.2)] relative",children:[ie.jsx("div",{className:"scanline pointer-events-none"}),ie.jsx("div",{className:"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-[0.05] pointer-events-none"}),ie.jsxs("div",{className:"bg-nexus-cyan/5 px-4 py-2 border-b border-nexus-cyan/20 flex justify-between items-center text-[10px] font-orbitron tracking-[0.2em] text-nexus-cyan",children:[ie.jsxs("span",{className:"flex items-center gap-2",children:[ie.jsx("span",{className:"animate-pulse",children:""}),"AIGESTION_TERMINAL_v2.6 // SECURE_SHELL"]}),ie.jsxs("div",{className:"flex gap-2",children:[ie.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500/50 shadow-[0_0_10px_rgba(239,68,68,0.5)]"}),ie.jsx("div",{className:"w-2 h-2 rounded-full bg-yellow-500/50 shadow-[0_0_10px_rgba(234,179,8,0.5)]"}),ie.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500/50 shadow-[0_0_10px_rgba(34,197,94,0.5)]"})]})]}),ie.jsx("div",{className:"h-64 overflow-y-auto p-6 font-mono text-xs space-y-2 scrollbar-hide",children:r.map((e,t)=>ie.jsx("div",{className:e.startsWith(">")?"text-nexus-cyan-glow":"text-nexus-silver",children:e},t))}),ie.jsxs("form",{onSubmit:e=>{e.preventDefault();const s=n.trim().toLowerCase();if(!s)return;const i=[`> ${n}`];switch(s){case"help":i.push("COMANDOS DISPONIBLES:","- help: Muestra esta ayuda","- clear: Limpia la terminal","- daniela: Estado del ncleo de voz","- exit: Cierra la terminal","- status: Estado de los nodos globales");break;case"clear":return o([]),void a("");case"daniela":i.push("DANIELA AI: ESTADO OPTIMAL","Latencia: 12ms","Sentimiento: Neutral/Analtico");break;case"status":i.push("NODOS ACTIVOS: 142","Carga de Red: 24%","Sincronizacin: 100%");break;case"exit":t(!1);break;default:i.push(`Error: Comando "${s}" no reconocido.`)}o(e=>[...e,...i]),a("")},className:"p-4 bg-white/5 border-t border-white/5 flex items-center gap-3",children:[ie.jsx("span",{className:"text-nexus-cyan-glow font-mono",children:"$"}),ie.jsx("input",{ref:l,type:"text",value:n,onChange:e=>a(e.target.value),className:"bg-transparent border-none outline-none flex-1 font-mono text-nexus-cyan-glow",placeholder:"Escribe un comando..."})]})]})})})},Ra=()=>ie.jsxs("div",{className:"fixed inset-0 -z-40 pointer-events-none overflow-hidden opacity-20",children:[ie.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"\n            linear-gradient(to right, rgba(0, 245, 255, 0.1) 1px, transparent 1px),\n            linear-gradient(to bottom, rgba(0, 245, 255, 0.1) 1px, transparent 1px)\n          ",backgroundSize:"40px 40px",maskImage:"radial-gradient(circle at 50% 50%, black, transparent 80%)"}}),ie.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-[40%] origin-bottom [transform:rotateX(60deg)]",style:{backgroundImage:"\n            linear-gradient(to right, rgba(138, 43, 226, 0.2) 1px, transparent 1px),\n            linear-gradient(to bottom, rgba(138, 43, 226, 0.2) 1px, transparent 1px)\n          ",backgroundSize:"100px 100px"}})]}),Da=({children:e,className:t=""})=>{const s=Us.useRef(null),[i,n]=Us.useState({x:0,y:0}),{x:a,y:r}=i;return ie.jsx(qs.div,{ref:s,onMouseMove:e=>{var t;const{clientX:i,clientY:a}=e,{height:r,width:o,left:l,top:c}=(null==(t=s.current)?void 0:t.getBoundingClientRect())||{height:0,width:0,left:0,top:0};n({x:.5*(i-(l+o/2)),y:.5*(a-(c+r/2))})},onMouseLeave:()=>{n({x:0,y:0})},animate:{x:a,y:r},transition:{type:"spring",stiffness:150,damping:15,mass:.1},className:`magnetic-wrap ${t}`,children:e})},Na={hover_glass:{src:"/sounds/hover_glass.mp3",volume:.1},click_activate:{src:"/sounds/click_activate.mp3",volume:.3},menu_open:{src:"/sounds/menu_open.mp3",volume:.2},success_chime:{src:"/sounds/success_chime.mp3",volume:.2},error_buzzer:{src:"/sounds/error_buzzer.mp3",volume:.2},nexus_hum:{src:"/sounds/nexus_hum.mp3",volume:.05,loop:!0},wuaw_subtle:{src:"/sounds/wuaw_subtle.mp3",volume:.15},data_pulse:{src:"/sounds/data_pulse.mp3",volume:.1}},Fa=class e{constructor(){W(this,"sounds",new Map),W(this,"isMuted",!1),W(this,"ambienceId",null);const e=localStorage.getItem("aigestion_mute");e&&(this.isMuted=JSON.parse(e),ya.Howler.mute(this.isMuted)),this.loadSound("hover_glass"),this.loadSound("click_activate")}static getInstance(){return e.instance||(e.instance=new e),e.instance}loadSound(e){if(this.sounds.has(e))return this.sounds.get(e);const t=Na[e],s=new ya.Howl({src:[t.src],volume:t.volume,loop:t.loop,preload:!0,onloaderror:(e,t)=>{}});return this.sounds.set(e,s),s}play(e){if(this.isMuted&&"nexus_hum"!==e)return;this.loadSound(e).play()}startAmbience(){if(this.isMuted||this.ambienceId)return;const e=this.loadSound("nexus_hum");e.playing()||(this.ambienceId=e.play(),e.fade(0,Na.nexus_hum.volume,2e3,this.ambienceId))}stopAmbience(){const e=this.sounds.get("nexus_hum");e&&this.ambienceId&&(e.fade(e.volume(),0,2e3,this.ambienceId),setTimeout(()=>{e.stop(),this.ambienceId=null},2e3))}toggleMute(){return this.isMuted=!this.isMuted,ya.Howler.mute(this.isMuted),localStorage.setItem("aigestion_mute",JSON.stringify(this.isMuted)),this.isMuted&&this.stopAmbience(),this.isMuted}getMutedState(){return this.isMuted}};W(Fa,"instance");const ja=Fa.getInstance(),La=()=>{const[e,t]=Us.useState(ja.getMutedState());return ie.jsx("button",{onClick:()=>{const e=ja.toggleMute();t(e),e||ja.play("success_chime")},className:"p-2 text-white/50 hover:text-nexus-cyan transition-colors",title:e?"Unmute Sound":"Mute Sound",children:e?ie.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[ie.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"}),ie.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2"})]}):ie.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:ie.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"})})})},Pa=()=>{const{playHover:e,playClick:t,playWhoosh:s}=Ta(),[i,n]=Us.useState(!1),[a,r]=Us.useState(!1),o=Hn();Us.useEffect(()=>{const e=()=>{n(window.scrollY>20)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]);const l=[{label:"Hablar con Daniela",path:"/daniela"},{label:"Ver en 3D",path:"#viture-xr",isHash:!0},{label:"Ver mi Oficina",path:"/virtual-office"},{label:"Probar el Panel",path:"/demo"}],c=(e,s)=>{if(t(),r(!1),s){const t=document.querySelector(e);null==t||t.scrollIntoView({behavior:"smooth"})}};return ie.jsxs(qs.nav,{initial:{y:-100},animate:{y:0},transition:{duration:.8,ease:[.16,1,.3,1]},className:"fixed top-0 w-full z-50 transition-all duration-500 "+(i?"bg-black/80 backdrop-blur-xl border-b border-white/5 py-3":"bg-transparent py-6"),children:[ie.jsxs("div",{className:"max-w-7xl mx-auto px-6 flex justify-between items-center",children:[ie.jsxs(ua,{to:"/",onClick:()=>c("/"),onMouseEnter:e,className:"group flex items-center gap-0 relative",children:[ie.jsxs("div",{className:"relative z-10 w-10 h-10 mr-3 transition-transform duration-500 group-hover:scale-110 group-hover:rotate-12",children:[ie.jsx("div",{className:"absolute inset-0 bg-nexus-violet/50 blur-lg rounded-full opacity-50 group-hover:opacity-100 transition-opacity"}),ie.jsx("img",{src:"/images/brand/logo.png",alt:"Logo",className:"w-full h-full object-contain filter drop-shadow-[0_0_8px_rgba(138,43,226,0.5)]"})]}),ie.jsxs("div",{className:"flex flex-col justify-center h-10",children:[ie.jsxs("h1",{className:"font-orbitron font-black text-xl tracking-[0.1em] leading-none text-white group-hover:text-transparent group-hover:bg-clip-text group-hover:bg-gradient-to-r group-hover:from-white group-hover:via-nexus-cyan group-hover:to-nexus-violet transition-all duration-300",children:["AIGESTION",ie.jsx("span",{className:"text-nexus-cyan-glow",children:".NET"})]}),ie.jsx("span",{className:"text-[8px] font-mono text-nexus-silver/50 tracking-[0.3em] uppercase opacity-0 group-hover:opacity-100 transition-opacity duration-300 -mt-1",children:"CONTROL MAESTRO"})]})]}),ie.jsx("div",{className:"hidden lg:flex items-center gap-8",children:l.map(t=>ie.jsxs(ua,{to:t.path,onClick:e=>{t.isHash?(e.preventDefault(),c(t.path,!0)):c(t.path)},onMouseEnter:e,className:"relative font-orbitron text-[11px] font-bold tracking-[0.15em] uppercase transition-colors duration-300 hover:text-white "+(o.pathname===t.path?"text-nexus-cyan":"text-nexus-silver/70"),children:[t.label,ie.jsx("span",{className:"absolute -bottom-1 left-0 w-0 h-[2px] bg-nexus-cyan transition-all duration-300 group-hover:w-full"})]},t.label))}),ie.jsxs("div",{className:"flex items-center gap-4",children:[ie.jsx(La,{}),ie.jsx(Da,{strength:20,children:ie.jsxs(ua,{to:"/login",onMouseEnter:()=>{e(),s()},onClick:t,className:"hidden sm:flex group relative items-center gap-3 px-6 py-2.5 overflow-hidden rounded-full bg-white/5 border border-white/10 hover:border-nexus-violet/50 transition-all duration-300",children:[ie.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-nexus-violet/20 via-nexus-cyan/20 to-nexus-violet/20 opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),ie.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-1000 ease-in-out"}),ie.jsx($s,{size:14,className:"text-nexus-violet-glow group-hover:text-white transition-colors"}),ie.jsx("span",{className:"relative font-orbitron text-[10px] font-bold tracking-[0.2em] uppercase text-white group-hover:text-shadow-glow",children:"ENTRAR"}),ie.jsx(Xs,{size:14,className:"text-nexus-silver/50 group-hover:text-white group-hover:translate-x-1 transition-all"})]})}),ie.jsx("button",{className:"lg:hidden p-2 text-white hover:text-nexus-cyan transition-colors",onClick:()=>r(!a),children:a?ie.jsx(Zs,{size:24}):ie.jsx(ei,{size:24})})]})]}),ie.jsx(zs,{children:a&&ie.jsx(qs.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"lg:hidden bg-nexus-obsidian/95 backdrop-blur-xl border-b border-white/10 overflow-hidden",children:ie.jsxs("div",{className:"flex flex-col p-6 gap-4",children:[l.map(e=>ie.jsx(ua,{to:e.path,onClick:t=>{e.isHash?(t.preventDefault(),c(e.path,!0)):c(e.path)},className:"font-orbitron text-sm font-bold tracking-widest text-nexus-silver hover:text-white hover:pl-2 transition-all border-b border-white/5 pb-4",children:e.label},e.label)),ie.jsx(ua,{to:"/login",onClick:()=>c("/login"),className:"btn-primary mt-4 w-full justify-center",children:"ENTRAR"})]})})})]})},Ua=()=>{const e=Array.from({length:20});return ie.jsx("div",{className:"fixed inset-0 -z-30 pointer-events-none overflow-hidden",children:e.map((e,t)=>ie.jsx(qs.div,{className:"absolute w-1 h-1 bg-nexus-cyan/20 rounded-full",initial:{x:100*Math.random()+"%",y:100*Math.random()+"%",scale:.5*Math.random()+.5},animate:{y:["-10%","110%"],opacity:[0,.5,0],x:[null,50*(Math.random()-.5)+"%"]},transition:{duration:10*Math.random()+10,repeat:1/0,ease:"linear",delay:10*Math.random()}},`particle-${t}`))})},Oa=()=>{const[e,t]=Us.useState(!1),s=Vs(-100),i=Vs(-100),n={damping:25,stiffness:700},a=Ks(s,n),r=Ks(i,n);return Us.useEffect(()=>{const e=e=>{s.set(e.clientX-16),i.set(e.clientY-16)},n=e=>{const s=e.target;"BUTTON"===s.tagName||"A"===s.tagName||s.closest("button")||s.closest("a")||s.classList.contains("interactive")?t(!0):t(!1)};return window.addEventListener("mousemove",e),window.addEventListener("mouseover",n),document.body.classList.add("custom-cursor"),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("mouseover",n),document.body.classList.remove("custom-cursor")}},[]),ie.jsxs(ie.Fragment,{children:[ie.jsx(qs.div,{className:"fixed top-0 left-0 w-8 h-8 rounded-full border border-nexus-cyan pointer-events-none z-[9999] mix-blend-difference",style:{x:a,y:r,scale:e?1.5:1},animate:{borderColor:e?"var(--color-nexus-violet)":"var(--color-nexus-cyan)"}}),ie.jsx(qs.div,{className:"fixed top-0 left-0 w-2 h-2 bg-nexus-cyan rounded-full pointer-events-none z-[9999] mix-blend-difference",style:{x:s,y:i,translateX:12,translateY:12},animate:{backgroundColor:e?"var(--color-nexus-violet)":"var(--color-nexus-cyan)"}})]})},Ga=()=>{const{scrollYProgress:e}=Js(),t=Ks(e,{stiffness:100,damping:30,restDelta:.001});return ie.jsx(qs.div,{className:"fixed top-0 left-0 right-0 h-[2px] bg-gradient-to-r from-nexus-violet via-nexus-cyan to-nexus-violet origin-left z-[100]",style:{scaleX:t}})},Ha=e=>{console.log(`[AudioService] Playing: ${e} (silent mode)`)},qa=globalThis,za=qa.ShadowRoot&&(void 0===qa.ShadyCSS||qa.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Va=Symbol(),Ka=new WeakMap;let Ja=class{constructor(e,t,s){if(this._$cssResult$=!0,s!==Va)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(za&&void 0===e){const s=void 0!==t&&1===t.length;s&&(e=Ka.get(t)),void 0===e&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),s&&Ka.set(t,e))}return e}toString(){return this.cssText}};const Ya=za?e=>e:e=>e instanceof CSSStyleSheet?(e=>{let t="";for(const s of e.cssRules)t+=s.cssText;return(e=>new Ja("string"==typeof e?e:e+"",void 0,Va))(t)})(e):e,{is:Wa,defineProperty:$a,getOwnPropertyDescriptor:Xa,getOwnPropertyNames:Za,getOwnPropertySymbols:er,getPrototypeOf:tr}=Object,sr=globalThis,ir=sr.trustedTypes,nr=ir?ir.emptyScript:"",ar=sr.reactiveElementPolyfillSupport,rr=(e,t)=>e,or={toAttribute(e,t){switch(t){case Boolean:e=e?nr:null;break;case Object:case Array:e=null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){let s=e;switch(t){case Boolean:s=null!==e;break;case Number:s=null===e?null:Number(e);break;case Object:case Array:try{s=JSON.parse(e)}catch(i){s=null}}return s}},lr=(e,t)=>!Wa(e,t),cr={attribute:!0,type:String,converter:or,reflect:!1,useDefault:!1,hasChanged:lr};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),sr.litPropertyMetadata??(sr.litPropertyMetadata=new WeakMap);let Ar=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??(this.l=[])).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,t=cr){if(t.state&&(t.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((t=Object.create(t)).wrapped=!0),this.elementProperties.set(e,t),!t.noAccessor){const s=Symbol(),i=this.getPropertyDescriptor(e,s,t);void 0!==i&&$a(this.prototype,e,i)}}static getPropertyDescriptor(e,t,s){const{get:i,set:n}=Xa(this.prototype,e)??{get(){return this[t]},set(e){this[t]=e}};return{get:i,set(t){const a=null==i?void 0:i.call(this);null==n||n.call(this,t),this.requestUpdate(e,a,s)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??cr}static _$Ei(){if(this.hasOwnProperty(rr("elementProperties")))return;const e=tr(this);e.finalize(),void 0!==e.l&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(rr("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(rr("properties"))){const e=this.properties,t=[...Za(e),...er(e)];for(const s of t)this.createProperty(s,e[s])}const e=this[Symbol.metadata];if(null!==e){const t=litPropertyMetadata.get(e);if(void 0!==t)for(const[e,s]of t)this.elementProperties.set(e,s)}this._$Eh=new Map;for(const[t,s]of this.elementProperties){const e=this._$Eu(t,s);void 0!==e&&this._$Eh.set(e,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const s=new Set(e.flat(1/0).reverse());for(const e of s)t.unshift(Ya(e))}else void 0!==e&&t.push(Ya(e));return t}static _$Eu(e,t){const s=t.attribute;return!1===s?void 0:"string"==typeof s?s:"string"==typeof e?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var e;this._$ES=new Promise(e=>this.enableUpdating=e),this._$AL=new Map,this._$E_(),this.requestUpdate(),null==(e=this.constructor.l)||e.forEach(e=>e(this))}addController(e){var t;(this._$EO??(this._$EO=new Set)).add(e),void 0!==this.renderRoot&&this.isConnected&&(null==(t=e.hostConnected)||t.call(e))}removeController(e){var t;null==(t=this._$EO)||t.delete(e)}_$E_(){const e=new Map,t=this.constructor.elementProperties;for(const s of t.keys())this.hasOwnProperty(s)&&(e.set(s,this[s]),delete this[s]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return((e,t)=>{if(za)e.adoptedStyleSheets=t.map(e=>e instanceof CSSStyleSheet?e:e.styleSheet);else for(const s of t){const t=document.createElement("style"),i=qa.litNonce;void 0!==i&&t.setAttribute("nonce",i),t.textContent=s.cssText,e.appendChild(t)}})(e,this.constructor.elementStyles),e}connectedCallback(){var e;this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null==(e=this._$EO)||e.forEach(e=>{var t;return null==(t=e.hostConnected)?void 0:t.call(e)})}enableUpdating(e){}disconnectedCallback(){var e;null==(e=this._$EO)||e.forEach(e=>{var t;return null==(t=e.hostDisconnected)?void 0:t.call(e)})}attributeChangedCallback(e,t,s){this._$AK(e,s)}_$ET(e,t){var s;const i=this.constructor.elementProperties.get(e),n=this.constructor._$Eu(e,i);if(void 0!==n&&!0===i.reflect){const a=(void 0!==(null==(s=i.converter)?void 0:s.toAttribute)?i.converter:or).toAttribute(t,i.type);this._$Em=e,null==a?this.removeAttribute(n):this.setAttribute(n,a),this._$Em=null}}_$AK(e,t){var s,i;const n=this.constructor,a=n._$Eh.get(e);if(void 0!==a&&this._$Em!==a){const e=n.getPropertyOptions(a),r="function"==typeof e.converter?{fromAttribute:e.converter}:void 0!==(null==(s=e.converter)?void 0:s.fromAttribute)?e.converter:or;this._$Em=a;const o=r.fromAttribute(t,e.type);this[a]=o??(null==(i=this._$Ej)?void 0:i.get(a))??o,this._$Em=null}}requestUpdate(e,t,s,i=!1,n){var a;if(void 0!==e){const r=this.constructor;if(!1===i&&(n=this[e]),s??(s=r.getPropertyOptions(e)),!((s.hasChanged??lr)(n,t)||s.useDefault&&s.reflect&&n===(null==(a=this._$Ej)?void 0:a.get(e))&&!this.hasAttribute(r._$Eu(e,s))))return;this.C(e,t,s)}!1===this.isUpdatePending&&(this._$ES=this._$EP())}C(e,t,{useDefault:s,reflect:i,wrapped:n},a){s&&!(this._$Ej??(this._$Ej=new Map)).has(e)&&(this._$Ej.set(e,a??t??this[e]),!0!==n||void 0!==a)||(this._$AL.has(e)||(this.hasUpdated||s||(t=void 0),this._$AL.set(e,t)),!0===i&&this._$Em!==e&&(this._$Eq??(this._$Eq=new Set)).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(t){Promise.reject(t)}const e=this.scheduleUpdate();return null!=e&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var e;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??(this.renderRoot=this.createRenderRoot()),this._$Ep){for(const[e,t]of this._$Ep)this[e]=t;this._$Ep=void 0}const e=this.constructor.elementProperties;if(e.size>0)for(const[t,s]of e){const{wrapped:e}=s,i=this[t];!0!==e||this._$AL.has(t)||void 0===i||this.C(t,void 0,s,i)}}let t=!1;const s=this._$AL;try{t=this.shouldUpdate(s),t?(this.willUpdate(s),null==(e=this._$EO)||e.forEach(e=>{var t;return null==(t=e.hostUpdate)?void 0:t.call(e)}),this.update(s)):this._$EM()}catch(i){throw t=!1,this._$EM(),i}t&&this._$AE(s)}willUpdate(e){}_$AE(e){var t;null==(t=this._$EO)||t.forEach(e=>{var t;return null==(t=e.hostUpdated)?void 0:t.call(e)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&(this._$Eq=this._$Eq.forEach(e=>this._$ET(e,this[e]))),this._$EM()}updated(e){}firstUpdated(e){}};Ar.elementStyles=[],Ar.shadowRootOptions={mode:"open"},Ar[rr("elementProperties")]=new Map,Ar[rr("finalized")]=new Map,null==ar||ar({ReactiveElement:Ar}),(sr.reactiveElementVersions??(sr.reactiveElementVersions=[])).push("2.1.2");const hr={attribute:!0,type:String,converter:or,reflect:!1,hasChanged:lr},dr=(e=hr,t,s)=>{const{kind:i,metadata:n}=s;let a=globalThis.litPropertyMetadata.get(n);if(void 0===a&&globalThis.litPropertyMetadata.set(n,a=new Map),"setter"===i&&((e=Object.create(e)).wrapped=!0),a.set(s.name,e),"accessor"===i){const{name:i}=s;return{set(s){const n=t.get.call(this);t.set.call(this,s),this.requestUpdate(i,n,e,!0,s)},init(t){return void 0!==t&&this.C(i,void 0,e,t),t}}}if("setter"===i){const{name:i}=s;return function(s){const n=this[i];t.call(this,s),this.requestUpdate(i,n,e,!0,s)}}throw Error("Unsupported decorator location: "+i)};function ur(e){return(t,s)=>"object"==typeof s?dr(e,t,s):((e,t,s)=>{const i=t.hasOwnProperty(s);return t.constructor.createProperty(s,e),i?Object.getOwnPropertyDescriptor(t,s):void 0})(e,t,s)}const pr=globalThis,gr=e=>e,mr=pr.trustedTypes,fr=mr?mr.createPolicy("lit-html",{createHTML:e=>e}):void 0,br="$lit$",xr=`lit$${Math.random().toFixed(9).slice(2)}$`,yr="?"+xr,vr=`<${yr}>`,wr=document,Ir=()=>wr.createComment(""),Cr=e=>null===e||"object"!=typeof e&&"function"!=typeof e,Er=Array.isArray,Br="[ \t\n\f\r]",Qr=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,Sr=/-->/g,_r=/>/g,kr=RegExp(`>|${Br}(?:([^\\s"'>=/]+)(${Br}*=${Br}*(?:[^ \t\n\f\r"'\`<>=]|("|')|))|$)`,"g"),Tr=/'/g,Mr=/"/g,Rr=/^(?:script|style|textarea|title)$/i,Dr=(Pr=1,(e,...t)=>({_$litType$:Pr,strings:e,values:t})),Nr=Symbol.for("lit-noChange"),Fr=Symbol.for("lit-nothing"),jr=new WeakMap,Lr=wr.createTreeWalker(wr,129);var Pr;function Ur(e,t){if(!Er(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return void 0!==fr?fr.createHTML(t):t}let Or=class e{constructor({strings:t,_$litType$:s},i){let n;this.parts=[];let a=0,r=0;const o=t.length-1,l=this.parts,[c,A]=((e,t)=>{const s=e.length-1,i=[];let n,a=2===t?"<svg>":3===t?"<math>":"",r=Qr;for(let o=0;o<s;o++){const t=e[o];let s,l,c=-1,A=0;for(;A<t.length&&(r.lastIndex=A,l=r.exec(t),null!==l);)A=r.lastIndex,r===Qr?"!--"===l[1]?r=Sr:void 0!==l[1]?r=_r:void 0!==l[2]?(Rr.test(l[2])&&(n=RegExp("</"+l[2],"g")),r=kr):void 0!==l[3]&&(r=kr):r===kr?">"===l[0]?(r=n??Qr,c=-1):void 0===l[1]?c=-2:(c=r.lastIndex-l[2].length,s=l[1],r=void 0===l[3]?kr:'"'===l[3]?Mr:Tr):r===Mr||r===Tr?r=kr:r===Sr||r===_r?r=Qr:(r=kr,n=void 0);const h=r===kr&&e[o+1].startsWith("/>")?" ":"";a+=r===Qr?t+vr:c>=0?(i.push(s),t.slice(0,c)+br+t.slice(c)+xr+h):t+xr+(-2===c?o:h)}return[Ur(e,a+(e[s]||"<?>")+(2===t?"</svg>":3===t?"</math>":"")),i]})(t,s);if(this.el=e.createElement(c,i),Lr.currentNode=this.el.content,2===s||3===s){const e=this.el.content.firstChild;e.replaceWith(...e.childNodes)}for(;null!==(n=Lr.nextNode())&&l.length<o;){if(1===n.nodeType){if(n.hasAttributes())for(const e of n.getAttributeNames())if(e.endsWith(br)){const t=A[r++],s=n.getAttribute(e).split(xr),i=/([.?@])?(.*)/.exec(t);l.push({type:1,index:a,name:i[2],strings:s,ctor:"."===i[1]?Vr:"?"===i[1]?Kr:"@"===i[1]?Jr:zr}),n.removeAttribute(e)}else e.startsWith(xr)&&(l.push({type:6,index:a}),n.removeAttribute(e));if(Rr.test(n.tagName)){const e=n.textContent.split(xr),t=e.length-1;if(t>0){n.textContent=mr?mr.emptyScript:"";for(let s=0;s<t;s++)n.append(e[s],Ir()),Lr.nextNode(),l.push({type:2,index:++a});n.append(e[t],Ir())}}}else if(8===n.nodeType)if(n.data===yr)l.push({type:2,index:a});else{let e=-1;for(;-1!==(e=n.data.indexOf(xr,e+1));)l.push({type:7,index:a}),e+=xr.length-1}a++}}static createElement(e,t){const s=wr.createElement("template");return s.innerHTML=e,s}};function Gr(e,t,s=e,i){var n,a;if(t===Nr)return t;let r=void 0!==i?null==(n=s._$Co)?void 0:n[i]:s._$Cl;const o=Cr(t)?void 0:t._$litDirective$;return(null==r?void 0:r.constructor)!==o&&(null==(a=null==r?void 0:r._$AO)||a.call(r,!1),void 0===o?r=void 0:(r=new o(e),r._$AT(e,s,i)),void 0!==i?(s._$Co??(s._$Co=[]))[i]=r:s._$Cl=r),void 0!==r&&(t=Gr(e,r._$AS(e,t.values),r,i)),t}class Hr{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:t},parts:s}=this._$AD,i=((null==e?void 0:e.creationScope)??wr).importNode(t,!0);Lr.currentNode=i;let n=Lr.nextNode(),a=0,r=0,o=s[0];for(;void 0!==o;){if(a===o.index){let t;2===o.type?t=new qr(n,n.nextSibling,this,e):1===o.type?t=new o.ctor(n,o.name,o.strings,this,e):6===o.type&&(t=new Yr(n,this,e)),this._$AV.push(t),o=s[++r]}a!==(null==o?void 0:o.index)&&(n=Lr.nextNode(),a++)}return Lr.currentNode=wr,i}p(e){let t=0;for(const s of this._$AV)void 0!==s&&(void 0!==s.strings?(s._$AI(e,s,t),t+=s.strings.length-2):s._$AI(e[t])),t++}}class qr{get _$AU(){var e;return(null==(e=this._$AM)?void 0:e._$AU)??this._$Cv}constructor(e,t,s,i){this.type=2,this._$AH=Fr,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=s,this.options=i,this._$Cv=(null==i?void 0:i.isConnected)??!0}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return void 0!==t&&11===(null==e?void 0:e.nodeType)&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=Gr(this,e,t),Cr(e)?e===Fr||null==e||""===e?(this._$AH!==Fr&&this._$AR(),this._$AH=Fr):e!==this._$AH&&e!==Nr&&this._(e):void 0!==e._$litType$?this.$(e):void 0!==e.nodeType?this.T(e):(e=>Er(e)||"function"==typeof(null==e?void 0:e[Symbol.iterator]))(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==Fr&&Cr(this._$AH)?this._$AA.nextSibling.data=e:this.T(wr.createTextNode(e)),this._$AH=e}$(e){var t;const{values:s,_$litType$:i}=e,n="number"==typeof i?this._$AC(e):(void 0===i.el&&(i.el=Or.createElement(Ur(i.h,i.h[0]),this.options)),i);if((null==(t=this._$AH)?void 0:t._$AD)===n)this._$AH.p(s);else{const e=new Hr(n,this),t=e.u(this.options);e.p(s),this.T(t),this._$AH=e}}_$AC(e){let t=jr.get(e.strings);return void 0===t&&jr.set(e.strings,t=new Or(e)),t}k(e){Er(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let s,i=0;for(const n of e)i===t.length?t.push(s=new qr(this.O(Ir()),this.O(Ir()),this,this.options)):s=t[i],s._$AI(n),i++;i<t.length&&(this._$AR(s&&s._$AB.nextSibling,i),t.length=i)}_$AR(e=this._$AA.nextSibling,t){var s;for(null==(s=this._$AP)||s.call(this,!1,!0,t);e!==this._$AB;){const t=gr(e).nextSibling;gr(e).remove(),e=t}}setConnected(e){var t;void 0===this._$AM&&(this._$Cv=e,null==(t=this._$AP)||t.call(this,e))}}class zr{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,s,i,n){this.type=1,this._$AH=Fr,this._$AN=void 0,this.element=e,this.name=t,this._$AM=i,this.options=n,s.length>2||""!==s[0]||""!==s[1]?(this._$AH=Array(s.length-1).fill(new String),this.strings=s):this._$AH=Fr}_$AI(e,t=this,s,i){const n=this.strings;let a=!1;if(void 0===n)e=Gr(this,e,t,0),a=!Cr(e)||e!==this._$AH&&e!==Nr,a&&(this._$AH=e);else{const i=e;let r,o;for(e=n[0],r=0;r<n.length-1;r++)o=Gr(this,i[s+r],t,r),o===Nr&&(o=this._$AH[r]),a||(a=!Cr(o)||o!==this._$AH[r]),o===Fr?e=Fr:e!==Fr&&(e+=(o??"")+n[r+1]),this._$AH[r]=o}a&&!i&&this.j(e)}j(e){e===Fr?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}let Vr=class extends zr{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===Fr?void 0:e}};class Kr extends zr{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==Fr)}}class Jr extends zr{constructor(e,t,s,i,n){super(e,t,s,i,n),this.type=5}_$AI(e,t=this){if((e=Gr(this,e,t,0)??Fr)===Nr)return;const s=this._$AH,i=e===Fr&&s!==Fr||e.capture!==s.capture||e.once!==s.once||e.passive!==s.passive,n=e!==Fr&&(s===Fr||i);i&&this.element.removeEventListener(this.name,this,s),n&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t;"function"==typeof this._$AH?this._$AH.call((null==(t=this.options)?void 0:t.host)??this.element,e):this._$AH.handleEvent(e)}}class Yr{constructor(e,t,s){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=s}get _$AU(){return this._$AM._$AU}_$AI(e){Gr(this,e)}}const Wr=pr.litHtmlPolyfillSupport;null==Wr||Wr(Or,qr),(pr.litHtmlVersions??(pr.litHtmlVersions=[])).push("3.3.2");const $r=(e,t,s)=>{const i=(null==s?void 0:s.renderBefore)??t;let n=i._$litPart$;if(void 0===n){const e=(null==s?void 0:s.renderBefore)??null;i._$litPart$=n=new qr(t.insertBefore(Ir(),e),e,void 0,s??{})}return n._$AI(e),n},Xr=globalThis;let Zr=class extends Ar{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var e;const t=super.createRenderRoot();return(e=this.renderOptions).renderBefore??(e.renderBefore=t.firstChild),t}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=$r(t,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),null==(e=this._$Do)||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),null==(e=this._$Do)||e.setConnected(!1)}render(){return Nr}};Zr._$litElement$=!0,Zr.finalized=!0,null==(e=Xr.litElementHydrateSupport)||e.call(Xr,{LitElement:Zr});const eo=Xr.litElementPolyfillSupport;null==eo||eo({LitElement:Zr}),(Xr.litElementVersions??(Xr.litElementVersions=[])).push("4.2.2");const to=null!=navigator.xr&&null!=self.XRSession&&null!=navigator.xr.isSessionSupported,so=to&&null!=self.XRSession.prototype.requestHitTestSource,io=null!=self.ResizeObserver,no=null!=self.IntersectionObserver,ao=so;(()=>{const e=navigator.userAgent||navigator.vendor||self.opera;let t=!1;(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0)})();const ro=/android/i.test(navigator.userAgent),oo=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!self.MSStream||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,lo=/firefox/i.test(navigator.userAgent),co=/OculusBrowser/.test(navigator.userAgent),Ao=ro&&!lo&&!co,ho=Boolean(window.webkit&&window.webkit.messageHandlers),uo=(()=>{if(oo){if(ho)return Boolean(/CriOS\/|EdgiOS\/|FxiOS\/|GSA\/|DuckDuckGo\//.test(navigator.userAgent));{const e=document.createElement("a");return Boolean(e.relList&&e.relList.supports&&e.relList.supports("ar"))}}return!1})(),po=e=>e&&"null"!==e?mo(e):null,go=()=>{if(ao)return;const e=[];throw to||e.push("WebXR Device API"),so||e.push("WebXR Hit Test API"),new Error(`The following APIs are required for AR, but are missing in this browser: ${e.join(", ")}`)},mo=e=>new URL(e,window.location.toString()).toString(),fo=(e,t)=>{let s=null;return(...i)=>{null!=s&&self.clearTimeout(s),s=self.setTimeout(()=>{s=null,e(...i)},t)}},bo=(e,t,s)=>Math.max(t,Math.min(s,e)),xo=(()=>{const e=new RegExp("[?&]model-viewer-debug-mode(&|$)");return()=>self.ModelViewerElement&&self.ModelViewerElement.debugMode||self.location&&self.location.search&&self.location.search.match(e)})();var yo=function(e,t,s,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(r=(a<3?n(r):a>3?n(t,s,r):n(t,s))||r);return a>3&&r&&Object.defineProperty(t,s,r),r};const vo=Symbol("currentEnvironmentMap"),wo=Symbol("currentBackground"),Io=Symbol("updateEnvironment"),Co=Symbol("cancelEnvironmentUpdate"),Eo=Dr`
<style>
:host {
  display: block;
  position: relative;
  contain: strict;
  width: 300px;
  height: 150px;
}

.container {
  position: relative;
  overflow: hidden;
}

.userInput {
  width: 100%;
  height: 100%;
  display: none;
  position: relative;
  outline-offset: -1px;
  outline-width: 1px;
}

canvas {
  position: absolute;
  display: none;
  pointer-events: none;
  /* NOTE(cdata): Chrome 76 and below apparently have a bug
   * that causes our canvas not to display pixels unless it is
   * on its own render layer
   * @see https://github.com/google/model-viewer/pull/755#issuecomment-536597893
   */
  transform: translateZ(0);
}

.show {
  display: block;
}

/* Adapted from HTML5 Boilerplate
 *
 * @see https://github.com/h5bp/html5-boilerplate/blob/ceb4620c78fc82e13534fc44202a3f168754873f/dist/css/main.css#L122-L133 */
.screen-reader-only {
  border: 0;
  left: 0;
  top: 0;
  clip: rect(0, 0, 0, 0);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  white-space: nowrap;
  width: 1px;
  pointer-events: none;
}

.slot {
  position: absolute;
  pointer-events: none;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}

.slot > * {
  pointer-events: initial;
}

.annotation-wrapper ::slotted(*) {
  opacity: var(--max-hotspot-opacity, 1);
  transition: opacity 0.3s;
}

.pointer-tumbling .annotation-wrapper ::slotted(*) {
  pointer-events: none;
}

.annotation-wrapper ::slotted(*) {
  pointer-events: initial;
}

.annotation-wrapper.hide ::slotted(*) {
  opacity: var(--min-hotspot-opacity, 0.25);
}

.slot.poster {
  display: none;
  background-color: inherit;
}

.slot.poster.show {
  display: inherit;
}

.slot.poster > * {
  pointer-events: initial;
}

.slot.poster:not(.show) > * {
  pointer-events: none;
}

#default-poster {
  width: 100%;
  height: 100%;
  /* The default poster is a <button> so we need to set display
   * to prevent it from being affected by text-align: */
  display: block;
  position: absolute;
  border: none;
  padding: 0;
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
  background-color: #fff0;
}

#default-progress-bar {
  display: block;
  position: relative;
  width: 100%;
  height: 100%;
  pointer-events: none;
  overflow: hidden;
}

#default-progress-bar > .bar {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: var(--progress-bar-height, 5px);
  background-color: var(--progress-bar-color, rgba(0, 0, 0, 0.4));
  transition: transform 0.09s;
  transform-origin: top left;
  transform: scaleX(0);
  overflow: hidden;
}

#default-progress-bar > .bar.hide {
  transition: opacity 0.3s 1s;
  opacity: 0;
}

.centered {
  align-items: center;
  justify-content: center;
}

.cover {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
}

.slot.interaction-prompt {
  display: var(--interaction-prompt-display, flex);
  overflow: hidden;
  opacity: 0;
  will-change: opacity;
  transition: opacity 0.3s;
}

.slot.interaction-prompt.visible {
  opacity: 1;
}

.animated-container {
  will-change: transform, opacity;
  opacity: 0;
  transition: opacity 0.3s;
}

.slot.interaction-prompt > * {
  pointer-events: none;
}

.slot.ar-button {
  -moz-user-select: none;
  -webkit-tap-highlight-color: transparent;
  user-select: none;

  display: var(--ar-button-display, block);
}

.slot.ar-button:not(.enabled) {
  display: none;
}

.fab {
  display: flex;
  align-items: center;
  justify-content: center;
  box-sizing: border-box;
  width: 40px;
  height: 40px;
  cursor: pointer;
  background-color: #fff;
  box-shadow: 0px 0px 4px rgba(0, 0, 0, 0.15);
  border-radius: 100px;
}

.fab > * {
  opacity: 0.87;
}

#default-ar-button {
  position: absolute;
  bottom: 16px;
  right: 16px;
  transform: scale(var(--ar-button-scale, 1));
  transform-origin: bottom right;
}

.slot.pan-target {
  display: block;
  position: absolute;
  width: 0;
  height: 0;
  left: 50%;
  top: 50%;
  transform: translate3d(-50%, -50%, 0);
  background-color: transparent;
  opacity: 0;
  transition: opacity 0.3s;
}

#default-pan-target {
  width: 6px;
  height: 6px;
  border-radius: 6px;
  border: 1px solid white;
  box-shadow: 0px 0px 2px 1px rgba(0, 0, 0, 0.8);
}

.slot.default {
  pointer-events: none;
}

.slot.progress-bar {
  pointer-events: none;
}

.slot.exit-webxr-ar-button {
  pointer-events: none;
}

.slot.exit-webxr-ar-button:not(.enabled) {
  display: none;
}

#default-exit-webxr-ar-button {
  display: flex;
  align-items: center;
  justify-content: center;
  position: absolute;
  top: env(safe-area-inset-top, 16px);
  right: 16px;
  width: 40px;
  height: 40px;
  box-sizing: border-box;
}

#default-exit-webxr-ar-button > svg {
  fill: #fff;
}
</style>
<div class="container">
  <div class="userInput" tabindex="0" role="img"
      aria-label="3D model">
      <div class="slot canvas">
        <slot name="canvas">
          <canvas></canvas>
        </slot>
      </div>

  </div>

  <!-- NOTE(cdata): We need to wrap slots because browsers without ShadowDOM
        will have their <slot> elements removed by ShadyCSS -->
  <div class="slot poster">
    <slot name="poster">
      <button type="button" id="default-poster" aria-hidden="true" aria-label="Loading 3D model"></button>
    </slot>
  </div>

  <div class="slot ar-button">
    <slot name="ar-button">
      <a id="default-ar-button" part="default-ar-button" class="fab"
          tabindex="2"
          role="button"
          href="javascript:void(0);"
          aria-label="View in your space">
        ${Dr`
<svg version="1.1" id="view_x5F_in_x5F_AR_x5F_icon"
	 xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="24px" height="24px"
	 viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
<rect id="Bounding_Box" x="0" y="0" fill="none" width="24" height="24"/>
<g id="Art_layer">
	<path d="M3,4c0-0.55,0.45-1,1-1h2V1H4C2.35,1,1,2.35,1,4v2h2V4z"/>
	<path d="M20,3c0.55,0,1,0.45,1,1v2h2V4c0-1.65-1.35-3-3-3h-2v2H20z"/>
	<path d="M4,21c-0.55,0-1-0.45-1-1v-2H1v2c0,1.65,1.35,3,3,3h2v-2H4z"/>
	<path d="M20,21c0.55,0,1-0.45,1-1v-2h2v2c0,1.65-1.35,3-3,3h-2v-2H20z"/>
	<g>
		<path d="M18.25,7.6l-5.5-3.18c-0.46-0.27-1.04-0.27-1.5,0L5.75,7.6C5.29,7.87,5,8.36,5,8.9v6.35c0,0.54,0.29,1.03,0.75,1.3
			l5.5,3.18c0.46,0.27,1.04,0.27,1.5,0l5.5-3.18c0.46-0.27,0.75-0.76,0.75-1.3V8.9C19,8.36,18.71,7.87,18.25,7.6z M7,14.96v-4.62
			l4,2.32v4.61L7,14.96z M12,10.93L8,8.61l4-2.31l4,2.31L12,10.93z M13,17.27v-4.61l4-2.32v4.62L13,17.27z"/>
	</g>
</g>
</svg>`}
      </a>
    </slot>
  </div>

  <div class="slot pan-target">
    <slot name="pan-target">
      <div id="default-pan-target">
      </div>
    </slot>
  </div>

  <div class="slot interaction-prompt cover centered">
    <div id="prompt" class="animated-container">
      <slot name="interaction-prompt" aria-hidden="true">
        ${Dr`
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="36">
    <defs>
        <path id="A" d="M.001.232h24.997V36H.001z" />
    </defs>
    <g transform="translate(-11 -4)" fill="none" fill-rule="evenodd">
        <path fill-opacity="0" fill="#fff" d="M0 0h44v44H0z" />
        <g transform="translate(11 3)">
            <path d="M8.733 11.165c.04-1.108.766-2.027 1.743-2.307a2.54 2.54 0 0 1 .628-.089c.16 0 .314.017.463.044 1.088.2 1.9 1.092 1.9 2.16v8.88h1.26c2.943-1.39 5-4.45 5-8.025a9.01 9.01 0 0 0-1.9-5.56l-.43-.5c-.765-.838-1.683-1.522-2.712-2-1.057-.49-2.226-.77-3.46-.77s-2.4.278-3.46.77c-1.03.478-1.947 1.162-2.71 2l-.43.5a9.01 9.01 0 0 0-1.9 5.56 9.04 9.04 0 0 0 .094 1.305c.03.21.088.41.13.617l.136.624c.083.286.196.56.305.832l.124.333a8.78 8.78 0 0 0 .509.953l.065.122a8.69 8.69 0 0 0 3.521 3.191l1.11.537v-9.178z" fill-opacity=".5" fill="#e4e4e4" />
            <path d="M22.94 26.218l-2.76 7.74c-.172.485-.676.8-1.253.8H12.24c-1.606 0-3.092-.68-3.98-1.82-1.592-2.048-3.647-3.822-6.11-5.27-.095-.055-.15-.137-.152-.23-.004-.1.046-.196.193-.297.56-.393 1.234-.6 1.926-.6a3.43 3.43 0 0 1 .691.069l4.922.994V10.972c0-.663.615-1.203 1.37-1.203s1.373.54 1.373 1.203v9.882h2.953c.273 0 .533.073.757.21l6.257 3.874c.027.017.045.042.07.06.41.296.586.77.426 1.22M4.1 16.614c-.024-.04-.042-.083-.065-.122a8.69 8.69 0 0 1-.509-.953c-.048-.107-.08-.223-.124-.333l-.305-.832c-.058-.202-.09-.416-.136-.624l-.13-.617a9.03 9.03 0 0 1-.094-1.305c0-2.107.714-4.04 1.9-5.56l.43-.5c.764-.84 1.682-1.523 2.71-2 1.058-.49 2.226-.77 3.46-.77s2.402.28 3.46.77c1.03.477 1.947 1.16 2.712 2l.428.5a9 9 0 0 1 1.901 5.559c0 3.577-2.056 6.636-5 8.026h-1.26v-8.882c0-1.067-.822-1.96-1.9-2.16-.15-.028-.304-.044-.463-.044-.22 0-.427.037-.628.09-.977.28-1.703 1.198-1.743 2.306v9.178l-1.11-.537C6.18 19.098 4.96 18 4.1 16.614M22.97 24.09l-6.256-3.874c-.102-.063-.218-.098-.33-.144 2.683-1.8 4.354-4.855 4.354-8.243 0-.486-.037-.964-.104-1.43a9.97 9.97 0 0 0-1.57-4.128l-.295-.408-.066-.092a10.05 10.05 0 0 0-.949-1.078c-.342-.334-.708-.643-1.094-.922-1.155-.834-2.492-1.412-3.94-1.65l-.732-.088-.748-.03a9.29 9.29 0 0 0-1.482.119c-1.447.238-2.786.816-3.94 1.65a9.33 9.33 0 0 0-.813.686 9.59 9.59 0 0 0-.845.877l-.385.437-.36.5-.288.468-.418.778-.04.09c-.593 1.28-.93 2.71-.93 4.222 0 3.832 2.182 7.342 5.56 8.938l1.437.68v4.946L5 25.64a4.44 4.44 0 0 0-.888-.086c-.017 0-.034.003-.05.003-.252.004-.503.033-.75.08a5.08 5.08 0 0 0-.237.056c-.193.046-.382.107-.568.18-.075.03-.15.057-.225.1-.25.114-.494.244-.723.405a1.31 1.31 0 0 0-.566 1.122 1.28 1.28 0 0 0 .645 1.051C4 29.925 5.96 31.614 7.473 33.563a5.06 5.06 0 0 0 .434.491c1.086 1.082 2.656 1.713 4.326 1.715h6.697c.748-.001 1.43-.333 1.858-.872.142-.18.256-.38.336-.602l2.757-7.74c.094-.26.13-.53.112-.794s-.088-.52-.203-.76a2.19 2.19 0 0 0-.821-.91" fill-opacity=".6" fill="#000" />
            <path d="M22.444 24.94l-6.257-3.874a1.45 1.45 0 0 0-.757-.211h-2.953v-9.88c0-.663-.616-1.203-1.373-1.203s-1.37.54-1.37 1.203v16.643l-4.922-.994a3.44 3.44 0 0 0-.692-.069 3.35 3.35 0 0 0-1.925.598c-.147.102-.198.198-.194.298.004.094.058.176.153.23 2.462 1.448 4.517 3.22 6.11 5.27.887 1.14 2.373 1.82 3.98 1.82h6.686c.577 0 1.08-.326 1.253-.8l2.76-7.74c.16-.448-.017-.923-.426-1.22-.025-.02-.043-.043-.07-.06z" fill="#fff" />
            <g transform="translate(0 .769)">
                <mask id="B" fill="#fff">
                    <use xlink:href="#A" />
                </mask>
                <path d="M23.993 24.992a1.96 1.96 0 0 1-.111.794l-2.758 7.74c-.08.22-.194.423-.336.602-.427.54-1.11.87-1.857.872h-6.698c-1.67-.002-3.24-.633-4.326-1.715-.154-.154-.3-.318-.434-.49C5.96 30.846 4 29.157 1.646 27.773c-.385-.225-.626-.618-.645-1.05a1.31 1.31 0 0 1 .566-1.122 4.56 4.56 0 0 1 .723-.405l.225-.1a4.3 4.3 0 0 1 .568-.18l.237-.056c.248-.046.5-.075.75-.08.018 0 .034-.003.05-.003.303-.001.597.027.89.086l3.722.752V20.68l-1.436-.68c-3.377-1.596-5.56-5.106-5.56-8.938 0-1.51.336-2.94.93-4.222.015-.03.025-.06.04-.09.127-.267.268-.525.418-.778.093-.16.186-.316.288-.468.063-.095.133-.186.2-.277L3.773 5c.118-.155.26-.29.385-.437.266-.3.544-.604.845-.877a9.33 9.33 0 0 1 .813-.686C6.97 2.167 8.31 1.59 9.757 1.35a9.27 9.27 0 0 1 1.481-.119 8.82 8.82 0 0 1 .748.031c.247.02.49.05.733.088 1.448.238 2.786.816 3.94 1.65.387.28.752.588 1.094.922a9.94 9.94 0 0 1 .949 1.078l.066.092c.102.133.203.268.295.408a9.97 9.97 0 0 1 1.571 4.128c.066.467.103.945.103 1.43 0 3.388-1.67 6.453-4.353 8.243.11.046.227.08.33.144l6.256 3.874c.37.23.645.55.82.9.115.24.185.498.203.76m.697-1.195c-.265-.55-.677-1.007-1.194-1.326l-5.323-3.297c2.255-2.037 3.564-4.97 3.564-8.114 0-2.19-.637-4.304-1.84-6.114-.126-.188-.26-.37-.4-.552-.645-.848-1.402-1.6-2.252-2.204C15.472.91 13.393.232 11.238.232A10.21 10.21 0 0 0 5.23 2.19c-.848.614-1.606 1.356-2.253 2.205-.136.18-.272.363-.398.55C1.374 6.756.737 8.87.737 11.06c0 4.218 2.407 8.08 6.133 9.842l.863.41v3.092l-2.525-.51c-.356-.07-.717-.106-1.076-.106a5.45 5.45 0 0 0-3.14.996c-.653.46-1.022 1.202-.99 1.983a2.28 2.28 0 0 0 1.138 1.872c2.24 1.318 4.106 2.923 5.543 4.772 1.26 1.62 3.333 2.59 5.55 2.592h6.698c1.42-.001 2.68-.86 3.134-2.138l2.76-7.74c.272-.757.224-1.584-.134-2.325" fill-opacity=".05" fill="#000" mask="url(#B)" />
            </g>
        </g>
    </g>
</svg>`}
      </slot>
    </div>
  </div>

  <div id="finger0" class="animated-container cover">
    <slot name="finger0" aria-hidden="true">
    </slot>
  </div>
  <div id="finger1" class="animated-container cover">
    <slot name="finger1" aria-hidden="true">
    </slot>
  </div>

  <div class="slot default">
    <slot></slot>

    <div class="slot progress-bar">
      <slot name="progress-bar">
        <div id="default-progress-bar" aria-hidden="true">
          <div class="bar" part="default-progress-bar"></div>
        </div>
      </slot>
    </div>

    <div class="slot exit-webxr-ar-button">
      <slot name="exit-webxr-ar-button">
        <a id="default-exit-webxr-ar-button" part="default-exit-webxr-ar-button"
            tabindex="3"
            aria-label="Exit AR"
            aria-hidden="true">
          ${Dr`
<svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24" fill="#000000">
    <!-- NOTE(cdata): This SVG filter is a stop-gap until we can implement
         support for dynamic re-coloring of UI components -->
    <defs>
      <filter id="drop-shadow" x="-100%" y="-100%" width="300%" height="300%">
        <feGaussianBlur in="SourceAlpha" stdDeviation="1"/>
        <feOffset dx="0" dy="0" result="offsetblur"/>
        <feFlood flood-color="#000000"/>
        <feComposite in2="offsetblur" operator="in"/>
        <feMerge>
          <feMergeNode/>
          <feMergeNode in="SourceGraphic"/>
        </feMerge>
      </filter>
    </defs>
    <path filter="url(#drop-shadow)" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
    <path d="M0 0h24v24H0z" fill="none"/>
</svg>`}
        </a>
      </slot>
    </div>
  </div>
</div>
<div class="screen-reader-only" role="region" aria-label="Live announcements">
  <span id="status" role="status"></span>
</div>`;var Bo=function(){var e=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),t=new Uint8Array([32,0,65,2,1,106,34,33,3,128,11,4,13,64,6,253,10,7,15,116,127,5,8,12,40,16,19,54,20,9,27,255,113,17,42,67,24,23,146,148,18,14,22,45,70,69,56,114,101,21,25,63,75,136,108,28,118,29,73,115]);if("object"!=typeof WebAssembly)return{supported:!1};var s,i=WebAssembly.validate(e)?a("b9H79TebbbeKl9Gbb9Gvuuuuueu9Giuuub9Geueuikqbbebeedddilve9Weeeviebeoweuec:q:6dkr;leDo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8A9TW79O9V9Wt9F9KW9J9V9KW9wWVtW949c919M9MWVbdY9TW79O9V9Wt9F9KW9J9V9KW69U9KW949c919M9MWVblE9TW79O9V9Wt9F9KW9J9V9KW69U9KW949tWG91W9U9JWbvL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9p9JtboK9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9r919HtbrL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWVT949Wbwl79IV9RbDq:p9sqlbzik9:evu8Jjjjjbcz9Rhbcbheincbhdcbhiinabcwfadfaicjuaead4ceGglE86bbaialfhiadcefgdcw9hmbkaec:q:yjjbfai86bbaecitc:q1jjbfab8Piw83ibaecefgecjd9hmbkk:N8JlHud97euo978Jjjjjbcj;kb9Rgv8Kjjjjbc9:hodnadcefal0mbcuhoaiRbbc:Ge9hmbavaialfgrad9Rad;8qbbcj;abad9UhlaicefhodnaeTmbadTmbalc;WFbGglcjdalcjd6EhwcbhDinawaeaD9RaDawfae6Egqcsfglc9WGgkci2hxakcethmalcl4cifcd4hPabaDad2fhsakc;ab6hzcbhHincbhOaohAdndninaraA9RaP6meavcj;cbfaOak2fhCaAaPfhocbhidnazmbarao9Rc;Gb6mbcbhlinaCalfhidndndndndnaAalco4fRbbgXciGPlbedibkaipxbbbbbbbbbbbbbbbbpklbxikaiaopbblaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbaoclfaYpQbfaKc:q:yjjbfRbbfhoxdkaiaopbbwaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbaocwfaYpQbfaKc:q:yjjbfRbbfhoxekaiaopbbbpklbaoczfhokdndndndndnaXcd4ciGPlbedibkaipxbbbbbbbbbbbbbbbbpklzxikaiaopbblaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklzaoclfaYpQbfaKc:q:yjjbfRbbfhoxdkaiaopbbwaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklzaocwfaYpQbfaKc:q:yjjbfRbbfhoxekaiaopbbbpklzaoczfhokdndndndndnaXcl4ciGPlbedibkaipxbbbbbbbbbbbbbbbbpklaxikaiaopbblaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklaaoclfaYpQbfaKc:q:yjjbfRbbfhoxdkaiaopbbwaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklaaocwfaYpQbfaKc:q:yjjbfRbbfhoxekaiaopbbbpklaaoczfhokdndndndndnaXco4Plbedibkaipxbbbbbbbbbbbbbbbbpkl8WxikaiaopbblaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibaXc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spkl8WaoclfaYpQbfaXc:q:yjjbfRbbfhoxdkaiaopbbwaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibaXc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spkl8WaocwfaYpQbfaXc:q:yjjbfRbbfhoxekaiaopbbbpkl8Waoczfhokalc;abfhialcjefak0meaihlarao9Rc;Fb0mbkkdnaiak9pmbaici4hlinarao9RcK6miaCaifhXdndndndndnaAaico4fRbbalcoG4ciGPlbedibkaXpxbbbbbbbbbbbbbbbbpkbbxikaXaopbblaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spkbbaoclfaYpQbfaKc:q:yjjbfRbbfhoxdkaXaopbbwaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spkbbaocwfaYpQbfaKc:q:yjjbfRbbfhoxekaXaopbbbpkbbaoczfhokalcdfhlaiczfgiak6mbkkaoTmeaohAaOcefgOclSmdxbkkc9:hoxlkdnakTmbavcjdfaHfhiavaHfpbdbhYcbhXinaiavcj;cbfaXfglpblbgLcep9TaLpxeeeeeeeeeeeeeeeegQp9op9Hp9rgLalakfpblbg8Acep9Ta8AaQp9op9Hp9rg8ApmbzeHdOiAlCvXoQrLgEalamfpblbg3cep9Ta3aQp9op9Hp9rg3alaxfpblbg5cep9Ta5aQp9op9Hp9rg5pmbzeHdOiAlCvXoQrLg8EpmbezHdiOAlvCXorQLgQaQpmbedibedibedibediaYp9UgYp9AdbbaiadfglaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaladfglaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaladfglaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaladfglaYaEa8EpmwDKYqk8AExm35Ps8E8FgQaQpmbedibedibedibedip9UgYp9AdbbaladfglaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaladfglaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaladfglaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaladfglaYaLa8ApmwKDYq8AkEx3m5P8Es8FgLa3a5pmwKDYq8AkEx3m5P8Es8Fg8ApmbezHdiOAlvCXorQLgQaQpmbedibedibedibedip9UgYp9AdbbaladfglaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaladfglaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaladfglaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaladfglaYaLa8ApmwDKYqk8AExm35Ps8E8FgQaQpmbedibedibedibedip9UgYp9AdbbaladfglaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaladfglaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaladfglaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaladfhiaXczfgXak6mbkkaHclfgHad6mbkasavcjdfaqad2;8qbbavavcjdfaqcufad2fad;8qbbaqaDfgDae6mbkkcbc99arao9Radcaadca0ESEhokavcj;kbf8Kjjjjbaokwbz:bjjjbk::seHu8Jjjjjbc;ae9Rgv8Kjjjjbc9:hodnaeci9UgrcHfal0mbcuhoaiRbbgwc;WeGc;Ge9hmbawcsGgwce0mbavc;abfcFecje;8kbavcUf9cu83ibavc8Wf9cu83ibavcyf9cu83ibavcaf9cu83ibavcKf9cu83ibavczf9cu83ibav9cu83iwav9cu83ibaialfc9WfhDaicefgqarfhidnaeTmbcmcsawceSEhkcbhxcbhmcbhPcbhwcbhlindnaiaD9nmbc9:hoxikdndnaqRbbgoc;Ve0mbavc;abfalaocu7gscl4fcsGcitfgzydlhrazydbhzdnaocsGgHak9pmbavawasfcsGcdtfydbaxaHEhoaHThsdndnadcd9hmbabaPcetfgHaz87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHazBdbaHcwfaoBdbaHclfarBdbkaxasfhxcdhHavawcdtfaoBdbawasfhwcehsalhOxdkdndnaHcsSmbaHc987aHamffcefhoxekaicefhoai8SbbgHcFeGhsdndnaHcu9mmbaohixekaicvfhiascFbGhscrhHdninao8SbbgOcFbGaHtasVhsaOcu9kmeaocefhoaHcrfgHc8J9hmbxdkkaocefhikasce4cbasceG9R7amfhokdndnadcd9hmbabaPcetfgHaz87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHazBdbaHcwfaoBdbaHclfarBdbkcdhHavawcdtfaoBdbcehsawcefhwalhOaohmxekdnaocpe0mbaxcefgHavawaDaocsGfRbbgocl49RcsGcdtfydbaocz6gzEhravawao9RcsGcdtfydbaHazfgAaocsGgHEhoaHThCdndnadcd9hmbabaPcetfgHax87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHaxBdbaHcwfaoBdbaHclfarBdbkcdhsavawcdtfaxBdbavawcefgwcsGcdtfarBdbcihHavc;abfalcitfgOaxBdlaOarBdbavawazfgwcsGcdtfaoBdbalcefcsGhOawaCfhwaxhzaAaCfhxxekaxcbaiRbbgOEgzaoc;:eSgHfhraOcsGhCaOcl4hAdndnaOcs0mbarcefhoxekarhoavawaA9RcsGcdtfydbhrkdndnaCmbaocefhxxekaohxavawaO9RcsGcdtfydbhokdndnaHTmbaicefhHxekaicdfhHai8SbegscFeGhzdnascu9kmbaicofhXazcFbGhzcrhidninaH8SbbgscFbGaitazVhzascu9kmeaHcefhHaicrfgic8J9hmbkaXhHxekaHcefhHkazce4cbazceG9R7amfgmhzkdndnaAcsSmbaHhsxekaHcefhsaH8SbbgicFeGhrdnaicu9kmbaHcvfhXarcFbGhrcrhidninas8SbbgHcFbGaitarVhraHcu9kmeascefhsaicrfgic8J9hmbkaXhsxekascefhskarce4cbarceG9R7amfgmhrkdndnaCcsSmbashixekascefhias8SbbgocFeGhHdnaocu9kmbascvfhXaHcFbGhHcrhodninai8SbbgscFbGaotaHVhHascu9kmeaicefhiaocrfgoc8J9hmbkaXhixekaicefhikaHce4cbaHceG9R7amfgmhokdndnadcd9hmbabaPcetfgHaz87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHazBdbaHcwfaoBdbaHclfarBdbkcdhsavawcdtfazBdbavawcefgwcsGcdtfarBdbcihHavc;abfalcitfgXazBdlaXarBdbavawaOcz6aAcsSVfgwcsGcdtfaoBdbawaCTaCcsSVfhwalcefcsGhOkaqcefhqavc;abfaOcitfgOarBdlaOaoBdbavc;abfalasfcsGcitfgraoBdlarazBdbawcsGhwalaHfcsGhlaPcifgPae6mbkkcbc99aiaDSEhokavc;aef8Kjjjjbaok:flevu8Jjjjjbcz9Rhvc9:hodnaecvfal0mbcuhoaiRbbc;:eGc;qe9hmbav9cb83iwaicefhraialfc98fhwdnaeTmbdnadcdSmbcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcdtfaic8Etc8F91aicd47avcwfaiceGcdtVgoydbfglBdbaoalBdbaDcefgDae9hmbxdkkcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcetfaic8Etc8F91aicd47avcwfaiceGcdtVgoydbfgl87ebaoalBdbaDcefgDae9hmbkkcbc99arawSEhokaok:wPliuo97eue978Jjjjjbca9Rhiaec98Ghldndnadcl9hmbdnalTmbcbhvabhdinadadpbbbgocKp:RecKp:Sep;6egraocwp:RecKp:Sep;6earp;Geaoczp:RecKp:Sep;6egwp;Gep;Kep;LegDpxbbbbbbbbbbbbbbbbp:2egqarpxbbbjbbbjbbbjbbbjgkp9op9rp;Kegrpxbb;:9cbb;:9cbb;:9cbb;:9cararp;MeaDaDp;Meawaqawakp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFbbbFbbbFbbbFbbbp9oaopxbbbFbbbFbbbFbbbFp9op9qarawp;Meaqp;Kecwp:RepxbFbbbFbbbFbbbFbbp9op9qaDawp;Meaqp;Keczp:RepxbbFbbbFbbbFbbbFbp9op9qpkbbadczfhdavclfgval6mbkkalaeSmeaipxbbbbbbbbbbbbbbbbgqpklbaiabalcdtfgdaeciGglcdtgv;8qbbdnalTmbaiaipblbgocKp:RecKp:Sep;6egraocwp:RecKp:Sep;6earp;Geaoczp:RecKp:Sep;6egwp;Gep;Kep;LegDaqp:2egqarpxbbbjbbbjbbbjbbbjgkp9op9rp;Kegrpxbb;:9cbb;:9cbb;:9cbb;:9cararp;MeaDaDp;Meawaqawakp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFbbbFbbbFbbbFbbbp9oaopxbbbFbbbFbbbFbbbFp9op9qarawp;Meaqp;Kecwp:RepxbFbbbFbbbFbbbFbbp9op9qaDawp;Meaqp;Keczp:RepxbbFbbbFbbbFbbbFbp9op9qpklbkadaiav;8qbbskdnalTmbcbhvabhdinadczfgxaxpbbbgopxbbbbbbFFbbbbbbFFgkp9oadpbbbgDaopmbediwDqkzHOAKY8AEgwczp:Reczp:Sep;6egraDaopmlvorxmPsCXQL358E8FpxFubbFubbFubbFubbp9op;6eawczp:Sep;6egwp;Gearp;Gep;Kep;Legopxbbbbbbbbbbbbbbbbp:2egqarpxbbbjbbbjbbbjbbbjgmp9op9rp;Kegrpxb;:FSb;:FSb;:FSb;:FSararp;Meaoaop;Meawaqawamp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFFbbFFbbFFbbFFbbp9oaoawp;Meaqp;Keczp:Rep9qgoarawp;Meaqp;KepxFFbbFFbbFFbbFFbbp9ogrpmwDKYqk8AExm35Ps8E8Fp9qpkbbadaDakp9oaoarpmbezHdiOAlvCXorQLp9qpkbbadcafhdavclfgval6mbkkalaeSmbaiaeciGgvcitgdfcbcaad9R;8kbaiabalcitfglad;8qbbdnavTmbaiaipblzgopxbbbbbbFFbbbbbbFFgkp9oaipblbgDaopmbediwDqkzHOAKY8AEgwczp:Reczp:Sep;6egraDaopmlvorxmPsCXQL358E8FpxFubbFubbFubbFubbp9op;6eawczp:Sep;6egwp;Gearp;Gep;Kep;Legopxbbbbbbbbbbbbbbbbp:2egqarpxbbbjbbbjbbbjbbbjgmp9op9rp;Kegrpxb;:FSb;:FSb;:FSb;:FSararp;Meaoaop;Meawaqawamp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFFbbFFbbFFbbFFbbp9oaoawp;Meaqp;Keczp:Rep9qgoarawp;Meaqp;KepxFFbbFFbbFFbbFFbbp9ogrpmwDKYqk8AExm35Ps8E8Fp9qpklzaiaDakp9oaoarpmbezHdiOAlvCXorQLp9qpklbkalaiad;8qbbkk;4wllue97euv978Jjjjjbc8W9Rhidnaec98GglTmbcbhvabhoinaiaopbbbgraoczfgwpbbbgDpmlvorxmPsCXQL358E8Fgqczp:Segkclp:RepklbaopxbbjZbbjZbbjZbbjZpx;Zl81Z;Zl81Z;Zl81Z;Zl81Zakpxibbbibbbibbbibbbp9qp;6ep;NegkaraDpmbediwDqkzHOAKY8AEgrczp:Reczp:Sep;6ep;MegDaDp;Meakarczp:Sep;6ep;Megxaxp;Meakaqczp:Reczp:Sep;6ep;Megqaqp;Mep;Kep;Kep;Lepxbbbbbbbbbbbbbbbbp:4ep;Jepxb;:FSb;:FSb;:FSb;:FSgkp;Mepxbbn0bbn0bbn0bbn0grp;KepxFFbbFFbbFFbbFFbbgmp9oaxakp;Mearp;Keczp:Rep9qgxaDakp;Mearp;Keamp9oaqakp;Mearp;Keczp:Rep9qgkpmbezHdiOAlvCXorQLgrp5baipblbpEb:T:j83ibaocwfarp5eaipblbpEe:T:j83ibawaxakpmwDKYqk8AExm35Ps8E8Fgkp5baipblbpEd:T:j83ibaocKfakp5eaipblbpEi:T:j83ibaocafhoavclfgval6mbkkdnalaeSmbaiaeciGgvcitgofcbcaao9R;8kbaiabalcitfgwao;8qbbdnavTmbaiaipblbgraipblzgDpmlvorxmPsCXQL358E8Fgqczp:Segkclp:RepklaaipxbbjZbbjZbbjZbbjZpx;Zl81Z;Zl81Z;Zl81Z;Zl81Zakpxibbbibbbibbbibbbp9qp;6ep;NegkaraDpmbediwDqkzHOAKY8AEgrczp:Reczp:Sep;6ep;MegDaDp;Meakarczp:Sep;6ep;Megxaxp;Meakaqczp:Reczp:Sep;6ep;Megqaqp;Mep;Kep;Kep;Lepxbbbbbbbbbbbbbbbbp:4ep;Jepxb;:FSb;:FSb;:FSb;:FSgkp;Mepxbbn0bbn0bbn0bbn0grp;KepxFFbbFFbbFFbbFFbbgmp9oaxakp;Mearp;Keczp:Rep9qgxaDakp;Mearp;Keamp9oaqakp;Mearp;Keczp:Rep9qgkpmbezHdiOAlvCXorQLgrp5baipblapEb:T:j83ibaiarp5eaipblapEe:T:j83iwaiaxakpmwDKYqk8AExm35Ps8E8Fgkp5baipblapEd:T:j83izaiakp5eaipblapEi:T:j83iKkawaiao;8qbbkk:Pddiue978Jjjjjbc;ab9Rhidnadcd4ae2glc98GgvTmbcbheabhdinadadpbbbgocwp:Recwp:Sep;6eaocep:SepxbbjFbbjFbbjFbbjFp9opxbbjZbbjZbbjZbbjZp:Uep;Mepkbbadczfhdaeclfgeav6mbkkdnavalSmbaialciGgecdtgdVcbc;abad9R;8kbaiabavcdtfgvad;8qbbdnaeTmbaiaipblbgocwp:Recwp:Sep;6eaocep:SepxbbjFbbjFbbjFbbjFp9opxbbjZbbjZbbjZbbjZp:Uep;Mepklbkavaiad;8qbbkk9teiucbcbydj1jjbgeabcifc98GfgbBdj1jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaikkkebcjwklz:Dbb"):a("b9H79Tebbbe8Fv9Gbb9Gvuuuuueu9Giuuub9Geueu9Giuuueuikqbeeedddillviebeoweuec:q:Odkr;leDo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8A9TW79O9V9Wt9F9KW9J9V9KW9wWVtW949c919M9MWVbeY9TW79O9V9Wt9F9KW9J9V9KW69U9KW949c919M9MWVbdE9TW79O9V9Wt9F9KW9J9V9KW69U9KW949tWG91W9U9JWbiL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9p9JtblK9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9r919HtbvL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWVT949Wbol79IV9Rbrq;w8Wqdbk;esezu8Jjjjjbcj;eb9Rgv8Kjjjjbc9:hodnadcefal0mbcuhoaiRbbc:Ge9hmbavaialfgrad9Radz1jjjbhwcj;abad9Uc;WFbGgocjdaocjd6EhDaicefhocbhqdnindndndnaeaq9nmbaDaeaq9RaqaDfae6Egkcsfglcl4cifcd4hxalc9WGgmTmecbhPawcjdfhsaohzinaraz9Rax6mvarazaxfgo9RcK6mvczhlcbhHinalgic9WfgOawcj;cbffhldndndndndnazaOco4fRbbaHcoG4ciGPlbedibkal9cb83ibalcwf9cb83ibxikalaoRblaoRbbgOco4gAaAciSgAE86bbawcj;cbfaifglcGfaoclfaAfgARbbaOcl4ciGgCaCciSgCE86bbalcVfaAaCfgARbbaOcd4ciGgCaCciSgCE86bbalc7faAaCfgARbbaOciGgOaOciSgOE86bbalctfaAaOfgARbbaoRbegOco4gCaCciSgCE86bbalc91faAaCfgARbbaOcl4ciGgCaCciSgCE86bbalc4faAaCfgARbbaOcd4ciGgCaCciSgCE86bbalc93faAaCfgARbbaOciGgOaOciSgOE86bbalc94faAaOfgARbbaoRbdgOco4gCaCciSgCE86bbalc95faAaCfgARbbaOcl4ciGgCaCciSgCE86bbalc96faAaCfgARbbaOcd4ciGgCaCciSgCE86bbalc97faAaCfgARbbaOciGgOaOciSgOE86bbalc98faAaOfgORbbaoRbigoco4gAaAciSgAE86bbalc99faOaAfgORbbaocl4ciGgAaAciSgAE86bbalc9:faOaAfgORbbaocd4ciGgAaAciSgAE86bbalcufaOaAfglRbbaociGgoaociSgoE86bbalaofhoxdkalaoRbwaoRbbgOcl4gAaAcsSgAE86bbawcj;cbfaifglcGfaocwfaAfgARbbaOcsGgOaOcsSgOE86bbalcVfaAaOfgORbbaoRbegAcl4gCaCcsSgCE86bbalc7faOaCfgORbbaAcsGgAaAcsSgAE86bbalctfaOaAfgORbbaoRbdgAcl4gCaCcsSgCE86bbalc91faOaCfgORbbaAcsGgAaAcsSgAE86bbalc4faOaAfgORbbaoRbigAcl4gCaCcsSgCE86bbalc93faOaCfgORbbaAcsGgAaAcsSgAE86bbalc94faOaAfgORbbaoRblgAcl4gCaCcsSgCE86bbalc95faOaCfgORbbaAcsGgAaAcsSgAE86bbalc96faOaAfgORbbaoRbvgAcl4gCaCcsSgCE86bbalc97faOaCfgORbbaAcsGgAaAcsSgAE86bbalc98faOaAfgORbbaoRbogAcl4gCaCcsSgCE86bbalc99faOaCfgORbbaAcsGgAaAcsSgAE86bbalc9:faOaAfgORbbaoRbrgocl4gAaAcsSgAE86bbalcufaOaAfglRbbaocsGgoaocsSgoE86bbalaofhoxekalao8Pbb83bbalcwfaocwf8Pbb83bbaoczfhokdnaiam9pmbaHcdfhHaiczfhlarao9RcL0mekkaiam6mvaoTmvdnakTmbawaPfRbbhHawcj;cbfhlashiakhOinaialRbbgzce4cbazceG9R7aHfgH86bbaiadfhialcefhlaOcufgOmbkkascefhsaohzaPcefgPad9hmbxikkcbc99arao9Radcaadca0ESEhoxlkaoaxad2fhCdnakmbadhlinaoTmlarao9Rax6mlaoaxfhoalcufglmbkaChoxekcbhmawcjdfhAinarao9Rax6miawamfRbbhHawcj;cbfhlaAhiakhOinaialRbbgzce4cbazceG9R7aHfgH86bbaiadfhialcefhlaOcufgOmbkaAcefhAaoaxfhoamcefgmad9hmbkaChokabaqad2fawcjdfakad2z1jjjb8Aawawcjdfakcufad2fadz1jjjb8Aakaqfhqaombkc9:hoxekc9:hokavcj;ebf8Kjjjjbaok;cseHu8Jjjjjbc;ae9Rgv8Kjjjjbc9:hodnaeci9UgrcHfal0mbcuhoaiRbbgwc;WeGc;Ge9hmbawcsGgwce0mbavc;abfcFecjez:jjjjb8AavcUf9cu83ibavc8Wf9cu83ibavcyf9cu83ibavcaf9cu83ibavcKf9cu83ibavczf9cu83ibav9cu83iwav9cu83ibaialfc9WfhDaicefgqarfhidnaeTmbcmcsawceSEhkcbhxcbhmcbhPcbhwcbhlindnaiaD9nmbc9:hoxikdndnaqRbbgoc;Ve0mbavc;abfalaocu7gscl4fcsGcitfgzydlhrazydbhzdnaocsGgHak9pmbavawasfcsGcdtfydbaxaHEhoaHThsdndnadcd9hmbabaPcetfgHaz87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHazBdbaHcwfaoBdbaHclfarBdbkaxasfhxcdhHavawcdtfaoBdbawasfhwcehsalhOxdkdndnaHcsSmbaHc987aHamffcefhoxekaicefhoai8SbbgHcFeGhsdndnaHcu9mmbaohixekaicvfhiascFbGhscrhHdninao8SbbgOcFbGaHtasVhsaOcu9kmeaocefhoaHcrfgHc8J9hmbxdkkaocefhikasce4cbasceG9R7amfhokdndnadcd9hmbabaPcetfgHaz87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHazBdbaHcwfaoBdbaHclfarBdbkcdhHavawcdtfaoBdbcehsawcefhwalhOaohmxekdnaocpe0mbaxcefgHavawaDaocsGfRbbgocl49RcsGcdtfydbaocz6gzEhravawao9RcsGcdtfydbaHazfgAaocsGgHEhoaHThCdndnadcd9hmbabaPcetfgHax87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHaxBdbaHcwfaoBdbaHclfarBdbkcdhsavawcdtfaxBdbavawcefgwcsGcdtfarBdbcihHavc;abfalcitfgOaxBdlaOarBdbavawazfgwcsGcdtfaoBdbalcefcsGhOawaCfhwaxhzaAaCfhxxekaxcbaiRbbgOEgzaoc;:eSgHfhraOcsGhCaOcl4hAdndnaOcs0mbarcefhoxekarhoavawaA9RcsGcdtfydbhrkdndnaCmbaocefhxxekaohxavawaO9RcsGcdtfydbhokdndnaHTmbaicefhHxekaicdfhHai8SbegscFeGhzdnascu9kmbaicofhXazcFbGhzcrhidninaH8SbbgscFbGaitazVhzascu9kmeaHcefhHaicrfgic8J9hmbkaXhHxekaHcefhHkazce4cbazceG9R7amfgmhzkdndnaAcsSmbaHhsxekaHcefhsaH8SbbgicFeGhrdnaicu9kmbaHcvfhXarcFbGhrcrhidninas8SbbgHcFbGaitarVhraHcu9kmeascefhsaicrfgic8J9hmbkaXhsxekascefhskarce4cbarceG9R7amfgmhrkdndnaCcsSmbashixekascefhias8SbbgocFeGhHdnaocu9kmbascvfhXaHcFbGhHcrhodninai8SbbgscFbGaotaHVhHascu9kmeaicefhiaocrfgoc8J9hmbkaXhixekaicefhikaHce4cbaHceG9R7amfgmhokdndnadcd9hmbabaPcetfgHaz87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHazBdbaHcwfaoBdbaHclfarBdbkcdhsavawcdtfazBdbavawcefgwcsGcdtfarBdbcihHavc;abfalcitfgXazBdlaXarBdbavawaOcz6aAcsSVfgwcsGcdtfaoBdbawaCTaCcsSVfhwalcefcsGhOkaqcefhqavc;abfaOcitfgOarBdlaOaoBdbavc;abfalasfcsGcitfgraoBdlarazBdbawcsGhwalaHfcsGhlaPcifgPae6mbkkcbc99aiaDSEhokavc;aef8Kjjjjbaok:flevu8Jjjjjbcz9Rhvc9:hodnaecvfal0mbcuhoaiRbbc;:eGc;qe9hmbav9cb83iwaicefhraialfc98fhwdnaeTmbdnadcdSmbcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcdtfaic8Etc8F91aicd47avcwfaiceGcdtVgoydbfglBdbaoalBdbaDcefgDae9hmbxdkkcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcetfaic8Etc8F91aicd47avcwfaiceGcdtVgoydbfgl87ebaoalBdbaDcefgDae9hmbkkcbc99arawSEhokaok:Lvoeue99dud99eud99dndnadcl9hmbaeTmeindndnabcdfgd8Sbb:Yab8Sbbgi:Ygl:l:tabcefgv8Sbbgo:Ygr:l:tgwJbb;:9cawawNJbbbbawawJbbbb9GgDEgq:mgkaqaicb9iEalMgwawNakaqaocb9iEarMgqaqNMM:r:vglNJbbbZJbbb:;aDEMgr:lJbbb9p9DTmbar:Ohixekcjjjj94hikadai86bbdndnaqalNJbbbZJbbb:;aqJbbbb9GEMgq:lJbbb9p9DTmbaq:Ohdxekcjjjj94hdkavad86bbdndnawalNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohdxekcjjjj94hdkabad86bbabclfhbaecufgembxdkkaeTmbindndnabclfgd8Ueb:Yab8Uebgi:Ygl:l:tabcdfgv8Uebgo:Ygr:l:tgwJb;:FSawawNJbbbbawawJbbbb9GgDEgq:mgkaqaicb9iEalMgwawNakaqaocb9iEarMgqaqNMM:r:vglNJbbbZJbbb:;aDEMgr:lJbbb9p9DTmbar:Ohixekcjjjj94hikadai87ebdndnaqalNJbbbZJbbb:;aqJbbbb9GEMgq:lJbbb9p9DTmbaq:Ohdxekcjjjj94hdkavad87ebdndnawalNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohdxekcjjjj94hdkabad87ebabcwfhbaecufgembkkk;oiliui99iue99dnaeTmbcbhiabhlindndnJ;Zl81Zalcof8UebgvciV:Y:vgoal8Ueb:YNgrJb;:FSNJbbbZJbbb:;arJbbbb9GEMgw:lJbbb9p9DTmbaw:OhDxekcjjjj94hDkalclf8Uebhqalcdf8UebhkabaiavcefciGfcetfaD87ebdndnaoak:YNgwJb;:FSNJbbbZJbbb:;awJbbbb9GEMgx:lJbbb9p9DTmbax:OhDxekcjjjj94hDkabaiavciGfgkcd7cetfaD87ebdndnaoaq:YNgoJb;:FSNJbbbZJbbb:;aoJbbbb9GEMgx:lJbbb9p9DTmbax:OhDxekcjjjj94hDkabaiavcufciGfcetfaD87ebdndnJbbjZararN:tawawN:taoaoN:tgrJbbbbarJbbbb9GE:rJb;:FSNJbbbZMgr:lJbbb9p9DTmbar:Ohvxekcjjjj94hvkabakcetfav87ebalcwfhlaiclfhiaecufgembkkk9mbdnadcd4ae2gdTmbinababydbgecwtcw91:Yaece91cjjj98Gcjjj;8if::NUdbabclfhbadcufgdmbkkk9teiucbcbydj1jjbgeabcifc98GfgbBdj1jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik;LeeeudndnaeabVciGTmbabhixekdndnadcz9pmbabhixekabhiinaiaeydbBdbaiclfaeclfydbBdbaicwfaecwfydbBdbaicxfaecxfydbBdbaeczfheaiczfhiadc9Wfgdcs0mbkkadcl6mbinaiaeydbBdbaeclfheaiclfhiadc98fgdci0mbkkdnadTmbinaiaeRbb86bbaicefhiaecefheadcufgdmbkkabk;aeedudndnabciGTmbabhixekaecFeGc:b:c:ew2hldndnadcz9pmbabhixekabhiinaialBdbaicxfalBdbaicwfalBdbaiclfalBdbaiczfhiadc9Wfgdcs0mbkkadcl6mbinaialBdbaiclfhiadc98fgdci0mbkkdnadTmbinaiae86bbaicefhiadcufgdmbkkabkkkebcjwklzNbb"),n=WebAssembly.instantiate(i,{}).then(function(e){(s=e.instance).exports.__wasm_call_ctors()});function a(e){for(var s=new Uint8Array(e.length),i=0;i<e.length;++i){var n=e.charCodeAt(i);s[i]=n>96?n-97:n>64?n-39:n+4}var a=0;for(i=0;i<e.length;++i)s[a++]=s[i]<60?t[s[i]]:64*(s[i]-60)+s[++i];return s.buffer.slice(0,a)}function r(e,t,s,i,n,a,r){var o=e.exports.sbrk,l=i+3&-4,c=o(l*n),A=o(a.length),h=new Uint8Array(e.exports.memory.buffer);h.set(a,A);var d=t(c,i,n,A,a.length);if(0==d&&r&&r(c,l,n),s.set(h.subarray(c,c+i*n)),o(c-o(0)),0!=d)throw new Error("Malformed buffer data: "+d)}var o={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},l={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"},c=[],A=0;function h(e){var t={object:new Worker(e),pending:0,requests:{}};return t.object.onmessage=function(e){var s=e.data;t.pending-=s.count,t.requests[s.id][s.action](s.value),delete t.requests[s.id]},t}function d(e){var t=e.data;if(!t.id)return self.close();self.ready.then(function(e){try{var s=new Uint8Array(t.count*t.size);r(e,e.exports[t.mode],s,t.count,t.size,t.source,e.exports[t.filter]),self.postMessage({id:t.id,count:t.count,action:"resolve",value:s},[s.buffer])}catch(i){self.postMessage({id:t.id,count:t.count,action:"reject",value:i})}})}return{ready:n,supported:!0,useWorkers:function(e){!function(e){for(var t="self.ready = WebAssembly.instantiate(new Uint8Array(["+new Uint8Array(i)+"]), {}).then(function(result) { result.instance.exports.__wasm_call_ctors(); return result.instance; });self.onmessage = "+d.name+";"+r.toString()+d.toString(),s=new Blob([t],{type:"text/javascript"}),n=URL.createObjectURL(s),a=c.length;a<e;++a)c[a]=h(n);for(a=e;a<c.length;++a)c[a].object.postMessage({});c.length=e,URL.revokeObjectURL(n)}(e)},decodeVertexBuffer:function(e,t,i,n,a){r(s,s.exports.meshopt_decodeVertexBuffer,e,t,i,n,s.exports[o[a]])},decodeIndexBuffer:function(e,t,i,n){r(s,s.exports.meshopt_decodeIndexBuffer,e,t,i,n)},decodeIndexSequence:function(e,t,i,n){r(s,s.exports.meshopt_decodeIndexSequence,e,t,i,n)},decodeGltfBuffer:function(e,t,i,n,a,c){r(s,s.exports[l[a]],e,t,i,n,s.exports[o[c]])},decodeGltfBufferAsync:function(e,t,i,a,h){return c.length>0?function(e,t,s,i,n){for(var a=c[0],r=1;r<c.length;++r)c[r].pending<a.pending&&(a=c[r]);return new Promise(function(r,o){var l=new Uint8Array(s),c=++A;a.pending+=e,a.requests[c]={resolve:r,reject:o},a.object.postMessage({id:c,count:e,size:t,source:l,mode:i,filter:n},[l.buffer])})}(e,t,i,l[a],o[h]):n.then(function(){var n=new Uint8Array(e*t);return r(s,s.exports[l[a]],n,e,t,i,s.exports[o[h]]),n})}}}();const Qo=new WeakMap;function So(){let e,t;function s(e,t,s,i,n,a){const r=s.num_points(),o=a.num_components(),l=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}(e,n),c=o*n.BYTES_PER_ELEMENT,A=4*Math.ceil(c/4),h=A/n.BYTES_PER_ELEMENT,d=r*c,u=r*A,p=e._malloc(d);t.GetAttributeDataArrayForAllPoints(s,a,l,d,p);const g=new n(e.HEAPF32.buffer,p,d/n.BYTES_PER_ELEMENT);let m;if(c===A)m=g.slice();else{m=new n(u/n.BYTES_PER_ELEMENT);let e=0;for(let t=0,s=g.length;t<s;t++){for(let s=0;s<o;s++)m[e+s]=g[t*o+s];e+=h}}return e._free(p),{name:i,count:r,itemSize:o,array:m,stride:h}}onmessage=function(i){const n=i.data;switch(n.type){case"init":e=n.decoderConfig,t=new Promise(function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)});break;case"decode":const i=n.buffer,a=n.taskConfig;t.then(e=>{const t=e.draco,r=new t.Decoder;try{const e=function(e,t,i,n){const a=n.attributeIDs,r=n.attributeTypes;let o,l;const c=t.GetEncodedGeometryType(i);if(c===e.TRIANGULAR_MESH)o=new e.Mesh,l=t.DecodeArrayToMesh(i,i.byteLength,o);else{if(c!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");o=new e.PointCloud,l=t.DecodeArrayToPointCloud(i,i.byteLength,o)}if(!l.ok()||0===o.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+l.error_msg());const A={index:null,attributes:[]};for(const h in a){const i=self[r[h]];let l,c;if(n.useUniqueIDs)c=a[h],l=t.GetAttributeByUniqueId(o,c);else{if(c=t.GetAttributeId(o,e[a[h]]),-1===c)continue;l=t.GetAttribute(o,c)}const d=s(e,t,o,h,i,l);"color"===h&&(d.vertexColorSpace=n.vertexColorSpace),A.attributes.push(d)}c===e.TRIANGULAR_MESH&&(A.index=function(e,t,s){const i=s.num_faces(),n=3*i,a=4*n,r=e._malloc(a);t.GetTrianglesUInt32Array(s,a,r);const o=new Uint32Array(e.HEAPF32.buffer,r,n).slice();return e._free(r),{array:o,itemSize:1}}(e,t,o));return e.destroy(o),A}(t,r,new Int8Array(i),a),o=e.attributes.map(e=>e.array.buffer);e.index&&o.push(e.index.array.buffer),self.postMessage({type:"decode",id:n.id,geometry:e},o)}catch(o){console.error(o),self.postMessage({type:"error",id:n.id,error:o.message})}finally{t.destroy(r)}})}}}function _o(e,t){if(t===ve)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),e;if(t===we||t===Ie){let s=e.getIndex();if(null===s){const t=[],i=e.getAttribute("position");if(void 0===i)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(let e=0;e<i.count;e++)t.push(e);e.setIndex(t),s=e.getIndex()}const i=s.count-2,n=[];if(t===we)for(let e=1;e<=i;e++)n.push(s.getX(0)),n.push(s.getX(e)),n.push(s.getX(e+1));else for(let e=0;e<i;e++)e%2==0?(n.push(s.getX(e)),n.push(s.getX(e+1)),n.push(s.getX(e+2))):(n.push(s.getX(e+2)),n.push(s.getX(e+1)),n.push(s.getX(e)));n.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const a=e.clone();return a.setIndex(n),a.clearGroups(),a}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",t),e}class ko extends he{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(e){return new Fo(e)}),this.register(function(e){return new jo(e)}),this.register(function(e){return new Vo(e)}),this.register(function(e){return new Ko(e)}),this.register(function(e){return new Jo(e)}),this.register(function(e){return new Po(e)}),this.register(function(e){return new Uo(e)}),this.register(function(e){return new Oo(e)}),this.register(function(e){return new Go(e)}),this.register(function(e){return new No(e)}),this.register(function(e){return new Ho(e)}),this.register(function(e){return new Lo(e)}),this.register(function(e){return new zo(e)}),this.register(function(e){return new qo(e)}),this.register(function(e){return new Ro(e)}),this.register(function(e){return new Yo(e)}),this.register(function(e){return new Wo(e)})}load(e,t,s,i){const n=this;let a;if(""!==this.resourcePath)a=this.resourcePath;else if(""!==this.path){const t=Ce.extractUrlBase(e);a=Ce.resolveURL(t,this.path)}else a=Ce.extractUrlBase(e);this.manager.itemStart(e);const r=function(t){i?i(t):console.error(t),n.manager.itemError(e),n.manager.itemEnd(e)},o=new de(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(s){try{n.parse(s,a,function(s){t(s),n.manager.itemEnd(e)},r)}catch(hv){r(hv)}},s,r)}setDRACOLoader(e){return this.dracoLoader=e,this}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,s,i){let n;const a={},r={},o=new TextDecoder;if("string"==typeof e)n=JSON.parse(e);else if(e instanceof ArrayBuffer){if(o.decode(new Uint8Array(e,0,4))===$o){try{a[Mo.KHR_BINARY_GLTF]=new el(e)}catch(c){return void(i&&i(c))}n=JSON.parse(a[Mo.KHR_BINARY_GLTF].content)}else n=JSON.parse(o.decode(e))}else n=e;if(void 0===n.asset||n.asset.version[0]<2)return void(i&&i(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const l=new Bl(n,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let A=0;A<this.pluginCallbacks.length;A++){const e=this.pluginCallbacks[A](l);e.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),r[e.name]=e,a[e.name]=!0}if(n.extensionsUsed)for(let A=0;A<n.extensionsUsed.length;++A){const e=n.extensionsUsed[A],t=n.extensionsRequired||[];switch(e){case Mo.KHR_MATERIALS_UNLIT:a[e]=new Do;break;case Mo.KHR_DRACO_MESH_COMPRESSION:a[e]=new tl(n,this.dracoLoader);break;case Mo.KHR_TEXTURE_TRANSFORM:a[e]=new sl;break;case Mo.KHR_MESH_QUANTIZATION:a[e]=new il;break;default:t.indexOf(e)>=0&&void 0===r[e]&&console.warn('THREE.GLTFLoader: Unknown extension "'+e+'".')}}l.setExtensions(a),l.setPlugins(r),l.parse(s,i)}parseAsync(e,t){const s=this;return new Promise(function(i,n){s.parse(e,t,i,n)})}}function To(){let e={};return{get:function(t){return e[t]},add:function(t,s){e[t]=s},remove:function(t){delete e[t]},removeAll:function(){e={}}}}const Mo={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class Ro{constructor(e){this.parser=e,this.name=Mo.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let s=0,i=t.length;s<i;s++){const i=t[s];i.extensions&&i.extensions[this.name]&&void 0!==i.extensions[this.name].light&&e._addNodeRef(this.cache,i.extensions[this.name].light)}}_loadLight(e){const t=this.parser,s="light:"+e;let i=t.cache.get(s);if(i)return i;const n=t.json,a=((n.extensions&&n.extensions[this.name]||{}).lights||[])[e];let r;const o=new be(16777215);void 0!==a.color&&o.setRGB(a.color[0],a.color[1],a.color[2],pe);const l=void 0!==a.range?a.range:0;switch(a.type){case"directional":r=new _e(o),r.target.position.set(0,0,-1),r.add(r.target);break;case"point":r=new Se(o),r.distance=l;break;case"spot":r=new Qe(o),r.distance=l,a.spot=a.spot||{},a.spot.innerConeAngle=void 0!==a.spot.innerConeAngle?a.spot.innerConeAngle:0,a.spot.outerConeAngle=void 0!==a.spot.outerConeAngle?a.spot.outerConeAngle:Math.PI/4,r.angle=a.spot.outerConeAngle,r.penumbra=1-a.spot.innerConeAngle/a.spot.outerConeAngle,r.target.position.set(0,0,-1),r.add(r.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+a.type)}return r.position.set(0,0,0),yl(r,a),void 0!==a.intensity&&(r.intensity=a.intensity),r.name=t.createUniqueName(a.name||"light_"+e),i=Promise.resolve(r),t.cache.add(s,i),i}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,s=this.parser,i=s.json.nodes[e],n=(i.extensions&&i.extensions[this.name]||{}).light;return void 0===n?null:this._loadLight(n).then(function(e){return s._getNodeRef(t.cache,n,e)})}}let Do=class{constructor(){this.name=Mo.KHR_MATERIALS_UNLIT}getMaterialType(){return Xe}extendParams(e,t,s){const i=[];e.color=new be(1,1,1),e.opacity=1;const n=t.pbrMetallicRoughness;if(n){if(Array.isArray(n.baseColorFactor)){const t=n.baseColorFactor;e.color.setRGB(t[0],t[1],t[2],pe),e.opacity=t[3]}void 0!==n.baseColorTexture&&i.push(s.assignTexture(e,"map",n.baseColorTexture,ue))}return Promise.all(i)}},No=class{constructor(e){this.parser=e,this.name=Mo.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const i=s.extensions[this.name].emissiveStrength;return void 0!==i&&(t.emissiveIntensity=i),Promise.resolve()}},Fo=class{constructor(e){this.parser=e,this.name=Mo.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Ee:null}extendMaterialParams(e,t){const s=this.parser,i=s.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const n=[],a=i.extensions[this.name];if(void 0!==a.clearcoatFactor&&(t.clearcoat=a.clearcoatFactor),void 0!==a.clearcoatTexture&&n.push(s.assignTexture(t,"clearcoatMap",a.clearcoatTexture)),void 0!==a.clearcoatRoughnessFactor&&(t.clearcoatRoughness=a.clearcoatRoughnessFactor),void 0!==a.clearcoatRoughnessTexture&&n.push(s.assignTexture(t,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),void 0!==a.clearcoatNormalTexture&&(n.push(s.assignTexture(t,"clearcoatNormalMap",a.clearcoatNormalTexture)),void 0!==a.clearcoatNormalTexture.scale)){const e=a.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Be(e,e)}return Promise.all(n)}},jo=class{constructor(e){this.parser=e,this.name=Mo.KHR_MATERIALS_DISPERSION}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Ee:null}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const i=s.extensions[this.name];return t.dispersion=void 0!==i.dispersion?i.dispersion:0,Promise.resolve()}},Lo=class{constructor(e){this.parser=e,this.name=Mo.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Ee:null}extendMaterialParams(e,t){const s=this.parser,i=s.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const n=[],a=i.extensions[this.name];return void 0!==a.iridescenceFactor&&(t.iridescence=a.iridescenceFactor),void 0!==a.iridescenceTexture&&n.push(s.assignTexture(t,"iridescenceMap",a.iridescenceTexture)),void 0!==a.iridescenceIor&&(t.iridescenceIOR=a.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==a.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=a.iridescenceThicknessMinimum),void 0!==a.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=a.iridescenceThicknessMaximum),void 0!==a.iridescenceThicknessTexture&&n.push(s.assignTexture(t,"iridescenceThicknessMap",a.iridescenceThicknessTexture)),Promise.all(n)}},Po=class{constructor(e){this.parser=e,this.name=Mo.KHR_MATERIALS_SHEEN}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Ee:null}extendMaterialParams(e,t){const s=this.parser,i=s.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const n=[];t.sheenColor=new be(0,0,0),t.sheenRoughness=0,t.sheen=1;const a=i.extensions[this.name];if(void 0!==a.sheenColorFactor){const e=a.sheenColorFactor;t.sheenColor.setRGB(e[0],e[1],e[2],pe)}return void 0!==a.sheenRoughnessFactor&&(t.sheenRoughness=a.sheenRoughnessFactor),void 0!==a.sheenColorTexture&&n.push(s.assignTexture(t,"sheenColorMap",a.sheenColorTexture,ue)),void 0!==a.sheenRoughnessTexture&&n.push(s.assignTexture(t,"sheenRoughnessMap",a.sheenRoughnessTexture)),Promise.all(n)}},Uo=class{constructor(e){this.parser=e,this.name=Mo.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Ee:null}extendMaterialParams(e,t){const s=this.parser,i=s.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const n=[],a=i.extensions[this.name];return void 0!==a.transmissionFactor&&(t.transmission=a.transmissionFactor),void 0!==a.transmissionTexture&&n.push(s.assignTexture(t,"transmissionMap",a.transmissionTexture)),Promise.all(n)}},Oo=class{constructor(e){this.parser=e,this.name=Mo.KHR_MATERIALS_VOLUME}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Ee:null}extendMaterialParams(e,t){const s=this.parser,i=s.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const n=[],a=i.extensions[this.name];t.thickness=void 0!==a.thicknessFactor?a.thicknessFactor:0,void 0!==a.thicknessTexture&&n.push(s.assignTexture(t,"thicknessMap",a.thicknessTexture)),t.attenuationDistance=a.attenuationDistance||1/0;const r=a.attenuationColor||[1,1,1];return t.attenuationColor=(new be).setRGB(r[0],r[1],r[2],pe),Promise.all(n)}},Go=class{constructor(e){this.parser=e,this.name=Mo.KHR_MATERIALS_IOR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Ee:null}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const i=s.extensions[this.name];return t.ior=void 0!==i.ior?i.ior:1.5,Promise.resolve()}},Ho=class{constructor(e){this.parser=e,this.name=Mo.KHR_MATERIALS_SPECULAR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Ee:null}extendMaterialParams(e,t){const s=this.parser,i=s.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const n=[],a=i.extensions[this.name];t.specularIntensity=void 0!==a.specularFactor?a.specularFactor:1,void 0!==a.specularTexture&&n.push(s.assignTexture(t,"specularIntensityMap",a.specularTexture));const r=a.specularColorFactor||[1,1,1];return t.specularColor=(new be).setRGB(r[0],r[1],r[2],pe),void 0!==a.specularColorTexture&&n.push(s.assignTexture(t,"specularColorMap",a.specularColorTexture,ue)),Promise.all(n)}},qo=class{constructor(e){this.parser=e,this.name=Mo.EXT_MATERIALS_BUMP}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Ee:null}extendMaterialParams(e,t){const s=this.parser,i=s.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const n=[],a=i.extensions[this.name];return t.bumpScale=void 0!==a.bumpFactor?a.bumpFactor:1,void 0!==a.bumpTexture&&n.push(s.assignTexture(t,"bumpMap",a.bumpTexture)),Promise.all(n)}},zo=class{constructor(e){this.parser=e,this.name=Mo.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Ee:null}extendMaterialParams(e,t){const s=this.parser,i=s.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const n=[],a=i.extensions[this.name];return void 0!==a.anisotropyStrength&&(t.anisotropy=a.anisotropyStrength),void 0!==a.anisotropyRotation&&(t.anisotropyRotation=a.anisotropyRotation),void 0!==a.anisotropyTexture&&n.push(s.assignTexture(t,"anisotropyMap",a.anisotropyTexture)),Promise.all(n)}};class Vo{constructor(e){this.parser=e,this.name=Mo.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,s=t.json,i=s.textures[e];if(!i.extensions||!i.extensions[this.name])return null;const n=i.extensions[this.name],a=t.options.ktx2Loader;if(!a){if(s.extensionsRequired&&s.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,n.source,a)}}class Ko{constructor(e){this.parser=e,this.name=Mo.EXT_TEXTURE_WEBP}loadTexture(e){const t=this.name,s=this.parser,i=s.json,n=i.textures[e];if(!n.extensions||!n.extensions[t])return null;const a=n.extensions[t],r=i.images[a.source];let o=s.textureLoader;if(r.uri){const e=s.options.manager.getHandler(r.uri);null!==e&&(o=e)}return s.loadTextureImage(e,a.source,o)}}class Jo{constructor(e){this.parser=e,this.name=Mo.EXT_TEXTURE_AVIF}loadTexture(e){const t=this.name,s=this.parser,i=s.json,n=i.textures[e];if(!n.extensions||!n.extensions[t])return null;const a=n.extensions[t],r=i.images[a.source];let o=s.textureLoader;if(r.uri){const e=s.options.manager.getHandler(r.uri);null!==e&&(o=e)}return s.loadTextureImage(e,a.source,o)}}class Yo{constructor(e){this.name=Mo.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,s=t.bufferViews[e];if(s.extensions&&s.extensions[this.name]){const e=s.extensions[this.name],i=this.parser.getDependency("buffer",e.buffer),n=this.parser.options.meshoptDecoder;if(!n||!n.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return i.then(function(t){const s=e.byteOffset||0,i=e.byteLength||0,a=e.count,r=e.byteStride,o=new Uint8Array(t,s,i);return n.decodeGltfBufferAsync?n.decodeGltfBufferAsync(a,r,o,e.mode,e.filter).then(function(e){return e.buffer}):n.ready.then(function(){const t=new ArrayBuffer(a*r);return n.decodeGltfBuffer(new Uint8Array(t),a,r,o,e.mode,e.filter),t})})}return null}}let Wo=class{constructor(e){this.name=Mo.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,s=t.nodes[e];if(!s.extensions||!s.extensions[this.name]||void 0===s.mesh)return null;const i=t.meshes[s.mesh];for(const o of i.primitives)if(o.mode!==ol.TRIANGLES&&o.mode!==ol.TRIANGLE_STRIP&&o.mode!==ol.TRIANGLE_FAN&&void 0!==o.mode)return null;const n=s.extensions[this.name].attributes,a=[],r={};for(const o in n)a.push(this.parser.getDependency("accessor",n[o]).then(e=>(r[o]=e,r[o])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(e=>{const t=e.pop(),s=t.isGroup?t.children:[t],i=e[0].count,n=[];for(const a of s){const e=new ke,t=new Te,s=new Re,o=new Te(1,1,1),l=new Me(a.geometry,a.material,i);for(let n=0;n<i;n++)r.TRANSLATION&&t.fromBufferAttribute(r.TRANSLATION,n),r.ROTATION&&s.fromBufferAttribute(r.ROTATION,n),r.SCALE&&o.fromBufferAttribute(r.SCALE,n),l.setMatrixAt(n,e.compose(t,s,o));for(const i in r)if("_COLOR_0"===i){const e=r[i];l.instanceColor=new De(e.array,e.itemSize,e.normalized)}else"TRANSLATION"!==i&&"ROTATION"!==i&&"SCALE"!==i&&a.geometry.setAttribute(i,r[i]);Ne.prototype.copy.call(l,a),this.parser.assignFinalMaterial(l),n.push(l)}return t.isGroup?(t.clear(),t.add(...n),t):n[0]}))}};const $o="glTF",Xo=1313821514,Zo=5130562;class el{constructor(e){this.name=Mo.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12),s=new TextDecoder;if(this.header={magic:s.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==$o)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const i=this.header.length-12,n=new DataView(e,12);let a=0;for(;a<i;){const t=n.getUint32(a,!0);a+=4;const i=n.getUint32(a,!0);if(a+=4,i===Xo){const i=new Uint8Array(e,12+a,t);this.content=s.decode(i)}else if(i===Zo){const s=12+a;this.body=e.slice(s,s+t)}a+=t}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class tl{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Mo.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const s=this.json,i=this.dracoLoader,n=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,r={},o={},l={};for(const c in a){const e=dl[c]||c.toLowerCase();r[e]=a[c]}for(const c in e.attributes){const t=dl[c]||c.toLowerCase();if(void 0!==a[c]){const i=s.accessors[e.attributes[c]],n=ll[i.componentType];l[t]=n.name,o[t]=!0===i.normalized}}return t.getDependency("bufferView",n).then(function(e){return new Promise(function(t,s){i.decodeDracoFile(e,function(e){for(const t in e.attributes){const s=e.attributes[t],i=o[t];void 0!==i&&(s.normalized=i)}t(e)},r,l,pe,s)})})}}class sl{constructor(){this.name=Mo.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return void 0!==t.texCoord&&t.texCoord!==e.channel||void 0!==t.offset||void 0!==t.rotation||void 0!==t.scale?(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0,e):e}}class il{constructor(){this.name=Mo.KHR_MESH_QUANTIZATION}}class nl extends yt{constructor(e,t,s,i){super(e,t,s,i)}copySampleValue_(e){const t=this.resultBuffer,s=this.sampleValues,i=this.valueSize,n=e*i*3+i;for(let a=0;a!==i;a++)t[a]=s[n+a];return t}interpolate_(e,t,s,i){const n=this.resultBuffer,a=this.sampleValues,r=this.valueSize,o=2*r,l=3*r,c=i-t,A=(s-t)/c,h=A*A,d=h*A,u=e*l,p=u-l,g=-2*d+3*h,m=d-h,f=1-g,b=m-h+A;for(let x=0;x!==r;x++){const e=a[p+x+r],t=a[p+x+o]*c,s=a[u+x+r],i=a[u+x]*c;n[x]=f*e+b*t+g*s+m*i}return n}}const al=new Re;class rl extends nl{interpolate_(e,t,s,i){const n=super.interpolate_(e,t,s,i);return al.fromArray(n).normalize().toArray(n),n}}const ol={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},ll={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},cl={9728:He,9729:Ge,9984:Oe,9985:Ue,9986:Pe,9987:Le},Al={33071:Ve,33648:ze,10497:qe},hl={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},dl={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},ul={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},pl={CUBICSPLINE:void 0,LINEAR:pt,STEP:ut},gl="OPAQUE",ml="MASK",fl="BLEND";function bl(e){return void 0===e.DefaultMaterial&&(e.DefaultMaterial=new We({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:xt})),e.DefaultMaterial}function xl(e,t,s){for(const i in s.extensions)void 0===e[i]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[i]=s.extensions[i])}function yl(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function vl(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(let s=0,i=t.weights.length;s<i;s++)e.morphTargetInfluences[s]=t.weights[s];if(t.extras&&Array.isArray(t.extras.targetNames)){const s=t.extras.targetNames;if(e.morphTargetInfluences.length===s.length){e.morphTargetDictionary={};for(let t=0,i=s.length;t<i;t++)e.morphTargetDictionary[s[t]]=t}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function wl(e){let t;const s=e.extensions&&e.extensions[Mo.KHR_DRACO_MESH_COMPRESSION];if(t=s?"draco:"+s.bufferView+":"+s.indices+":"+Il(s.attributes):e.indices+":"+Il(e.attributes)+":"+e.mode,void 0!==e.targets)for(let i=0,n=e.targets.length;i<n;i++)t+=":"+Il(e.targets[i]);return t}function Il(e){let t="";const s=Object.keys(e).sort();for(let i=0,n=s.length;i<n;i++)t+=s[i]+":"+e[s[i]]+";";return t}function Cl(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const El=new ke;class Bl{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new To,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let s=!1,i=-1,n=!1,a=-1;if("undefined"!=typeof navigator){const e=navigator.userAgent;s=!0===/^((?!chrome|android).)*safari/i.test(e);const t=e.match(/Version\/(\d+)/);i=s&&t?parseInt(t[1],10):-1,n=e.indexOf("Firefox")>-1,a=n?e.match(/Firefox\/([0-9]+)\./)[1]:-1}"undefined"==typeof createImageBitmap||s&&i<17||n&&a<98?this.textureLoader=new Fe(this.options.manager):this.textureLoader=new je(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new de(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const s=this,i=this.json,n=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(e){return e._markDefs&&e._markDefs()}),Promise.all(this._invokeAll(function(e){return e.beforeRoot&&e.beforeRoot()})).then(function(){return Promise.all([s.getDependencies("scene"),s.getDependencies("animation"),s.getDependencies("camera")])}).then(function(t){const a={scene:t[0][i.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:i.asset,parser:s,userData:{}};return xl(n,a,i),yl(a,i),Promise.all(s._invokeAll(function(e){return e.afterRoot&&e.afterRoot(a)})).then(function(){for(const e of a.scenes)e.updateMatrixWorld();e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],s=this.json.meshes||[];for(let i=0,n=t.length;i<n;i++){const s=t[i].joints;for(let t=0,i=s.length;t<i;t++)e[s[t]].isBone=!0}for(let i=0,n=e.length;i<n;i++){const t=e[i];void 0!==t.mesh&&(this._addNodeRef(this.meshCache,t.mesh),void 0!==t.skin&&(s[t.mesh].isSkinnedMesh=!0)),void 0!==t.camera&&this._addNodeRef(this.cameraCache,t.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,s){if(e.refs[t]<=1)return s;const i=s.clone(),n=(e,t)=>{const s=this.associations.get(e);null!=s&&this.associations.set(t,s);for(const[i,a]of e.children.entries())n(a,t.children[i])};return n(s,i),i.name+="_instance_"+e.uses[t]++,i}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let s=0;s<t.length;s++){const i=e(t[s]);if(i)return i}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const s=[];for(let i=0;i<t.length;i++){const n=e(t[i]);n&&s.push(n)}return s}getDependency(e,t){const s=e+":"+t;let i=this.cache.get(s);if(!i){switch(e){case"scene":i=this.loadScene(t);break;case"node":i=this._invokeOne(function(e){return e.loadNode&&e.loadNode(t)});break;case"mesh":i=this._invokeOne(function(e){return e.loadMesh&&e.loadMesh(t)});break;case"accessor":i=this.loadAccessor(t);break;case"bufferView":i=this._invokeOne(function(e){return e.loadBufferView&&e.loadBufferView(t)});break;case"buffer":i=this.loadBuffer(t);break;case"material":i=this._invokeOne(function(e){return e.loadMaterial&&e.loadMaterial(t)});break;case"texture":i=this._invokeOne(function(e){return e.loadTexture&&e.loadTexture(t)});break;case"skin":i=this.loadSkin(t);break;case"animation":i=this._invokeOne(function(e){return e.loadAnimation&&e.loadAnimation(t)});break;case"camera":i=this.loadCamera(t);break;default:if(i=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!i)throw new Error("Unknown type: "+e)}this.cache.add(s,i)}return i}getDependencies(e){let t=this.cache.get(e);if(!t){const s=this,i=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(i.map(function(t,i){return s.getDependency(e,i)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],s=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[Mo.KHR_BINARY_GLTF].body);const i=this.options;return new Promise(function(e,n){s.load(Ce.resolveURL(t.uri,i.path),e,void 0,function(){n(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(e){const s=t.byteLength||0,i=t.byteOffset||0;return e.slice(i,i+s)})}loadAccessor(e){const t=this,s=this.json,i=this.json.accessors[e];if(void 0===i.bufferView&&void 0===i.sparse){const e=hl[i.type],t=ll[i.componentType],s=!0===i.normalized,n=new t(i.count*e);return Promise.resolve(new me(n,e,s))}const n=[];return void 0!==i.bufferView?n.push(this.getDependency("bufferView",i.bufferView)):n.push(null),void 0!==i.sparse&&(n.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),n.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(n).then(function(e){const n=e[0],a=hl[i.type],r=ll[i.componentType],o=r.BYTES_PER_ELEMENT,l=o*a,c=i.byteOffset||0,A=void 0!==i.bufferView?s.bufferViews[i.bufferView].byteStride:void 0,h=!0===i.normalized;let d,u;if(A&&A!==l){const e=Math.floor(c/A),s="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+e+":"+i.count;let l=t.cache.get(s);l||(d=new r(n,e*A,i.count*A/o),l=new fe(d,A/o),t.cache.add(s,l)),u=new ye(l,a,c%A/o,h)}else d=null===n?new r(i.count*a):new r(n,c,i.count*a),u=new me(d,a,h);if(void 0!==i.sparse){const t=hl.SCALAR,s=ll[i.sparse.indices.componentType],o=i.sparse.indices.byteOffset||0,l=i.sparse.values.byteOffset||0,c=new s(e[1],o,i.sparse.count*t),A=new r(e[2],l,i.sparse.count*a);null!==n&&(u=new me(u.array.slice(),u.itemSize,u.normalized)),u.normalized=!1;for(let e=0,i=c.length;e<i;e++){const t=c[e];if(u.setX(t,A[e*a]),a>=2&&u.setY(t,A[e*a+1]),a>=3&&u.setZ(t,A[e*a+2]),a>=4&&u.setW(t,A[e*a+3]),a>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}u.normalized=h}return u})}loadTexture(e){const t=this.json,s=this.options,i=t.textures[e].source,n=t.images[i];let a=this.textureLoader;if(n.uri){const e=s.manager.getHandler(n.uri);null!==e&&(a=e)}return this.loadTextureImage(e,i,a)}loadTextureImage(e,t,s){const i=this,n=this.json,a=n.textures[e],r=n.images[t],o=(r.uri||r.bufferView)+":"+a.sampler;if(this.textureCache[o])return this.textureCache[o];const l=this.loadImageSource(t,s).then(function(t){t.flipY=!1,t.name=a.name||r.name||"",""===t.name&&"string"==typeof r.uri&&!1===r.uri.startsWith("data:image/")&&(t.name=r.uri);const s=(n.samplers||{})[a.sampler]||{};return t.magFilter=cl[s.magFilter]||Ge,t.minFilter=cl[s.minFilter]||Le,t.wrapS=Al[s.wrapS]||qe,t.wrapT=Al[s.wrapT]||qe,t.generateMipmaps=!t.isCompressedTexture&&t.minFilter!==He&&t.minFilter!==Ge,i.associations.set(t,{textures:e}),t}).catch(function(){return null});return this.textureCache[o]=l,l}loadImageSource(e,t){const s=this,i=this.json,n=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(e=>e.clone());const a=i.images[e],r=self.URL||self.webkitURL;let o=a.uri||"",l=!1;if(void 0!==a.bufferView)o=s.getDependency("bufferView",a.bufferView).then(function(e){l=!0;const t=new Blob([e],{type:a.mimeType});return o=r.createObjectURL(t),o});else if(void 0===a.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const c=Promise.resolve(o).then(function(e){return new Promise(function(s,i){let a=s;!0===t.isImageBitmapLoader&&(a=function(e){const t=new gt(e);t.needsUpdate=!0,s(t)}),t.load(Ce.resolveURL(e,n.path),a,void 0,i)})}).then(function(e){var t;return!0===l&&r.revokeObjectURL(o),yl(e,a),e.userData.mimeType=a.mimeType||((t=a.uri).search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/)?"image/jpeg":t.search(/\.webp($|\?)/i)>0||0===t.search(/^data\:image\/webp/)?"image/webp":t.search(/\.ktx2($|\?)/i)>0||0===t.search(/^data\:image\/ktx2/)?"image/ktx2":"image/png"),e}).catch(function(e){throw console.error("THREE.GLTFLoader: Couldn't load texture",o),e});return this.sourceCache[e]=c,c}assignTexture(e,t,s,i){const n=this;return this.getDependency("texture",s.index).then(function(a){if(!a)return null;if(void 0!==s.texCoord&&s.texCoord>0&&((a=a.clone()).channel=s.texCoord),n.extensions[Mo.KHR_TEXTURE_TRANSFORM]){const e=void 0!==s.extensions?s.extensions[Mo.KHR_TEXTURE_TRANSFORM]:void 0;if(e){const t=n.associations.get(a);a=n.extensions[Mo.KHR_TEXTURE_TRANSFORM].extendTexture(a,e),n.associations.set(a,t)}}return void 0!==i&&(a.colorSpace=i),e[t]=a,a})}assignFinalMaterial(e){const t=e.geometry;let s=e.material;const i=void 0===t.attributes.tangent,n=void 0!==t.attributes.color,a=void 0===t.attributes.normal;if(e.isPoints){const e="PointsMaterial:"+s.uuid;let t=this.cache.get(e);t||(t=new Ke,Je.prototype.copy.call(t,s),t.color.copy(s.color),t.map=s.map,t.sizeAttenuation=!1,this.cache.add(e,t)),s=t}else if(e.isLine){const e="LineBasicMaterial:"+s.uuid;let t=this.cache.get(e);t||(t=new Ye,Je.prototype.copy.call(t,s),t.color.copy(s.color),t.map=s.map,this.cache.add(e,t)),s=t}if(i||n||a){let e="ClonedMaterial:"+s.uuid+":";i&&(e+="derivative-tangents:"),n&&(e+="vertex-colors:"),a&&(e+="flat-shading:");let t=this.cache.get(e);t||(t=s.clone(),n&&(t.vertexColors=!0),a&&(t.flatShading=!0),i&&(t.normalScale&&(t.normalScale.y*=-1),t.clearcoatNormalScale&&(t.clearcoatNormalScale.y*=-1)),this.cache.add(e,t),this.associations.set(t,this.associations.get(s))),s=t}e.material=s}getMaterialType(){return We}loadMaterial(e){const t=this,s=this.json,i=this.extensions,n=s.materials[e];let a;const r={},o=[];if((n.extensions||{})[Mo.KHR_MATERIALS_UNLIT]){const e=i[Mo.KHR_MATERIALS_UNLIT];a=e.getMaterialType(),o.push(e.extendParams(r,n,t))}else{const s=n.pbrMetallicRoughness||{};if(r.color=new be(1,1,1),r.opacity=1,Array.isArray(s.baseColorFactor)){const e=s.baseColorFactor;r.color.setRGB(e[0],e[1],e[2],pe),r.opacity=e[3]}void 0!==s.baseColorTexture&&o.push(t.assignTexture(r,"map",s.baseColorTexture,ue)),r.metalness=void 0!==s.metallicFactor?s.metallicFactor:1,r.roughness=void 0!==s.roughnessFactor?s.roughnessFactor:1,void 0!==s.metallicRoughnessTexture&&(o.push(t.assignTexture(r,"metalnessMap",s.metallicRoughnessTexture)),o.push(t.assignTexture(r,"roughnessMap",s.metallicRoughnessTexture))),a=this._invokeOne(function(t){return t.getMaterialType&&t.getMaterialType(e)}),o.push(Promise.all(this._invokeAll(function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,r)})))}!0===n.doubleSided&&(r.side=$e);const l=n.alphaMode||gl;if(l===fl?(r.transparent=!0,r.depthWrite=!1):(r.transparent=!1,l===ml&&(r.alphaTest=void 0!==n.alphaCutoff?n.alphaCutoff:.5)),void 0!==n.normalTexture&&a!==Xe&&(o.push(t.assignTexture(r,"normalMap",n.normalTexture)),r.normalScale=new Be(1,1),void 0!==n.normalTexture.scale)){const e=n.normalTexture.scale;r.normalScale.set(e,e)}if(void 0!==n.occlusionTexture&&a!==Xe&&(o.push(t.assignTexture(r,"aoMap",n.occlusionTexture)),void 0!==n.occlusionTexture.strength&&(r.aoMapIntensity=n.occlusionTexture.strength)),void 0!==n.emissiveFactor&&a!==Xe){const e=n.emissiveFactor;r.emissive=(new be).setRGB(e[0],e[1],e[2],pe)}return void 0!==n.emissiveTexture&&a!==Xe&&o.push(t.assignTexture(r,"emissiveMap",n.emissiveTexture,ue)),Promise.all(o).then(function(){const s=new a(r);return n.name&&(s.name=n.name),yl(s,n),t.associations.set(s,{materials:e}),n.extensions&&xl(i,s,n),s})}createUniqueName(e){const t=Ze.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,s=this.extensions,i=this.primitiveCache;function n(e){return s[Mo.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then(function(s){return Ql(s,e,t)})}const a=[];for(let r=0,o=e.length;r<o;r++){const s=e[r],o=wl(s),l=i[o];if(l)a.push(l.promise);else{let e;e=s.extensions&&s.extensions[Mo.KHR_DRACO_MESH_COMPRESSION]?n(s):Ql(new ge,s,t),i[o]={primitive:s,promise:e},a.push(e)}}return Promise.all(a)}loadMesh(e){const t=this,s=this.json,i=this.extensions,n=s.meshes[e],a=n.primitives,r=[];for(let o=0,l=a.length;o<l;o++){const e=void 0===a[o].material?bl(this.cache):this.getDependency("material",a[o].material);r.push(e)}return r.push(t.loadGeometries(a)),Promise.all(r).then(function(s){const r=s.slice(0,s.length-1),o=s[s.length-1],l=[];for(let A=0,h=o.length;A<h;A++){const s=o[A],c=a[A];let h;const d=r[A];if(c.mode===ol.TRIANGLES||c.mode===ol.TRIANGLE_STRIP||c.mode===ol.TRIANGLE_FAN||void 0===c.mode)h=!0===n.isSkinnedMesh?new et(s,d):new tt(s,d),!0===h.isSkinnedMesh&&h.normalizeSkinWeights(),c.mode===ol.TRIANGLE_STRIP?h.geometry=_o(h.geometry,Ie):c.mode===ol.TRIANGLE_FAN&&(h.geometry=_o(h.geometry,we));else if(c.mode===ol.LINES)h=new st(s,d);else if(c.mode===ol.LINE_STRIP)h=new it(s,d);else if(c.mode===ol.LINE_LOOP)h=new nt(s,d);else{if(c.mode!==ol.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+c.mode);h=new at(s,d)}Object.keys(h.geometry.morphAttributes).length>0&&vl(h,n),h.name=t.createUniqueName(n.name||"mesh_"+e),yl(h,n),c.extensions&&xl(i,h,c),t.assignFinalMaterial(h),l.push(h)}for(let i=0,n=l.length;i<n;i++)t.associations.set(l[i],{meshes:e,primitives:i});if(1===l.length)return n.extensions&&xl(i,l[0],n),l[0];const c=new rt;n.extensions&&xl(i,c,n),t.associations.set(c,{meshes:e});for(let e=0,t=l.length;e<t;e++)c.add(l[e]);return c})}loadCamera(e){let t;const s=this.json.cameras[e],i=s[s.type];if(i)return"perspective"===s.type?t=new ot(lt.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):"orthographic"===s.type&&(t=new ct(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),s.name&&(t.name=this.createUniqueName(s.name)),yl(t,s),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],s=[];for(let i=0,n=t.joints.length;i<n;i++)s.push(this._loadNodeShallow(t.joints[i]));return void 0!==t.inverseBindMatrices?s.push(this.getDependency("accessor",t.inverseBindMatrices)):s.push(null),Promise.all(s).then(function(e){const s=e.pop(),i=e,n=[],a=[];for(let r=0,o=i.length;r<o;r++){const e=i[r];if(e){n.push(e);const t=new ke;null!==s&&t.fromArray(s.array,16*r),a.push(t)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[r])}return new At(n,a)})}loadAnimation(e){const t=this.json,s=this,i=t.animations[e],n=i.name?i.name:"animation_"+e,a=[],r=[],o=[],l=[],c=[];for(let A=0,h=i.channels.length;A<h;A++){const e=i.channels[A],t=i.samplers[e.sampler],s=e.target,n=s.node,h=void 0!==i.parameters?i.parameters[t.input]:t.input,d=void 0!==i.parameters?i.parameters[t.output]:t.output;void 0!==s.node&&(a.push(this.getDependency("node",n)),r.push(this.getDependency("accessor",h)),o.push(this.getDependency("accessor",d)),l.push(t),c.push(s))}return Promise.all([Promise.all(a),Promise.all(r),Promise.all(o),Promise.all(l),Promise.all(c)]).then(function(e){const t=e[0],a=e[1],r=e[2],o=e[3],l=e[4],c=[];for(let i=0,n=t.length;i<n;i++){const e=t[i],n=a[i],A=r[i],h=o[i],d=l[i];if(void 0===e)continue;e.updateMatrix&&e.updateMatrix();const u=s._createAnimationTracks(e,n,A,h,d);if(u)for(let t=0;t<u.length;t++)c.push(u[t])}const A=new ht(n,void 0,c);return yl(A,i),A})}createNodeMesh(e){const t=this.json,s=this,i=t.nodes[e];return void 0===i.mesh?null:s.getDependency("mesh",i.mesh).then(function(e){const t=s._getNodeRef(s.meshCache,i.mesh,e);return void 0!==i.weights&&t.traverse(function(e){if(e.isMesh)for(let t=0,s=i.weights.length;t<s;t++)e.morphTargetInfluences[t]=i.weights[t]}),t})}loadNode(e){const t=this,s=this.json.nodes[e],i=t._loadNodeShallow(e),n=[],a=s.children||[];for(let o=0,l=a.length;o<l;o++)n.push(t.getDependency("node",a[o]));const r=void 0===s.skin?Promise.resolve(null):t.getDependency("skin",s.skin);return Promise.all([i,Promise.all(n),r]).then(function(e){const t=e[0],s=e[1],i=e[2];null!==i&&t.traverse(function(e){e.isSkinnedMesh&&e.bind(i,El)});for(let n=0,a=s.length;n<a;n++)t.add(s[n]);return t})}_loadNodeShallow(e){const t=this.json,s=this.extensions,i=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const n=t.nodes[e],a=n.name?i.createUniqueName(n.name):"",r=[],o=i._invokeOne(function(t){return t.createNodeMesh&&t.createNodeMesh(e)});return o&&r.push(o),void 0!==n.camera&&r.push(i.getDependency("camera",n.camera).then(function(e){return i._getNodeRef(i.cameraCache,n.camera,e)})),i._invokeAll(function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)}).forEach(function(e){r.push(e)}),this.nodeCache[e]=Promise.all(r).then(function(t){let r;if(r=!0===n.isBone?new dt:t.length>1?new rt:1===t.length?t[0]:new Ne,r!==t[0])for(let e=0,s=t.length;e<s;e++)r.add(t[e]);if(n.name&&(r.userData.name=n.name,r.name=a),yl(r,n),n.extensions&&xl(s,r,n),void 0!==n.matrix){const e=new ke;e.fromArray(n.matrix),r.applyMatrix4(e)}else void 0!==n.translation&&r.position.fromArray(n.translation),void 0!==n.rotation&&r.quaternion.fromArray(n.rotation),void 0!==n.scale&&r.scale.fromArray(n.scale);if(i.associations.has(r)){if(void 0!==n.mesh&&i.meshCache.refs[n.mesh]>1){const e=i.associations.get(r);i.associations.set(r,{...e})}}else i.associations.set(r,{});return i.associations.get(r).nodes=e,r}),this.nodeCache[e]}loadScene(e){const t=this.extensions,s=this.json.scenes[e],i=this,n=new rt;s.name&&(n.name=i.createUniqueName(s.name)),yl(n,s),s.extensions&&xl(t,n,s);const a=s.nodes||[],r=[];for(let o=0,l=a.length;o<l;o++)r.push(i.getDependency("node",a[o]));return Promise.all(r).then(function(e){for(let t=0,s=e.length;t<s;t++)n.add(e[t]);return i.associations=(e=>{const t=new Map;for(const[s,n]of i.associations)(s instanceof Je||s instanceof gt)&&t.set(s,n);return e.traverse(e=>{const s=i.associations.get(e);null!=s&&t.set(e,s)}),t})(n),n})}_createAnimationTracks(e,t,s,i,n){const a=[],r=e.name?e.name:e.uuid,o=[];let l;switch(ul[n.path]===ul.weights?e.traverse(function(e){e.morphTargetInfluences&&o.push(e.name?e.name:e.uuid)}):o.push(r),ul[n.path]){case ul.weights:l=ft;break;case ul.rotation:l=bt;break;case ul.translation:case ul.scale:l=mt;break;default:if(1===s.itemSize)l=ft;else l=mt}const c=void 0!==i.interpolation?pl[i.interpolation]:pt,A=this._getArrayFromAccessor(s);for(let h=0,d=o.length;h<d;h++){const e=new l(o[h]+"."+ul[n.path],t.array,A,c);"CUBICSPLINE"===i.interpolation&&this._createCubicSplineTrackInterpolant(e),a.push(e)}return a}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const e=Cl(t.constructor),s=new Float32Array(t.length);for(let i=0,n=t.length;i<n;i++)s[i]=t[i]*e;t=s}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(e){return new(this instanceof bt?rl:nl)(this.times,this.values,this.getValueSize()/3,e)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function Ql(e,t,s){const i=t.attributes,n=[];function a(t,i){return s.getDependency("accessor",t).then(function(t){e.setAttribute(i,t)})}for(const r in i){const t=dl[r]||r.toLowerCase();t in e.attributes||n.push(a(i[r],t))}if(void 0!==t.indices&&!e.index){const i=s.getDependency("accessor",t.indices).then(function(t){e.setIndex(t)});n.push(i)}return xe.workingColorSpace!==pe&&"COLOR_0"in i&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${xe.workingColorSpace}" not supported.`),yl(e,t),function(e,t,s){const i=t.attributes,n=new vt;if(void 0===i.POSITION)return;{const e=s.json.accessors[i.POSITION],t=e.min,a=e.max;if(void 0===t||void 0===a)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(n.set(new Te(t[0],t[1],t[2]),new Te(a[0],a[1],a[2])),e.normalized){const t=Cl(ll[e.componentType]);n.min.multiplyScalar(t),n.max.multiplyScalar(t)}}const a=t.targets;if(void 0!==a){const e=new Te,t=new Te;for(let i=0,n=a.length;i<n;i++){const n=a[i];if(void 0!==n.POSITION){const i=s.json.accessors[n.POSITION],a=i.min,r=i.max;if(void 0!==a&&void 0!==r){if(t.setX(Math.max(Math.abs(a[0]),Math.abs(r[0]))),t.setY(Math.max(Math.abs(a[1]),Math.abs(r[1]))),t.setZ(Math.max(Math.abs(a[2]),Math.abs(r[2]))),i.normalized){const e=Cl(ll[i.componentType]);t.multiplyScalar(e)}e.max(t)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}n.expandByVector(e)}e.boundingBox=n;const r=new wt;n.getCenter(r.center),r.radius=n.min.distanceTo(n.max)/2,e.boundingSphere=r}(e,t,s),Promise.all(n).then(function(){return void 0!==t.targets?function(e,t,s){let i=!1,n=!1,a=!1;for(let c=0,A=t.length;c<A;c++){const e=t[c];if(void 0!==e.POSITION&&(i=!0),void 0!==e.NORMAL&&(n=!0),void 0!==e.COLOR_0&&(a=!0),i&&n&&a)break}if(!i&&!n&&!a)return Promise.resolve(e);const r=[],o=[],l=[];for(let c=0,A=t.length;c<A;c++){const A=t[c];if(i){const t=void 0!==A.POSITION?s.getDependency("accessor",A.POSITION):e.attributes.position;r.push(t)}if(n){const t=void 0!==A.NORMAL?s.getDependency("accessor",A.NORMAL):e.attributes.normal;o.push(t)}if(a){const t=void 0!==A.COLOR_0?s.getDependency("accessor",A.COLOR_0):e.attributes.color;l.push(t)}}return Promise.all([Promise.all(r),Promise.all(o),Promise.all(l)]).then(function(t){const s=t[0],r=t[1],o=t[2];return i&&(e.morphAttributes.position=s),n&&(e.morphAttributes.normal=r),a&&(e.morphAttributes.color=o),e.morphTargetsRelative=!0,e})}(e,t.targets,s):e})}class Sl{constructor(e=4){this.pool=e,this.queue=[],this.workers=[],this.workersResolve=[],this.workerStatus=0,this.workerCreator=null}_initWorker(e){if(!this.workers[e]){const t=this.workerCreator();t.addEventListener("message",this._onMessage.bind(this,e)),this.workers[e]=t}}_getIdleWorker(){for(let e=0;e<this.pool;e++)if(!(this.workerStatus&1<<e))return e;return-1}_onMessage(e,t){const s=this.workersResolve[e];if(s&&s(t),this.queue.length){const{resolve:t,msg:s,transfer:i}=this.queue.shift();this.workersResolve[e]=t,this.workers[e].postMessage(s,i)}else this.workerStatus^=1<<e}setWorkerCreator(e){this.workerCreator=e}setWorkerLimit(e){this.pool=e}postMessage(e,t){return new Promise(s=>{const i=this._getIdleWorker();-1!==i?(this._initWorker(i),this.workerStatus|=1<<i,this.workersResolve[i]=s,this.workers[i].postMessage(e,t)):this.queue.push({resolve:s,msg:e,transfer:t})})}dispose(){this.workers.forEach(e=>e.terminate()),this.workersResolve.length=0,this.workers.length=0,this.queue.length=0,this.workerStatus=0}}const _l=9,kl=15,Tl=16,Ml=22,Rl=37,Dl=43,Nl=76,Fl=83,jl=97,Ll=100,Pl=103,Ul=109,Ol=122,Gl=123,Hl=131,ql=132,zl=133,Vl=134,Kl=137,Jl=138,Yl=139,Wl=140,$l=141,Xl=142,Zl=145,ec=146,tc=148,sc=152,ic=153,nc=154,ac=155,rc=156,oc=157,lc=158,cc=165,Ac=166,hc=1000054e3,dc=1000054001,uc=1000054004,pc=1000054005,gc=1000066e3,mc=1000066004;class fc{constructor(e,t,s,i){this._dataView=void 0,this._littleEndian=void 0,this._offset=void 0,this._dataView=new DataView(e.buffer,e.byteOffset+t,s),this._littleEndian=i,this._offset=0}_nextUint8(){const e=this._dataView.getUint8(this._offset);return this._offset+=1,e}_nextUint16(){const e=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,e}_nextUint32(){const e=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,e}_nextUint64(){const e=this._dataView.getUint32(this._offset,this._littleEndian)+2**32*this._dataView.getUint32(this._offset+4,this._littleEndian);return this._offset+=8,e}_nextInt32(){const e=this._dataView.getInt32(this._offset,this._littleEndian);return this._offset+=4,e}_nextUint8Array(e){const t=new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+this._offset,e);return this._offset+=e,t}_skip(e){return this._offset+=e,this}_scan(e,t=0){const s=this._offset;let i=0;for(;this._dataView.getUint8(this._offset)!==t&&i<e;)i++,this._offset++;return i<e&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+s,i)}}const bc=[171,75,84,88,32,50,48,187,13,10,26,10];function xc(e){return(new TextDecoder).decode(e)}let yc,vc,wc;const Ic={env:{emscripten_notify_memory_growth:function(e){wc=new Uint8Array(vc.exports.memory.buffer)}}};class Cc{init(){return yc||(yc="undefined"!=typeof fetch?fetch("data:application/wasm;base64,"+Ec).then(e=>e.arrayBuffer()).then(e=>WebAssembly.instantiate(e,Ic)).then(this._init):WebAssembly.instantiate(Buffer.from(Ec,"base64"),Ic).then(this._init),yc)}_init(e){vc=e.instance,Ic.env.emscripten_notify_memory_growth(0)}decode(e,t=0){if(!vc)throw new Error("ZSTDDecoder: Await .init() before decoding.");const s=e.byteLength,i=vc.exports.malloc(s);wc.set(e,i),t=t||Number(vc.exports.ZSTD_findDecompressedSize(i,s));const n=vc.exports.malloc(t),a=vc.exports.ZSTD_decompress(n,t,i,s),r=wc.slice(n,n+a);return vc.exports.free(i),vc.exports.free(n),r}}const Ec="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IAMNACAEQQNxBEADQCACRQ0FIAAgAkF/aiICaiIDIAEgAmotAAA6AAAgA0EDcQ0ACwsgAkEDTQ0AA0AgACACQXxqIgJqIAEgAmooAgA2AgAgAkEDSw0ACwsgAkUNAgNAIAAgAkF/aiICaiABIAJqLQAAOgAAIAINAAsMAgsgAkEDTQ0AIAIhBANAIAMgASgCADYCACABQQRqIQEgA0EEaiEDIARBfGoiBEEDSw0ACyACQQNxIQILIAJFDQADQCADIAEtAAA6AAAgA0EBaiEDIAFBAWohASACQX9qIgINAAsLIAAL8wICAn8BfgJAIAJFDQAgACACaiIDQX9qIAE6AAAgACABOgAAIAJBA0kNACADQX5qIAE6AAAgACABOgABIANBfWogAToAACAAIAE6AAIgAkEHSQ0AIANBfGogAToAACAAIAE6AAMgAkEJSQ0AIABBACAAa0EDcSIEaiIDIAFB/wFxQYGChAhsIgE2AgAgAyACIARrQXxxIgRqIgJBfGogATYCACAEQQlJDQAgAyABNgIIIAMgATYCBCACQXhqIAE2AgAgAkF0aiABNgIAIARBGUkNACADIAE2AhggAyABNgIUIAMgATYCECADIAE2AgwgAkFwaiABNgIAIAJBbGogATYCACACQWhqIAE2AgAgAkFkaiABNgIAIAQgA0EEcUEYciIEayICQSBJDQAgAa0iBUIghiAFhCEFIAMgBGohAQNAIAEgBTcDGCABIAU3AxAgASAFNwMIIAEgBTcDACABQSBqIQEgAkFgaiICQR9LDQALCyAACy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAIajYCACADCy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAFajYCACADCx8AIAAgASACKAIEEAg2AgAgARAEGiAAIAJBCGo2AgQLCAAgAGdBH3MLugUBDX8jAEEQayIKJAACfyAEQQNNBEAgCkEANgIMIApBDGogAyAEEAsaIAAgASACIApBDGpBBBAVIgBBbCAAEAMbIAAgACAESxsMAQsgAEEAIAEoAgBBAXRBAmoQECENQVQgAygAACIGQQ9xIgBBCksNABogAiAAQQVqNgIAIAMgBGoiAkF8aiEMIAJBeWohDiACQXtqIRAgAEEGaiELQQQh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ASIDNgLE4AEgACgCvOABIQQgACABNgK84AEgACABIAJqNgK44AEgACABIAQgA2tqNgLA4AELpgEBAX8gACAAKALs4QEQFjYCyOABIABCADcD+OABIABCADcDuOABIABBwOABakIANwMAIABBqNAAaiIBQYyAgOAANgIAIABBADYCmOIBIABCADcDiOEBIABCAzcDgOEBIABBrNABakHgEikCADcCACAAQbTQAWpB6BIoAgA2AgAgACABNgIMIAAgAEGYIGo2AgggACAAQaAwajYCBCAAIABBEGo2AgALYQEBf0G4fyEDAkAgAUEDSQ0AIAIgABAhIgFBA3YiADYCCCACIAFBAXE2AgQgAiABQQF2QQNxIgM2AgACQCADQX9qIgFBAksNAAJAIAFBAWsOAgEAAgtBbA8LIAAhAwsgAwsMACAAIAEgAkEAEC4LiAQCA38CfiADEBYhBCAAQQBBKBAQIQAgBCACSwRAIAQPCyABRQRAQX8PCwJAAkAgA0EBRg0AIAEoAAAiBkGo6r5pRg0AQXYhAyAGQXBxQdDUtMIBRw0BQQghAyACQQhJDQEgAEEAQSgQECEAIAEoAAQhASAAQQE2AhQgACABrTcDAEEADwsgASACIAMQLyIDIAJLDQAgACADNgIYQXIhAyABIARqIgVBf2otAAAiAkEIcQ0AIAJBIHEiBkUEQEFwIQMgBS0AACIFQacBSw0BIAVBB3GtQgEgBUEDdkEKaq2GIgdCA4h+IAd8IQggBEEBaiEECyACQQZ2IQMgAkECdiEFAkAgAkEDcUF/aiICQQJLBEBBACECDAELAkACQAJAIAJBAWsOAgECAAsgASAEai0AACECIARBAWohBAwCCyABIARqLwAAIQIgBEECaiEEDAELIAEgBGooAAAhAiAEQQRqIQQLIAVBAXEhBQJ+AkACQAJAIANBf2oiA0ECTQRAIANBAWsOAgIDAQtCfyAGRQ0DGiABIARqMQAADAMLIAEgBGovAACtQoACfAwCCyABIARqKAAArQwBCyABIARqKQAACyEHIAAgBTYCICAAIAI2AhwgACAHNwMAQQAhAyAAQQA2AhQgACAHIAggBhsiBzcDCCAAIAdCgIAIIAdCgIAIVBs+AhALIAMLWwEBf0G4fyEDIAIQFiICIAFNBH8gACACakF/ai0AACIAQQNxQQJ0QaAeaigC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C0Egak8NAQsgByAHKQNoNwMQIAcgBykDYDcDCCAEIA0gB0EIaiAHQdwAaiAPIA4gESAQEB4hCwwBCyACIARqIQggBCAKEAcgAkERTwRAIARBEGohAgNAIAIgCkEQaiIKEAcgAkEQaiICIAhJDQALCyAIIAlrIQIgByATNgJcIAkgCCAOa0sEQCAJIAggEWtLBEBBbCELDAILIBAgAiAOayICaiIKIANqIBBNBEAgCCAKIAMQDxoMAgsgCCAKQQAgAmsQDyEIIAcgAiADaiIDNgJkIAggAmshCCAOIQILIAlBEE8EQCADIAhqIQMDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALDAELAkAgCUEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgCUECdCIDQcAeaigCAGoiAhAXIAIgA0HgHmooAgBrIQIgBygCZCEDDAELIAggAhAMCyADQQlJDQAgAyAIaiEDIAhBCGoiCCACQQhqIgJrQQ9MBEADQCAIIAIQDCACQQhqIQIgCEEIaiIIIANJDQAMAgALAAsDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALCyAHQRhqEAQaIAsgDCALEAMiAhshDCAEIAQgC2ogAhshBCAFQX9qIgUNAAsgDBADDQFBbCEMIAdBGGoQBEECSQ0BQQAhCANAIAhBA0cEQCAAIAhBAnQiAmpBrNABaiACIAdqKAJENgIAIAhBAWohCAwBCwsgBygCXCEIC0G6fyEMIA8gCGsiACANIARrSw0AIAQEfyAEIAggABALIABqBUEACyABayEMCyAHQfAAaiQAIAwLkRcCFn8FfiMAQdABayIHJAAgByAAKALw4QEiCDYCvAEgASACaiESIAggACgCgOIBaiETAkACQCAFRQRAIAEhAwwBCyAAKALE4AEhESAAKALA4AEhFSAAKAK84AEhDyAAQQE2AozhAUEAIQgDQCAIQQNHBEAgByAIQQJ0IgJqIAAgAmpBrNABaigCADYCVCAIQQFqIQgMAQsLIAcgETYCZCAHIA82AmAgByABIA9rNgJoQWwhECAHQShqIAMgBBAGEAMNASAFQQQgBUEESBshFyAHQTxqIAdBKGogACgCABATIAdBxABqIAdBKGogACgCCBATIAdBzABqIAdB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IAdB0AFqJAAgEAslACAAQgA3AgAgAEEAOwEIIABBADoACyAAIAE2AgwgACACOgAKC7QFAQN/IwBBMGsiBCQAIABB/wFqIgVBfWohBgJAIAMvAQIEQCAEQRhqIAEgAhAGIgIQAw0BIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahASOgAAIAMgBEEIaiAEQRhqEBI6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0FIAEgBEEQaiAEQRhqEBI6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBSABIARBCGogBEEYahASOgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEjoAACABIAJqIABrIQIMAwsgAyAEQRBqIARBGGoQEjoAAiADIARBCGogBEEYahASOgADIANBBGohAwwAAAsACyAEQRhqIAEgAhAGIgIQAw0AIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahAROgAAIAMgBEEIaiAEQRhqEBE6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0EIAEgBEEQaiAEQRhqEBE6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBCABIARBCGogBEEYahAROgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEToAACABIAJqIABrIQIMAgsgAyAEQRBqIARBGGoQEToAAiADIARBCGogBEEYahAROgADIANBBGohAwwAAAsACyAEQTBqJAAgAgtpAQF/An8CQAJAIAJBB00NACABKAAAQbfIwuF+Rw0AIAAgASgABDYCmOIBQWIgAEEQaiABIAIQPiIDEAMNAhogAEKBgICAEDcDiOEBIAAgASADaiACIANrECoMAQsgACABIAIQKgtBAAsLrQMBBn8jAEGAAWsiAyQAQWIhCAJAIAJBCUkNACAAQZjQAGogAUEIaiIEIAJBeGogAEGY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wOABCwutAgIEfwF+IwBBQGoiBCQAAkACQCACQQhJDQAgASgAAEFwcUHQ1LTCAUcNACABIAIQIiEBIABCADcDCCAAQQA2AgQgACABNgIADAELIARBGGogASACEC0iAxADBEAgACADEBoMAQsgAwRAIABBuH8QGgwBCyACIAQoAjAiA2shAiABIANqIQMDQAJAIAAgAyACIARBCGoQLCIFEAMEfyAFBSACIAVBA2oiBU8NAUG4fwsQGgwCCyAGQQFqIQYgAiAFayECIAMgBWohAyAEKAIMRQ0ACyAEKAI4BEAgAkEDTQRAIABBuH8QGgwCCyADQQRqIQMLIAQoAighAiAEKQMYIQcgAEEANgIEIAAgAyABazYCACAAIAIgBmytIAcgB0J/URs3AwgLIARBQGskAAslAQF/IwBBEGsiAiQAIAIgACABEFEgAigCACEAIAJBEGokACAAC30BBH8jAEGQBGsiBCQAIARB/wE2AggCQCAEQRBqIARBCGogBEEMaiABIAIQFSIGEAMEQCAGIQUMAQtBVCEFIAQoAgwiB0EGSw0AIAMgBEEQaiAEKAIIIAcQQSIFEAMNACAAIAEgBmogAiAGayADEDwhBQsgBEGQBGokACAFC4cBAgJ/An5BABAWIQMCQANAIAEgA08EQAJAIAAoAABBcHFB0NS0wgFGBEAgACABECIiAhADRQ0BQn4PCyAAIAEQVSIEQn1WDQMgBCAFfCIFIARUIQJCfiEEIAINAyAAIAEQUiICEAMNAwsgASACayEBIAAgAmohAAwBCwtCfiAFIAEbIQQLIAQLPwIBfwF+IwBBMGsiAiQAAn5CfiACQQhqIAAgARAtDQAaQgAgAigCHEEBRg0AGiACKQMICyEDIAJBMGokACADC40BAQJ/IwBBMGsiASQAAkAgAEUNACAAKAKI4gENACABIABB/OEBaigCADYCKCABIAApAvThATcDICAAEDAgACgCqOIBIQIgASABKAIoNgIYIAEgASkDIDcDECACIAFBEGoQGyAAQQA2AqjiASABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALKgECfyMAQRBrIgAkACAAQQA2AgggAEIANwMAIAAQWCEBIABBEGokACABC4cBAQN/IwBBEGsiAiQAAkAgACgCAEUgACgCBEVzDQAgAiAAKAIINgIIIAIgACkCADcDAAJ/IAIoAgAiAQRAIAIoAghBqOMJIAERBQAMAQtBqOMJECgLIgFFDQAgASAAKQIANwL04QEgAUH84QFqIAAoAgg2AgAgARBZIAEhAwsgAkEQaiQAIAMLywEBAn8jAEEgayIBJAAgAEGBgIDAADYCtOIBIABBADYCiOIBIABBADYC7OEBIABCADcDkOIBIABBADYCpOMJIABBADYC3OIBIABCADcCzOIBIABBADYCvOIBIABBADYCxOABIABCADcCnOIBIABBpOIBakIANwIAIABBrOIBakEANgIAIAFCADcCECABQgA3AhggASABKQMYNwMIIAEgASkDEDcDACABKAIIQQh2QQFxIQIgAEEANgLg4gEgACACNgKM4gEgAUEgaiQAC3YBA38jAEEwayIBJAAgAARAIAEgAEHE0AFqIgIoAgA2AiggASAAKQK80AE3AyAgACgCACEDIAEgAigCADYCGCABIAApArzQATcDECADIAFBEGoQGyABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALzAEBAX8gACABKAK00AE2ApjiASAAIAEoAgQiAjYCwOABIAAgAjYCvOABIAAgAiABKAIIaiICNgK44AEgACACNgLE4AEgASgCuNABBEAgAEKBgICAEDcDiOEBIAAgAUGk0ABqNgIMIAAgAUGUIGo2AgggACABQZwwajYCBCAAIAFBDGo2AgAgAEGs0AFqIAFBqNABaigCADYCACAAQbDQAWogAUGs0AFqKAIANgIAIABBtNABaiABQbDQAWooAgA2AgAPCyAAQgA3A4jhAQs7ACACRQRAQbp/DwsgBEUEQEFsDwsgAiAEEGAEQCAAIAEgAiADIAQgBRBhDwsgACABIAIgAyAEIAUQZQtGAQF/IwBBEGsiBSQAIAVBCGogBBAOAn8gBS0ACQRAIAAgASACIAMgBBAyDAELIAAgASACIAMgBBA0CyEAIAVBEGokACAACzQAIAAgAyAEIAUQNiIFEAMEQCAFDwsgBSAESQR/IAEgAiADIAVqIAQgBWsgABA1BUG4fwsLRgEBfyMAQRBrIgUkACAFQQhqIAQQDgJ/IAUtAAkEQCAAIAEgAiADIAQQYgwBCyAAIAEgAiADIAQQNQshACAFQRBqJAAgAAtZAQF/QQ8hAiABIABJBEAgAUEE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";xe.spaces[ue];const Bc=new WeakMap;let Qc,Sc=0;class _c extends he{constructor(e){super(e),this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerPool=new Sl,this.workerSourceURL="",this.workerConfig=null,"undefined"!=typeof MSC_TRANSCODER&&console.warn('THREE.KTX2Loader: Please update to latest "basis_transcoder". "msc_basis_transcoder" is no longer supported in three.js r125+.')}setTranscoderPath(e){return this.transcoderPath=e,this}setWorkerLimit(e){return this.workerPool.setWorkerLimit(e),this}async detectSupportAsync(e){return console.warn('KTX2Loader: "detectSupportAsync()" has been deprecated. Use "detectSupport()" and "await renderer.init();" when creating the renderer.'),await e.init(),this.detectSupport(e)}detectSupport(e){return!0===e.isWebGPURenderer?this.workerConfig={astcSupported:e.hasFeature("texture-compression-astc"),astcHDRSupported:!1,etc1Supported:e.hasFeature("texture-compression-etc1"),etc2Supported:e.hasFeature("texture-compression-etc2"),dxtSupported:e.hasFeature("texture-compression-s3tc"),bptcSupported:e.hasFeature("texture-compression-bc"),pvrtcSupported:e.hasFeature("texture-compression-pvrtc")}:(this.workerConfig={astcSupported:e.extensions.has("WEBGL_compressed_texture_astc"),astcHDRSupported:e.extensions.has("WEBGL_compressed_texture_astc")&&e.extensions.get("WEBGL_compressed_texture_astc").getSupportedProfiles().includes("hdr"),etc1Supported:e.extensions.has("WEBGL_compressed_texture_etc1"),etc2Supported:e.extensions.has("WEBGL_compressed_texture_etc"),dxtSupported:e.extensions.has("WEBGL_compressed_texture_s3tc"),bptcSupported:e.extensions.has("EXT_texture_compression_bptc"),pvrtcSupported:e.extensions.has("WEBGL_compressed_texture_pvrtc")||e.extensions.has("WEBKIT_WEBGL_compressed_texture_pvrtc")},"undefined"!=typeof navigator&&navigator.platform.indexOf("Linux")>=0&&navigator.userAgent.indexOf("Firefox")>=0&&this.workerConfig.astcSupported&&this.workerConfig.etc2Supported&&this.workerConfig.bptcSupported&&this.workerConfig.dxtSupported&&(this.workerConfig.astcSupported=!1,this.workerConfig.etc2Supported=!1)),this}init(){if(!this.transcoderPending){const e=new de(this.manager);e.setPath(this.transcoderPath),e.setWithCredentials(this.withCredentials);const t=e.loadAsync("basis_transcoder.js"),s=new de(this.manager);s.setPath(this.transcoderPath),s.setResponseType("arraybuffer"),s.setWithCredentials(this.withCredentials);const i=s.loadAsync("basis_transcoder.wasm");this.transcoderPending=Promise.all([t,i]).then(([e,t])=>{const s=_c.BasisWorker.toString(),i=["/* constants */","let _EngineFormat = "+JSON.stringify(_c.EngineFormat),"let _EngineType = "+JSON.stringify(_c.EngineType),"let _TranscoderFormat = "+JSON.stringify(_c.TranscoderFormat),"let _BasisFormat = "+JSON.stringify(_c.BasisFormat),"/* basis_transcoder.js */",e,"/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([i])),this.transcoderBinary=t,this.workerPool.setWorkerCreator(()=>{const e=new Worker(this.workerSourceURL),t=this.transcoderBinary.slice(0);return e.postMessage({type:"init",config:this.workerConfig,transcoderBinary:t},[t]),e})}),Sc>0&&console.warn("THREE.KTX2Loader: Multiple active KTX2 loaders may cause performance issues. Use a single KTX2Loader instance, or call .dispose() on old instances."),Sc++}return this.transcoderPending}load(e,t,s,i){if(null===this.workerConfig)throw new Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");const n=new de(this.manager);n.setPath(this.path),n.setCrossOrigin(this.crossOrigin),n.setWithCredentials(this.withCredentials),n.setRequestHeader(this.requestHeader),n.setResponseType("arraybuffer"),n.load(e,e=>{this.parse(e,t,i)},s,i)}parse(e,t,s){if(null===this.workerConfig)throw new Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");if(Bc.has(e)){return Bc.get(e).promise.then(t).catch(s)}this._createTexture(e).then(e=>t?t(e):null).catch(s)}_createTextureFrom(e,t){const{type:s,error:i,data:{faces:n,width:a,height:r,format:o,type:l,dfdFlags:c}}=e;if("error"===s)return Promise.reject(i);let A;if(6===t.faceCount)A=new It(n,o,l);else{const e=n[0].mipmaps;A=t.layerCount>1?new Ct(e,a,r,t.layerCount,o,l):new Et(e,a,r,o,l)}return A.minFilter=1===n[0].mipmaps.length?Ge:Le,A.magFilter=Ge,A.generateMipmaps=!1,A.needsUpdate=!0,A.colorSpace=Rc(t),A.premultiplyAlpha=!!(1&c),A}async _createTexture(e,t={}){const s=function(e){const t=new Uint8Array(e.buffer,e.byteOffset,bc.length);if(t[0]!==bc[0]||t[1]!==bc[1]||t[2]!==bc[2]||t[3]!==bc[3]||t[4]!==bc[4]||t[5]!==bc[5]||t[6]!==bc[6]||t[7]!==bc[7]||t[8]!==bc[8]||t[9]!==bc[9]||t[10]!==bc[10]||t[11]!==bc[11])throw new Error("Missing KTX 2.0 identifier.");const s={vkFormat:0,typeSize:1,pixelWidth:0,pixelHeight:0,pixelDepth:0,layerCount:0,faceCount:1,levelCount:0,supercompressionScheme:0,levels:[],dataFormatDescriptor:[{vendorId:0,descriptorType:0,versionNumber:2,colorModel:0,colorPrimaries:1,transferFunction:2,flags:0,texelBlockDimension:[0,0,0,0],bytesPlane:[0,0,0,0,0,0,0,0],samples:[]}],keyValue:{},globalData:null},i=17*Uint32Array.BYTES_PER_ELEMENT,n=new fc(e,bc.length,i,!0);s.vkFormat=n._nextUint32(),s.typeSize=n._nextUint32(),s.pixelWidth=n._nextUint32(),s.pixelHeight=n._nextUint32(),s.pixelDepth=n._nextUint32(),s.layerCount=n._nextUint32(),s.faceCount=n._nextUint32(),s.levelCount=n._nextUint32(),s.supercompressionScheme=n._nextUint32();const a=n._nextUint32(),r=n._nextUint32(),o=n._nextUint32(),l=n._nextUint32(),c=n._nextUint64(),A=n._nextUint64(),h=3*Math.max(s.levelCount,1)*8,d=new fc(e,bc.length+i,h,!0);for(let j=0,L=Math.max(s.levelCount,1);j<L;j++)s.levels.push({levelData:new Uint8Array(e.buffer,e.byteOffset+d._nextUint64(),d._nextUint64()),uncompressedByteLength:d._nextUint64()});const u=new fc(e,a,r,!0);u._skip(4);const p=u._nextUint16(),g=u._nextUint16(),m=u._nextUint16(),f=u._nextUint16(),b={vendorId:p,descriptorType:g,versionNumber:m,colorModel:u._nextUint8(),colorPrimaries:u._nextUint8(),transferFunction:u._nextUint8(),flags:u._nextUint8(),texelBlockDimension:[u._nextUint8(),u._nextUint8(),u._nextUint8(),u._nextUint8()],bytesPlane:[u._nextUint8(),u._nextUint8(),u._nextUint8(),u._nextUint8(),u._nextUint8(),u._nextUint8(),u._nextUint8(),u._nextUint8()],samples:[]},x=(f/4-6)/4;for(let j=0;j<x;j++){const e={bitOffset:u._nextUint16(),bitLength:u._nextUint8(),channelType:u._nextUint8(),samplePosition:[u._nextUint8(),u._nextUint8(),u._nextUint8(),u._nextUint8()],sampleLower:Number.NEGATIVE_INFINITY,sampleUpper:Number.POSITIVE_INFINITY};64&e.channelType?(e.sampleLower=u._nextInt32(),e.sampleUpper=u._nextInt32()):(e.sampleLower=u._nextUint32(),e.sampleUpper=u._nextUint32()),b.samples[j]=e}s.dataFormatDescriptor.length=0,s.dataFormatDescriptor.push(b);const y=new fc(e,o,l,!0);for(;y._offset<l;){const e=y._nextUint32(),t=y._scan(e),i=xc(t);if(s.keyValue[i]=y._nextUint8Array(e-t.byteLength-1),i.match(/^ktx/i)){const e=xc(s.keyValue[i]);s.keyValue[i]=e.substring(0,e.lastIndexOf("\0"))}y._skip(e%4?4-e%4:0)}if(A<=0)return s;const v=new fc(e,c,A,!0),w=v._nextUint16(),I=v._nextUint16(),C=v._nextUint32(),E=v._nextUint32(),B=v._nextUint32(),Q=v._nextUint32(),S=[];for(let j=0,L=Math.max(s.levelCount,1);j<L;j++)S.push({imageFlags:v._nextUint32(),rgbSliceByteOffset:v._nextUint32(),rgbSliceByteLength:v._nextUint32(),alphaSliceByteOffset:v._nextUint32(),alphaSliceByteLength:v._nextUint32()});const _=c+v._offset,k=_+C,T=k+E,M=T+B,R=new Uint8Array(e.buffer,e.byteOffset+_,C),D=new Uint8Array(e.buffer,e.byteOffset+k,E),N=new Uint8Array(e.buffer,e.byteOffset+T,B),F=new Uint8Array(e.buffer,e.byteOffset+M,Q);return s.globalData={endpointCount:w,selectorCount:I,imageDescs:S,endpointsData:R,selectorsData:D,tablesData:N,extendedData:F},s}(new Uint8Array(e)),i=s.vkFormat===gc&&167===s.dataFormatDescriptor[0].colorModel;if(!(0===s.vkFormat||i&&!this.workerConfig.astcHDRSupported))return async function(e){const{vkFormat:t}=e;if(void 0===Tc[t])throw new Error("THREE.KTX2Loader: Unsupported vkFormat: "+t);void 0===Mc[t]&&console.warn('THREE.KTX2Loader: Missing ".type" for vkFormat: '+t);let s;2===e.supercompressionScheme&&(Qc||(Qc=new Promise(async e=>{const t=new Cc;await t.init(),e(t)})),s=await Qc);const i=[];for(let r=0;r<e.levels.length;r++){const n=Math.max(1,e.pixelWidth>>r),a=Math.max(1,e.pixelHeight>>r),o=e.pixelDepth?Math.max(1,e.pixelDepth>>r):0,l=e.levels[r];let c,A;if(0===e.supercompressionScheme)c=l.levelData;else{if(2!==e.supercompressionScheme)throw new Error("THREE.KTX2Loader: Unsupported supercompressionScheme.");c=s.decode(l.levelData,l.uncompressedByteLength)}A=Mc[t]===Zt?new Float32Array(c.buffer,c.byteOffset,c.byteLength/Float32Array.BYTES_PER_ELEMENT):Mc[t]===Wt?new Uint16Array(c.buffer,c.byteOffset,c.byteLength/Uint16Array.BYTES_PER_ELEMENT):Mc[t]===Xt||Mc[t]===$t?new Uint32Array(c.buffer,c.byteOffset,c.byteLength/Uint32Array.BYTES_PER_ELEMENT):c,i.push({data:A,width:n,height:a,depth:o})}const n=0===e.levelCount||i.length>1;let a;if(kc.has(Tc[t]))a=0===e.pixelDepth?new es(i[0].data,e.pixelWidth,e.pixelHeight):new ts(i[0].data,e.pixelWidth,e.pixelHeight,e.pixelDepth),a.minFilter=n?Oe:He,a.magFilter=He,a.generateMipmaps=0===e.levelCount;else{if(e.pixelDepth>0)throw new Error("THREE.KTX2Loader: Unsupported pixelDepth.");a=new Et(i,e.pixelWidth,e.pixelHeight),a.minFilter=n?Le:Ge,a.magFilter=Ge}return a.mipmaps=i,a.type=Mc[t],a.format=Tc[t],a.colorSpace=Rc(e),a.needsUpdate=!0,Promise.resolve(a)}(s);const n=t,a=this.init().then(()=>this.workerPool.postMessage({type:"transcode",buffer:e,taskConfig:n},[e])).then(e=>this._createTextureFrom(e.data,s));return Bc.set(e,{promise:a}),a}dispose(){this.workerPool.dispose(),this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),Sc--}}_c.BasisFormat={ETC1S:0,UASTC:1,UASTC_HDR:2},_c.TranscoderFormat={ETC1:0,ETC2:1,BC1:2,BC3:3,BC4:4,BC5:5,BC7_M6_OPAQUE_ONLY:6,BC7_M5:7,PVRTC1_4_RGB:8,PVRTC1_4_RGBA:9,ASTC_4x4:10,ATC_RGB:11,ATC_RGBA_INTERPOLATED_ALPHA:12,RGBA32:13,RGB565:14,BGR565:15,RGBA4444:16,BC6H:22,RGB_HALF:24,RGBA_HALF:25},_c.EngineFormat={RGBAFormat:Jt,RGBA_ASTC_4x4_Format:Lt,RGB_BPTC_UNSIGNED_Format:as,RGBA_BPTC_Format:_t,RGBA_ETC2_EAC_Format:qt,RGBA_PVRTC_4BPPV1_Format:St,RGBA_S3TC_DXT5_Format:ns,RGB_ETC1_Format:is,RGB_ETC2_Format:Ht,RGB_PVRTC_4BPPV1_Format:ss,RGBA_S3TC_DXT1_Format:Ft},_c.EngineType={UnsignedByteType:Yt,HalfFloatType:Wt,FloatType:Zt},_c.BasisWorker=function(){let e,t,s;const i=_EngineFormat,n=_EngineType,a=_TranscoderFormat,r=_BasisFormat;self.addEventListener("message",function(i){const a=i.data;switch(a.type){case"init":e=a.config,o=a.transcoderBinary,t=new Promise(e=>{s={wasmBinary:o,onRuntimeInitialized:e},BASIS(s)}).then(()=>{s.initializeBasis(),void 0===s.KTX2File&&console.warn("THREE.KTX2Loader: Please update Basis Universal transcoder.")});break;case"transcode":t.then(()=>{try{const{faces:t,buffers:i,width:o,height:h,hasAlpha:d,format:u,type:p,dfdFlags:g}=function(t){const i=new s.KTX2File(new Uint8Array(t));function a(){i.close(),i.delete()}if(!i.isValid())throw a(),new Error("THREE.KTX2Loader:\tInvalid or unsupported .ktx2 file");let o;if(i.isUASTC())o=r.UASTC;else if(i.isETC1S())o=r.ETC1S;else{if(!i.isHDR())throw new Error("THREE.KTX2Loader: Unknown Basis encoding");o=r.UASTC_HDR}const h=i.getWidth(),d=i.getHeight(),u=i.getLayers()||1,p=i.getLevels(),g=i.getFaces(),m=i.getHasAlpha(),f=i.getDFDFlags(),{transcoderFormat:b,engineFormat:x,engineType:y}=function(t,s,i,n){const a=l[t];for(let r=0;r<a.length;r++){const o=a[r];if(o.if&&!e[o.if])continue;if(!o.basisFormat.includes(t))continue;if(n&&o.transcoderFormat.length<2)continue;if(o.needsPowerOfTwo&&(!c(s)||!c(i)))continue;return{transcoderFormat:o.transcoderFormat[n?1:0],engineFormat:o.engineFormat[n?1:0],engineType:o.engineType[0]}}throw new Error("THREE.KTX2Loader: Failed to identify transcoding target.")}(o,h,d,m);if(!h||!d||!p)throw a(),new Error("THREE.KTX2Loader:\tInvalid texture");if(!i.startTranscoding())throw a(),new Error("THREE.KTX2Loader: .startTranscoding failed");const v=[],w=[];for(let e=0;e<g;e++){const t=[];for(let s=0;s<p;s++){const r=[];let o,l;for(let t=0;t<u;t++){const c=i.getImageLevelInfo(s,t,e);0!==e||0!==s||0!==t||c.origWidth%4==0&&c.origHeight%4==0||console.warn("THREE.KTX2Loader: ETC1S and UASTC textures should use multiple-of-four dimensions."),p>1?(o=c.origWidth,l=c.origHeight):(o=c.width,l=c.height);let A=new Uint8Array(i.getImageTranscodedSizeInBytes(s,t,0,b));const h=i.transcodeImage(A,s,t,e,b,0,-1,-1);if(y===n.HalfFloatType&&(A=new Uint16Array(A.buffer,A.byteOffset,A.byteLength/Uint16Array.BYTES_PER_ELEMENT)),!h)throw a(),new Error("THREE.KTX2Loader: .transcodeImage failed.");r.push(A)}const c=A(r);t.push({data:c,width:o,height:l}),w.push(c.buffer)}v.push({mipmaps:t,width:h,height:d,format:x,type:y})}return a(),{faces:v,buffers:w,width:h,height:d,hasAlpha:m,dfdFlags:f,format:x,type:y}}(a.buffer);self.postMessage({type:"transcode",id:a.id,data:{faces:t,width:o,height:h,hasAlpha:d,format:u,type:p,dfdFlags:g}},i)}catch(t){console.error(t),self.postMessage({type:"error",id:a.id,error:t.message})}})}var o});const o=[{if:"astcSupported",basisFormat:[r.UASTC],transcoderFormat:[a.ASTC_4x4,a.ASTC_4x4],engineFormat:[i.RGBA_ASTC_4x4_Format,i.RGBA_ASTC_4x4_Format],engineType:[n.UnsignedByteType],priorityETC1S:1/0,priorityUASTC:1,needsPowerOfTwo:!1},{if:"bptcSupported",basisFormat:[r.ETC1S,r.UASTC],transcoderFormat:[a.BC7_M5,a.BC7_M5],engineFormat:[i.RGBA_BPTC_Format,i.RGBA_BPTC_Format],engineType:[n.UnsignedByteType],priorityETC1S:3,priorityUASTC:2,needsPowerOfTwo:!1},{if:"dxtSupported",basisFormat:[r.ETC1S,r.UASTC],transcoderFormat:[a.BC1,a.BC3],engineFormat:[i.RGBA_S3TC_DXT1_Format,i.RGBA_S3TC_DXT5_Format],engineType:[n.UnsignedByteType],priorityETC1S:4,priorityUASTC:5,needsPowerOfTwo:!1},{if:"etc2Supported",basisFormat:[r.ETC1S,r.UASTC],transcoderFormat:[a.ETC1,a.ETC2],engineFormat:[i.RGB_ETC2_Format,i.RGBA_ETC2_EAC_Format],engineType:[n.UnsignedByteType],priorityETC1S:1,priorityUASTC:3,needsPowerOfTwo:!1},{if:"etc1Supported",basisFormat:[r.ETC1S,r.UASTC],transcoderFormat:[a.ETC1],engineFormat:[i.RGB_ETC1_Format],engineType:[n.UnsignedByteType],priorityETC1S:2,priorityUASTC:4,needsPowerOfTwo:!1},{if:"pvrtcSupported",basisFormat:[r.ETC1S,r.UASTC],transcoderFormat:[a.PVRTC1_4_RGB,a.PVRTC1_4_RGBA],engineFormat:[i.RGB_PVRTC_4BPPV1_Format,i.RGBA_PVRTC_4BPPV1_Format],engineType:[n.UnsignedByteType],priorityETC1S:5,priorityUASTC:6,needsPowerOfTwo:!0},{if:"bptcSupported",basisFormat:[r.UASTC_HDR],transcoderFormat:[a.BC6H],engineFormat:[i.RGB_BPTC_UNSIGNED_Format],engineType:[n.HalfFloatType],priorityHDR:1,needsPowerOfTwo:!1},{basisFormat:[r.ETC1S,r.UASTC],transcoderFormat:[a.RGBA32,a.RGBA32],engineFormat:[i.RGBAFormat,i.RGBAFormat],engineType:[n.UnsignedByteType,n.UnsignedByteType],priorityETC1S:100,priorityUASTC:100,needsPowerOfTwo:!1},{basisFormat:[r.UASTC_HDR],transcoderFormat:[a.RGBA_HALF],engineFormat:[i.RGBAFormat],engineType:[n.HalfFloatType],priorityHDR:100,needsPowerOfTwo:!1}],l={[r.ETC1S]:o.filter(e=>e.basisFormat.includes(r.ETC1S)).sort((e,t)=>e.priorityETC1S-t.priorityETC1S),[r.UASTC]:o.filter(e=>e.basisFormat.includes(r.UASTC)).sort((e,t)=>e.priorityUASTC-t.priorityUASTC),[r.UASTC_HDR]:o.filter(e=>e.basisFormat.includes(r.UASTC_HDR)).sort((e,t)=>e.priorityHDR-t.priorityHDR)};function c(e){return e<=2||!(e&e-1)&&0!==e}function A(e){if(1===e.length)return e[0];let t=0;for(let n=0;n<e.length;n++){t+=e[n].byteLength}const s=new Uint8Array(t);let i=0;for(let n=0;n<e.length;n++){const t=e[n];s.set(t,i),i+=t.byteLength}return s}};const kc=new Set([Jt,zt,Kt,Vt]),Tc={[Ul]:Jt,[Pl]:Kt,[Ll]:Vt,[jl]:Jt,[Fl]:Kt,[Nl]:Vt,[Dl]:Jt,[Rl]:Jt,[Ml]:Kt,[Tl]:Kt,[kl]:Vt,[_l]:Vt,[Gl]:zt,[Ol]:zt,[sc]:qt,[tc]:Ht,[ic]:Gt,[nc]:Ot,[ac]:Ut,[rc]:Pt,[gc]:Lt,[lc]:Lt,[oc]:Lt,[mc]:jt,[Ac]:jt,[cc]:jt,[Vl]:Ft,[zl]:Ft,[ql]:Nt,[Hl]:Nt,[Jl]:Dt,[Kl]:Dt,[Wl]:Rt,[Yl]:Mt,[Xl]:Tt,[$l]:kt,[ec]:_t,[Zl]:_t,[pc]:St,[dc]:St,[uc]:Qt,[hc]:Qt},Mc={[Ul]:Zt,[Pl]:Zt,[Ll]:Zt,[jl]:Wt,[Fl]:Wt,[Nl]:Wt,[Dl]:Yt,[Rl]:Yt,[Ml]:Yt,[Tl]:Yt,[kl]:Yt,[_l]:Yt,[Gl]:Xt,[Ol]:$t,[sc]:Yt,[tc]:Yt,[ic]:Yt,[ic]:Yt,[ac]:Yt,[ac]:Yt,[gc]:Wt,[lc]:Yt,[oc]:Yt,[mc]:Wt,[Ac]:Yt,[cc]:Yt,[Vl]:Yt,[zl]:Yt,[ql]:Yt,[Hl]:Yt,[Jl]:Yt,[Kl]:Yt,[Wl]:Yt,[Yl]:Yt,[Xl]:Yt,[$l]:Yt,[ec]:Yt,[Zl]:Yt,[pc]:Yt,[dc]:Yt,[uc]:Yt,[hc]:Yt};function Rc(e){const t=e.dataFormatDescriptor[0];return 1===t.colorPrimaries?2===t.transferFunction?ue:pe:10===t.colorPrimaries?2===t.transferFunction?"display-p3":"display-p3-linear":(0===t.colorPrimaries||console.warn(`THREE.KTX2Loader: Unsupported color primaries, "${t.colorPrimaries}"`),Bt)}var Dc,Nc;const Fc=Symbol("retainerCount"),jc=Symbol("recentlyUsed"),Lc=Symbol("evict"),Pc=Symbol("evictionThreshold"),Uc=Symbol("cache");class Oc{constructor(e,t=5){this[Dc]=new Map,this[Nc]=[],this[Uc]=e,this[Pc]=t}set evictionThreshold(e){this[Pc]=e,this[Lc]()}get evictionThreshold(){return this[Pc]}get cache(){return this[Uc]}retainerCount(e){return this[Fc].get(e)||0}reset(){this[Fc].clear(),this[jc]=[]}retain(e){this[Fc].has(e)||this[Fc].set(e,0),this[Fc].set(e,this[Fc].get(e)+1);const t=this[jc].indexOf(e);-1!==t&&this[jc].splice(t,1),this[jc].unshift(e),this[Lc]()}release(e){this[Fc].has(e)&&this[Fc].set(e,Math.max(this[Fc].get(e)-1,0)),this[Lc]()}[(Dc=Fc,Nc=jc,Lc)](){if(!(this[jc].length<this[Pc]))for(let e=this[jc].length-1;e>=this[Pc];--e){const t=this[jc][e];0===this[Fc].get(t)&&(this[Uc].delete(t),this[jc].splice(e,1))}}}const Gc=e=>{const t=new Map;for(const s of e.mappings)for(const e of s.variants)t.set(e,{material:null,gltfMaterialIndex:s.material});return t};class Hc{constructor(e){this.parser=e,this.name="KHR_materials_variants"}afterRoot(e){const t=this.parser,s=t.json;if(void 0===s.extensions||void 0===s.extensions[this.name])return null;const i=(e=>{const t=[],s=new Set;for(const i of e){let e=i,n=0;for(;s.has(e);)e=i+"."+ ++n;s.add(e),t.push(e)}return t})((s.extensions[this.name].variants||[]).map(e=>e.name));for(const n of e.scenes)n.traverse(e=>{const i=e;if(!i.material)return;const n=t.associations.get(i);if(null==n||null==n.meshes||null==n.primitives)return;const a=s.meshes[n.meshes].primitives[n.primitives].extensions;a&&a[this.name]&&(i.userData.variantMaterials=Gc(a[this.name]))});return e.userData.variants=i,Promise.resolve()}}var qc,zc;gt.DEFAULT_ANISOTROPY=4;const Vc=new Map,Kc=new Map;let Jc;const Yc=new class extends he{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,s,i){const n=new de(this.manager);n.setPath(this.path),n.setResponseType("arraybuffer"),n.setRequestHeader(this.requestHeader),n.setWithCredentials(this.withCredentials),n.load(e,e=>{this.parse(e,t,i)},s,i)}parse(e,t,s=()=>{}){this.decodeDracoFile(e,t,null,null,ue,s).catch(s)}decodeDracoFile(e,t,s,i,n=pe,a=()=>{}){const r={attributeIDs:s||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!s,vertexColorSpace:n};return this.decodeGeometry(e,r).then(t).catch(a)}decodeGeometry(e,t){const s=JSON.stringify(t);if(Qo.has(e)){const t=Qo.get(e);if(t.key===s)return t.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let i;const n=this.workerNextTaskID++,a=e.byteLength,r=this._getWorker(n,a).then(s=>(i=s,new Promise((s,a)=>{i._callbacks[n]={resolve:s,reject:a},i.postMessage({type:"decode",id:n,taskConfig:t,buffer:e},[e])}))).then(e=>this._createGeometry(e.geometry));return r.catch(()=>!0).then(()=>{i&&n&&this._releaseTask(i,n)}),Qo.set(e,{key:s,promise:r}),r}_createGeometry(e){const t=new ge;e.index&&t.setIndex(new me(e.index.array,1));for(let s=0;s<e.attributes.length;s++){const{name:i,array:n,itemSize:a,stride:r,vertexColorSpace:o}=e.attributes[s];let l;if(a===r)l=new me(n,a);else{const e=new fe(n,r);l=new ye(e,a,0)}"color"===i&&(this._assignVertexColorSpace(l,o),l.normalized=n instanceof Float32Array==!1),t.setAttribute(i,l)}return t}_assignVertexColorSpace(e,t){if(t!==ue)return;const s=new be;for(let i=0,n=e.count;i<n;i++)s.fromBufferAttribute(e,i),xe.colorSpaceToWorking(s,ue),e.setXYZ(i,s.r,s.g,s.b)}_loadLibrary(e,t){const s=new de(this.manager);return s.setPath(this.decoderPath),s.setResponseType(t),s.setWithCredentials(this.withCredentials),new Promise((t,i)=>{s.load(e,t,void 0,i)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(t=>{const s=t[0];e||(this.decoderConfig.wasmBinary=t[1]);const i=So.toString(),n=["/* draco decoder */",s,"","/* worker */",i.substring(i.indexOf("{")+1,i.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([n]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const e=new Worker(this.workerSourceURL);e._callbacks={},e._taskCosts={},e._taskLoad=0,e.postMessage({type:"init",decoderConfig:this.decoderConfig}),e.onmessage=function(t){const s=t.data;switch(s.type){case"decode":e._callbacks[s.id].resolve(s);break;case"error":e._callbacks[s.id].reject(s);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+s.type+'"')}},this.workerPool.push(e)}else this.workerPool.sort(function(e,t){return e._taskLoad>t._taskLoad?-1:1});const s=this.workerPool[this.workerPool.length-1];return s._taskCosts[e]=t,s._taskLoad+=t,s})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,""!==this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),this}};let Wc;const $c=new _c;let Xc,Zc;const eA=Symbol("loader"),tA=Symbol("evictionPolicy"),sA=Symbol("GLTFInstance");class iA extends rs{static setDRACODecoderLocation(e){Jc=e,Yc.setDecoderPath(e)}static getDRACODecoderLocation(){return Jc}static setKTX2TranscoderLocation(e){Wc=e,$c.setTranscoderPath(e)}static getKTX2TranscoderLocation(){return Wc}static setMeshoptDecoderLocation(e){var t;Xc!==e&&(Xc=e,Zc=(t=e,new Promise((e,s)=>{const i=document.createElement("script");document.body.appendChild(i),i.onload=e,i.onerror=s,i.async=!0,i.src=t})).then(()=>Bo.ready).then(()=>Bo))}static getMeshoptDecoderLocation(){return Xc}static initializeKTX2Loader(e){$c.detectSupport(e)}static get cache(){return Vc}static clearCache(){Vc.forEach((e,t)=>{this.delete(t)}),this[tA].reset()}static has(e){return Vc.has(e)}static async delete(e){if(!this.has(e))return;const t=Vc.get(e);Kc.delete(e),Vc.delete(e);(await t).dispose()}static hasFinishedLoading(e){return!!Kc.get(e)}constructor(e){super(),this[zc]=(new ko).register(e=>new Hc(e)),this[sA]=e,this[eA].setDRACOLoader(Yc),this[eA].setKTX2Loader($c)}get[(qc=tA,zc=eA,tA)](){return this.constructor[tA]}async preload(e,t,s=()=>{}){if(this[eA].setWithCredentials(t.withCredentials),this.dispatchEvent({type:"preload",element:t,src:e}),!Vc.has(e)){null!=Zc&&this[eA].setMeshoptDecoder(await Zc);const t=((e,t,s=()=>{})=>{const i=e=>{const t=e.loaded/e.total;s(Math.max(0,Math.min(1,isFinite(t)?t:1)))};return new Promise((s,n)=>{t.load(e,s,i,n)})})(e,this[eA],e=>{s(.8*e)}),i=this[sA],n=t.then(e=>i.prepare(e)).then(e=>(s(.9),new i(e))).catch(e=>(console.error(e),new i));Vc.set(e,n)}await Vc.get(e),Kc.set(e,!0),s&&s(1)}async load(e,t,s=()=>{}){await this.preload(e,t,s);const i=await Vc.get(e),n=await i.clone();return this[tA].retain(e),n.dispose=()=>{this[tA].release(e)},n}}iA[qc]=new Oc(iA);class nA extends Ne{constructor(e=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new Be(.5,.5),this.addEventListener("removed",function(){this.traverse(function(e){e.element&&e.element instanceof e.element.ownerDocument.defaultView.Element&&null!==e.element.parentNode&&e.element.remove()})})}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this.center=e.center,this}}const aA=new Te,rA=new ke,oA=new ke,lA=new Te,cA=new Te;class AA{constructor(e={}){const t=this;let s,i,n,a;const r={objects:new WeakMap},o=void 0!==e.element?e.element:document.createElement("div");function l(e){e.isCSS2DObject&&(e.element.style.display="none");for(let t=0,s=e.children.length;t<s;t++)l(e.children[t])}function c(e,s,i){if(!1!==e.visible){if(e.isCSS2DObject){aA.setFromMatrixPosition(e.matrixWorld),aA.applyMatrix4(oA);const l=aA.z>=-1&&aA.z<=1&&!0===e.layers.test(i.layers),c=e.element;c.style.display=!0===l?"":"none",!0===l&&(e.onBeforeRender(t,s,i),c.style.transform="translate("+-100*e.center.x+"%,"+-100*e.center.y+"%)translate("+(aA.x*n+n)+"px,"+(-aA.y*a+a)+"px)",c.parentNode!==o&&o.appendChild(c),e.onAfterRender(t,s,i));const h={distanceToCameraSquared:A(i,e)};r.objects.set(e,h)}for(let t=0,n=e.children.length;t<n;t++)c(e.children[t],s,i)}else l(e)}function A(e,t){return lA.setFromMatrixPosition(e.matrixWorld),cA.setFromMatrixPosition(t.matrixWorld),lA.distanceToSquared(cA)}o.style.overflow="hidden",this.domElement=o,this.sortObjects=!0,this.getSize=function(){return{width:s,height:i}},this.render=function(e,t){!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),rA.copy(t.matrixWorldInverse),oA.multiplyMatrices(t.projectionMatrix,rA),c(e,e,t),this.sortObjects&&function(e){const t=function(e){const t=[];return e.traverseVisible(function(e){e.isCSS2DObject&&t.push(e)}),t}(e).sort(function(e,t){if(e.renderOrder!==t.renderOrder)return t.renderOrder-e.renderOrder;return r.objects.get(e).distanceToCameraSquared-r.objects.get(t).distanceToCameraSquared}),s=t.length;for(let i=0,n=t.length;i<n;i++)t[i].element.style.zIndex=s-i}(e)},this.setSize=function(e,t){s=e,i=t,n=s/2,a=i/2,o.style.width=e+"px",o.style.height=t+"px"}}}function hA(e,t,s){let i=s;const n=new Te;return e.updateWorldMatrix(!0,!0),e.traverseVisible(e=>{const{geometry:s}=e;if(void 0!==s){const{position:a}=s.attributes;if(void 0!==a)for(let s=0,r=a.count;s<r;s++)e.isMesh?e.getVertexPosition(s,n):n.fromBufferAttribute(a,s),e.isSkinnedMesh||n.applyMatrix4(e.matrixWorld),i=t(i,n)}}),i}const dA={POSITION:["byte","byte normalized","unsigned byte","unsigned byte normalized","short","short normalized","unsigned short","unsigned short normalized"],NORMAL:["byte normalized","short normalized"],TANGENT:["byte normalized","short normalized"],TEXCOORD:["byte","byte normalized","unsigned byte","short","short normalized","unsigned short"]};class uA{constructor(){this.textureUtils=null,this.pluginCallbacks=[],this.register(function(e){return new VA(e)}),this.register(function(e){return new KA(e)}),this.register(function(e){return new $A(e)}),this.register(function(e){return new XA(e)}),this.register(function(e){return new ZA(e)}),this.register(function(e){return new eh(e)}),this.register(function(e){return new JA(e)}),this.register(function(e){return new YA(e)}),this.register(function(e){return new WA(e)}),this.register(function(e){return new th(e)}),this.register(function(e){return new sh(e)}),this.register(function(e){return new ih(e)}),this.register(function(e){return new nh(e)}),this.register(function(e){return new ah(e)})}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}setTextureUtils(e){return this.textureUtils=e,this}parse(e,t,s,i){const n=new zA,a=[];for(let r=0,o=this.pluginCallbacks.length;r<o;r++)a.push(this.pluginCallbacks[r](n));n.setPlugins(a),n.setTextureUtils(this.textureUtils),n.writeAsync(e,t,i).catch(s)}parseAsync(e,t){const s=this;return new Promise(function(i,n){s.parse(e,i,n,t)})}}const pA=0,gA=1,mA=2,fA=3,bA=4,xA=5120,yA=5121,vA=5122,wA=5123,IA=5124,CA=5125,EA=5126,BA=34962,QA=34963,SA=9728,_A=9729,kA=9984,TA=9985,MA=9986,RA=9987,DA=33071,NA=33648,FA=10497,jA="KHR_mesh_quantization",LA={};LA[He]=SA,LA[Oe]=kA,LA[Pe]=MA,LA[Ge]=_A,LA[Ue]=TA,LA[Le]=RA,LA[Ve]=DA,LA[qe]=FA,LA[ze]=NA;const PA={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},UA=new be;function OA(e,t){return e.length===t.length&&e.every(function(e,s){return e===t[s]})}function GA(e){return 4*Math.ceil(e/4)}function HA(e,t=0){const s=GA(e.byteLength);if(s!==e.byteLength){const i=new Uint8Array(s);if(i.set(new Uint8Array(e)),0!==t)for(let n=e.byteLength;n<s;n++)i[n]=t;return i.buffer}return e}function qA(){return"undefined"==typeof document&&"undefined"!=typeof OffscreenCanvas?new OffscreenCanvas(1,1):document.createElement("canvas")}class zA{constructor(){this.plugins=[],this.options={},this.pending=[],this.buffers=[],this.byteOffset=0,this.buffers=[],this.nodeMap=new Map,this.skins=[],this.extensionsUsed={},this.extensionsRequired={},this.uids=new Map,this.uid=0,this.json={asset:{version:"2.0",generator:"THREE.GLTFExporter r"+os}},this.cache={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map},this.textureUtils=null}setPlugins(e){this.plugins=e}setTextureUtils(e){this.textureUtils=e}async writeAsync(e,t,s={}){this.options=Object.assign({binary:!1,trs:!1,onlyVisible:!0,maxTextureSize:1/0,animations:[],includeCustomExtensions:!1},s),this.options.animations.length>0&&(this.options.trs=!0),await this.processInputAsync(e),await Promise.all(this.pending);const i=this,n=i.buffers,a=i.json;s=i.options;const r=i.extensionsUsed,o=i.extensionsRequired,l=new Blob(n,{type:"application/octet-stream"}),c=Object.keys(r),A=Object.keys(o);if(c.length>0&&(a.extensionsUsed=c),A.length>0&&(a.extensionsRequired=A),a.buffers&&a.buffers.length>0&&(a.buffers[0].byteLength=l.size),!0===s.binary){const e=new FileReader;e.readAsArrayBuffer(l),e.onloadend=function(){const s=HA(e.result),i=new DataView(new ArrayBuffer(8));i.setUint32(0,s.byteLength,!0),i.setUint32(4,5130562,!0);const n=HA((r=JSON.stringify(a),(new TextEncoder).encode(r).buffer),32);var r;const o=new DataView(new ArrayBuffer(8));o.setUint32(0,n.byteLength,!0),o.setUint32(4,1313821514,!0);const l=new ArrayBuffer(12),c=new DataView(l);c.setUint32(0,1179937895,!0),c.setUint32(4,2,!0);const A=12+o.byteLength+n.byteLength+i.byteLength+s.byteLength;c.setUint32(8,A,!0);const h=new Blob([l,o,n,i,s],{type:"application/octet-stream"}),d=new FileReader;d.readAsArrayBuffer(h),d.onloadend=function(){t(d.result)}}}else if(a.buffers&&a.buffers.length>0){const e=new FileReader;e.readAsDataURL(l),e.onloadend=function(){const s=e.result;a.buffers[0].uri=s,t(a)}}else t(a)}serializeUserData(e,t){if(0===Object.keys(e.userData).length)return;const s=this.options,i=this.extensionsUsed;try{const n=JSON.parse(JSON.stringify(e.userData));if(s.includeCustomExtensions&&n.gltfExtensions){void 0===t.extensions&&(t.extensions={});for(const e in n.gltfExtensions)t.extensions[e]=n.gltfExtensions[e],i[e]=!0;delete n.gltfExtensions}Object.keys(n).length>0&&(t.extras=n)}catch(n){console.warn("THREE.GLTFExporter: userData of '"+e.name+"' won't be serialized because of JSON.stringify error - "+n.message)}}getUID(e,t=!1){if(!1===this.uids.has(e)){const t=new Map;t.set(!0,this.uid++),t.set(!1,this.uid++),this.uids.set(e,t)}return this.uids.get(e).get(t)}isNormalizedNormalAttribute(e){if(this.cache.attributesNormalized.has(e))return!1;const t=new Te;for(let s=0,i=e.count;s<i;s++)if(Math.abs(t.fromBufferAttribute(e,s).length()-1)>5e-4)return!1;return!0}createNormalizedNormalAttribute(e){const t=this.cache;if(t.attributesNormalized.has(e))return t.attributesNormalized.get(e);const s=e.clone(),i=new Te;for(let n=0,a=s.count;n<a;n++)i.fromBufferAttribute(s,n),0===i.x&&0===i.y&&0===i.z?i.setX(1):i.normalize(),s.setXYZ(n,i.x,i.y,i.z);return t.attributesNormalized.set(e,s),s}applyTextureTransform(e,t){let s=!1;const i={};0===t.offset.x&&0===t.offset.y||(i.offset=t.offset.toArray(),s=!0),0!==t.rotation&&(i.rotation=t.rotation,s=!0),1===t.repeat.x&&1===t.repeat.y||(i.scale=t.repeat.toArray(),s=!0),s&&(e.extensions=e.extensions||{},e.extensions.KHR_texture_transform=i,this.extensionsUsed.KHR_texture_transform=!0)}async buildMetalRoughTextureAsync(e,t){if(e===t)return e;function s(e){return e.colorSpace===ue?function(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}:function(e){return e}}e instanceof Et&&(e=await this.decompressTextureAsync(e)),t instanceof Et&&(t=await this.decompressTextureAsync(t));const i=e?e.image:null,n=t?t.image:null,a=Math.max(i?i.width:0,n?n.width:0),r=Math.max(i?i.height:0,n?n.height:0),o=qA();o.width=a,o.height=r;const l=o.getContext("2d",{willReadFrequently:!0});l.fillStyle="#00ffff",l.fillRect(0,0,a,r);const c=l.getImageData(0,0,a,r);if(i){l.drawImage(i,0,0,a,r);const t=s(e),n=l.getImageData(0,0,a,r).data;for(let e=2;e<n.length;e+=4)c.data[e]=256*t(n[e]/256)}if(n){l.drawImage(n,0,0,a,r);const e=s(t),i=l.getImageData(0,0,a,r).data;for(let t=1;t<i.length;t+=4)c.data[t]=256*e(i[t]/256)}l.putImageData(c,0,0);const A=(e||t).clone();return A.source=new ls(o),A.colorSpace=Bt,A.channel=(e||t).channel,e&&t&&e.channel!==t.channel&&console.warn("THREE.GLTFExporter: UV channels for metalnessMap and roughnessMap textures must match."),console.warn("THREE.GLTFExporter: Merged metalnessMap and roughnessMap textures."),A}async decompressTextureAsync(e,t=1/0){if(null===this.textureUtils)throw new Error("THREE.GLTFExporter: setTextureUtils() must be called to process compressed textures.");return await this.textureUtils.decompress(e,t)}processBuffer(e){const t=this.json,s=this.buffers;return t.buffers||(t.buffers=[{byteLength:0}]),s.push(e),0}processBufferView(e,t,s,i,n){const a=this.json;let r;switch(a.bufferViews||(a.bufferViews=[]),t){case xA:case yA:r=1;break;case vA:case wA:r=2;break;default:r=4}let o=e.itemSize*r;n===BA&&(o=4*Math.ceil(o/4));const l=GA(i*o),c=new DataView(new ArrayBuffer(l));let A=0;for(let d=s;d<s+i;d++){for(let s=0;s<e.itemSize;s++){let i;e.itemSize>4?i=e.array[d*e.itemSize+s]:(0===s?i=e.getX(d):1===s?i=e.getY(d):2===s?i=e.getZ(d):3===s&&(i=e.getW(d)),!0===e.normalized&&(i=lt.normalize(i,e.array))),t===EA?c.setFloat32(A,i,!0):t===IA?c.setInt32(A,i,!0):t===CA?c.setUint32(A,i,!0):t===vA?c.setInt16(A,i,!0):t===wA?c.setUint16(A,i,!0):t===xA?c.setInt8(A,i):t===yA&&c.setUint8(A,i),A+=r}A%o!==0&&(A+=o-A%o)}const h={buffer:this.processBuffer(c.buffer),byteOffset:this.byteOffset,byteLength:l};void 0!==n&&(h.target=n),n===BA&&(h.byteStride=o),this.byteOffset+=l,a.bufferViews.push(h);return{id:a.bufferViews.length-1,byteLength:0}}processBufferViewImage(e){const t=this,s=t.json;return s.bufferViews||(s.bufferViews=[]),new Promise(function(i){const n=new FileReader;n.readAsArrayBuffer(e),n.onloadend=function(){const e=HA(n.result),a={buffer:t.processBuffer(e),byteOffset:t.byteOffset,byteLength:e.byteLength};t.byteOffset+=e.byteLength,i(s.bufferViews.push(a)-1)}})}processAccessor(e,t,s,i){const n=this.json;let a;if(e.array.constructor===Float32Array)a=EA;else if(e.array.constructor===Int32Array)a=IA;else if(e.array.constructor===Uint32Array)a=CA;else if(e.array.constructor===Int16Array)a=vA;else if(e.array.constructor===Uint16Array)a=wA;else if(e.array.constructor===Int8Array)a=xA;else{if(e.array.constructor!==Uint8Array)throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type: "+e.array.constructor.name);a=yA}if(void 0===s&&(s=0),void 0!==i&&i!==1/0||(i=e.count),0===i)return null;const r=function(e,t,s){const i={min:new Array(e.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(e.itemSize).fill(Number.NEGATIVE_INFINITY)};for(let n=t;n<t+s;n++)for(let t=0;t<e.itemSize;t++){let s;e.itemSize>4?s=e.array[n*e.itemSize+t]:(0===t?s=e.getX(n):1===t?s=e.getY(n):2===t?s=e.getZ(n):3===t&&(s=e.getW(n)),!0===e.normalized&&(s=lt.normalize(s,e.array))),i.min[t]=Math.min(i.min[t],s),i.max[t]=Math.max(i.max[t],s)}return i}(e,s,i);let o;void 0!==t&&(o=e===t.index?QA:BA);const l=this.processBufferView(e,a,s,i,o),c={bufferView:l.id,byteOffset:l.byteOffset,componentType:a,count:i,max:r.max,min:r.min,type:{1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",9:"MAT3",16:"MAT4"}[e.itemSize]};return!0===e.normalized&&(c.normalized=!0),n.accessors||(n.accessors=[]),n.accessors.push(c)-1}processImage(e,t,s,i="image/png"){if(null!==e){const n=this,a=n.cache,r=n.json,o=n.options,l=n.pending;a.images.has(e)||a.images.set(e,{});const c=a.images.get(e),A=i+":flipY/"+s.toString();if(void 0!==c[A])return c[A];r.images||(r.images=[]);const h={mimeType:i},d=qA();d.width=Math.min(e.width,o.maxTextureSize),d.height=Math.min(e.height,o.maxTextureSize);const u=d.getContext("2d",{willReadFrequently:!0});if(!0===s&&(u.translate(0,d.height),u.scale(1,-1)),void 0!==e.data){t!==Jt&&console.error("GLTFExporter: Only RGBAFormat is supported.",t),(e.width>o.maxTextureSize||e.height>o.maxTextureSize)&&console.warn("GLTFExporter: Image size is bigger than maxTextureSize",e);const s=new Uint8ClampedArray(e.height*e.width*4);for(let t=0;t<s.length;t+=4)s[t+0]=e.data[t+0],s[t+1]=e.data[t+1],s[t+2]=e.data[t+2],s[t+3]=e.data[t+3];u.putImageData(new ImageData(s,e.width,e.height),0,0)}else{if(!("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas))throw new Error("THREE.GLTFExporter: Invalid image type. Use HTMLImageElement, HTMLCanvasElement, ImageBitmap or OffscreenCanvas.");u.drawImage(e,0,0,d.width,d.height)}!0===o.binary?l.push(function(e,t){if("undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas){let s;return"image/jpeg"===t?s=.92:"image/webp"===t&&(s=.8),e.convertToBlob({type:t,quality:s})}return new Promise(s=>e.toBlob(s,t))}(d,i).then(e=>n.processBufferViewImage(e)).then(e=>{h.bufferView=e})):h.uri=cs.getDataURL(d,i);const p=r.images.push(h)-1;return c[A]=p,p}throw new Error("THREE.GLTFExporter: No valid image data found. Unable to process texture.")}processSampler(e){const t=this.json;t.samplers||(t.samplers=[]);const s={magFilter:LA[e.magFilter],minFilter:LA[e.minFilter],wrapS:LA[e.wrapS],wrapT:LA[e.wrapT]};return t.samplers.push(s)-1}async processTextureAsync(e){const t=this.options,s=this.cache,i=this.json;if(s.textures.has(e))return s.textures.get(e);i.textures||(i.textures=[]),e instanceof Et&&(e=await this.decompressTextureAsync(e,t.maxTextureSize));let n=e.userData.mimeType;"image/webp"===n&&(n="image/png");const a={sampler:this.processSampler(e),source:this.processImage(e.image,e.format,e.flipY,n)};e.name&&(a.name=e.name),await this._invokeAllAsync(async function(t){t.writeTexture&&await t.writeTexture(e,a)});const r=i.textures.push(a)-1;return s.textures.set(e,r),r}async processMaterialAsync(e){const t=this.cache,s=this.json;if(t.materials.has(e))return t.materials.get(e);if(e.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;s.materials||(s.materials=[]);const i={pbrMetallicRoughness:{}};!0!==e.isMeshStandardMaterial&&!0!==e.isMeshBasicMaterial&&console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");const n=e.color.toArray().concat([e.opacity]);if(OA(n,[1,1,1,1])||(i.pbrMetallicRoughness.baseColorFactor=n),e.isMeshStandardMaterial?(i.pbrMetallicRoughness.metallicFactor=e.metalness,i.pbrMetallicRoughness.roughnessFactor=e.roughness):(i.pbrMetallicRoughness.metallicFactor=0,i.pbrMetallicRoughness.roughnessFactor=1),e.metalnessMap||e.roughnessMap){const t=await this.buildMetalRoughTextureAsync(e.metalnessMap,e.roughnessMap),s={index:await this.processTextureAsync(t),texCoord:t.channel};this.applyTextureTransform(s,t),i.pbrMetallicRoughness.metallicRoughnessTexture=s}if(e.map){const t={index:await this.processTextureAsync(e.map),texCoord:e.map.channel};this.applyTextureTransform(t,e.map),i.pbrMetallicRoughness.baseColorTexture=t}if(e.emissive){const t=e.emissive;if(Math.max(t.r,t.g,t.b)>0&&(i.emissiveFactor=e.emissive.toArray()),e.emissiveMap){const t={index:await this.processTextureAsync(e.emissiveMap),texCoord:e.emissiveMap.channel};this.applyTextureTransform(t,e.emissiveMap),i.emissiveTexture=t}}if(e.normalMap){const t={index:await this.processTextureAsync(e.normalMap),texCoord:e.normalMap.channel};e.normalScale&&1!==e.normalScale.x&&(t.scale=e.normalScale.x),this.applyTextureTransform(t,e.normalMap),i.normalTexture=t}if(e.aoMap){const t={index:await this.processTextureAsync(e.aoMap),texCoord:e.aoMap.channel};1!==e.aoMapIntensity&&(t.strength=e.aoMapIntensity),this.applyTextureTransform(t,e.aoMap),i.occlusionTexture=t}e.transparent?i.alphaMode="BLEND":e.alphaTest>0&&(i.alphaMode="MASK",i.alphaCutoff=e.alphaTest),e.side===$e&&(i.doubleSided=!0),""!==e.name&&(i.name=e.name),this.serializeUserData(e,i),await this._invokeAllAsync(async function(t){t.writeMaterialAsync&&await t.writeMaterialAsync(e,i)});const a=s.materials.push(i)-1;return t.materials.set(e,a),a}async processMeshAsync(e){const t=this.cache,s=this.json,i=[e.geometry.uuid];if(Array.isArray(e.material))for(let x=0,y=e.material.length;x<y;x++)i.push(e.material[x].uuid);else i.push(e.material.uuid);const n=i.join(":");if(t.meshes.has(n))return t.meshes.get(n);const a=e.geometry;let r;r=e.isLineSegments?gA:e.isLineLoop?mA:e.isLine?fA:e.isPoints?pA:e.material.wireframe?gA:bA;const o={},l={},c=[],A=[],h={uv:"TEXCOORD_0",uv1:"TEXCOORD_1",uv2:"TEXCOORD_2",uv3:"TEXCOORD_3",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},d=a.getAttribute("normal");void 0===d||this.isNormalizedNormalAttribute(d)||(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),a.setAttribute("normal",this.createNormalizedNormalAttribute(d)));let u=null;for(let x in a.attributes){if("morph"===x.slice(0,5))continue;const e=a.attributes[x];x=h[x]||x.toUpperCase();if(/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(x)||(x="_"+x),t.attributes.has(this.getUID(e))){l[x]=t.attributes.get(this.getUID(e));continue}u=null;const s=e.array;"JOINTS_0"!==x||s instanceof Uint16Array||s instanceof Uint8Array?(s instanceof Uint32Array||s instanceof Int32Array)&&!x.startsWith("_")&&(console.warn(`GLTFExporter: Attribute "${x}" converted to type FLOAT.`),u=uA.Utils.toFloat32BufferAttribute(e)):(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),u=new me(new Uint16Array(s),e.itemSize,e.normalized));const i=this.processAccessor(u||e,a);null!==i&&(x.startsWith("_")||this.detectMeshQuantization(x,e),l[x]=i,t.attributes.set(this.getUID(e),i))}if(void 0!==d&&a.setAttribute("normal",d),0===Object.keys(l).length)return null;if(void 0!==e.morphTargetInfluences&&e.morphTargetInfluences.length>0){const s=[],i=[],n={};if(void 0!==e.morphTargetDictionary)for(const t in e.morphTargetDictionary)n[e.morphTargetDictionary[t]]=t;for(let r=0;r<e.morphTargetInfluences.length;++r){const o={};let l=!1;for(const e in a.morphAttributes){if("position"!==e&&"normal"!==e){l||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),l=!0);continue}const s=a.morphAttributes[e][r],i=e.toUpperCase(),n=a.attributes[e];if(t.attributes.has(this.getUID(s,!0))){o[i]=t.attributes.get(this.getUID(s,!0));continue}const c=s.clone();if(!a.morphTargetsRelative)for(let e=0,t=s.count;e<t;e++)for(let i=0;i<s.itemSize;i++)0===i&&c.setX(e,s.getX(e)-n.getX(e)),1===i&&c.setY(e,s.getY(e)-n.getY(e)),2===i&&c.setZ(e,s.getZ(e)-n.getZ(e)),3===i&&c.setW(e,s.getW(e)-n.getW(e));o[i]=this.processAccessor(c,a),t.attributes.set(this.getUID(n,!0),o[i])}A.push(o),s.push(e.morphTargetInfluences[r]),void 0!==e.morphTargetDictionary&&i.push(n[r])}o.weights=s,i.length>0&&(o.extras={},o.extras.targetNames=i)}const p=Array.isArray(e.material);if(p&&0===a.groups.length)return null;let g=!1;if(p&&null===a.index){const e=[];for(let t=0,s=a.attributes.position.count;t<s;t++)e[t]=t;a.setIndex(e),g=!0}const m=p?e.material:[e.material],f=p?a.groups:[{materialIndex:0,start:void 0,count:void 0}];for(let x=0,y=f.length;x<y;x++){const e={mode:r,attributes:l};if(this.serializeUserData(a,e),A.length>0&&(e.targets=A),null!==a.index){let s=this.getUID(a.index);void 0===f[x].start&&void 0===f[x].count||(s+=":"+f[x].start+":"+f[x].count),t.attributes.has(s)?e.indices=t.attributes.get(s):(e.indices=this.processAccessor(a.index,a,f[x].start,f[x].count),t.attributes.set(s,e.indices)),null===e.indices&&delete e.indices}const s=await this.processMaterialAsync(m[f[x].materialIndex]);null!==s&&(e.material=s),c.push(e)}!0===g&&a.setIndex(null),o.primitives=c,s.meshes||(s.meshes=[]),await this._invokeAllAsync(function(t){t.writeMesh&&t.writeMesh(e,o)});const b=s.meshes.push(o)-1;return t.meshes.set(n,b),b}detectMeshQuantization(e,t){if(this.extensionsUsed[jA])return;let s;switch(t.array.constructor){case Int8Array:s="byte";break;case Uint8Array:s="unsigned byte";break;case Int16Array:s="short";break;case Uint16Array:s="unsigned short";break;default:return}t.normalized&&(s+=" normalized");const i=e.split("_",1)[0];dA[i]&&dA[i].includes(s)&&(this.extensionsUsed[jA]=!0,this.extensionsRequired[jA]=!0)}processCamera(e){const t=this.json;t.cameras||(t.cameras=[]);const s=e.isOrthographicCamera,i={type:s?"orthographic":"perspective"};return s?i.orthographic={xmag:2*e.right,ymag:2*e.top,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near}:i.perspective={aspectRatio:e.aspect,yfov:lt.degToRad(e.fov),zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near},""!==e.name&&(i.name=e.type),t.cameras.push(i)-1}processAnimation(e,t){const s=this.json,i=this.nodeMap;s.animations||(s.animations=[]);const n=(e=uA.Utils.mergeMorphTargetTracks(e.clone(),t)).tracks,a=[],r=[];for(let l=0;l<n.length;++l){const e=n[l],s=Ze.parseTrackName(e.name);let o=Ze.findNode(t,s.nodeName);const c=PA[s.propertyName];if("bones"===s.objectName&&(o=!0===o.isSkinnedMesh?o.skeleton.getBoneByName(s.objectIndex):void 0),!o||!c){console.warn('THREE.GLTFExporter: Could not export animation track "%s".',e.name);continue}const A=1;let h,d=e.values.length/e.times.length;c===PA.morphTargetInfluences&&(d/=o.morphTargetInfluences.length),!0===e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline?(h="CUBICSPLINE",d/=3):h=e.getInterpolation()===ut?"STEP":"LINEAR",r.push({input:this.processAccessor(new me(e.times,A)),output:this.processAccessor(new me(e.values,d)),interpolation:h}),a.push({sampler:r.length-1,target:{node:i.get(o),path:c}})}const o={name:e.name||"clip_"+s.animations.length,samplers:r,channels:a};return this.serializeUserData(e,o),s.animations.push(o),s.animations.length-1}processSkin(e){const t=this.json,s=this.nodeMap,i=t.nodes[s.get(e)],n=e.skeleton;if(void 0===n)return null;const a=e.skeleton.bones[0];if(void 0===a)return null;const r=[],o=new Float32Array(16*n.bones.length),l=new ke;for(let c=0;c<n.bones.length;++c)r.push(s.get(n.bones[c])),l.copy(n.boneInverses[c]),l.multiply(e.bindMatrix).toArray(o,16*c);void 0===t.skins&&(t.skins=[]),t.skins.push({inverseBindMatrices:this.processAccessor(new me(o,16)),joints:r,skeleton:s.get(a)});return i.skin=t.skins.length-1}async processNodeAsync(e){const t=this.json,s=this.options,i=this.nodeMap;t.nodes||(t.nodes=[]);const n={};if(s.trs){const t=e.quaternion.toArray(),s=e.position.toArray(),i=e.scale.toArray();OA(t,[0,0,0,1])||(n.rotation=t),OA(s,[0,0,0])||(n.translation=s),OA(i,[1,1,1])||(n.scale=i)}else e.matrixAutoUpdate&&e.updateMatrix(),!1===OA(e.matrix.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])&&(n.matrix=e.matrix.elements);if(""!==e.name&&(n.name=String(e.name)),this.serializeUserData(e,n),e.isMesh||e.isLine||e.isPoints){const t=await this.processMeshAsync(e);null!==t&&(n.mesh=t)}else e.isCamera&&(n.camera=this.processCamera(e));e.isSkinnedMesh&&this.skins.push(e);const a=t.nodes.push(n)-1;if(i.set(e,a),e.children.length>0){const t=[];for(let i=0,n=e.children.length;i<n;i++){const n=e.children[i];if(n.visible||!1===s.onlyVisible){const e=await this.processNodeAsync(n);null!==e&&t.push(e)}}t.length>0&&(n.children=t)}return await this._invokeAllAsync(function(t){t.writeNode&&t.writeNode(e,n)}),a}async processSceneAsync(e){const t=this.json,s=this.options;t.scenes||(t.scenes=[],t.scene=0);const i={};""!==e.name&&(i.name=e.name),t.scenes.push(i);const n=[];for(let a=0,r=e.children.length;a<r;a++){const t=e.children[a];if(t.visible||!1===s.onlyVisible){const e=await this.processNodeAsync(t);null!==e&&n.push(e)}}n.length>0&&(i.nodes=n),this.serializeUserData(e,i)}async processObjectsAsync(e){const t=new As;t.name="AuxScene";for(let s=0;s<e.length;s++)t.children.push(e[s]);await this.processSceneAsync(t)}async processInputAsync(e){const t=this.options;e=e instanceof Array?e:[e],await this._invokeAllAsync(function(t){t.beforeParse&&t.beforeParse(e)});const s=[];for(let i=0;i<e.length;i++)e[i]instanceof As?await this.processSceneAsync(e[i]):s.push(e[i]);s.length>0&&await this.processObjectsAsync(s);for(let i=0;i<this.skins.length;++i)this.processSkin(this.skins[i]);for(let i=0;i<t.animations.length;++i)this.processAnimation(t.animations[i],e[0]);await this._invokeAllAsync(function(t){t.afterParse&&t.afterParse(e)})}async _invokeAllAsync(e){for(let t=0,s=this.plugins.length;t<s;t++)await e(this.plugins[t])}}class VA{constructor(e){this.writer=e,this.name="KHR_lights_punctual"}writeNode(e,t){if(!e.isLight)return;if(!e.isDirectionalLight&&!e.isPointLight&&!e.isSpotLight)return void console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",e);const s=this.writer,i=s.json,n=s.extensionsUsed,a={};e.name&&(a.name=e.name),a.color=e.color.toArray(),a.intensity=e.intensity,e.isDirectionalLight?a.type="directional":e.isPointLight?(a.type="point",e.distance>0&&(a.range=e.distance)):e.isSpotLight&&(a.type="spot",e.distance>0&&(a.range=e.distance),a.spot={},a.spot.innerConeAngle=(1-e.penumbra)*e.angle,a.spot.outerConeAngle=e.angle),void 0!==e.decay&&2!==e.decay&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),!e.target||e.target.parent===e&&0===e.target.position.x&&0===e.target.position.y&&-1===e.target.position.z||console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1."),n[this.name]||(i.extensions=i.extensions||{},i.extensions[this.name]={lights:[]},n[this.name]=!0);const r=i.extensions[this.name].lights;r.push(a),t.extensions=t.extensions||{},t.extensions[this.name]={light:r.length-1}}}class KA{constructor(e){this.writer=e,this.name="KHR_materials_unlit"}async writeMaterialAsync(e,t){if(!e.isMeshBasicMaterial)return;const s=this.writer.extensionsUsed;t.extensions=t.extensions||{},t.extensions[this.name]={},s[this.name]=!0,t.pbrMetallicRoughness.metallicFactor=0,t.pbrMetallicRoughness.roughnessFactor=.9}}class JA{constructor(e){this.writer=e,this.name="KHR_materials_clearcoat"}async writeMaterialAsync(e,t){if(!e.isMeshPhysicalMaterial||0===e.clearcoat)return;const s=this.writer,i=s.extensionsUsed,n={};if(n.clearcoatFactor=e.clearcoat,e.clearcoatMap){const t={index:await s.processTextureAsync(e.clearcoatMap),texCoord:e.clearcoatMap.channel};s.applyTextureTransform(t,e.clearcoatMap),n.clearcoatTexture=t}if(n.clearcoatRoughnessFactor=e.clearcoatRoughness,e.clearcoatRoughnessMap){const t={index:await s.processTextureAsync(e.clearcoatRoughnessMap),texCoord:e.clearcoatRoughnessMap.channel};s.applyTextureTransform(t,e.clearcoatRoughnessMap),n.clearcoatRoughnessTexture=t}if(e.clearcoatNormalMap){const t={index:await s.processTextureAsync(e.clearcoatNormalMap),texCoord:e.clearcoatNormalMap.channel};1!==e.clearcoatNormalScale.x&&(t.scale=e.clearcoatNormalScale.x),s.applyTextureTransform(t,e.clearcoatNormalMap),n.clearcoatNormalTexture=t}t.extensions=t.extensions||{},t.extensions[this.name]=n,i[this.name]=!0}}class YA{constructor(e){this.writer=e,this.name="KHR_materials_dispersion"}async writeMaterialAsync(e,t){if(!e.isMeshPhysicalMaterial||0===e.dispersion)return;const s=this.writer.extensionsUsed,i={};i.dispersion=e.dispersion,t.extensions=t.extensions||{},t.extensions[this.name]=i,s[this.name]=!0}}class WA{constructor(e){this.writer=e,this.name="KHR_materials_iridescence"}async writeMaterialAsync(e,t){if(!e.isMeshPhysicalMaterial||0===e.iridescence)return;const s=this.writer,i=s.extensionsUsed,n={};if(n.iridescenceFactor=e.iridescence,e.iridescenceMap){const t={index:await s.processTextureAsync(e.iridescenceMap),texCoord:e.iridescenceMap.channel};s.applyTextureTransform(t,e.iridescenceMap),n.iridescenceTexture=t}if(n.iridescenceIor=e.iridescenceIOR,n.iridescenceThicknessMinimum=e.iridescenceThicknessRange[0],n.iridescenceThicknessMaximum=e.iridescenceThicknessRange[1],e.iridescenceThicknessMap){const t={index:await s.processTextureAsync(e.iridescenceThicknessMap),texCoord:e.iridescenceThicknessMap.channel};s.applyTextureTransform(t,e.iridescenceThicknessMap),n.iridescenceThicknessTexture=t}t.extensions=t.extensions||{},t.extensions[this.name]=n,i[this.name]=!0}}class $A{constructor(e){this.writer=e,this.name="KHR_materials_transmission"}async writeMaterialAsync(e,t){if(!e.isMeshPhysicalMaterial||0===e.transmission)return;const s=this.writer,i=s.extensionsUsed,n={};if(n.transmissionFactor=e.transmission,e.transmissionMap){const t={index:await s.processTextureAsync(e.transmissionMap),texCoord:e.transmissionMap.channel};s.applyTextureTransform(t,e.transmissionMap),n.transmissionTexture=t}t.extensions=t.extensions||{},t.extensions[this.name]=n,i[this.name]=!0}}class XA{constructor(e){this.writer=e,this.name="KHR_materials_volume"}async writeMaterialAsync(e,t){if(!e.isMeshPhysicalMaterial||0===e.transmission)return;const s=this.writer,i=s.extensionsUsed,n={};if(n.thicknessFactor=e.thickness,e.thicknessMap){const t={index:await s.processTextureAsync(e.thicknessMap),texCoord:e.thicknessMap.channel};s.applyTextureTransform(t,e.thicknessMap),n.thicknessTexture=t}e.attenuationDistance!==1/0&&(n.attenuationDistance=e.attenuationDistance),n.attenuationColor=e.attenuationColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=n,i[this.name]=!0}}class ZA{constructor(e){this.writer=e,this.name="KHR_materials_ior"}async writeMaterialAsync(e,t){if(!e.isMeshPhysicalMaterial||1.5===e.ior)return;const s=this.writer.extensionsUsed,i={};i.ior=e.ior,t.extensions=t.extensions||{},t.extensions[this.name]=i,s[this.name]=!0}}class eh{constructor(e){this.writer=e,this.name="KHR_materials_specular"}async writeMaterialAsync(e,t){if(!e.isMeshPhysicalMaterial||1===e.specularIntensity&&e.specularColor.equals(UA)&&!e.specularIntensityMap&&!e.specularColorMap)return;const s=this.writer,i=s.extensionsUsed,n={};if(e.specularIntensityMap){const t={index:await s.processTextureAsync(e.specularIntensityMap),texCoord:e.specularIntensityMap.channel};s.applyTextureTransform(t,e.specularIntensityMap),n.specularTexture=t}if(e.specularColorMap){const t={index:await s.processTextureAsync(e.specularColorMap),texCoord:e.specularColorMap.channel};s.applyTextureTransform(t,e.specularColorMap),n.specularColorTexture=t}n.specularFactor=e.specularIntensity,n.specularColorFactor=e.specularColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=n,i[this.name]=!0}}class th{constructor(e){this.writer=e,this.name="KHR_materials_sheen"}async writeMaterialAsync(e,t){if(!e.isMeshPhysicalMaterial||0==e.sheen)return;const s=this.writer,i=s.extensionsUsed,n={};if(e.sheenRoughnessMap){const t={index:await s.processTextureAsync(e.sheenRoughnessMap),texCoord:e.sheenRoughnessMap.channel};s.applyTextureTransform(t,e.sheenRoughnessMap),n.sheenRoughnessTexture=t}if(e.sheenColorMap){const t={index:await s.processTextureAsync(e.sheenColorMap),texCoord:e.sheenColorMap.channel};s.applyTextureTransform(t,e.sheenColorMap),n.sheenColorTexture=t}n.sheenRoughnessFactor=e.sheenRoughness,n.sheenColorFactor=e.sheenColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=n,i[this.name]=!0}}class sh{constructor(e){this.writer=e,this.name="KHR_materials_anisotropy"}async writeMaterialAsync(e,t){if(!e.isMeshPhysicalMaterial||0==e.anisotropy)return;const s=this.writer,i=s.extensionsUsed,n={};if(e.anisotropyMap){const t={index:await s.processTextureAsync(e.anisotropyMap)};s.applyTextureTransform(t,e.anisotropyMap),n.anisotropyTexture=t}n.anisotropyStrength=e.anisotropy,n.anisotropyRotation=e.anisotropyRotation,t.extensions=t.extensions||{},t.extensions[this.name]=n,i[this.name]=!0}}class ih{constructor(e){this.writer=e,this.name="KHR_materials_emissive_strength"}async writeMaterialAsync(e,t){if(!e.isMeshStandardMaterial||1===e.emissiveIntensity)return;const s=this.writer.extensionsUsed,i={};i.emissiveStrength=e.emissiveIntensity,t.extensions=t.extensions||{},t.extensions[this.name]=i,s[this.name]=!0}}class nh{constructor(e){this.writer=e,this.name="EXT_materials_bump"}async writeMaterialAsync(e,t){if(!e.isMeshStandardMaterial||1===e.bumpScale&&!e.bumpMap)return;const s=this.writer,i=s.extensionsUsed,n={};if(e.bumpMap){const t={index:await s.processTextureAsync(e.bumpMap),texCoord:e.bumpMap.channel};s.applyTextureTransform(t,e.bumpMap),n.bumpTexture=t}n.bumpFactor=e.bumpScale,t.extensions=t.extensions||{},t.extensions[this.name]=n,i[this.name]=!0}}class ah{constructor(e){this.writer=e,this.name="EXT_mesh_gpu_instancing"}writeNode(e,t){if(!e.isInstancedMesh)return;const s=this.writer,i=e,n=new Float32Array(3*i.count),a=new Float32Array(4*i.count),r=new Float32Array(3*i.count),o=new ke,l=new Te,c=new Re,A=new Te;for(let d=0;d<i.count;d++)i.getMatrixAt(d,o),o.decompose(l,c,A),l.toArray(n,3*d),c.toArray(a,4*d),A.toArray(r,3*d);const h={TRANSLATION:s.processAccessor(new me(n,3)),ROTATION:s.processAccessor(new me(a,4)),SCALE:s.processAccessor(new me(r,3))};i.instanceColor&&(h._COLOR_0=s.processAccessor(i.instanceColor)),t.extensions=t.extensions||{},t.extensions[this.name]={attributes:h},s.extensionsUsed[this.name]=!0,s.extensionsRequired[this.name]=!0}}uA.Utils={insertKeyframe:function(e,t){const s=.001,i=e.getValueSize(),n=new e.TimeBufferType(e.times.length+1),a=new e.ValueBufferType(e.values.length+i),r=e.createInterpolant(new e.ValueBufferType(i));let o;if(0===e.times.length){n[0]=t;for(let e=0;e<i;e++)a[e]=0;o=0}else if(t<e.times[0]){if(Math.abs(e.times[0]-t)<s)return 0;n[0]=t,n.set(e.times,1),a.set(r.evaluate(t),0),a.set(e.values,i),o=0}else if(t>e.times[e.times.length-1]){if(Math.abs(e.times[e.times.length-1]-t)<s)return e.times.length-1;n[n.length-1]=t,n.set(e.times,0),a.set(e.values,0),a.set(r.evaluate(t),e.values.length),o=n.length-1}else for(let l=0;l<e.times.length;l++){if(Math.abs(e.times[l]-t)<s)return l;if(e.times[l]<t&&e.times[l+1]>t){n.set(e.times.slice(0,l+1),0),n[l+1]=t,n.set(e.times.slice(l+1),l+2),a.set(e.values.slice(0,(l+1)*i),0),a.set(r.evaluate(t),(l+1)*i),a.set(e.values.slice((l+1)*i),(l+2)*i),o=l+1;break}}return e.times=n,e.values=a,o},mergeMorphTargetTracks:function(e,t){const s=[],i={},n=e.tracks;for(let a=0;a<n.length;++a){let e=n[a];const r=Ze.parseTrackName(e.name),o=Ze.findNode(t,r.nodeName);if("morphTargetInfluences"!==r.propertyName||void 0===r.propertyIndex){s.push(e);continue}if(e.createInterpolant!==e.InterpolantFactoryMethodDiscrete&&e.createInterpolant!==e.InterpolantFactoryMethodLinear){if(e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),e=e.clone(),e.setInterpolation(pt)}const l=o.morphTargetInfluences.length,c=o.morphTargetDictionary[r.propertyIndex];if(void 0===c)throw new Error("THREE.GLTFExporter: Morph target name not found: "+r.propertyIndex);let A;if(void 0===i[o.uuid]){A=e.clone();const t=new A.ValueBufferType(l*A.times.length);for(let e=0;e<A.times.length;e++)t[e*l+c]=A.values[e];A.name=(r.nodeName||"")+".morphTargetInfluences",A.values=t,i[o.uuid]=A,s.push(A);continue}const h=e.createInterpolant(new e.ValueBufferType(1));A=i[o.uuid];for(let t=0;t<A.times.length;t++)A.values[t*l+c]=h.evaluate(A.times[t]);for(let t=0;t<e.times.length;t++){const s=this.insertKeyframe(A,e.times[t]);A.values[s*l+c]=e.values[t]}}return e.tracks=s,e},toFloat32BufferAttribute:function(e){const t=new me(new Float32Array(e.count*e.itemSize),e.itemSize,!1);if(!e.normalized&&!e.isInterleavedBufferAttribute)return t.array.set(e.array),t;for(let s=0,i=e.count;s<i;s++)for(let n=0;n<e.itemSize;n++)t.setComponent(s,n,e.getComponent(s,n));return t}};const rh=e=>void 0!==e.material&&e.userData&&e.userData.variantMaterials&&!!Array.from(e.userData.variantMaterials.values()).filter(e=>oh(e.material)),oh=e=>e&&e.isMaterial&&!Array.isArray(e);class lh{constructor(e){this.writer=e,this.name="KHR_materials_variants",this.variantNames=[]}beforeParse(e){const t=new Set,s=e=>{if(!rh(e))return;const s=e.userData.variantMaterials,i=e.userData.variantData;for(const[n,a]of i){const e=s.get(a.index);e&&oh(e.material)&&t.add(n)}};if(Array.isArray(e))for(const i of e)i.traverse(s);else e.traverse(s);t.forEach(e=>this.variantNames.push(e))}async writeMesh(e,t){if(!rh(e))return;const s=e.userData,i=s.variantMaterials,n=s.variantData,a=new Map,r=new Map,o=Array.from(n.values()).sort((e,t)=>e.index-t.index);for(const[A,h]of o.entries())r.set(h.index,A);for(const A of n.values()){const e=i.get(A.index);if(!e||!oh(e.material))continue;const t=await this.writer.processMaterialAsync(e.material);a.has(t)||a.set(t,{material:t,variants:[]}),a.get(t).variants.push(r.get(A.index))}const l=Array.from(a.values()).map(e=>e.variants.sort((e,t)=>e-t)&&e).sort((e,t)=>e.material-t.material);if(0===l.length)return;const c=oh(s.originalMaterial)?await this.writer.processMaterialAsync(s.originalMaterial):-1;for(const A of t.primitives)c>=0&&(A.material=c),A.extensions=A.extensions||{},A.extensions[this.name]={mappings:l}}afterParse(){if(0===this.variantNames.length)return;const e=this.writer.json;e.extensions=e.extensions||{};const t=this.variantNames.map(e=>({name:e}));e.extensions[this.name]={variants:t},this.writer.extensionsUsed[this.name]=!0}}class ch{constructor(e,t,s,i,n){this.xrLight=e,this.renderer=t,this.lightProbe=s,this.xrWebGLBinding=null,this.estimationStartCallback=n,this.frameCallback=this.onXRFrame.bind(this);const a=t.xr.getSession();if(i&&"XRWebGLBinding"in window){const s=new ds(16);e.environment=s.texture;const i=t.getContext();switch(a.preferredReflectionFormat){case"srgba8":i.getExtension("EXT_sRGB");break;case"rgba16f":i.getExtension("OES_texture_half_float")}this.xrWebGLBinding=new XRWebGLBinding(a,i),this.lightProbe.addEventListener("reflectionchange",()=>{this.updateReflection()})}a.requestAnimationFrame(this.frameCallback)}updateReflection(){const e=this.renderer.properties.get(this.xrLight.environment);if(e){const t=this.xrWebGLBinding.getReflectionCubeMap(this.lightProbe);t&&(e.__webglTexture=t,this.xrLight.environment.needsPMREMUpdate=!0)}}onXRFrame(e,t){if(!this.xrLight)return;t.session.requestAnimationFrame(this.frameCallback);const s=t.getLightEstimate(this.lightProbe);if(s){this.xrLight.lightProbe.sh.fromArray(s.sphericalHarmonicsCoefficients),this.xrLight.lightProbe.intensity=1;const e=Math.max(1,Math.max(s.primaryLightIntensity.x,Math.max(s.primaryLightIntensity.y,s.primaryLightIntensity.z)));this.xrLight.directionalLight.color.setRGB(s.primaryLightIntensity.x/e,s.primaryLightIntensity.y/e,s.primaryLightIntensity.z/e),this.xrLight.directionalLight.intensity=e,this.xrLight.directionalLight.position.copy(s.primaryLightDirection),this.estimationStartCallback&&(this.estimationStartCallback(),this.estimationStartCallback=null)}}dispose(){this.xrLight=null,this.renderer=null,this.lightProbe=null,this.xrWebGLBinding=null}}class Ah extends rt{constructor(e,t=!0){super(),this.lightProbe=new hs,this.lightProbe.intensity=0,this.add(this.lightProbe),this.directionalLight=new _e,this.directionalLight.intensity=0,this.add(this.directionalLight),this.environment=null;let s=null,i=!1;e.xr.addEventListener("sessionstart",()=>{const n=e.xr.getSession();"requestLightProbe"in n&&n.requestLightProbe({reflectionFormat:n.preferredReflectionFormat}).then(n=>{s=new ch(this,e,n,t,()=>{i=!0,this.dispatchEvent({type:"estimationstart"})})})}),e.xr.addEventListener("sessionend",()=>{s&&(s.dispose(),s=null),i&&this.dispatchEvent({type:"estimationend"})}),this.dispose=()=>{s&&(s.dispose(),s=null),this.remove(this.lightProbe),this.lightProbe=null,this.remove(this.directionalLight),this.directionalLight=null,this.environment=null}}}class hh{constructor(e=50){this.velocity=0,this.naturalFrequency=0,this.setDecayTime(e)}setDecayTime(e){this.naturalFrequency=1/Math.max(.001,e)}update(e,t,s,i){const n=2e-4*this.naturalFrequency;if(null==e||0===i)return t;if(e===t&&0===this.velocity)return t;if(s<0)return e;const a=e-t,r=this.velocity+this.naturalFrequency*a,o=a+s*r,l=Math.exp(-this.naturalFrequency*s),c=(r-this.naturalFrequency*o)*l,A=-this.naturalFrequency*(c+r*l);return Math.abs(c)<n*Math.abs(i)&&A*a>=0?(this.velocity=0,t):(this.velocity=c,t+o*l)}}const dh=.2,uh=Math.PI/24,ph=new Be,gh=(e,t,s)=>{let i=t>0?s>0?0:-Math.PI/2:s>0?Math.PI/2:Math.PI;for(let n=0;n<=12;++n)e.push(t+.17*Math.cos(i),s+.17*Math.sin(i),0,t+dh*Math.cos(i),s+dh*Math.sin(i),0),i+=uh};class mh extends tt{constructor(e,t){const s=new ge,i=[],n=[],{size:a,boundingBox:r}=e,o=a.x/2,l=("back"===t?a.y:a.z)/2;gh(n,o,l),gh(n,-o,l),gh(n,-o,-l),gh(n,o,-l);const c=n.length/3;for(let d=0;d<c-2;d+=2)i.push(d,d+1,d+3,d,d+3,d+2);const A=c-2;i.push(A,A+1,1,A,1,0),s.setAttribute("position",new us(n,3)),s.setIndex(i),super(s),this.side=t;const h=this.material;switch(h.side=$e,h.transparent=!0,h.opacity=0,this.goalOpacity=0,this.opacityDamper=new hh,this.hitPlane=new tt(new ps(2*(o+dh),2*(l+dh))),this.hitPlane.visible=!1,this.hitPlane.material.side=$e,this.add(this.hitPlane),this.hitBox=new tt(new gs(a.x+.4,a.y+dh,a.z+.4)),this.hitBox.visible=!1,this.hitBox.material.side=$e,this.add(this.hitBox),r.getCenter(this.position),t){case"bottom":this.rotateX(-Math.PI/2),this.shadowHeight=r.min.y,this.position.y=this.shadowHeight;break;case"back":this.shadowHeight=r.min.z,this.position.z=this.shadowHeight}e.target.add(this),this.hitBox.position.y=(a.y+dh)/2+r.min.y,e.target.add(this.hitBox),this.offsetHeight=0}getHit(e,t,s){ph.set(t,-s),this.hitPlane.visible=!0;const i=e.positionAndNormalFromPoint(ph,this.hitPlane);return this.hitPlane.visible=!1,null==i?null:i.position}getExpandedHit(e,t,s){this.hitPlane.scale.set(1e3,1e3,1e3),this.hitPlane.updateMatrixWorld();const i=this.getHit(e,t,s);return this.hitPlane.scale.set(1,1,1),i}controllerIntersection(e,t){this.hitBox.visible=!0;const s=e.hitFromController(t,this.hitBox);return this.hitBox.visible=!1,s}set offsetHeight(e){e-=.001,"back"===this.side?this.position.z=this.shadowHeight+e:this.position.y=this.shadowHeight+e}get offsetHeight(){return"back"===this.side?this.position.z-this.shadowHeight:this.position.y-this.shadowHeight}set show(e){this.goalOpacity=e?.75:0}updateOpacity(e){const t=this.material;t.opacity=this.opacityDamper.update(t.opacity,this.goalOpacity,e,1),this.visible=t.opacity>0}dispose(){const{geometry:e,material:t}=this.hitPlane;e.dispose(),t.dispose(),this.hitBox.geometry.dispose(),this.hitBox.material.dispose(),this.geometry.dispose(),this.material.dispose(),this.hitBox.removeFromParent(),this.removeFromParent()}}const fh=(e,t)=>({type:"number",number:e,unit:t}),bh=(()=>{const e={};return t=>{const s=t;if(s in e)return e[s];const i=[];let n=0;for(;t;){if(++n>1e3){t="";break}const e=xh(t),s=e.nodes[0];if(null==s||0===s.terms.length)break;i.push(s),t=e.remainingInput}return e[s]=i}})(),xh=(()=>{const e=/^(\-\-|[a-z\u0240-\uffff])/i,t=/^([\*\+\/]|[\-]\s)/i,s=/^[\),]/;return i=>{const n=[];for(;i.length&&(i=i.trim(),!s.test(i));)if("("===i[0]){const{nodes:e,remainingInput:t}=Ih(i);i=t,n.push({type:"function",name:{type:"ident",value:"calc"},arguments:e})}else if(e.test(i)){const e=yh(i),t=e.nodes[0];if("("===(i=e.remainingInput)[0]){const{nodes:e,remainingInput:s}=Ih(i);n.push({type:"function",name:t,arguments:e}),i=s}else n.push(t)}else if(t.test(i))n.push({type:"operator",value:i[0]}),i=i.slice(1);else{const{nodes:e,remainingInput:t}="#"===i[0]?wh(i):vh(i);if(0===e.length)break;n.push(e[0]),i=t}return{nodes:[{type:"expression",terms:n}],remainingInput:i}}})(),yh=(()=>{const e=/[^a-z0-9_\-\u0240-\uffff]/i;return t=>{const s=t.match(e);return{nodes:[{type:"ident",value:null==s?t:t.substr(0,s.index)}],remainingInput:null==s?"":t.substr(s.index)}}})(),vh=(()=>{const e=/[\+\-]?(\d+[\.]\d+|\d+|[\.]\d+)([eE][\+\-]?\d+)?/,t=/^[a-z%]+/i,s=/^(m|mm|cm|rad|deg|[%])$/;return i=>{const n=i.match(e),a=null==n?"0":n[0],r=(i=null==a?i:i.slice(a.length)).match(t);let o=null!=r&&""!==r[0]?r[0]:null;const l=null==r?i:i.slice(o.length);return null==o||s.test(o)||(o=null),{nodes:[{type:"number",number:parseFloat(a)||0,unit:o}],remainingInput:l}}})(),wh=(()=>{const e=/^[a-f0-9]*/i;return t=>{const s=(t=t.slice(1).trim()).match(e);return{nodes:null==s?[]:[{type:"hex",value:s[0]}],remainingInput:null==s?t:t.slice(s[0].length)}}})(),Ih=e=>{const t=[];for(e=e.slice(1).trim();e.length;){const s=xh(e);if(t.push(s.nodes[0]),","===(e=s.remainingInput.trim())[0])e=e.slice(1).trim();else if(")"===e[0]){e=e.slice(1);break}}return{nodes:t,remainingInput:e}},Ch=Symbol("visitedTypes");class Eh{constructor(e){this[Ch]=e}walk(e,t){const s=e.slice();for(;s.length;){const e=s.shift();switch(this[Ch].indexOf(e.type)>-1&&t(e),e.type){case"expression":s.unshift(...e.terms);break;case"function":s.unshift(e.name,...e.arguments)}}}}const Bh=Object.freeze({type:"number",number:0,unit:null}),Qh=(e,t=0)=>{let{number:s,unit:i}=e;if(isFinite(s)){if("rad"===e.unit||null==e.unit)return e}else s=t,i="rad";return{type:"number",number:("deg"===i&&null!=s?s:0)*Math.PI/180,unit:"rad"}},Sh=(e,t=0)=>{let s,{number:i,unit:n}=e;if(isFinite(i)){if("m"===e.unit)return e}else i=t,n="m";switch(n){default:s=1;break;case"cm":s=.01;break;case"mm":s=.001}return{type:"number",number:s*i,unit:"m"}},_h=(()=>{const e=e=>e,t={rad:e,deg:Qh,m:e,mm:Sh,cm:Sh};return(e,s=Bh)=>{isFinite(e.number)||(e.number=s.number,e.unit=s.unit);const{unit:i}=e;if(null==i)return e;const n=t[i];return null==n?s:n(e)}})();var kh,Th,Mh;const Rh=Symbol("evaluate"),Dh=Symbol("lastValue");class Nh{constructor(){this[kh]=null}static evaluatableFor(e,t=Bh){if(e instanceof Nh)return e;if("number"===e.type)return"%"===e.unit?new Lh(e,t):e;switch(e.name.value){case"calc":return new Hh(e,t);case"env":return new Uh(e)}return Bh}static evaluate(e){return e instanceof Nh?e.evaluate():e}static isConstant(e){return!(e instanceof Nh)||e.isConstant}static applyIntrinsics(e,t){const{basis:s,keywords:i}=t,{auto:n}=i;return s.map((t,s)=>{const a=null==n[s]?t:n[s];let r=e[s]?e[s]:a;if("ident"===r.type){const e=r.value;e in i&&(r=i[e][s])}return null!=r&&"ident"!==r.type||(r=a),"%"===r.unit?fh(r.number/100*t.number,t.unit):(r=_h(r,t),r.unit!==t.unit?t:r)})}get isConstant(){return!1}evaluate(){return this.isConstant&&null!=this[Dh]||(this[Dh]=this[Rh]()),this[Dh]}}kh=Dh;const Fh=Symbol("percentage"),jh=Symbol("basis");class Lh extends Nh{constructor(e,t){super(),this[Fh]=e,this[jh]=t}get isConstant(){return!0}[Rh](){return fh(this[Fh].number/100*this[jh].number,this[jh].unit)}}const Ph=Symbol("identNode");class Uh extends Nh{constructor(e){super(),this[Th]=null;const t=e.arguments.length?e.arguments[0].terms[0]:null;null!=t&&"ident"===t.type&&(this[Ph]=t)}get isConstant(){return!1}[(Th=Ph,Rh)](){if(null!=this[Ph]&&"window-scroll-y"===this[Ph].value){return{type:"number",number:window.pageYOffset/(Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)-window.innerHeight)||0,unit:null}}return Bh}}const Oh=/[\*\/]/,Gh=Symbol("evaluator");class Hh extends Nh{constructor(e,t=Bh){if(super(),this[Mh]=null,1!==e.arguments.length)return;const s=e.arguments[0].terms.slice(),i=[];for(;s.length;){const e=s.shift();if(i.length>0){const s=i[i.length-1];if("operator"===s.type&&Oh.test(s.value)){const s=i.pop(),n=i.pop();if(null==n)return;i.push(new Kh(s,Nh.evaluatableFor(n,t),Nh.evaluatableFor(e,t)));continue}}i.push("operator"===e.type?e:Nh.evaluatableFor(e,t))}for(;i.length>2;){const[e,s,n]=i.splice(0,3);if("operator"!==s.type)return;i.unshift(new Kh(s,Nh.evaluatableFor(e,t),Nh.evaluatableFor(n,t)))}1===i.length&&(this[Gh]=i[0])}get isConstant(){return null==this[Gh]||Nh.isConstant(this[Gh])}[(Mh=Gh,Rh)](){return null!=this[Gh]?Nh.evaluate(this[Gh]):Bh}}const qh=Symbol("operator"),zh=Symbol("left"),Vh=Symbol("right");class Kh extends Nh{constructor(e,t,s){super(),this[qh]=e,this[zh]=t,this[Vh]=s}get isConstant(){return Nh.isConstant(this[zh])&&Nh.isConstant(this[Vh])}[Rh](){const e=_h(Nh.evaluate(this[zh])),t=_h(Nh.evaluate(this[Vh])),{number:s,unit:i}=e,{number:n,unit:a}=t;if(null!=a&&null!=i&&a!=i)return Bh;const r=i||a;let o;switch(this[qh].value){case"+":o=s+n;break;case"-":o=s-n;break;case"/":o=s/n;break;case"*":o=s*n;break;default:return Bh}return{type:"number",number:o,unit:r}}}const Jh=Symbol("evaluatables"),Yh=Symbol("intrinsics");class Wh extends Nh{constructor(e,t){super(),this[Yh]=t;const s=e[0],i=null!=s?s.terms:[];this[Jh]=t.basis.map((e,t)=>{const s=i[t];return null==s?{type:"ident",value:"auto"}:"ident"===s.type?s:Nh.evaluatableFor(s,e)})}get isConstant(){for(const e of this[Jh])if(!Nh.isConstant(e))return!1;return!0}[Rh](){const e=this[Jh].map(e=>Nh.evaluate(e));return Nh.applyIntrinsics(e,this[Yh]).map(e=>e.number)}}var $h,Xh,Zh,ed;const td=Symbol("instances"),sd=Symbol("activateListener"),id=Symbol("deactivateListener"),nd=Symbol("notifyInstances"),ad=Symbol("notify"),rd=Symbol("callback");class od{static[nd](){for(const e of od[td])e[ad]()}static[($h=td,sd)](){window.addEventListener("scroll",this[nd],{passive:!0})}static[id](){window.removeEventListener("scroll",this[nd])}constructor(e){this[rd]=e}observe(){0===od[td].size&&od[sd](),od[td].add(this)}disconnect(){od[td].delete(this),0===od[td].size&&od[id]()}[ad](){this[rd]()}}od[$h]=new Set;const ld=Symbol("computeStyleCallback"),cd=Symbol("astWalker"),Ad=Symbol("dependencies"),hd=Symbol("onScroll");class dd{constructor(e){this[Xh]={},this[Zh]=new Eh(["function"]),this[ed]=()=>{this[ld]({relatedState:"window-scroll"})},this[ld]=e}observeEffectsFor(e){const t={},s=this[Ad];this[cd].walk(e,e=>{const{name:i}=e,n=e.arguments[0].terms[0];if("env"===i.value&&null!=n&&"ident"===n.type&&"window-scroll-y"===n.value)if(null==t["window-scroll"]){const e="window-scroll"in s?s["window-scroll"]:new od(this[hd]);e.observe(),delete s["window-scroll"],t["window-scroll"]=e}});for(const i in s){s[i].disconnect()}this[Ad]=t}dispose(){for(const e in this[Ad]){this[Ad][e].disconnect()}}}Xh=Ad,Zh=cd,ed=hd;const ud=e=>{const t=e.observeEffects||!1,s=e.intrinsics instanceof Function?e.intrinsics:()=>e.intrinsics;return(i,n)=>{const a=i.updated,r=i.connectedCallback,o=i.disconnectedCallback,l=Symbol(`${n}StyleEffector`),c=Symbol(`${n}StyleEvaluator`),A=Symbol(`${n}UpdateEvaluator`),h=Symbol(`${n}EvaluateAndSync`);Object.defineProperties(i,{[l]:{value:null,writable:!0},[c]:{value:null,writable:!0},[A]:{value:function(){const e=bh(this[n]);this[c]=new Wh(e,s(this)),null==this[l]&&t&&(this[l]=new dd(()=>this[h]())),null!=this[l]&&this[l].observeEffectsFor(e)}},[h]:{value:function(){if(null==this[c])return;const t=this[c].evaluate();this[e.updateHandler](t)}},updated:{value:function(e){e.has(n)&&(this[A](),this[h]()),a.call(this,e)}},connectedCallback:{value:function(){r.call(this),this.requestUpdate(n,this[n])}},disconnectedCallback:{value:function(){o.call(this),null!=this[l]&&(this[l].dispose(),this[l]=null)}}})}},pd=e=>e<.5?2*e*e:(4-2*e)*e-1,gd=(e,t,s=pd)=>i=>e+(t-e)*s(i),md=e=>{const t=[],s=[];let i=e.initialValue;for(let n=0;n<e.keyframes.length;++n){const a=e.keyframes[n],{value:r,frames:o}=a,l=a.ease||pd,c=gd(i,r,l);t.push(c),s.push(o),i=r}return((e,t)=>{const s=t.map((i=0,e=>i+=e));var i;return t=>{t=bo(t,0,1),t*=s[s.length-1];const i=s.findIndex(e=>e>=t),n=i<1?0:s[i-1],a=s[i];return e[i]((t-n)/(a-n))}})(t,s)};var fd=function(e,t,s,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(r=(a<3?n(r):a>3?n(t,s,r):n(t,s))||r);return a>3&&r&&Object.defineProperty(t,s,r),r};const bd=md({initialValue:0,keyframes:[{frames:5,value:-1},{frames:1,value:-1},{frames:8,value:1},{frames:1,value:1},{frames:5,value:0},{frames:18,value:0}]}),xd=md({initialValue:0,keyframes:[{frames:1,value:1},{frames:5,value:1},{frames:1,value:0},{frames:6,value:0}]}),yd="0deg 75deg 105%",vd=["front","right","back","left"],wd=["upper-","","lower-"],Id="auto",Cd="basic",Ed="wiggle",Bd="none",Qd=()=>({basis:[Qh(fh(30,"deg"))],keywords:{auto:[null]}}),Sd=()=>({basis:[Qh(fh(12,"deg"))],keywords:{auto:[null]}}),_d=(()=>{const e=bh(yd)[0].terms,t=_h(e[0]),s=_h(e[1]);return e=>{const i=e[nf].idealCameraDistance();return{basis:[t,s,fh(i,"m")],keywords:{auto:[null,null,fh(105,"%")]}}}})(),kd=e=>{const t=2.2*e[nf].boundingSphere.radius;return{basis:[fh(-1/0,"rad"),fh(0,"rad"),fh(t,"m")],keywords:{auto:[null,null,null]}}},Td=e=>{const t=_d(e),s=new Wh([],t).evaluate()[2];return{basis:[fh(1/0,"rad"),fh(Math.PI,"rad"),fh(s,"m")],keywords:{auto:[null,null,null]}}},Md=e=>{const t=e[nf].boundingBox.getCenter(new Te);return{basis:[fh(t.x,"m"),fh(t.y,"m"),fh(t.z,"m")],keywords:{auto:[null,null,null]}}},Rd=Math.PI/2,Dd=Math.PI/3,Nd=Rd/2,Fd=2*Math.PI,jd=Symbol("controls"),Ld=Symbol("panElement"),Pd=Symbol("promptElement"),Ud=Symbol("promptAnimatedContainer"),Od=Symbol("fingerAnimatedContainers"),Gd=Symbol("deferInteractionPrompt"),Hd=Symbol("updateAria"),qd=Symbol("a11y"),zd=Symbol("updateA11y"),Vd=Symbol("updateCameraForRadius"),Kd=Symbol("cancelPrompts"),Jd=Symbol("onChange"),Yd=Symbol("onPointerChange"),Wd=Symbol("waitingToPromptUser"),$d=Symbol("userHasInteracted"),Xd=Symbol("promptElementVisibleTime"),Zd=Symbol("lastPromptOffset"),eu=Symbol("cancellationSource"),tu=Symbol("lastSpherical"),su=Symbol("jumpCamera"),iu=Symbol("initialized"),nu=Symbol("maintainThetaPhi"),au=Symbol("syncCameraOrbit"),ru=Symbol("syncFieldOfView"),ou=Symbol("syncCameraTarget"),lu=Symbol("syncMinCameraOrbit"),cu=Symbol("syncMaxCameraOrbit"),Au=Symbol("syncMinFieldOfView"),hu=Symbol("syncMaxFieldOfView"),du=new Be,uu=new Te,pu=Object.freeze({minimumRadius:0,maximumRadius:1/0,minimumPolarAngle:0,maximumPolarAngle:Math.PI,minimumAzimuthalAngle:-1/0,maximumAzimuthalAngle:1/0,minimumFieldOfView:10,maximumFieldOfView:45,touchAction:"none"}),gu=Math.PI/8,mu=.04,fu={USER_INTERACTION:"user-interaction",NONE:"none",AUTOMATIC:"automatic"};class bu extends rs{constructor(e,t,s){super(),this.camera=e,this.element=t,this.scene=s,this.orbitSensitivity=1,this.zoomSensitivity=1,this.panSensitivity=1,this.inputSensitivity=1,this.changeSource=fu.NONE,this._interactionEnabled=!1,this._disableZoom=!1,this.isUserPointing=!1,this.enablePan=!0,this.enableTap=!0,this.panProjection=new fs,this.panPerPixel=0,this.spherical=new ms,this.goalSpherical=new ms,this.thetaDamper=new hh,this.phiDamper=new hh,this.radiusDamper=new hh,this.logFov=Math.log(pu.maximumFieldOfView),this.goalLogFov=this.logFov,this.fovDamper=new hh,this.touchMode=null,this.pointers=[],this.startTime=0,this.startPointerPosition={clientX:0,clientY:0},this.lastSeparation=0,this.touchDecided=!1,this.onContext=e=>{if(this.enablePan)e.preventDefault();else for(const t of this.pointers)this.onPointerUp(new PointerEvent("pointercancel",Object.assign(Object.assign({},this.startPointerPosition),{pointerId:t.id})))},this.touchModeZoom=(e,t)=>{if(!this._disableZoom){const e=this.twoTouchDistance(this.pointers[0],this.pointers[1]),t=mu*this.zoomSensitivity*(this.lastSeparation-e)*50/this.scene.height;this.lastSeparation=e,this.userAdjustOrbit(0,0,t)}this.panPerPixel>0&&this.movePan(e,t)},this.disableScroll=e=>{e.preventDefault()},this.touchModeRotate=(e,t)=>{const{touchAction:s}=this._options;if(!this.touchDecided&&"none"!==s){this.touchDecided=!0;const i=Math.abs(e),n=Math.abs(t);if(this.changeSource===fu.USER_INTERACTION&&("pan-y"===s&&n>i||"pan-x"===s&&i>n))return void(this.touchMode=null);this.element.addEventListener("touchmove",this.disableScroll,{passive:!1})}this.handleSinglePointerMove(e,t)},this.onPointerDown=e=>{if(this.pointers.length>2)return;const{element:t}=this;0===this.pointers.length&&(t.addEventListener("pointermove",this.onPointerMove),t.addEventListener("pointerup",this.onPointerUp),this.touchMode=null,this.touchDecided=!1,this.startPointerPosition.clientX=e.clientX,this.startPointerPosition.clientY=e.clientY,this.startTime=performance.now());try{t.setPointerCapture(e.pointerId)}catch(s){}this.pointers.push({clientX:e.clientX,clientY:e.clientY,id:e.pointerId}),this.isUserPointing=!1,"touch"===e.pointerType?(this.changeSource=e.altKey?fu.AUTOMATIC:fu.USER_INTERACTION,this.onTouchChange(e)):(this.changeSource=fu.USER_INTERACTION,this.onMouseDown(e)),this.changeSource===fu.USER_INTERACTION&&this.dispatchEvent({type:"user-interaction"})},this.onPointerMove=e=>{const t=this.pointers.find(t=>t.id===e.pointerId);if(null==t)return;if("mouse"===e.pointerType&&0===e.buttons)return void this.onPointerUp(e);const s=this.pointers.length,i=(e.clientX-t.clientX)/s,n=(e.clientY-t.clientY)/s;0===i&&0===n||(t.clientX=e.clientX,t.clientY=e.clientY,"touch"===e.pointerType?(this.changeSource=e.altKey?fu.AUTOMATIC:fu.USER_INTERACTION,null!==this.touchMode&&this.touchMode(i,n)):(this.changeSource=fu.USER_INTERACTION,this.panPerPixel>0?this.movePan(i,n):this.handleSinglePointerMove(i,n)))},this.onPointerUp=e=>{const{element:t}=this,s=this.pointers.findIndex(t=>t.id===e.pointerId);-1!==s&&this.pointers.splice(s,1),this.panPerPixel>0&&!e.altKey&&this.resetRadius(),0===this.pointers.length?(t.removeEventListener("pointermove",this.onPointerMove),t.removeEventListener("pointerup",this.onPointerUp),t.removeEventListener("touchmove",this.disableScroll),this.enablePan&&this.enableTap&&this.recenter(e)):null!==this.touchMode&&this.onTouchChange(e),this.scene.element[Ld].style.opacity=0,t.style.cursor="grab",this.panPerPixel=0,this.isUserPointing&&this.dispatchEvent({type:"pointer-change-end"})},this.onWheel=e=>{this.changeSource=fu.USER_INTERACTION;const t=e.deltaY*(1==e.deltaMode?18:1)*mu*this.zoomSensitivity/30;this.userAdjustOrbit(0,0,t),e.preventDefault(),this.dispatchEvent({type:"user-interaction"})},this.onKeyDown=e=>{const{changeSource:t}=this;this.changeSource=fu.USER_INTERACTION;(e.shiftKey&&this.enablePan?this.panKeyCodeHandler(e):this.orbitZoomKeyCodeHandler(e))?(e.preventDefault(),this.dispatchEvent({type:"user-interaction"})):this.changeSource=t},this._options=Object.assign({},pu),this.setOrbit(0,Math.PI/2,1),this.setFieldOfView(100),this.jumpToGoal()}get interactionEnabled(){return this._interactionEnabled}enableInteraction(){if(!1===this._interactionEnabled){const{element:e}=this;e.addEventListener("pointerdown",this.onPointerDown),e.addEventListener("pointercancel",this.onPointerUp),this._disableZoom||e.addEventListener("wheel",this.onWheel),e.addEventListener("keydown",this.onKeyDown),e.addEventListener("touchmove",()=>{},{passive:!1}),e.addEventListener("contextmenu",this.onContext),this.element.style.cursor="grab",this._interactionEnabled=!0,this.updateTouchActionStyle()}}disableInteraction(){if(!0===this._interactionEnabled){const{element:e}=this;e.removeEventListener("pointerdown",this.onPointerDown),e.removeEventListener("pointermove",this.onPointerMove),e.removeEventListener("pointerup",this.onPointerUp),e.removeEventListener("pointercancel",this.onPointerUp),e.removeEventListener("wheel",this.onWheel),e.removeEventListener("keydown",this.onKeyDown),e.removeEventListener("contextmenu",this.onContext),e.style.cursor="",this.touchMode=null,this._interactionEnabled=!1,this.updateTouchActionStyle()}}get options(){return this._options}set disableZoom(e){this._disableZoom!=e&&(this._disableZoom=e,!0===e?this.element.removeEventListener("wheel",this.onWheel):this.element.addEventListener("wheel",this.onWheel),this.updateTouchActionStyle())}getCameraSpherical(e=new ms){return e.copy(this.spherical)}getFieldOfView(){return this.camera.fov}applyOptions(e){Object.assign(this._options,e),this.setOrbit(),this.setFieldOfView(Math.exp(this.goalLogFov))}updateNearFar(e,t){this.camera.far=0===t?2:t,this.camera.near=Math.max(e,this.camera.far/1e3),this.camera.updateProjectionMatrix()}updateAspect(e){this.camera.aspect=e,this.camera.updateProjectionMatrix()}setOrbit(e=this.goalSpherical.theta,t=this.goalSpherical.phi,s=this.goalSpherical.radius){const{minimumAzimuthalAngle:i,maximumAzimuthalAngle:n,minimumPolarAngle:a,maximumPolarAngle:r,minimumRadius:o,maximumRadius:l}=this._options,{theta:c,phi:A,radius:h}=this.goalSpherical,d=bo(e,i,n);isFinite(i)||isFinite(n)||(this.spherical.theta=this.wrapAngle(this.spherical.theta-d)+d);const u=bo(t,a,r),p=bo(s,o,l);return(d!==c||u!==A||p!==h)&&(!!(isFinite(d)&&isFinite(u)&&isFinite(p))&&(this.goalSpherical.theta=d,this.goalSpherical.phi=u,this.goalSpherical.radius=p,this.goalSpherical.makeSafe(),!0))}setRadius(e){this.goalSpherical.radius=e,this.setOrbit()}setFieldOfView(e){const{minimumFieldOfView:t,maximumFieldOfView:s}=this._options;e=bo(e,t,s),this.goalLogFov=Math.log(e)}setDamperDecayTime(e){this.thetaDamper.setDecayTime(e),this.phiDamper.setDecayTime(e),this.radiusDamper.setDecayTime(e),this.fovDamper.setDecayTime(e)}adjustOrbit(e,t,s){const{theta:i,phi:n,radius:a}=this.goalSpherical,{minimumRadius:r,maximumRadius:o,minimumFieldOfView:l,maximumFieldOfView:c}=this._options,A=this.spherical.theta-i,h=Math.PI-.001,d=i-bo(e,-h-A,h-A),u=n-t,p=0===s?0:((s>0?o:r)-a)/(Math.log(s>0?c:l)-this.goalLogFov),g=a+s*(isFinite(p)?p:2*(o-r));if(this.setOrbit(d,u,g),0!==s){const e=this.goalLogFov+s;this.setFieldOfView(Math.exp(e))}}jumpToGoal(){this.update(0,1e4)}update(e,t){if(this.isStationary())return!1;const{maximumPolarAngle:s,maximumRadius:i}=this._options,n=this.spherical.theta-this.goalSpherical.theta;return Math.abs(n)>Math.PI&&!isFinite(this._options.minimumAzimuthalAngle)&&!isFinite(this._options.maximumAzimuthalAngle)&&(this.spherical.theta-=2*Math.sign(n)*Math.PI),this.spherical.theta=this.thetaDamper.update(this.spherical.theta,this.goalSpherical.theta,t,Math.PI),this.spherical.phi=this.phiDamper.update(this.spherical.phi,this.goalSpherical.phi,t,s),this.spherical.radius=this.radiusDamper.update(this.spherical.radius,this.goalSpherical.radius,t,i),this.logFov=this.fovDamper.update(this.logFov,this.goalLogFov,t,1),this.moveCamera(),!0}updateTouchActionStyle(){const{style:e}=this.element;if(this._interactionEnabled){const{touchAction:t}=this._options;this._disableZoom&&"none"!==t?e.touchAction="manipulation":e.touchAction=t}else e.touchAction=""}isStationary(){return this.goalSpherical.theta===this.spherical.theta&&this.goalSpherical.phi===this.spherical.phi&&this.goalSpherical.radius===this.spherical.radius&&this.goalLogFov===this.logFov}moveCamera(){this.spherical.makeSafe(),this.camera.position.setFromSpherical(this.spherical),this.camera.setRotationFromEuler(new bs(this.spherical.phi-Math.PI/2,this.spherical.theta,0,"YXZ")),this.camera.fov!==Math.exp(this.logFov)&&(this.camera.fov=Math.exp(this.logFov),this.camera.updateProjectionMatrix())}userAdjustOrbit(e,t,s){this.adjustOrbit(e*this.orbitSensitivity*this.inputSensitivity,t*this.orbitSensitivity*this.inputSensitivity,s*this.inputSensitivity)}wrapAngle(e){const t=(e+Math.PI)/(2*Math.PI);return 2*(t-Math.floor(t))*Math.PI-Math.PI}pixelLengthToSphericalAngle(e){return 2*Math.PI*e/this.scene.height}twoTouchDistance(e,t){const{clientX:s,clientY:i}=e,{clientX:n,clientY:a}=t,r=n-s,o=a-i;return Math.sqrt(r*r+o*o)}handleSinglePointerMove(e,t){const s=this.pixelLengthToSphericalAngle(e),i=this.pixelLengthToSphericalAngle(t);!1===this.isUserPointing&&(this.isUserPointing=!0,this.dispatchEvent({type:"pointer-change-start"})),this.userAdjustOrbit(s,i,0)}initializePan(){const{theta:e,phi:t}=this.spherical,s=e-this.scene.yaw;this.panPerPixel=.018*this.panSensitivity/this.scene.height,this.panProjection.set(-Math.cos(s),-Math.cos(t)*Math.sin(s),0,0,Math.sin(t),0,Math.sin(s),-Math.cos(t)*Math.cos(s),0)}movePan(e,t){const{scene:s}=this,i=uu.set(e,t,0).multiplyScalar(this.inputSensitivity),n=this.spherical.radius*Math.exp(this.logFov)*this.panPerPixel;i.multiplyScalar(n);const a=s.getTarget();a.add(i.applyMatrix3(this.panProjection)),s.boundingSphere.clampPoint(a,a),s.setTarget(a.x,a.y,a.z)}recenter(e){if(performance.now()>this.startTime+300||Math.abs(e.clientX-this.startPointerPosition.clientX)>2||Math.abs(e.clientY-this.startPointerPosition.clientY)>2)return;const{scene:t}=this,s=t.positionAndNormalFromPoint(t.getNDC(e.clientX,e.clientY));if(null==s){const{cameraTarget:e}=t.element;t.element.cameraTarget="",t.element.cameraTarget=e,this.userAdjustOrbit(0,0,1)}else t.target.worldToLocal(s.position),t.setTarget(s.position.x,s.position.y,s.position.z)}resetRadius(){const{scene:e}=this,t=e.positionAndNormalFromPoint(du.set(0,0));if(null==t)return;e.target.worldToLocal(t.position);const s=e.getTarget(),{theta:i,phi:n}=this.spherical,a=i-e.yaw,r=uu.set(Math.sin(n)*Math.sin(a),Math.cos(n),Math.sin(n)*Math.cos(a)),o=r.dot(t.position.sub(s));s.add(r.multiplyScalar(o)),e.setTarget(s.x,s.y,s.z),this.setOrbit(void 0,void 0,this.goalSpherical.radius-o)}onTouchChange(e){if(1===this.pointers.length)this.touchMode=this.touchModeRotate;else{if(this._disableZoom)return this.touchMode=null,void this.element.removeEventListener("touchmove",this.disableScroll);this.touchMode=this.touchDecided&&null===this.touchMode?null:this.touchModeZoom,this.touchDecided=!0,this.element.addEventListener("touchmove",this.disableScroll,{passive:!1}),this.lastSeparation=this.twoTouchDistance(this.pointers[0],this.pointers[1]),this.enablePan&&null!=this.touchMode&&(this.initializePan(),e.altKey||(this.scene.element[Ld].style.opacity=1))}}onMouseDown(e){this.panPerPixel=0,this.enablePan&&(2===e.button||e.ctrlKey||e.metaKey||e.shiftKey)&&(this.initializePan(),this.scene.element[Ld].style.opacity=1),this.element.style.cursor="grabbing"}orbitZoomKeyCodeHandler(e){let t=!0;switch(e.key){case"PageUp":this.userAdjustOrbit(0,0,mu*this.zoomSensitivity);break;case"PageDown":this.userAdjustOrbit(0,0,-.04*this.zoomSensitivity);break;case"ArrowUp":this.userAdjustOrbit(0,-gu,0);break;case"ArrowDown":this.userAdjustOrbit(0,gu,0);break;case"ArrowLeft":this.userAdjustOrbit(-gu,0,0);break;case"ArrowRight":this.userAdjustOrbit(gu,0,0);break;default:t=!1}return t}panKeyCodeHandler(e){this.initializePan();let t=!0;switch(e.key){case"ArrowUp":this.movePan(0,-10);break;case"ArrowDown":this.movePan(0,10);break;case"ArrowLeft":this.movePan(-10,0);break;case"ArrowRight":this.movePan(10,0);break;default:t=!1}return t}}const xu=150,yu="not-presenting",vu="session-started",wu="object-placed",Iu="failed",Cu="tracking",Eu="not-tracking",Bu=new Te,Qu=new Re,Su=new ke,_u=new Te,ku=new ot(45,1,.1,100),Tu=(new ge).setFromPoints([new Te(0,0,0),new Te(0,0,-1)]),Mu=new gs;class Ru extends rs{constructor(e){super(),this.renderer=e,this.currentSession=null,this.placeOnWall=!1,this.placementBox=null,this.lastTick=null,this.turntableRotation=null,this.oldShadowIntensity=null,this.frame=null,this.initialHitSource=null,this.transientHitTestSource=null,this.inputSource=null,this._presentedScene=null,this.resolveCleanup=null,this.exitWebXRButtonContainer=null,this.overlay=null,this.xrLight=null,this.xrMode=null,this.controller1=null,this.controller2=null,this.selectedController=null,this.tracking=!0,this.frames=0,this.initialized=!1,this.oldTarget=new Te,this.placementComplete=!1,this.isTranslating=!1,this.isRotating=!1,this.isTwoFingering=!1,this.lastDragPosition=new Te,this.relativeOrientation=new Re,this.scaleLine=new it(Tu),this.firstRatio=0,this.lastAngle=0,this.goalPosition=new Te,this.goalYaw=0,this.goalScale=1,this.xDamper=new hh,this.yDamper=new hh,this.zDamper=new hh,this.yawDamper=new hh,this.pitchDamper=new hh,this.rollDamper=new hh,this.scaleDamper=new hh,this.onExitWebXRButtonContainerClick=()=>this.stopPresenting(),this.onControllerSelectStart=e=>{const t=this.presentedScene,s=e.target;if(null!=this.placementBox.controllerIntersection(t,s))null!=this.selectedController&&(this.selectedController.userData.line.visible=!1,t.canScale&&(this.isTwoFingering=!0,this.firstRatio=this.controllerSeparation()/t.pivot.scale.x,this.scaleLine.visible=!0)),s.attach(t.pivot),this.selectedController=s,t.setShadowIntensity(.01);else{const e=s===this.controller1?this.controller2:this.controller1;this.relativeOrientation.copy(s.quaternion).invert().multiply(t.pivot.getWorldQuaternion(Qu)),e.userData.turning=!1,s.userData.turning=!0,s.userData.line.visible=!1}},this.onControllerSelectEnd=e=>{const t=e.target;if(t.userData.turning=!1,t.userData.line.visible=!0,this.isTwoFingering=!1,this.scaleLine.visible=!1,null!=this.selectedController&&this.selectedController!=t)return;const s=this.presentedScene;s.attach(s.pivot),this.selectedController=null,this.goalYaw=Math.atan2(s.pivot.matrix.elements[8],s.pivot.matrix.elements[10]),this.goalPosition.x=s.pivot.position.x,this.goalPosition.z=s.pivot.position.z},this.onUpdateScene=()=>{null!=this.placementBox&&this.isPresenting&&(this.placementBox.dispose(),this.placementBox=new mh(this.presentedScene,this.placeOnWall?"back":"bottom"))},this.onSelectStart=e=>{const t=this.transientHitTestSource;if(null==t)return;const s=this.frame.getHitTestResultsForTransientInput(t),i=this.presentedScene,n=this.placementBox;if(1===s.length){this.inputSource=e.inputSource;const{axes:t}=this.inputSource.gamepad,s=n.getHit(this.presentedScene,t[0],t[1]);n.show=!0,null!=s?(this.isTranslating=!0,this.lastDragPosition.copy(s)):!1===this.placeOnWall&&(this.isRotating=!0,this.lastAngle=1.5*t[0])}else if(2===s.length){n.show=!0,this.isTwoFingering=!0;const{separation:e}=this.fingerPolar(s);this.firstRatio=e/i.pivot.scale.x}},this.onSelectEnd=()=>{this.isTranslating=!1,this.isRotating=!1,this.isTwoFingering=!1,this.inputSource=null,this.goalPosition.y+=this.placementBox.offsetHeight*this.presentedScene.scale.x,this.placementBox.show=!1},this.threeRenderer=e.threeRenderer,this.threeRenderer.xr.enabled=!0}async resolveARSession(){go();const e=await navigator.xr.requestSession("immersive-ar",{requiredFeatures:[],optionalFeatures:["hit-test","dom-overlay","light-estimation"],domOverlay:this.overlay?{root:this.overlay}:void 0});return this.threeRenderer.xr.setReferenceSpaceType("local"),await this.threeRenderer.xr.setSession(e),this.threeRenderer.xr.cameraAutoUpdate=!1,e}get presentedScene(){return this._presentedScene}async supportsPresentation(){try{return go(),await navigator.xr.isSessionSupported("immersive-ar")}catch(e){return console.warn("Request to present in WebXR denied:"),console.warn(e),console.warn("Falling back to next ar-mode"),!1}}async present(e,t=!1){this.isPresenting&&console.warn("Cannot present while a model is already presenting");let s=new Promise((e,t)=>{requestAnimationFrame(()=>e())});e.setHotspotsVisibility(!1),e.queueRender(),await s,this._presentedScene=e,this.overlay=e.element.shadowRoot.querySelector("div.default"),!0===t&&(this.xrLight=new Ah(this.threeRenderer),this.xrLight.addEventListener("estimationstart",()=>{if(!this.isPresenting||null==this.xrLight)return;const e=this.presentedScene;e.add(this.xrLight),e.environment=this.xrLight.environment}));const i=await this.resolveARSession();i.addEventListener("end",()=>{this.postSessionCleanup()},{once:!0});const n=e.element.shadowRoot.querySelector(".slot.exit-webxr-ar-button");n.classList.add("enabled"),n.addEventListener("click",this.onExitWebXRButtonContainerClick),this.exitWebXRButtonContainer=n;const a=await i.requestReferenceSpace("viewer");this.xrMode=i.interactionMode,this.tracking=!0,this.frames=0,this.initialized=!1,this.turntableRotation=e.yaw,this.goalYaw=e.yaw,this.goalScale=1,e.setBackground(null),this.oldShadowIntensity=e.shadowIntensity,e.setShadowIntensity(.01),this.oldTarget.copy(e.getTarget()),e.element.addEventListener("load",this.onUpdateScene);const r=20*Math.PI/180,o=!0===this.placeOnWall?void 0:new XRRay(new DOMPoint(0,0,0),{x:0,y:-Math.sin(r),z:-Math.cos(r)});i.requestHitTestSource({space:a,offsetRay:o}).then(e=>{this.initialHitSource=e}),"screen-space"!==this.xrMode&&(this.setupControllers(),this.xDamper.setDecayTime(xu),this.yDamper.setDecayTime(xu),this.zDamper.setDecayTime(xu),this.yawDamper.setDecayTime(xu),this.pitchDamper.setDecayTime(xu),this.rollDamper.setDecayTime(xu)),this.currentSession=i,this.placementBox=new mh(e,this.placeOnWall?"back":"bottom"),this.placementComplete=!1,this.lastTick=performance.now(),this.dispatchEvent({type:"status",status:vu})}setupControllers(){this.controller1=this.threeRenderer.xr.getController(0),this.controller1.addEventListener("selectstart",this.onControllerSelectStart),this.controller1.addEventListener("selectend",this.onControllerSelectEnd),this.controller2=this.threeRenderer.xr.getController(1),this.controller2.addEventListener("selectstart",this.onControllerSelectStart),this.controller2.addEventListener("selectend",this.onControllerSelectEnd);const e=this.presentedScene;if(e.add(this.controller1),e.add(this.controller2),!this.controller1.userData.line){const t=new it(Tu);t.name="line",t.scale.z=5,this.controller1.userData.turning=!1,this.controller1.userData.line=t,this.controller1.add(t),this.controller2.userData.turning=!1;const s=t.clone();this.controller2.userData.line=s,this.controller2.add(s),this.scaleLine.name="scale line",this.scaleLine.visible=!1,this.controller1.add(this.scaleLine);const{size:i}=e,n=.1/Math.max(i.x,i.y,i.z),a=new tt(Mu);a.name="box",a.scale.copy(i).multiplyScalar(n),a.visible=!1,this.controller1.userData.box=a,e.add(a);const r=a.clone();this.controller2.userData.box=r,e.add(r)}}hover(e){if("screen-space"===this.xrMode||this.selectedController==e)return!1;const t=this.presentedScene,s=this.placementBox.controllerIntersection(t,e);return e.userData.box.visible=(null==s||e.userData.turning)&&!this.isTwoFingering,e.userData.line.scale.z=null==s?5:s.distance,null!=s}controllerSeparation(){return this.controller1.position.distanceTo(this.controller2.position)}async stopPresenting(){if(!this.isPresenting)return;const e=new Promise(e=>{this.resolveCleanup=e});try{await this.currentSession.end(),await e}catch(t){console.warn("Error while trying to end WebXR AR session"),console.warn(t),this.postSessionCleanup()}}get isPresenting(){return null!=this.presentedScene}get target(){return this.oldTarget}updateTarget(){const e=this.presentedScene;if(null!=e){const t=e.getTarget();this.oldTarget.copy(t),this.placeOnWall?t.z=e.boundingBox.min.z:t.y=e.boundingBox.min.y,e.setTarget(t.x,t.y,t.z)}}postSessionCleanup(){const e=this.currentSession;null!=e&&(e.removeEventListener("selectstart",this.onSelectStart),e.removeEventListener("selectend",this.onSelectEnd),this.currentSession=null);const t=this.presentedScene;if(this._presentedScene=null,null!=t){const{element:e}=t;null!=this.xrLight&&(t.remove(this.xrLight),this.xrLight.dispose(),this.xrLight=null),t.add(t.pivot),t.pivot.quaternion.set(0,0,0,1),t.pivot.position.set(0,0,0),t.pivot.scale.set(1,1,1),t.setShadowOffset(0);const s=this.turntableRotation;null!=s&&(t.yaw=s);const i=this.oldShadowIntensity;null!=i&&t.setShadowIntensity(i),t.setEnvironmentAndSkybox(e[vo],e[wo]);const n=this.oldTarget;t.setTarget(n.x,n.y,n.z),t.xrCamera=null,t.element.removeEventListener("load",this.onUpdateScene),t.orientHotspots(0);const{width:a,height:r}=e.getBoundingClientRect();t.setSize(a,r),requestAnimationFrame(()=>{t.element.dispatchEvent(new CustomEvent("camera-change",{detail:{source:fu.NONE}}))})}this.renderer.height=0;const s=this.exitWebXRButtonContainer;null!=s&&(s.classList.remove("enabled"),s.removeEventListener("click",this.onExitWebXRButtonContainerClick),this.exitWebXRButtonContainer=null);const i=this.transientHitTestSource;null!=i&&(i.cancel(),this.transientHitTestSource=null);const n=this.initialHitSource;null!=n&&(n.cancel(),this.initialHitSource=null),null!=this.placementBox&&(this.placementBox.dispose(),this.placementBox=null),"screen-space"!==this.xrMode&&(null!=this.controller1&&(this.controller1.userData.turning=!1,this.controller1.userData.box.visible=!1,this.controller1.userData.line.visible=!0,this.controller1.removeEventListener("selectstart",this.onControllerSelectStart),this.controller1.removeEventListener("selectend",this.onControllerSelectEnd),this.controller1.removeFromParent(),this.controller1=null),null!=this.controller2&&(this.controller2.userData.turning=!1,this.controller2.userData.box.visible=!1,this.controller2.userData.line.visible=!0,this.controller2.removeEventListener("selectstart",this.onControllerSelectStart),this.controller2.removeEventListener("selectend",this.onControllerSelectEnd),this.controller2.removeFromParent(),this.controller2=null),this.selectedController=null,this.scaleLine.visible=!1),this.isTranslating=!1,this.isRotating=!1,this.isTwoFingering=!1,this.lastTick=null,this.turntableRotation=null,this.oldShadowIntensity=null,this.frame=null,this.inputSource=null,this.overlay=null,null!=this.resolveCleanup&&this.resolveCleanup(),this.dispatchEvent({type:"status",status:yu})}updateView(e){const t=this.presentedScene,s=this.threeRenderer.xr;s.updateCamera(ku),t.xrCamera=s.getCamera();const{elements:i}=t.getCamera().matrixWorld;if(t.orientHotspots(Math.atan2(i[1],i[5])),this.initialized||(this.placeInitially(),this.initialized=!0),e.requestViewportScale&&e.recommendedViewportScale){const t=e.recommendedViewportScale;e.requestViewportScale(Math.max(t,.25))}const n=s.getBaseLayer();if(null!=n){const t=n instanceof XRWebGLLayer?n.getViewport(e):s.getBinding().getViewSubImage(n,e).viewport;this.threeRenderer.setViewport(t.x,t.y,t.width,t.height)}}placeInitially(){const e=this.presentedScene,{pivot:t,element:s}=e,{position:i}=t,n=e.getCamera(),{width:a,height:r}=this.overlay.getBoundingClientRect();e.setSize(a,r),n.projectionMatrixInverse.copy(n.projectionMatrix).invert();const{theta:o}=s.getCameraOrbit(),l=n.getWorldDirection(Bu);e.yaw=Math.atan2(-l.x,-l.z)-o,this.goalYaw=e.yaw;const c=Math.max(1,2*e.boundingSphere.radius);i.copy(n.position).add(l.multiplyScalar(c)),this.updateTarget();const A=e.getTarget();if(i.add(A).sub(this.oldTarget),this.goalPosition.copy(i),e.setHotspotsVisibility(!0),"screen-space"===this.xrMode){const{session:e}=this.frame;e.addEventListener("selectstart",this.onSelectStart),e.addEventListener("selectend",this.onSelectEnd),e.requestHitTestSourceForTransientInput({profile:"generic-touchscreen"}).then(e=>{this.transientHitTestSource=e})}}getTouchLocation(){const{axes:e}=this.inputSource.gamepad;let t=this.placementBox.getExpandedHit(this.presentedScene,e[0],e[1]);return null!=t&&(Bu.copy(t).sub(this.presentedScene.getCamera().position),Bu.length()>10)?null:t}getHitPoint(e){const t=this.threeRenderer.xr.getReferenceSpace(),s=e.getPose(t);if(null==s)return null;const i=Su.fromArray(s.transform.matrix);return!0===this.placeOnWall&&(this.goalYaw=Math.atan2(i.elements[4],i.elements[6])),i.elements[5]>.75!==this.placeOnWall?_u.setFromMatrixPosition(i):null}moveToFloor(e){const t=this.initialHitSource;if(null==t)return;const s=e.getHitTestResults(t);if(0==s.length)return;const i=s[0],n=this.getHitPoint(i);null!=n&&(this.placementBox.show=!0,this.isTranslating||(this.placeOnWall?this.goalPosition.copy(n):this.goalPosition.y=n.y),t.cancel(),this.initialHitSource=null,this.dispatchEvent({type:"status",status:wu}))}fingerPolar(e){const t=e[0].inputSource.gamepad.axes,s=e[1].inputSource.gamepad.axes,i=s[0]-t[0],n=s[1]-t[1],a=Math.atan2(n,i);let r=this.lastAngle-a;return r>Math.PI?r-=2*Math.PI:r<-Math.PI&&(r+=2*Math.PI),this.lastAngle=a,{separation:Math.sqrt(i*i+n*n),deltaYaw:r}}setScale(e){const t=e/this.firstRatio;this.goalScale=Math.abs(t-1)<.2?1:t}processInput(e){const t=this.transientHitTestSource;if(null==t)return;if(!this.isTranslating&&!this.isTwoFingering&&!this.isRotating)return;const s=e.getHitTestResultsForTransientInput(t),i=this.presentedScene,n=i.pivot.scale.x;if(this.isTwoFingering)if(s.length<2)this.isTwoFingering=!1;else{const{separation:e,deltaYaw:t}=this.fingerPolar(s);!1===this.placeOnWall&&(this.goalYaw+=t),i.canScale&&this.setScale(e)}else{if(2===s.length){this.isTranslating=!1,this.isRotating=!1,this.isTwoFingering=!0;const{separation:e}=this.fingerPolar(s);return void(this.firstRatio=e/n)}if(this.isRotating){const e=1.5*this.inputSource.gamepad.axes[0];this.goalYaw+=e-this.lastAngle,this.lastAngle=e}else this.isTranslating&&s.forEach(e=>{if(e.inputSource!==this.inputSource)return;let t=null;if(e.results.length>0&&(t=this.getHitPoint(e.results[0])),null==t&&(t=this.getTouchLocation()),null!=t){if(this.goalPosition.sub(this.lastDragPosition),!1===this.placeOnWall){const e=t.y-this.lastDragPosition.y;if(e<0){this.placementBox.offsetHeight=e/n,this.presentedScene.setShadowOffset(e);const s=Bu.copy(i.getCamera().position),a=-e/(s.y-t.y);s.multiplyScalar(a),t.multiplyScalar(1-a).add(s)}}this.goalPosition.add(t),this.lastDragPosition.copy(t)}})}}moveScene(e){const t=this.presentedScene,{pivot:s}=t,i=this.placementBox;if(i.updateOpacity(e),this.controller1&&(this.controller1.userData.turning&&(s.quaternion.copy(this.controller1.quaternion).multiply(this.relativeOrientation),this.selectedController&&this.selectedController===this.controller2&&s.quaternion.premultiply(Qu.copy(this.controller2.quaternion).invert())),this.controller1.userData.box.position.copy(this.controller1.position),s.getWorldQuaternion(this.controller1.userData.box.quaternion)),this.controller2&&(this.controller2.userData.turning&&(s.quaternion.copy(this.controller2.quaternion).multiply(this.relativeOrientation),this.selectedController&&this.selectedController===this.controller1&&s.quaternion.premultiply(Qu.copy(this.controller1.quaternion).invert())),this.controller2.userData.box.position.copy(this.controller2.position),s.getWorldQuaternion(this.controller2.userData.box.quaternion)),this.controller1&&this.controller2&&this.isTwoFingering){const e=this.controllerSeparation();this.setScale(e),this.scaleLine.scale.z=-e,this.scaleLine.lookAt(this.controller2.position)}const n=t.pivot.scale.x;if(this.goalScale!==n){const s=this.scaleDamper.update(n,this.goalScale,e,1);t.pivot.scale.set(s,s,s)}if(s.parent!==t)return;const{position:a}=s,r=t.boundingSphere.radius,o=this.goalPosition;let l=fu.NONE;if(!o.equals(a)){l=fu.USER_INTERACTION;let{x:s,y:n,z:c}=a;if(s=this.xDamper.update(s,o.x,e,r),n=this.yDamper.update(n,o.y,e,r),c=this.zDamper.update(c,o.z,e,r),a.set(s,n,c),"screen-space"===this.xrMode&&!this.isTranslating){const e=o.y-n;this.placementComplete&&!1===this.placeOnWall?(i.offsetHeight=e/t.pivot.scale.x,t.setShadowOffset(e)):0===e&&(this.placementComplete=!0,i.show=!1,t.setShadowIntensity(.8))}"screen-space"!==this.xrMode&&o.equals(a)&&t.setShadowIntensity(.8)}t.updateTarget(e),Qu.setFromAxisAngle(Bu.set(0,1,0),this.goalYaw);const c=t.pivot.quaternion.angleTo(Qu),A=c-this.yawDamper.update(c,0,e,Math.PI);t.pivot.quaternion.rotateTowards(Qu,A),t.element.dispatchEvent(new CustomEvent("camera-change",{detail:{source:l}}))}onWebXRFrame(e,t){if("screen-space"!==this.xrMode){const e=this.hover(this.controller1),t=this.hover(this.controller2);this.placementBox.show=(e||t)&&!this.isTwoFingering}this.frame=t,++this.frames;const s=this.threeRenderer.xr.getReferenceSpace(),i=t.getViewerPose(s);null==i&&!0===this.tracking&&this.frames>30&&(this.tracking=!1,this.dispatchEvent({type:"tracking",status:Eu}));const n=this.presentedScene;if(null==i||null==n||!n.element.loaded)return void this.threeRenderer.clear();!1===this.tracking&&(this.tracking=!0,this.dispatchEvent({type:"tracking",status:Cu}));let a=!0;for(const r of i.views){if(this.updateView(r),a){this.moveToFloor(t),this.processInput(t);const s=e-this.lastTick;this.moveScene(s),this.renderer.preRender(n,e,s),this.lastTick=e,n.renderShadow(this.threeRenderer)}this.threeRenderer.render(n,n.getCamera()),a=!1}}}function Du(e){const t=new Map,s=new Map,i=e.clone();return Nu(e,i,function(e,i){t.set(i,e),s.set(e,i)}),i.traverse(function(e){if(!e.isSkinnedMesh)return;const i=e,n=t.get(e),a=n.skeleton.bones;i.skeleton=n.skeleton.clone(),i.bindMatrix.copy(n.bindMatrix),i.skeleton.bones=a.map(function(e){return s.get(e)}),i.bind(i.skeleton,i.bindMatrix)}),i}function Nu(e,t,s){s(e,t);for(let i=0;i<e.children.length;i++)Nu(e.children[i],t.children[i],s)}const Fu=Symbol("prepared"),ju=Symbol("prepare"),Lu=Symbol("preparedGLTF"),Pu=Symbol("clone");class Uu{static prepare(e){if(null==e.scene)throw new Error("Model does not have a scene");if(e[Fu])return e;const t=this[ju](e);return t[Fu]=!0,t}static[ju](e){const{scene:t}=e,s=[t];return Object.assign(Object.assign({},e),{scene:t,scenes:s})}get parser(){return this[Lu].parser}get animations(){return this[Lu].animations}get scene(){return this[Lu].scene}get scenes(){return this[Lu].scenes}get cameras(){return this[Lu].cameras}get asset(){return this[Lu].asset}get userData(){return this[Lu].userData}constructor(e){this[Lu]=e}clone(){return new(0,this.constructor)(this[Pu]())}dispose(){this.scenes.forEach(e=>{e.traverse(e=>{const t=e;if(!t.material)return;(Array.isArray(t.material)?t.material:[t.material]).forEach(e=>{for(const t in e){const s=e[t];if(s instanceof gt){const e=s.source.data;null!=e.close&&e.close(),s.dispose()}}e.dispose()}),t.geometry.dispose()})})}[Pu](){const e=this[Lu],t=Du(this.scene);Ou(t,this.scene);const s=[t],i=e.userData?Object.assign({},e.userData):{};return Object.assign(Object.assign({},e),{scene:t,scenes:s,userData:i})}}const Ou=(e,t)=>{Gu(e,t,(e,t)=>{void 0!==t.userData.variantMaterials&&(e.userData.variantMaterials=new Map(t.userData.variantMaterials)),void 0!==t.userData.variantData&&(e.userData.variantData=t.userData.variantData),void 0!==t.userData.originalMaterial&&(e.userData.originalMaterial=t.userData.originalMaterial)})},Gu=(e,t,s)=>{s(e,t);for(let i=0;i<e.children.length;i++)Gu(e.children[i],t.children[i],s)},Hu=Symbol("threeGLTF"),qu=Symbol("gltf"),zu=Symbol("gltfElementMap"),Vu=Symbol("threeObjectMap"),Ku=Symbol("parallelTraverseThreeScene"),Ju=Symbol("correlateOriginalThreeGLTF"),Yu=Symbol("correlateCloneThreeGLTF");class Wu{static from(e,t){return null!=t?this[Yu](e,t):this[Ju](e)}static[Ju](e){const t=e.parser.json,s=e.parser.associations,i=new Map,n={name:"Default"},a={index:-1};for(const r of s.keys())r instanceof Je&&null==s.get(r)&&(a.index<0&&(null==t.materials&&(t.materials=[]),a.index=t.materials.length,t.materials.push(n)),r.name=n.name,s.set(r,{materials:a.index}));for(const[r,o]of s){o&&(r.userData=r.userData||{},r.userData.associations=o);for(const e in o)if(null!=e&&"primitives"!==e){const s=e,n=(t[s]||[])[o[s]];if(null==n)continue;let a=i.get(n);null==a&&(a=new Set,i.set(n,a)),a.add(r)}}return new Wu(e,t,s,i)}static[Yu](e,t){const s=t.threeGLTF,i=t.gltf,n=JSON.parse(JSON.stringify(i)),a=new Map,r=new Map;for(let o=0;o<s.scenes.length;o++)this[Ku](s.scenes[o],e.scenes[o],(e,s)=>{const i=t.threeObjectMap.get(e);if(null!=i)for(const t in i)if(null!=t&&"primitives"!==t){const e=t,o=i[e],l=n[e][o],c=a.get(s)||{};c[e]=o,a.set(s,c);const A=r.get(l)||new Set;A.add(s),r.set(l,A)}});return new Wu(e,n,a,r)}static[Ku](e,t,s){const i=(e,t)=>{if(s(e,t),e.isObject3D){const n=e,a=t;if(n.material)if(Array.isArray(n.material))for(let e=0;e<n.material.length;++e)s(n.material[e],a.material[e]);else s(n.material,a.material);for(let s=0;s<e.children.length;++s)i(e.children[s],t.children[s])}};i(e,t)}get threeGLTF(){return this[Hu]}get gltf(){return this[qu]}get gltfElementMap(){return this[zu]}get threeObjectMap(){return this[Vu]}constructor(e,t,s,i){this[Hu]=e,this[qu]=t,this[zu]=i,this[Vu]=s}}const $u=Symbol("correlatedSceneGraph");class Xu extends Uu{static[ju](e){const t=super[ju](e);null==t[$u]&&(t[$u]=Wu.from(t));const{scene:s}=t,i=new wt(void 0,1/0);return s.traverse(e=>{e.renderOrder=1e3,e.frustumCulled=!1,e.name||(e.name=e.uuid);const s=e;if(s.material){const{geometry:e}=s;s.castShadow=!0,s.isSkinnedMesh&&(e.boundingSphere=i,e.boundingBox=null);const n=s.material;if(!0===n.isMeshBasicMaterial&&(n.toneMapped=!1),n.shadowSide=xt,n.aoMap){const{gltf:s,threeObjectMap:i}=t[$u],a=i.get(n);if(null!=s.materials&&null!=a&&null!=a.materials){const t=s.materials[a.materials];t.occlusionTexture&&0===t.occlusionTexture.texCoord&&null!=e.attributes.uv&&e.setAttribute("uv2",e.attributes.uv)}}}}),t}get correlatedSceneGraph(){return this[Lu][$u]}[Pu](){const e=super[Pu](),t=new Map;return e.scene.traverse(e=>{const s=e;if(s.material){const e=s.material;if(null!=e){if(t.has(e.uuid))return void(s.material=t.get(e.uuid));s.material=e.clone(),t.set(e.uuid,s.material)}}const i=e;void 0!==i.target&&i.add(i.target)}),e[$u]=Wu.from(e,this.correlatedSceneGraph),e}}class Zu extends xs{constructor(e){super(e),this.type=Wt}parse(e){const t=function(e,t){switch(e){case 1:throw new Error("THREE.HDRLoader: Read Error: "+(t||""));case 2:throw new Error("THREE.HDRLoader: Write Error: "+(t||""));case 3:throw new Error("THREE.HDRLoader: Bad File Format: "+(t||""));default:throw new Error("THREE.HDRLoader: Memory Error: "+(t||""))}},s=function(e,t,s){t=t||1024;let i=e.pos,n=-1,a=0,r="",o=String.fromCharCode.apply(null,new Uint16Array(e.subarray(i,i+128)));for(;0>(n=o.indexOf("\n"))&&a<t&&i<e.byteLength;)r+=o,a+=o.length,i+=128,o+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(i,i+128)));return-1<n&&(e.pos+=a+n+1,r+o.slice(0,n))},i=function(e,t,s,i){const n=e[t+3],a=Math.pow(2,n-128)/255;s[i+0]=e[t+0]*a,s[i+1]=e[t+1]*a,s[i+2]=e[t+2]*a,s[i+3]=1},n=function(e,t,s,i){const n=e[t+3],a=Math.pow(2,n-128)/255;s[i+0]=ys.toHalfFloat(Math.min(e[t+0]*a,65504)),s[i+1]=ys.toHalfFloat(Math.min(e[t+1]*a,65504)),s[i+2]=ys.toHalfFloat(Math.min(e[t+2]*a,65504)),s[i+3]=ys.toHalfFloat(1)},a=new Uint8Array(e);a.pos=0;const r=function(e){const i=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,n=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,a=/^\s*FORMAT=(\S+)\s*$/,r=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,o={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let l,c;for((e.pos>=e.byteLength||!(l=s(e)))&&t(1,"no header found"),(c=l.match(/^#\?(\S+)/))||t(3,"bad initial token"),o.valid|=1,o.programtype=c[1],o.string+=l+"\n";l=s(e),!1!==l;)if(o.string+=l+"\n","#"!==l.charAt(0)){if((c=l.match(i))&&(o.gamma=parseFloat(c[1])),(c=l.match(n))&&(o.exposure=parseFloat(c[1])),(c=l.match(a))&&(o.valid|=2,o.format=c[1]),(c=l.match(r))&&(o.valid|=4,o.height=parseInt(c[1],10),o.width=parseInt(c[2],10)),2&o.valid&&4&o.valid)break}else o.comments+=l+"\n";return 2&o.valid||t(3,"missing format specifier"),4&o.valid||t(3,"missing image size specifier"),o}(a),o=r.width,l=r.height,c=function(e,s,i){const n=s;if(n<8||n>32767||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);n!==(e[2]<<8|e[3])&&t(3,"wrong scanline width");const a=new Uint8Array(4*s*i);a.length||t(4,"unable to allocate buffer space");let r=0,o=0;const l=4*n,c=new Uint8Array(4),A=new Uint8Array(l);let h=i;for(;h>0&&o<e.byteLength;){o+4>e.byteLength&&t(1),c[0]=e[o++],c[1]=e[o++],c[2]=e[o++],c[3]=e[o++],2==c[0]&&2==c[1]&&(c[2]<<8|c[3])==n||t(3,"bad rgbe scanline format");let s,i=0;for(;i<l&&o<e.byteLength;){s=e[o++];const n=s>128;if(n&&(s-=128),(0===s||i+s>l)&&t(3,"bad scanline data"),n){const t=e[o++];for(let e=0;e<s;e++)A[i++]=t}else A.set(e.subarray(o,o+s),i),i+=s,o+=s}const d=n;for(let e=0;e<d;e++){let t=0;a[r]=A[e+t],t+=n,a[r+1]=A[e+t],t+=n,a[r+2]=A[e+t],t+=n,a[r+3]=A[e+t],r+=4}h--}return a}(a.subarray(a.pos),o,l);let A,h,d;switch(this.type){case Zt:d=c.length/4;const e=new Float32Array(4*d);for(let s=0;s<d;s++)i(c,4*s,e,4*s);A=e,h=Zt;break;case Wt:d=c.length/4;const t=new Uint16Array(4*d);for(let s=0;s<d;s++)n(c,4*s,t,4*s);A=t,h=Wt;break;default:throw new Error("THREE.HDRLoader: Unsupported type: "+this.type)}return{width:o,height:l,data:A,header:r.string,gamma:r.gamma,exposure:r.exposure,type:h}}setDataType(e){return this.type=e,this}load(e,t,s,i){return super.load(e,function(e,s){switch(e.type){case Zt:case Wt:e.colorSpace=pe,e.minFilter=Ge,e.magFilter=Ge,e.generateMipmaps=!1,e.flipY=!0}t&&t(e,s)},s,i)}}class ep extends Zu{constructor(e){console.warn("RGBELoader has been deprecated. Please use HDRLoader instead."),super(e)}}const tp={topLight:{intensity:500,position:[.418,16.199,.3]},room:{position:[-.757,13.219,.717],scale:[31.713,28.305,28.591]},boxes:[{position:[-10.906,2.009,1.846],rotation:-.195,scale:[2.328,7.905,4.651]},{position:[-5.607,-.754,-.758],rotation:.994,scale:[1.97,1.534,3.955]},{position:[6.167,.857,7.803],rotation:.561,scale:[3.927,6.285,3.687]},{position:[-2.017,.018,6.124],rotation:.333,scale:[2.002,4.566,2.064]},{position:[2.291,-.756,-2.621],rotation:-.286,scale:[1.546,1.552,1.496]},{position:[-2.193,-.369,-5.547],rotation:.516,scale:[3.875,3.487,2.986]}],lights:[{intensity:50,position:[-16.116,14.37,8.208],scale:[.1,2.428,2.739]},{intensity:50,position:[-16.109,18.021,-8.207],scale:[.1,2.425,2.751]},{intensity:17,position:[14.904,12.198,-1.832],scale:[.15,4.265,6.331]},{intensity:43,position:[-.462,8.89,14.52],scale:[4.38,5.441,.088]},{intensity:20,position:[3.235,11.486,-12.541],scale:[2.5,2,.1]},{intensity:100,position:[0,20,0],scale:[1,.1,1]}]},sp={topLight:{intensity:400,position:[.5,14,.5]},room:{position:[0,13.2,0],scale:[31.5,28.5,31.5]},boxes:[{position:[-10.906,-1,1.846],rotation:-.195,scale:[2.328,7.905,4.651]},{position:[-5.607,-.754,-.758],rotation:.994,scale:[1.97,1.534,3.955]},{position:[6.167,-.16,7.803],rotation:.561,scale:[3.927,6.285,3.687]},{position:[-2.017,.018,6.124],rotation:.333,scale:[2.002,4.566,2.064]},{position:[2.291,-.756,-2.621],rotation:-.286,scale:[1.546,1.552,1.496]},{position:[-2.193,-.369,-5.547],rotation:.516,scale:[3.875,3.487,2.986]}],lights:[{intensity:80,position:[-14,10,8],scale:[.1,2.5,2.5]},{intensity:80,position:[-14,14,-4],scale:[.1,2.5,2.5]},{intensity:23,position:[14,12,0],scale:[.1,5,5]},{intensity:16,position:[0,9,14],scale:[5,5,.1]},{intensity:80,position:[7,8,-14],scale:[2.5,2.5,.1]},{intensity:80,position:[-7,16,-14],scale:[2.5,2.5,.1]},{intensity:1,position:[0,20,0],scale:[.1,.1,.1]}]};class ip extends As{constructor(e){super(),this.position.y=-3.5;const t=new gs;t.deleteAttribute("uv");const s=new We({metalness:0,side:vs}),i=new We({metalness:0}),n="legacy"==e?tp:sp,a=new Se(16777215,n.topLight.intensity,28,2);a.position.set(...n.topLight.position),this.add(a);const r=new tt(t,s);r.position.set(...n.room.position),r.scale.set(...n.room.scale),this.add(r);for(const o of n.boxes){const e=new tt(t,i);e.position.set(...o.position),e.rotation.set(0,o.rotation,0),e.scale.set(...o.scale),this.add(e)}for(const o of n.lights){const e=new tt(t,this.createAreaLightMaterial(o.intensity));e.position.set(...o.position),e.scale.set(...o.scale),this.add(e)}}createAreaLightMaterial(e){const t=new Xe;return t.color.setScalar(e),t}}const np=20,ap=/\.hdr(\.js)?$/;class rp{constructor(e){this.threeRenderer=e,this.lottieLoaderUrl="",this._ldrLoader=null,this._imageLoader=null,this._hdrLoader=null,this._lottieLoader=null,this.generatedEnvironmentMap=null,this.generatedEnvironmentMapAlt=null,this.skyboxCache=new Map,this.blurMaterial=null,this.blurScene=null}ldrLoader(e){return null==this._ldrLoader&&(this._ldrLoader=new Fe),this._ldrLoader.setWithCredentials(e),this._ldrLoader}imageLoader(e){return null==this._imageLoader&&(this._imageLoader=new ws(this.threeRenderer)),this._imageLoader.setWithCredentials(e),this._imageLoader}hdrLoader(e){return null==this._hdrLoader&&(this._hdrLoader=new ep,this._hdrLoader.setDataType(Wt)),this._hdrLoader.setWithCredentials(e),this._hdrLoader}async getLottieLoader(e){if(null==this._lottieLoader){const{LottieLoader:e}=await import(this.lottieLoaderUrl);this._lottieLoader=new e}return this._lottieLoader.setWithCredentials(e),this._lottieLoader}async loadImage(e,t){const s=await new Promise((s,i)=>this.ldrLoader(t).load(e,s,()=>{},i));return s.name=e,s.flipY=!1,s}async loadLottie(e,t,s){const i=await this.getLottieLoader(s);i.setQuality(t);const n=await new Promise((t,s)=>i.load(e,t,()=>{},s));return n.name=e,n}async loadEquirect(e,t=!1,s=()=>{}){try{const i=ap.test(e),n=i?this.hdrLoader(t):this.imageLoader(t),a=await new Promise((t,i)=>n.load(e,e=>{const{renderTarget:s}=e;if(null!=s){const{texture:i}=s;e.dispose(!1),t(i)}else t(e)},e=>{s(e.loaded/e.total*.9)},i));return s(1),a.name=e,a.mapping=Is,i||(a.colorSpace=ue),a}finally{s&&s(1)}}async generateEnvironmentMapAndSkybox(e=null,t=null,s=()=>{},i=!1){const n="legacy"!==t;"legacy"!==t&&"neutral"!==t||(t=null),t=po(t);let a,r=Promise.resolve(null);e&&(r=this.loadEquirectFromUrl(e,i,s)),a=t?this.loadEquirectFromUrl(t,i,s):e?this.loadEquirectFromUrl(e,i,s):n?this.loadGeneratedEnvironmentMapAlt():this.loadGeneratedEnvironmentMap();const[o,l]=await Promise.all([a,r]);if(null==o)throw new Error("Failed to load environment map.");return{environmentMap:o,skybox:l}}async loadEquirectFromUrl(e,t,s){if(!this.skyboxCache.has(e)){const i=this.loadEquirect(e,t,s);this.skyboxCache.set(e,i)}return this.skyboxCache.get(e)}async GenerateEnvironmentMap(e,t){await((e=0)=>new Promise(t=>setTimeout(t,e)))();const s=this.threeRenderer,i=new ds(256,{generateMipmaps:!1,type:Wt,format:Jt,colorSpace:pe,depthBuffer:!0}),n=new Cs(.1,100,i),a=n.renderTarget.texture;a.name=t;const r=s.outputColorSpace,o=s.toneMapping;return s.toneMapping=ce,s.outputColorSpace=pe,n.update(s,e),this.blurCubemap(i,.04),s.toneMapping=o,s.outputColorSpace=r,a}async loadGeneratedEnvironmentMap(){return null==this.generatedEnvironmentMap&&(this.generatedEnvironmentMap=this.GenerateEnvironmentMap(new ip("legacy"),"legacy")),this.generatedEnvironmentMap}async loadGeneratedEnvironmentMapAlt(){return null==this.generatedEnvironmentMapAlt&&(this.generatedEnvironmentMapAlt=this.GenerateEnvironmentMap(new ip("neutral"),"neutral")),this.generatedEnvironmentMapAlt}blurCubemap(e,t){if(null==this.blurMaterial){this.blurMaterial=this.getBlurShader(np);const e=new gs,t=new tt(e,this.blurMaterial);this.blurScene=new As,this.blurScene.add(t)}const s=e.clone();this.halfblur(e,s,t,"latitudinal"),this.halfblur(s,e,t,"longitudinal")}halfblur(e,t,s,i){const n=e.width,a=isFinite(s)?Math.PI/(2*n):2*Math.PI/39,r=s/a,o=isFinite(s)?1+Math.floor(3*r):np;o>np&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${o} samples when the maximum is set to 20`);const l=[];let c=0;for(let h=0;h<np;++h){const e=h/r,t=Math.exp(-e*e/2);l.push(t),0==h?c+=t:h<o&&(c+=2*t)}for(let h=0;h<l.length;h++)l[h]=l[h]/c;const A=this.blurMaterial.uniforms;A.envMap.value=e.texture,A.samples.value=o,A.weights.value=l,A.latitudinal.value="latitudinal"===i,A.dTheta.value=a;new Cs(.1,100,t).update(this.threeRenderer,this.blurScene)}getBlurShader(e){const t=new Float32Array(e),s=new Te(0,1,0);return new Es({name:"SphericalGaussianBlur",defines:{n:e},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:t},latitudinal:{value:!1},dTheta:{value:0},poleAxis:{value:s}},vertexShader:"\n      \n      varying vec3 vOutputDirection;\n  \n      void main() {\n  \n        vOutputDirection = vec3( position );\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n  \n      }\n    ",fragmentShader:"\n        varying vec3 vOutputDirection;\n  \n        uniform samplerCube envMap;\n        uniform int samples;\n        uniform float weights[ n ];\n        uniform bool latitudinal;\n        uniform float dTheta;\n        uniform vec3 poleAxis;\n  \n        vec3 getSample( float theta, vec3 axis ) {\n  \n          float cosTheta = cos( theta );\n          // Rodrigues' axis-angle rotation\n          vec3 sampleDirection = vOutputDirection * cosTheta\n            + cross( axis, vOutputDirection ) * sin( theta )\n            + axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n  \n          return vec3( textureCube( envMap, sampleDirection ) );\n  \n        }\n  \n        void main() {\n  \n          vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n  \n          if ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n  \n            axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n  \n          }\n  \n          axis = normalize( axis );\n  \n          gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n          gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n  \n          for ( int i = 1; i < n; i++ ) {\n  \n            if ( i >= samples ) {\n  \n              break;\n  \n            }\n  \n            float theta = dTheta * float( i );\n            gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n            gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n  \n          }\n        }\n      ",blending:Bs,depthTest:!1,depthWrite:!1,side:vs})}async dispose(){for(const[,e]of this.skyboxCache){(await e).dispose()}null!=this.generatedEnvironmentMap&&((await this.generatedEnvironmentMap).dispose(),this.generatedEnvironmentMap=null),null!=this.generatedEnvironmentMapAlt&&((await this.generatedEnvironmentMapAlt).dispose(),this.generatedEnvironmentMapAlt=null),null!=this.blurMaterial&&this.blurMaterial.dispose()}}const op=[1,.79,.62,.5,.4,.31,.25],lp="high-performance";class cp extends rs{static get singleton(){return this._singleton||(this._singleton=new cp({powerPreference:(self.ModelViewerElement||{}).powerPreference||lp,debug:xo()})),this._singleton}static resetSingleton(){const e=this._singleton.dispose();for(const t of e)t.disconnectedCallback();this._singleton=new cp({powerPreference:(self.ModelViewerElement||{}).powerPreference||lp,debug:xo()});for(const t of e)t.connectedCallback()}get canRender(){return null!=this.threeRenderer}get scaleFactor(){return op[this.scaleStep]}set minScale(e){let t=1;for(;t<op.length&&!(op[t]<e);)++t;this.lastStep=t-1}constructor(e){super(),this.loader=new iA(Xu),this.width=0,this.height=0,this.dpr=1,this.scenes=new Set,this.multipleScenesVisible=!1,this.lastTick=performance.now(),this.renderedLastFrame=!1,this.scaleStep=0,this.lastStep=3,this.avgFrameDuration=50,this.onWebGLContextLost=e=>{this.dispatchEvent({type:"contextlost",sourceEvent:e})},this.onWebGLContextRestored=()=>{var e;null===(e=this.textureUtils)||void 0===e||e.dispose(),this.textureUtils=new rp(this.threeRenderer);for(const t of this.scenes)t.element[Io]()},this.dpr=window.devicePixelRatio,this.canvas3D=document.createElement("canvas"),this.canvas3D.id="webgl-canvas",this.canvas3D.classList.add("show");try{this.threeRenderer=new Qs({canvas:this.canvas3D,alpha:!0,antialias:!0,powerPreference:e.powerPreference,preserveDrawingBuffer:!0}),this.threeRenderer.autoClear=!0,this.threeRenderer.setPixelRatio(1),this.threeRenderer.debug={checkShaderErrors:!!e.debug,onShaderError:null},this.threeRenderer.toneMapping=Ae}catch(t){console.warn(t)}this.arRenderer=new Ru(this),this.textureUtils=this.canRender?new rp(this.threeRenderer):null,iA.initializeKTX2Loader(this.threeRenderer),this.canvas3D.addEventListener("webglcontextlost",this.onWebGLContextLost),this.canvas3D.addEventListener("webglcontextrestored",this.onWebGLContextRestored),this.updateRendererSize()}registerScene(e){this.scenes.add(e),e.forceRescale();const t=new Be;this.threeRenderer.getSize(t),e.canvas.width=t.x,e.canvas.height=t.y,this.canRender&&this.scenes.size>0&&this.threeRenderer.setAnimationLoop((e,t)=>this.render(e,t))}unregisterScene(e){this.scenes.delete(e),this.canvas3D.parentElement===e.canvas.parentElement&&e.canvas.parentElement.removeChild(this.canvas3D),this.canRender&&0===this.scenes.size&&this.threeRenderer.setAnimationLoop(null)}displayCanvas(e){return e.element.modelIsVisible&&!this.multipleScenesVisible?this.canvas3D:e.element[sf]}countVisibleScenes(){const{canvas3D:e}=this;let t=0,s=null;for(const n of this.scenes){const{element:i}=n;i.modelIsVisible&&null==n.externalRenderer&&++t,e.parentElement===n.canvas.parentElement&&(s=n)}const i=t>1;if(null!=s){const t=i&&!this.multipleScenesVisible,n=!s.element.modelIsVisible;if(t||n){const{width:t,height:i}=this.sceneSize(s);this.copyPixels(s,t,i),e.parentElement.removeChild(e)}}this.multipleScenesVisible=i}updateRendererSize(){var e;const t=window.devicePixelRatio;if(t!==this.dpr)for(const n of this.scenes){const{element:e}=n;e[Hm](e.getBoundingClientRect())}let s=0,i=0;for(const n of this.scenes)s=Math.max(s,n.width),i=Math.max(i,n.height);if(s!==this.width||i!==this.height||t!==this.dpr){this.width=s,this.height=i,this.dpr=t,s=Math.ceil(s*t),i=Math.ceil(i*t),this.canRender&&this.threeRenderer.setSize(s,i,!1);for(const t of this.scenes){const{canvas:n}=t;n.width=s,n.height=i,t.forceRescale(),null===(e=t.effectRenderer)||void 0===e||e.setSize(s,i)}}}updateRendererScale(e){const t=this.scaleStep;this.avgFrameDuration+=bo(.2*(e-this.avgFrameDuration),-5,5),this.avgFrameDuration>60?++this.scaleStep:this.avgFrameDuration<40&&this.scaleStep>0&&--this.scaleStep,this.scaleStep=Math.min(this.scaleStep,this.lastStep),t!==this.scaleStep&&(this.avgFrameDuration=50)}shouldRender(e){if(e.shouldRender())e.scaleStep!=this.scaleStep&&(e.scaleStep=this.scaleStep,this.rescaleCanvas(e));else{if(0==e.scaleStep)return!1;e.scaleStep=0,this.rescaleCanvas(e)}return!0}rescaleCanvas(e){const t=op[e.scaleStep],s=Math.ceil(this.width/t),i=Math.ceil(this.height/t),{style:n}=e.canvas;n.width=`${s}px`,n.height=`${i}px`,this.canvas3D.style.width=`${s}px`,this.canvas3D.style.height=`${i}px`;const a=this.dpr*t,r=t<1?"GPU throttling":this.dpr!==window.devicePixelRatio?"No meta viewport tag":"";e.element.dispatchEvent(new CustomEvent("render-scale",{detail:{reportedDpr:window.devicePixelRatio,renderedDpr:a,minimumDpr:this.dpr*op[this.lastStep],pixelWidth:Math.ceil(e.width*a),pixelHeight:Math.ceil(e.height*a),reason:r}}))}sceneSize(e){const{dpr:t}=this,s=op[e.scaleStep];return{width:Math.min(Math.ceil(e.width*s*t),this.canvas3D.width),height:Math.min(Math.ceil(e.height*s*t),this.canvas3D.height)}}copyPixels(e,t,s){const i=e.context;null!=i?(i.clearRect(0,0,t,s),i.drawImage(this.canvas3D,0,0,t,s,0,0,t,s),e.canvas.classList.add("show")):console.log("could not acquire 2d context")}orderedScenes(){const e=[];for(const t of[!1,!0])for(const s of this.scenes)s.element.modelIsVisible===t&&e.push(s);return e}get isPresenting(){return this.arRenderer.isPresenting}preRender(e,t,s){const{element:i,exposure:n,toneMapping:a}=e;i[rf](t,s);const r="number"==typeof n&&!Number.isNaN(n),o=i.environmentImage,l=i.skyboxImage,c=a===Ae&&("neutral"===o||"legacy"===o||!o&&!l);this.threeRenderer.toneMappingExposure=(r?n:1)*(c?1.3:1)}render(e,t){if(null!=t)return void this.arRenderer.onWebXRFrame(e,t);const s=e-this.lastTick;if(this.lastTick=e,!this.canRender||this.isPresenting)return;this.countVisibleScenes(),this.updateRendererSize(),this.renderedLastFrame&&(this.updateRendererScale(s),this.renderedLastFrame=!1);const{canvas3D:i}=this;for(const n of this.orderedScenes()){const{element:t}=n;if(!t.loaded||!t.modelIsVisible&&n.renderCount>0)continue;if(this.preRender(n,e,s),!this.shouldRender(n))continue;if(null!=n.externalRenderer){const e=n.getCamera();e.updateMatrix();const{matrix:t,projectionMatrix:s}=e,i=t.elements.slice(),a=n.getTarget();i[12]+=a.x,i[13]+=a.y,i[14]+=a.z,n.externalRenderer.render({viewMatrix:i,projectionMatrix:s.elements});continue}if(!t.modelIsVisible&&!this.multipleScenesVisible)for(const e of this.scenes)e.element.modelIsVisible&&e.queueRender();const{width:a,height:r}=this.sceneSize(n);n.renderShadow(this.threeRenderer),this.threeRenderer.setRenderTarget(null),this.threeRenderer.setViewport(0,Math.ceil(this.height*this.dpr)-r,a,r),null!=n.effectRenderer?n.effectRenderer.render(s):(this.threeRenderer.autoClear=!0,this.threeRenderer.toneMapping=n.toneMapping,this.threeRenderer.render(n,n.camera)),this.multipleScenesVisible||!n.element.modelIsVisible&&0===n.renderCount?this.copyPixels(n,a,r):i.parentElement!==n.canvas.parentElement&&(n.canvas.parentElement.appendChild(i),n.canvas.classList.remove("show")),n.hasRendered(),++n.renderCount,this.renderedLastFrame=!0}}dispose(){null!=this.textureUtils&&this.textureUtils.dispose(),null!=this.threeRenderer&&this.threeRenderer.dispose(),this.textureUtils=null,this.threeRenderer=null;const e=[];for(const t of this.scenes)e.push(t.element);return this.canvas3D.removeEventListener("webglcontextlost",this.onWebGLContextLost),this.canvas3D.removeEventListener("webglcontextrestored",this.onWebGLContextRestored),e}}const Ap=Symbol("correlatedObjects"),hp=Symbol("onUpdate");class dp{constructor(e,t){this[hp]=e,this[Ap]=t}}const up=new Xe,pp=new ps(2,2);let gp=0;const mp=Symbol("threeTexture"),fp=Symbol("threeTextures");class bp extends dp{get[mp](){var e;return null===(e=this[Ap])||void 0===e?void 0:e.values().next().value}get[fp](){return this[Ap]}constructor(e,t){super(e,new Set(t?[t]:[])),this[mp].image.src||(this[mp].image.src=t.name?t.name:"adhoc_image"+gp++),this[mp].image.name||(this[mp].image.name=t&&t.image&&t.image.src?t.image.src.split("/").pop():"adhoc_image")}get name(){return this[mp].image.name||""}get uri(){return this[mp].image.src}get bufferView(){return this[mp].image.bufferView}get element(){const e=this[mp];if(e&&(e.isCanvasTexture||e.isVideoTexture))return e.image}get animation(){const e=this[mp];if(e&&e.isCanvasTexture&&e.animation)return e.animation}get type(){return null!=this.uri?"external":"embedded"}set name(e){for(const t of this[fp])t.image.name=e}update(){const e=this[mp];e&&e.isCanvasTexture&&!e.animation&&(this[mp].needsUpdate=!0,this[hp]())}async createThumbnail(e,t){const s=new As;up.map=this[mp];const i=new tt(pp,up);s.add(i);const n=new ct(-1,1,1,-1,0,1),{threeRenderer:a}=cp.singleton,r=new Ss(e,t);a.setRenderTarget(r),a.render(s,n),a.setRenderTarget(null);const o=new Uint8Array(e*t*4);a.readRenderTargetPixels(r,0,0,e,t,o),Rm.width=e,Rm.height=t;const l=Rm.getContext("2d"),c=l.createImageData(e,t);return c.data.set(o),l.putImageData(c,0,0),new Promise(async(e,t)=>{Rm.toBlob(s=>{if(!s)return t("Failed to capture thumbnail.");e(URL.createObjectURL(s))},"image/png")})}}var xp,yp,vp,wp;(yp=xp||(xp={}))[yp.Nearest=9728]="Nearest",yp[yp.Linear=9729]="Linear",yp[yp.NearestMipmapNearest=9984]="NearestMipmapNearest",yp[yp.LinearMipmapNearest=9985]="LinearMipmapNearest",yp[yp.NearestMipmapLinear=9986]="NearestMipmapLinear",yp[yp.LinearMipmapLinear=9987]="LinearMipmapLinear",(wp=vp||(vp={}))[wp.ClampToEdge=33071]="ClampToEdge",wp[wp.MirroredRepeat=33648]="MirroredRepeat",wp[wp.Repeat=10497]="Repeat";const Ip=new Map([[vp.Repeat,qe],[vp.ClampToEdge,Ve],[vp.MirroredRepeat,ze]]),Cp=new Map([[qe,vp.Repeat],[Ve,vp.ClampToEdge],[ze,vp.MirroredRepeat]]),Ep=new Map([[xp.Nearest,He],[xp.Linear,Ge],[xp.NearestMipmapNearest,Oe],[xp.LinearMipmapNearest,Ue],[xp.NearestMipmapLinear,Pe],[xp.LinearMipmapLinear,Le]]),Bp=new Map([[He,xp.Nearest],[Ge,xp.Linear],[Oe,xp.NearestMipmapNearest],[Ue,xp.LinearMipmapNearest],[Pe,xp.NearestMipmapLinear],[Le,xp.LinearMipmapLinear]]),Qp=new Map([[xp.Nearest,He],[xp.Linear,Ge]]),Sp=new Map([[He,xp.Nearest],[Ge,xp.Linear]]),_p=(()=>e=>Bp.has(e))(),kp=(()=>e=>Sp.has(e))(),Tp=(()=>e=>Cp.has(e))(),Mp=Symbol("threeTexture"),Rp=Symbol("threeTextures"),Dp=Symbol("setProperty");class Np extends dp{get[Mp](){var e;return null===(e=this[Ap])||void 0===e?void 0:e.values().next().value}get[Rp](){return this[Ap]}constructor(e,t){super(e,new Set(t?[t]:[]))}get name(){return this[Mp].name||""}get minFilter(){return Bp.get(this[Mp].minFilter)}get magFilter(){return Sp.get(this[Mp].magFilter)}get wrapS(){return Cp.get(this[Mp].wrapS)}get wrapT(){return Cp.get(this[Mp].wrapT)}get rotation(){return this[Mp].rotation}get scale(){return gf(this[Mp].repeat)}get offset(){return gf(this[Mp].offset)}setMinFilter(e){this[Dp]("minFilter",Ep.get(e))}setMagFilter(e){this[Dp]("magFilter",Qp.get(e))}setWrapS(e){this[Dp]("wrapS",Ip.get(e))}setWrapT(e){this[Dp]("wrapT",Ip.get(e))}setRotation(e){null==e&&(e=0),this[Dp]("rotation",e)}setScale(e){null==e&&(e={u:1,v:1}),this[Dp]("repeat",new Be(e.u,e.v))}setOffset(e){null==e&&(e={u:0,v:0}),this[Dp]("offset",new Be(e.u,e.v))}[Dp](e,t){if(((e,t)=>{switch(e){case"minFilter":return _p(t);case"magFilter":return kp(t);case"wrapS":case"wrapT":return Tp(t);case"rotation":case"repeat":case"offset":return!0;default:throw new Error(`Cannot configure property "${e}" on Sampler`)}})(e,t))for(const s of this[Rp])s[e]=t,s.needsUpdate=!0;this[hp]()}}const Fp=Symbol("image"),jp=Symbol("sampler"),Lp=Symbol("threeTexture");class Pp extends dp{get[Lp](){var e;return null===(e=this[Ap])||void 0===e?void 0:e.values().next().value}constructor(e,t){super(e,new Set(t?[t]:[])),this[jp]=new Np(e,t),this[Fp]=new bp(e,t)}get name(){return this[Lp].name||""}set name(e){for(const t of this[Ap])t.name=e}get sampler(){return this[jp]}get source(){return this[Fp]}}var Up,Op,Gp;const Hp=Symbol("texture"),qp=Symbol("transform"),zp=Symbol("materials"),Vp=Symbol("usage"),Kp=Symbol("onUpdate"),Jp=Symbol("activeVideo");var Yp,Wp;(Wp=Yp||(Yp={}))[Wp.Base=0]="Base",Wp[Wp.MetallicRoughness=1]="MetallicRoughness",Wp[Wp.Normal=2]="Normal",Wp[Wp.Occlusion=3]="Occlusion",Wp[Wp.Emissive=4]="Emissive",Wp[Wp.Clearcoat=5]="Clearcoat",Wp[Wp.ClearcoatRoughness=6]="ClearcoatRoughness",Wp[Wp.ClearcoatNormal=7]="ClearcoatNormal",Wp[Wp.SheenColor=8]="SheenColor",Wp[Wp.SheenRoughness=9]="SheenRoughness",Wp[Wp.Transmission=10]="Transmission",Wp[Wp.Thickness=11]="Thickness",Wp[Wp.Specular=12]="Specular",Wp[Wp.SpecularColor=13]="SpecularColor",Wp[Wp.Iridescence=14]="Iridescence",Wp[Wp.IridescenceThickness=15]="IridescenceThickness",Wp[Wp.Anisotropy=16]="Anisotropy";class $p{constructor(e,t,s,i){this[Up]=null,this[Op]={rotation:0,scale:new Be(1,1),offset:new Be(0,0)},this[Gp]=!1,s&&(this[qp].rotation=s.rotation,this[qp].scale.copy(s.repeat),this[qp].offset.copy(s.offset),this[Hp]=new Pp(e,s)),this[Kp]=e,this[zp]=i,this[Vp]=t}get texture(){return this[Hp]}setTexture(e){var t,s;const i=null!=e?e.source[mp]:null,n=null===(t=this[Hp])||void 0===t?void 0:t.source[mp];if(null!=n&&n.isVideoTexture?this[Jp]=!1:(null===(s=this[Hp])||void 0===s?void 0:s.source.animation)&&this[Hp].source.animation.removeEventListener("enterFrame",this[Kp]),this[Hp]=e,null!=i&&i.isVideoTexture){const e=i.image;if(this[Jp]=!0,null!=e.requestVideoFrameCallback){const t=()=>{this[Jp]&&(this[Kp](),e.requestVideoFrameCallback(t))};e.requestVideoFrameCallback(t)}else{const e=()=>{this[Jp]&&(this[Kp](),requestAnimationFrame(e))};requestAnimationFrame(e)}}else null!=(null==e?void 0:e.source.animation)&&e.source.animation.addEventListener("enterFrame",this[Kp]);let a=ue;if(this[zp])for(const r of this[zp]){switch(this[Vp]){case Yp.Base:r.map=i;break;case Yp.MetallicRoughness:a=pe,r.metalnessMap=i,r.roughnessMap=i;break;case Yp.Normal:a=pe,r.normalMap=i;break;case Yp.Occlusion:a=pe,r.aoMap=i;break;case Yp.Emissive:r.emissiveMap=i;break;case Yp.Clearcoat:r.clearcoatMap=i;break;case Yp.ClearcoatRoughness:r.clearcoatRoughnessMap=i;break;case Yp.ClearcoatNormal:r.clearcoatNormalMap=i;break;case Yp.SheenColor:r.sheenColorMap=i;break;case Yp.SheenRoughness:r.sheenRoughnessMap=i;break;case Yp.Transmission:r.transmissionMap=i;break;case Yp.Thickness:r.thicknessMap=i;break;case Yp.Specular:r.specularIntensityMap=i;break;case Yp.SpecularColor:r.specularColorMap=i;break;case Yp.Iridescence:r.iridescenceMap=i;break;case Yp.IridescenceThickness:r.iridescenceThicknessMap=i;break;case Yp.Anisotropy:r.anisotropyMap=i}r.needsUpdate=!0}i&&(i.colorSpace=a,i.rotation=this[qp].rotation,i.repeat=this[qp].scale,i.offset=this[qp].offset),this[Kp]()}}Up=Hp,Op=qp,Gp=Jp;const Xp=Symbol("threeMaterial"),Zp=Symbol("threeMaterials"),eg=Symbol("baseColorTexture"),tg=Symbol("metallicRoughnessTexture");class sg extends dp{get[Zp](){return this[Ap]}get[Xp](){var e;return null===(e=this[Ap])||void 0===e?void 0:e.values().next().value}constructor(e,t){super(e,t);const{map:s,metalnessMap:i}=t.values().next().value;this[eg]=new $p(e,Yp.Base,s,t),this[tg]=new $p(e,Yp.MetallicRoughness,i,t)}get baseColorFactor(){const e=[0,0,0,this[Xp].opacity];return this[Xp].color.toArray(e),e}get metallicFactor(){return this[Xp].metalness}get roughnessFactor(){return this[Xp].roughness}get baseColorTexture(){return this[eg]}get metallicRoughnessTexture(){return this[tg]}setBaseColorFactor(e){const t=new be;e instanceof Array?t.fromArray(e):t.set(e);for(const s of this[Zp])s.color.set(t),e instanceof Array&&e.length>3?s.opacity=e[3]:(e=[0,0,0,s.opacity],t.toArray(e));this[hp]()}setMetallicFactor(e){for(const t of this[Zp])t.metalness=e;this[hp]()}setRoughnessFactor(e){for(const t of this[Zp])t.roughness=e;this[hp]()}}var ig,ng;const ag=Symbol("pbrMetallicRoughness"),rg=Symbol("normalTexture"),og=Symbol("occlusionTexture"),lg=Symbol("emissiveTexture"),cg=Symbol("backingThreeMaterial"),Ag=Symbol("applyAlphaCutoff"),hg=Symbol("getAlphaMode"),dg=Symbol("lazyLoadGLTFInfo"),ug=Symbol("initialize"),pg=Symbol("getLoadedMaterial"),gg=Symbol("ensureMaterialIsLoaded"),mg=Symbol("gltfIndex"),fg=Symbol("setActive"),bg=Symbol("variantIndices"),xg=Symbol("isActive"),yg=Symbol("modelVariants"),vg=Symbol("name"),wg=Symbol("pbrTextures");class Ig extends dp{get[(ig=bg,ng=wg,cg)](){return this[Ap].values().next().value}constructor(e,t,s,i,n,a,r=void 0){super(e,n),this[ig]=new Set,this[ng]=new Map,this[mg]=t,this[xg]=s,this[yg]=i,this[vg]=a,null==r?this[ug]():this[dg]=r}[ug](){const e=this[hp],t=this[Ap];this[ag]=new sg(e,t);const{normalMap:s,aoMap:i,emissiveMap:n}=t.values().next().value;this[rg]=new $p(e,Yp.Normal,s,t),this[og]=new $p(e,Yp.Occlusion,i,t),this[lg]=new $p(e,Yp.Emissive,n,t);const a=s=>{this[wg].set(s,new $p(e,s,null,t))};a(Yp.Clearcoat),a(Yp.ClearcoatRoughness),a(Yp.ClearcoatNormal),a(Yp.SheenColor),a(Yp.SheenRoughness),a(Yp.Transmission),a(Yp.Thickness),a(Yp.Specular),a(Yp.SpecularColor),a(Yp.Iridescence),a(Yp.IridescenceThickness),a(Yp.Anisotropy)}async[pg](){if(null!=this[dg]){const e=await this[dg].doLazyLoad();return this[ug](),this[dg]=void 0,this.ensureLoaded=async()=>{},e}return null}colorFromRgb(e){const t=new be;return e instanceof Array?t.fromArray(e):t.set(e),t}[gg](){if(null!=this[dg])throw new Error(`Material "${this.name}" has not been loaded, call 'await\n    myMaterial.ensureLoaded()' before using an unloaded material.`)}async ensureLoaded(){await this[pg]()}get isLoaded(){return null==this[dg]}get isActive(){return this[xg]}[fg](e){this[xg]=e}get name(){return this[vg]||""}set name(e){if(this[vg]=e,null!=this[Ap])for(const t of this[Ap])t.name=e}get pbrMetallicRoughness(){return this[gg](),this[ag]}get normalTexture(){return this[gg](),this[rg]}get occlusionTexture(){return this[gg](),this[og]}get emissiveTexture(){return this[gg](),this[lg]}get emissiveFactor(){return this[gg](),this[cg].emissive.toArray()}get index(){return this[mg]}hasVariant(e){const t=this[yg].get(e);return null!=t&&this[bg].has(t.index)}setEmissiveFactor(e){this[gg]();const t=this.colorFromRgb(e);for(const s of this[Ap])s.emissive.set(t);this[hp]()}[hg](){return this[cg].transparent?"BLEND":this[cg].alphaTest>0?"MASK":"OPAQUE"}[Ag](){this[gg]();for(const e of this[Ap])"MASK"===this[hg]()?null==e.alphaTest&&(e.alphaTest=.5):e.alphaTest=void 0,e.needsUpdate=!0}setAlphaCutoff(e){this[gg]();for(const t of this[Ap])t.alphaTest=e,t.needsUpdate=!0;this[Ag](),this[hp]()}getAlphaCutoff(){return this[gg](),this[cg].alphaTest}setDoubleSided(e){this[gg]();for(const t of this[Ap])t.side=e?$e:xt,t.needsUpdate=!0;this[hp]()}getDoubleSided(){return this[gg](),this[cg].side==$e}setAlphaMode(e){this[gg]();const t=(e,t)=>{e.transparent=t,e.depthWrite=!t};for(const s of this[Ap])t(s,"BLEND"===e),s.alphaTest="MASK"===e?.5:void 0,s.needsUpdate=!0;this[hp]()}getAlphaMode(){return this[gg](),this[hg]()}get emissiveStrength(){return this[gg](),this[cg].emissiveIntensity}setEmissiveStrength(e){this[gg]();for(const t of this[Ap])t.emissiveIntensity=e;this[hp]()}get clearcoatFactor(){return this[gg](),this[cg].clearcoat}get clearcoatRoughnessFactor(){return this[gg](),this[cg].clearcoatRoughness}get clearcoatTexture(){return this[gg](),this[wg].get(Yp.Clearcoat)}get clearcoatRoughnessTexture(){return this[gg](),this[wg].get(Yp.ClearcoatRoughness)}get clearcoatNormalTexture(){return this[gg](),this[wg].get(Yp.ClearcoatNormal)}get clearcoatNormalScale(){return this[gg](),this[cg].clearcoatNormalScale.x}setClearcoatFactor(e){this[gg]();for(const t of this[Ap])t.clearcoat=e;this[hp]()}setClearcoatRoughnessFactor(e){this[gg]();for(const t of this[Ap])t.clearcoatRoughness=e;this[hp]()}setClearcoatNormalScale(e){this[gg]();for(const t of this[Ap])t.clearcoatNormalScale=new Be(e,e);this[hp]()}get ior(){return this[gg](),this[cg].ior}setIor(e){this[gg]();for(const t of this[Ap])t.ior=e;this[hp]()}get sheenColorFactor(){return this[gg](),this[cg].sheenColor.toArray()}get sheenColorTexture(){return this[gg](),this[wg].get(Yp.SheenColor)}get sheenRoughnessFactor(){return this[gg](),this[cg].sheenRoughness}get sheenRoughnessTexture(){return this[gg](),this[wg].get(Yp.SheenRoughness)}setSheenColorFactor(e){this[gg]();const t=this.colorFromRgb(e);for(const s of this[Ap])s.sheenColor.set(t),s.sheen=1;this[hp]()}setSheenRoughnessFactor(e){this[gg]();for(const t of this[Ap])t.sheenRoughness=e,t.sheen=1;this[hp]()}get transmissionFactor(){return this[gg](),this[cg].transmission}get transmissionTexture(){return this[gg](),this[wg].get(Yp.Transmission)}setTransmissionFactor(e){this[gg]();for(const t of this[Ap])t.transmission=e;this[hp]()}get thicknessFactor(){return this[gg](),this[cg].thickness}get thicknessTexture(){return this[gg](),this[wg].get(Yp.Thickness)}get attenuationDistance(){return this[gg](),this[cg].attenuationDistance}get attenuationColor(){return this[gg](),this[cg].attenuationColor.toArray()}setThicknessFactor(e){this[gg]();for(const t of this[Ap])t.thickness=e;this[hp]()}setAttenuationDistance(e){this[gg]();for(const t of this[Ap])t.attenuationDistance=e;this[hp]()}setAttenuationColor(e){this[gg]();const t=this.colorFromRgb(e);for(const s of this[Ap])s.attenuationColor.set(t);this[hp]()}get specularFactor(){return this[gg](),this[cg].specularIntensity}get specularTexture(){return this[gg](),this[wg].get(Yp.Specular)}get specularColorFactor(){return this[gg](),this[cg].specularColor.toArray()}get specularColorTexture(){return this[gg](),this[wg].get(Yp.SheenColor)}setSpecularFactor(e){this[gg]();for(const t of this[Ap])t.specularIntensity=e;this[hp]()}setSpecularColorFactor(e){this[gg]();const t=this.colorFromRgb(e);for(const s of this[Ap])s.specularColor.set(t);this[hp]()}get iridescenceFactor(){return this[gg](),this[cg].iridescence}get iridescenceTexture(){return this[gg](),this[wg].get(Yp.Iridescence)}get iridescenceIor(){return this[gg](),this[cg].iridescenceIOR}get iridescenceThicknessMinimum(){return this[gg](),this[cg].iridescenceThicknessRange[0]}get iridescenceThicknessMaximum(){return this[gg](),this[cg].iridescenceThicknessRange[1]}get iridescenceThicknessTexture(){return this[gg](),this[wg].get(Yp.IridescenceThickness)}setIridescenceFactor(e){this[gg]();for(const t of this[Ap])t.iridescence=e;this[hp]()}setIridescenceIor(e){this[gg]();for(const t of this[Ap])t.iridescenceIOR=e;this[hp]()}setIridescenceThicknessMinimum(e){this[gg]();for(const t of this[Ap])t.iridescenceThicknessRange[0]=e;this[hp]()}setIridescenceThicknessMaximum(e){this[gg]();for(const t of this[Ap])t.iridescenceThicknessRange[1]=e;this[hp]()}get anisotropyStrength(){return this[gg](),this[cg].anisotropy}get anisotropyRotation(){return this[gg](),this[cg].anisotropyRotation}get anisotropyTexture(){return this[gg](),this[wg].get(Yp.Anisotropy)}setAnisotropyStrength(e){this[gg]();for(const t of this[Ap])t.anisotropy=e;this[hp]()}setAnisotropyRotation(e){this[gg]();for(const t of this[Ap])t.anisotropyRotation=e;this[hp]()}}let Cg=class{constructor(e){this.name="",this.children=new Array,this.name=e}};class Eg extends Cg{constructor(e,t,s,i){super(e.name),this.materials=new Map,this.variantToMaterialMap=new Map,this.initialMaterialIdx=0,this.activeMaterialIdx=0,this.mesh=e;const{gltf:n,threeGLTF:a,threeObjectMap:r}=i;this.parser=a.parser,this.modelVariants=s,this.mesh.userData.variantData=s;const o=r.get(e.material);null!=o.materials?this.initialMaterialIdx=this.activeMaterialIdx=o.materials:console.error(`Primitive (${e.name}) missing initial material reference.`);const l=e.userData.associations||{};if(null==l.meshes)return void console.error("Mesh is missing primitive index association");const c=((n.meshes||[])[l.meshes].primitives||[])[l.primitives];if(null!=c){if(null!=c.material)this.materials.set(c.material,t[c.material]);else{const e=t.findIndex(e=>"Default"===e.name);e>=0?this.materials.set(e,t[e]):console.warn("gltfPrimitive has no material!")}if(c.extensions&&c.extensions.KHR_materials_variants){const e=c.extensions.KHR_materials_variants,i=a.parser.json.extensions.KHR_materials_variants.variants;for(const n of e.mappings){const e=t[n.material];this.materials.set(n.material,e);for(const t of n.variants){const{name:n}=i[t];this.variantToMaterialMap.set(t,e),e[bg].add(t),s.has(n)||s.set(n,{name:n,index:t})}}}}else console.error("Mesh primitive definition is missing.")}async setActiveMaterial(e){const t=this.materials.get(e);if(e!==this.activeMaterialIdx){const s=t[Ap],i=await t[pg]();this.mesh.material=null!=i?i:s.values().next().value,this.parser.assignFinalMaterial(this.mesh),s.add(this.mesh.material),this.activeMaterialIdx=e}return this.mesh.material}getActiveMaterial(){return this.materials.get(this.activeMaterialIdx)}getMaterial(e){return this.materials.get(e)}async enableVariant(e){if(null==e)return this.setActiveMaterial(this.initialMaterialIdx);if(null!=this.variantToMaterialMap&&this.modelVariants.has(e)){const t=this.modelVariants.get(e);return this.enableVariantHelper(t.index)}return null}async enableVariantHelper(e){if(null!=this.variantToMaterialMap&&null!=e){const t=this.variantToMaterialMap.get(e);if(null!=t)return this.setActiveMaterial(t.index)}return null}async instantiateVariants(){if(null!=this.variantToMaterialMap)for(const e of this.variantToMaterialMap.keys()){const t=this.mesh.userData.variantMaterials.get(e);if(null!=t.material)continue;const s=await this.enableVariantHelper(e);null!=s&&(t.material=s)}}get variantInfo(){return this.variantToMaterialMap}addVariant(e,t){if(!this.ensureVariantIsUnused(t))return!1;this.modelVariants.has(t)||this.modelVariants.set(t,{name:t,index:this.modelVariants.size});const s=this.modelVariants.get(t).index;return e[bg].add(s),this.variantToMaterialMap.set(s,e),this.materials.set(e.index,e),this.updateVariantUserData(s,e),!0}deleteVariant(e){if(this.variantInfo.has(e)){this.variantInfo.delete(e);const t=this.mesh.userData.variantMaterials;null!=t&&t.delete(e)}}updateVariantUserData(e,t){t[bg].add(e),this.mesh.userData.variantData=this.modelVariants,this.mesh.userData.variantMaterials=this.mesh.userData.variantMaterials||new Map;this.mesh.userData.variantMaterials.set(e,{material:t[Ap].values().next().value,gltfMaterialIndex:t.index})}ensureVariantIsUnused(e){const t=this.modelVariants.get(e);return null==t||!this.variantInfo.has(t.index)||(console.warn(`Primitive cannot add variant '${e}' for this material, it already exists.`),!1)}}var Bg,Qg,Sg,_g,kg,Tg;const Mg=Symbol("materials"),Rg=Symbol("hierarchy"),Dg=Symbol("roots"),Ng=Symbol("primitives"),Fg=Symbol("prepareVariantsForExport"),jg=Symbol("switchVariant"),Lg=Symbol("materialFromPoint"),Pg=Symbol("nodeFromPoint"),Ug=Symbol("nodeFromIndex"),Og=Symbol("variantData"),Gg=Symbol("availableVariants"),Hg=Symbol("modelOnUpdate"),qg=Symbol("cloneMaterial");class zg{constructor(e,t,s,i){this.gltf=e,this.gltfElementMap=t,this.mapKey=s,this.doLazyLoad=i}}class Vg{constructor(e,t=()=>{}){this[Bg]=new Array,this[Qg]=new Array,this[Sg]=new Array,this[_g]=new Array,this[kg]=()=>{},this[Tg]=new Map,this[Hg]=t;const{gltf:s,threeGLTF:i,gltfElementMap:n}=e;for(const[o,l]of s.materials.entries()){const e=n.get(l);if(null!=e)this[Mg].push(new Ig(t,o,!0,this[Og],e,l.name));else{const e=(s.materials||[])[o],a=new Set;n.set(e,a);const r=async()=>{const e=await i.parser.getDependency("material",o);return a.add(e),e};this[Mg].push(new Ig(t,o,!1,this[Og],a,l.name,new zg(s,n,e,r)))}}const a=new Map,r=new Array;for(const o of i.scene.children)r.push(o);for(;r.length>0;){const t=r.pop();let s=null;t instanceof tt?(s=new Eg(t,this.materials,this[Og],e),this[Ng].push(s)):s=new Cg(t.name);const i=a.get(t);null!=i?i.children.push(s):this[Dg].push(s),this[Rg].push(s);for(const e of t.children)r.push(e),a.set(t,s)}}get materials(){return this[Mg]}[(Bg=Mg,Qg=Rg,Sg=Dg,_g=Ng,kg=Hg,Tg=Og,Gg)](){const e=Array.from(this[Og].values());return e.sort((e,t)=>e.index-t.index),e.map(e=>e.name)}getMaterialByName(e){const t=this[Mg].filter(t=>t.name===e);return t.length>0?t[0]:null}[Ug](e,t){const s=this[Rg].find(s=>{if(s instanceof Eg){const{meshes:i,primitives:n}=s.mesh.userData.associations;if(i==e&&n==t)return!0}return!1});return null==s?null:s}[Pg](e){return this[Rg].find(t=>{if(t instanceof Eg){if(t.mesh===e.object)return!0}return!1})}[Lg](e){return this[Pg](e).getActiveMaterial()}async[jg](e){for(const t of this[Ng])await t.enableVariant(e);for(const t of this.materials)t[fg](!1);for(const t of this[Ng])this.materials[t.getActiveMaterial().index][fg](!0)}async[Fg](){const e=new Array;for(const t of this[Ng])e.push(t.instantiateVariants());await Promise.all(e)}[qg](e,t){const s=this.materials[e];s.isLoaded||console.error("Cloning an unloaded material,\n           call 'material.ensureLoaded() before cloning the material.");const i=s[Ap],n=new Set;for(const[r,o]of i.entries()){const e=o.clone();e.name=t+(i.size>1?"_inst"+r:""),n.add(e)}const a=new Ig(this[Hg],this[Mg].length,!1,this[Og],n,t);return this[Mg].push(a),a}createMaterialInstanceForVariant(e,t,s,i=!0){let n=null;for(const a of this[Ng]){const i=this[Og].get(s);null!=i&&a.variantInfo.has(i.index)||null!=a.getMaterial(e)&&(this.hasVariant(s)||this.createVariant(s),null==n&&(n=this[qg](e,t)),a.addVariant(n,s))}if(i&&null!=n){n[fg](!0),this.materials[e][fg](!1);for(const e of this[Ng])e.enableVariant(s)}return n}createVariant(e){this[Og].has(e)?console.warn(`Variant '${e}'' already exists`):this[Og].set(e,{name:e,index:this[Og].size})}hasVariant(e){return this[Og].has(e)}setMaterialToVariant(e,t){if(null!=this[Gg]().find(e=>e===t))if(e<0||e>=this.materials.length)console.error("setMaterialToVariant(): materialIndex is out of bounds.");else for(const s of this[Ng]){const i=s.getMaterial(e);null!=i&&s.addVariant(i,t)}else console.warn(`Can't add material to '${t}', the variant does not exist.'`)}updateVariantName(e,t){const s=this[Og].get(e);null!=s&&(s.name=t,this[Og].set(t,s),this[Og].delete(e))}deleteVariant(e){const t=this[Og].get(e);if(null!=t){for(const s of this.materials)s.hasVariant(e)&&s[bg].delete(t.index);for(const e of this[Ng])e.deleteVariant(t.index);this[Og].delete(e)}}}var Kg=function(e,t,s,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(r=(a<3?n(r):a>3?n(t,s,r):n(t,s))||r);return a>3&&r&&Object.defineProperty(t,s,r),r};const Jg=Symbol("currentGLTF"),Yg=Symbol("originalGltfJson"),Wg=Symbol("model"),$g=Symbol("getOnUpdateMethod"),Xg=Symbol("buildTexture");class Zg extends tt{constructor(){super(void 0,new Xe({depthWrite:!1})),this.height=0,this.radius=0,this.resolution=0,this.userData.noHit=!0}get map(){return this.material.map}set map(e){this.material.map=e}isUsable(){return this.height>0&&this.radius>0&&null!=this.geometry&&null!=this.map}updateGeometry(e=this.height,t=this.radius,s=128){e==this.height&&t==this.radius&&s==this.resolution||(this.height=e,this.radius=t,this.resolution=s,e>0&&t>0&&(this.geometry.dispose(),this.geometry=function(e,t,s){const i=new Ts(t,2*s,s);i.scale(1,1,-1);const n=i.getAttribute("position"),a=new Te;for(let r=0;r<n.count;++r)if(a.fromBufferAttribute(n,r),a.y<0){const t=3*-e/2,s=a.y<t?-e/a.y:1-a.y*a.y/(3*t*t);a.multiplyScalar(s),a.toArray(n.array,3*r)}return n.needsUpdate=!0,i}(e,t,s)))}}const em=new Te,tm=new Te,sm=new Te,im=new fs,nm=new Ms,am=new Re;class rm extends nA{constructor(e){super(document.createElement("div")),this.normal=new Te(0,1,0),this.initialized=!1,this.referenceCount=1,this.pivot=document.createElement("div"),this.slot=document.createElement("slot"),this.element.classList.add("annotation-wrapper"),this.slot.name=e.name,this.element.appendChild(this.pivot),this.pivot.appendChild(this.slot),this.updatePosition(e.position),this.updateNormal(e.normal),this.surface=e.surface}get facingCamera(){return!this.element.classList.contains("hide")}show(){this.facingCamera&&this.initialized||this.updateVisibility(!0)}hide(){!this.facingCamera&&this.initialized||this.updateVisibility(!1)}increment(){this.referenceCount++}decrement(){return this.referenceCount>0&&--this.referenceCount,0===this.referenceCount}updatePosition(e){if(null==e)return;const t=bh(e)[0].terms;for(let s=0;s<3;++s)this.position.setComponent(s,_h(t[s]).number);this.updateMatrixWorld()}updateNormal(e){if(null==e)return;const t=bh(e)[0].terms;for(let s=0;s<3;++s)this.normal.setComponent(s,t[s].number)}updateSurface(){const{mesh:e,tri:t,bary:s}=this;if(null==e||null==t||null==s)return;e.getVertexPosition(t.x,em),e.getVertexPosition(t.y,tm),e.getVertexPosition(t.z,sm),em.toArray(im.elements,0),tm.toArray(im.elements,3),sm.toArray(im.elements,6),this.position.copy(s).applyMatrix3(im);const i=this.parent;i.worldToLocal(e.localToWorld(this.position)),nm.set(em,tm,sm),nm.getNormal(this.normal).transformDirection(e.matrixWorld);const n=i.parent;am.setFromAxisAngle(em.set(0,1,0),-n.rotation.y),this.normal.applyQuaternion(am)}orient(e){this.pivot.style.transform=`rotate(${e}rad)`}updateVisibility(e){this.element.classList.toggle("hide",!e),this.slot.assignedNodes().forEach(t=>{if(t.nodeType!==Node.ELEMENT_NODE)return;const s=t,i=s.dataset.visibilityAttribute;if(null!=i){const t=`data-${i}`;s.toggleAttribute(t,e)}s.dispatchEvent(new CustomEvent("hotspot-visibility",{detail:{visible:e}}))}),this.initialized=!0}}const om={name:"HorizontalBlurShader",uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform float h;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 sum = vec4( 0.0 );\n\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;\n\n\t\t\tgl_FragColor = sum;\n\n\t\t}"},lm={name:"VerticalBlurShader",uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform float v;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 sum = vec4( 0.0 );\n\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;\n\n\t\t\tgl_FragColor = sum;\n\n\t\t}"};function cm(e,t,s){return(1-s)*e+s*t}class Am extends Ne{constructor(e,t,s){super(),this.camera=new ct,this.renderTarget=null,this.renderTargetBlur=null,this.depthMaterial=new Rs,this.horizontalBlurMaterial=new Es(om),this.verticalBlurMaterial=new Es(lm),this.intensity=0,this.softness=1,this.boundingBox=new vt,this.size=new Te,this.maxDimension=0,this.isAnimated=!1,this.needsUpdate=!1;const{camera:i}=this;i.rotation.x=Math.PI/2,i.left=-.5,i.right=.5,i.bottom=-.5,i.top=.5,this.add(i);const n=new ps,a=new Xe({opacity:1,transparent:!0,side:vs});this.floor=new tt(n,a),this.floor.userData.noHit=!0,i.add(this.floor),this.blurPlane=new tt(n),this.blurPlane.visible=!1,i.add(this.blurPlane),e.target.add(this),this.depthMaterial.onBeforeCompile=function(e){e.fragmentShader=e.fragmentShader.replace("gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );","gl_FragColor = vec4( vec3( 0.0 ), ( 1.0 - fragCoordZ ) * opacity );")},this.depthMaterial.side=$e,this.horizontalBlurMaterial.depthTest=!1,this.verticalBlurMaterial.depthTest=!1,this.setScene(e,t,s)}setScene(e,t,s){const{boundingBox:i,size:n,rotation:a,position:r}=this;if(this.isAnimated=e.animationNames.length>0,this.boundingBox.copy(e.boundingBox),this.size.copy(e.size),this.maxDimension=Math.max(n.x,n.y,n.z)*(this.isAnimated?2:1),this.boundingBox.getCenter(r),"back"===s){const{min:e,max:t}=i;[e.y,e.z]=[e.z,e.y],[t.y,t.z]=[t.z,t.y],[n.y,n.z]=[n.z,n.y],a.x=Math.PI/2,a.y=Math.PI}else a.x=0,a.y=0;if(this.isAnimated){const e=i.min.y,t=i.max.y;n.y=this.maxDimension,i.expandByVector(n.subScalar(this.maxDimension).multiplyScalar(-.5)),i.min.y=e,i.max.y=t,n.set(this.maxDimension,t-e,this.maxDimension)}"bottom"===s?r.y=i.min.y:r.z=i.min.y,this.setSoftness(t)}setSoftness(e){this.softness=e;const{size:t,camera:s}=this,i=this.isAnimated?2:1,n=i*Math.pow(2,9-3*e);this.setMapSize(n);const a=t.y/2,r=t.y*i;s.near=0,s.far=cm(r,a,e),this.depthMaterial.opacity=1/e,s.updateProjectionMatrix(),this.setIntensity(this.intensity),this.setOffset(0)}setMapSize(e){const{size:t}=this;this.isAnimated&&(e*=2);const s=Math.floor(t.x>t.z?e:e*t.x/t.z),i=Math.floor(t.x>t.z?e*t.z/t.x:e),n=10+s,a=10+i;if(null==this.renderTarget||this.renderTarget.width===n&&this.renderTarget.height===a||(this.renderTarget.dispose(),this.renderTarget=null,this.renderTargetBlur.dispose(),this.renderTargetBlur=null),null==this.renderTarget){const e={format:Jt};this.renderTarget=new Ss(n,a,e),this.renderTargetBlur=new Ss(n,a,e),this.floor.material.map=this.renderTarget.texture}this.camera.scale.set(t.x*(1+10/s),t.z*(1+10/i),1),this.needsUpdate=!0}setIntensity(e){this.intensity=e,e>0?(this.visible=!0,this.floor.visible=!0,this.floor.material.opacity=e*cm(.3,1,this.softness*this.softness)):(this.visible=!1,this.floor.visible=!1)}getIntensity(){return this.intensity}setOffset(e){this.floor.position.z=-e+this.gap()}gap(){return.001*this.maxDimension}render(e,t){t.overrideMaterial=this.depthMaterial;const s=e.getClearAlpha();e.setClearAlpha(0),this.floor.visible=!1;const i=e.xr.enabled;e.xr.enabled=!1;const n=e.getRenderTarget();e.setRenderTarget(this.renderTarget),e.render(t,this.camera),t.overrideMaterial=null,this.floor.visible=!0,this.blurShadow(e),e.xr.enabled=i,e.setRenderTarget(n),e.setClearAlpha(s)}blurShadow(e){const{camera:t,horizontalBlurMaterial:s,verticalBlurMaterial:i,renderTarget:n,renderTargetBlur:a,blurPlane:r}=this;r.visible=!0,r.material=s,s.uniforms.h.value=1/this.renderTarget.width,s.uniforms.tDiffuse.value=this.renderTarget.texture,e.setRenderTarget(a),e.render(r,t),r.material=i,i.uniforms.v.value=1/this.renderTarget.height,i.uniforms.tDiffuse.value=this.renderTargetBlur.texture,e.setRenderTarget(n),e.render(r,t),r.visible=!1}dispose(){null!=this.renderTarget&&this.renderTarget.dispose(),null!=this.renderTargetBlur&&this.renderTargetBlur.dispose(),this.depthMaterial.dispose(),this.horizontalBlurMaterial.dispose(),this.verticalBlurMaterial.dispose(),this.floor.material.dispose(),this.floor.geometry.dispose(),this.blurPlane.geometry.dispose(),this.removeFromParent()}}const hm=new Te,dm=new Te,um=new Te,pm=new Ds,gm=new Te,mm=new Be;class fm extends As{constructor({canvas:e,element:t,width:s,height:i}){super(),this.annotationRenderer=new AA,this.effectRenderer=null,this.schemaElement=document.createElement("script"),this.width=1,this.height=1,this.aspect=1,this.scaleStep=0,this.renderCount=0,this.externalRenderer=null,this.appendedAnimations=[],this.markedAnimations=[],this.camera=new ot(45,1,.1,100),this.xrCamera=null,this.url=null,this.pivot=new Ne,this.target=new Ne,this.animationNames=[],this.boundingBox=new vt,this.boundingSphere=new wt,this.size=new Te,this.idealAspect=0,this.framedFoVDeg=0,this.shadow=null,this.shadowIntensity=0,this.shadowSoftness=1,this.bakedShadows=new Set,this.exposure=1,this.toneMapping=Ae,this.canScale=!0,this.isDirty=!1,this.goalTarget=new Te,this.targetDamperX=new hh,this.targetDamperY=new hh,this.targetDamperZ=new hh,this._currentGLTF=null,this._model=null,this.cancelPendingSourceChange=null,this.animationsByName=new Map,this.currentAnimationAction=null,this.groundedSkybox=new Zg,this.name="ModelScene",this.element=t,this.canvas=e,this.camera=new ot(45,1,.1,100),this.camera.name="MainCamera",this.add(this.pivot),this.pivot.name="Pivot",this.pivot.add(this.target),this.setSize(s,i),this.target.name="Target",this.mixer=new Ns(this.target);const{domElement:n}=this.annotationRenderer,{style:a}=n;a.display="none",a.pointerEvents="none",a.position="absolute",a.top="0",this.element.shadowRoot.querySelector(".default").appendChild(n),this.schemaElement.setAttribute("type","application/ld+json")}get context(){return this.canvas.getContext("2d")}getCamera(){return null!=this.xrCamera?this.xrCamera:this.camera}queueRender(){this.isDirty=!0}shouldRender(){return this.isDirty}hasRendered(){this.isDirty=!1}forceRescale(){this.scaleStep=-1,this.queueRender()}async setObject(e){this.reset(),this._model=e,this.target.add(e),await this.setupScene()}async setSource(e,t=()=>{}){if(!e||e===this.url)return void t(1);if(this.reset(),this.url=e,null!=this.externalRenderer){const e=await this.externalRenderer.load(t);return this.boundingSphere.radius=e.framedRadius,void(this.idealAspect=e.fieldOfViewAspect)}let s;null!=this.cancelPendingSourceChange&&(this.cancelPendingSourceChange(),this.cancelPendingSourceChange=null);try{s=await new Promise(async(s,i)=>{this.cancelPendingSourceChange=()=>i();try{s(await this.element[cf].loader.load(e,this.element,t))}catch(n){i(n)}})}catch(r){if(null==r)return;throw r}this.cancelPendingSourceChange=null,this.reset(),this.url=e,this._currentGLTF=s,null!=s&&(this._model=s.scene,this.target.add(s.scene));const{animations:i}=s,n=new Map,a=[];for(const o of i)n.set(o.name,o),a.push(o.name);this.animations=i,this.animationsByName=n,this.animationNames=a,await this.setupScene()}async setupScene(){this.applyTransform(),this.updateBoundingBox(),await this.updateFraming(),this.updateShadow(),this.setShadowIntensity(this.shadowIntensity),this.setGroundedSkybox()}reset(){this.url=null,this.renderCount=0,this.queueRender(),null!=this.shadow&&this.shadow.setIntensity(0),this.bakedShadows.clear();const{_model:e}=this;null!=e&&(e.removeFromParent(),this._model=null);const t=this._currentGLTF;null!=t&&(t.dispose(),this._currentGLTF=null),null!=this.currentAnimationAction&&(this.currentAnimationAction.stop(),this.currentAnimationAction=null),this.mixer.stopAllAction(),this.mixer.uncacheRoot(this)}dispose(){this.reset(),null!=this.shadow&&(this.shadow.dispose(),this.shadow=null),this.element[Jg]=null,this.element[Yg]=null,this.element[Wg]=null}get currentGLTF(){return this._currentGLTF}setSize(e,t){if(this.width!==e||this.height!==t){if(this.width=Math.max(e,1),this.height=Math.max(t,1),this.annotationRenderer.setSize(e,t),this.aspect=this.width/this.height,null!=this.externalRenderer){const s=window.devicePixelRatio;this.externalRenderer.resize(e*s,t*s)}this.queueRender()}}markBakedShadow(e){e.userData.noHit=!0,this.bakedShadows.add(e)}unmarkBakedShadow(e){e.userData.noHit=!1,e.visible=!0,this.bakedShadows.delete(e),this.boundingBox.expandByObject(e)}findBakedShadows(e){const t=new vt;e.traverse(e=>{const s=e;if(!s.material)return;if(!s.material.transparent)return;t.setFromObject(s);const i=t.getSize(gm),n=Math.min(i.x,i.y,i.z);Math.max(i.x,i.y,i.z)<100*n||this.markBakedShadow(s)})}checkBakedShadows(){const{min:e,max:t}=this.boundingBox,s=new vt;this.boundingBox.getSize(this.size);for(const i of this.bakedShadows)s.setFromObject(i),s.min.y<e.y+this.size.y/100&&s.min.x<=e.x&&s.max.x>=t.x&&s.min.z<=e.z&&s.max.z>=t.z||s.min.z<e.z+this.size.z/100&&s.min.x<=e.x&&s.max.x>=t.x&&s.min.y<=e.y&&s.max.y>=t.y||this.unmarkBakedShadow(i)}applyTransform(){const{model:e}=this;if(null==e)return;const t=bh(this.element.orientation)[0].terms,s=_h(t[0]).number,i=_h(t[1]).number,n=_h(t[2]).number;e.quaternion.setFromEuler(new bs(i,n,s,"YXZ"));const a=bh(this.element.scale)[0].terms;e.scale.set(a[0].number,a[1].number,a[2].number)}updateBoundingBox(){const{model:e}=this;if(null==e)return;this.target.remove(e),this.findBakedShadows(e);const t=(e,t)=>e.expandByPoint(t);this.setBakedShadowVisibility(!1),this.boundingBox=hA(e,t,new vt),this.boundingBox.isEmpty()&&(this.setBakedShadowVisibility(!0),this.bakedShadows.forEach(e=>this.unmarkBakedShadow(e)),this.boundingBox=hA(e,t,new vt)),this.checkBakedShadows(),this.setBakedShadowVisibility(),this.boundingBox.getSize(this.size),this.target.add(e)}async updateFraming(){const{model:e}=this;if(null==e)return;this.target.remove(e),this.setBakedShadowVisibility(!1);const{center:t}=this.boundingSphere;this.element.requestUpdate("cameraTarget"),await this.element.updateComplete,t.copy(this.getTarget());this.boundingSphere.radius=Math.sqrt(hA(e,(e,s)=>Math.max(e,t.distanceToSquared(s)),0));this.idealAspect=hA(e,(e,s)=>{s.sub(t);const i=Math.sqrt(s.x*s.x+s.z*s.z);return Math.max(e,i/(this.idealCameraDistance()-Math.abs(s.y)))},0)/Math.tan(this.framedFoVDeg/2*Math.PI/180),this.setBakedShadowVisibility(),this.target.add(e)}setBakedShadowVisibility(e=this.shadowIntensity<=0){for(const t of this.bakedShadows)t.visible=e}idealCameraDistance(){const e=this.framedFoVDeg/2*Math.PI/180;return this.boundingSphere.radius/Math.sin(e)}adjustedFoV(e){const t=Math.tan(e/2*Math.PI/180)*Math.max(1,this.idealAspect/this.aspect);return 2*Math.atan(t)*180/Math.PI}getNDC(e,t){if(null!=this.xrCamera)mm.set(e/window.screen.width,t/window.screen.height);else{const s=this.element.getBoundingClientRect();mm.set((e-s.x)/this.width,(t-s.y)/this.height)}return mm.multiplyScalar(2).subScalar(1),mm.y*=-1,mm}getSize(){return{width:this.width,height:this.height}}setEnvironmentAndSkybox(e,t){this.element[cf].arRenderer.presentedScene!==this&&(this.environment=e,this.setBackground(t),this.queueRender())}setBackground(e){this.groundedSkybox.map=e,this.groundedSkybox.isUsable()?(this.target.add(this.groundedSkybox),this.background=null):(this.target.remove(this.groundedSkybox),this.background=e)}farRadius(){return this.boundingSphere.radius*(null!=this.groundedSkybox.parent?10:1)}setGroundedSkybox(){const e=bh(this.element.skyboxHeight)[0].terms[0],t=_h(e).number,s=10*this.boundingSphere.radius;this.groundedSkybox.updateGeometry(t,s),this.groundedSkybox.position.y=t-(this.shadow?2*this.shadow.gap():0),this.setBackground(this.groundedSkybox.map)}setTarget(e,t,s){this.goalTarget.set(-e,-t,-s)}setTargetDamperDecayTime(e){this.targetDamperX.setDecayTime(e),this.targetDamperY.setDecayTime(e),this.targetDamperZ.setDecayTime(e)}getTarget(){return this.goalTarget.clone().multiplyScalar(-1)}getDynamicTarget(){return this.target.position.clone().multiplyScalar(-1)}jumpToGoal(){this.updateTarget(1e4)}updateTarget(e){const t=this.goalTarget,s=this.target.position;if(t.equals(s))return!1;{const i=this.boundingSphere.radius/10;let{x:n,y:a,z:r}=s;return n=this.targetDamperX.update(n,t.x,e,i),a=this.targetDamperY.update(a,t.y,e,i),r=this.targetDamperZ.update(r,t.z,e,i),this.groundedSkybox.position.x=-n,this.groundedSkybox.position.z=-r,this.target.position.set(n,a,r),this.target.updateMatrixWorld(),this.queueRender(),!0}}pointTowards(e,t){const{x:s,z:i}=this.position;this.yaw=Math.atan2(e-s,t-i)}get model(){return this._model}set yaw(e){this.pivot.rotation.y=e,this.groundedSkybox.rotation.y=-e,this.queueRender()}get yaw(){return this.pivot.rotation.y}set animationTime(e){this.mixer.setTime(e),this.queueShadowRender()}get animationTime(){if(null!=this.currentAnimationAction){const e=Math.max(this.currentAnimationAction._loopCount,0);return this.currentAnimationAction.loop!==Fs||1&~e?this.currentAnimationAction.time:this.duration-this.currentAnimationAction.time}return 0}set animationTimeScale(e){this.mixer.timeScale=e}get animationTimeScale(){return this.mixer.timeScale}get duration(){return null!=this.currentAnimationAction&&this.currentAnimationAction.getClip()?this.currentAnimationAction.getClip().duration:0}get hasActiveAnimation(){return null!=this.currentAnimationAction}playAnimation(e=null,t=0,s=js,i=1/0){if(null==this._currentGLTF)return;const{animations:n}=this;if(null==n||0===n.length)return;let a=null;if(null!=e&&(a=this.animationsByName.get(e),null==a)){const t=parseInt(e);!isNaN(t)&&t>=0&&t<n.length&&(a=n[t])}null==a&&(a=n[0]);try{const{currentAnimationAction:e}=this,n=this.mixer.clipAction(a,this);n.timeScale!=this.element.timeScale&&(n.timeScale=this.element.timeScale),this.currentAnimationAction=n,this.element.paused?this.mixer.stopAllAction():(n.paused=!1,null!=e&&n!==e?n.crossFadeFrom(e,t,!1):this.animationTimeScale>0&&this.animationTime==this.duration&&(this.animationTime=0)),n.setLoop(s,i),n.enabled=!0,n.clampWhenFinished=!0,n.play()}catch(r){console.error(r)}}appendAnimation(e="",t=js,s=1/0,i=1,n=1,a=!1,r=!1,o=!0,l=null,c=!1){if(null==this._currentGLTF||e===this.element.animationName)return;const{animations:A}=this;if(null==A||0===A.length)return;let h=null;if(e&&(h=this.animationsByName.get(e)),null!=h){"string"==typeof s?isNaN(s)?(s=1/0,console.warn("Invalid repetitionCount value, repetitionCount is set to Infinity")):s=Math.max(parseInt(s),1):"number"==typeof s&&s<1&&(s=1),1===s&&t!==Ls&&(t=Ls),"string"==typeof i&&(isNaN(i)?(i=1,console.warn("Invalid weight value, weight is set to 1")):i=parseFloat(i)),"string"==typeof n&&(isNaN(n)?(n=1,console.warn("Invalid timeScale value, timeScale is set to 1")):n=parseFloat(n)),"string"==typeof a&&("true"===a.toLowerCase().trim()?a=!0:"false"===a.toLowerCase().trim()?a=!1:isNaN(a)?(a=!1,console.warn("Invalid fade value, fade is set to false")):a=parseFloat(a)),"string"==typeof r&&("true"===r.toLowerCase().trim()?r=!0:"false"===r.toLowerCase().trim()?r=!1:isNaN(r)?(r=!1,console.warn("Invalid warp value, warp is set to false")):r=parseFloat(r)),"string"==typeof l&&(isNaN(l)||(l=parseFloat(l)));try{const A=this.mixer.existingAction(h)||this.mixer.clipAction(h,this),d=A.timeScale;c&&this.appendedAnimations.includes(e)&&(this.markedAnimations.map(e=>e.name).includes(e)||this.markedAnimations.push({name:e,loopMode:t,repetitionCount:s})),"number"==typeof l&&(A.time=Math.min(Math.max(l,0),h.duration)),"boolean"==typeof a&&a?A.fadeIn(1.25):"number"==typeof a?A.fadeIn(Math.max(a,0)):i>=0&&(A.weight=Math.min(Math.max(i,0),1)),"boolean"==typeof r&&r?A.warp(o?d:0,n,1.25):"number"==typeof r?A.warp(o?d:0,n,Math.max(r,0)):A.timeScale=n,A.isRunning()||(A.time==h.duration&&A.stop(),A.setLoop(t,s),A.paused=!1,A.enabled=!0,A.clampWhenFinished=!0,A.play()),this.appendedAnimations.includes(e)||this.element[nf].appendedAnimations.push(e)}catch(d){console.error(d)}}}detachAnimation(e="",t=!0){if(null==this._currentGLTF||e===this.element.animationName)return;const{animations:s}=this;if(null==s||0===s.length)return;let i=null;if(e&&(i=this.animationsByName.get(e)),null!=i){"string"==typeof t&&("true"===t.toLowerCase().trim()?t=!0:"false"===t.toLowerCase().trim()?t=!1:isNaN(t)?(t=!0,console.warn("Invalid fade value, fade is set to true")):t=parseFloat(t));try{const s=this.mixer.existingAction(i)||this.mixer.clipAction(i,this);"boolean"==typeof t&&t?s.fadeOut(1.5):"number"==typeof t?s.fadeOut(Math.max(t,0)):s.stop();const n=this.element[nf].appendedAnimations.filter(t=>t!==e);this.element[nf].appendedAnimations=n}catch(n){console.error(n)}}}updateAnimationLoop(e="",t=js,s=1/0){if(null==this._currentGLTF||e===this.element.animationName)return;const{animations:i}=this;if(null==i||0===i.length)return;let n=null;if(e&&(n=this.animationsByName.get(e)),null!=n)try{const e=this.mixer.existingAction(n)||this.mixer.clipAction(n,this);e.stop(),e.setLoop(t,s),e.play()}catch(a){console.error(a)}}stopAnimation(){this.currentAnimationAction=null,this.mixer.stopAllAction()}updateAnimation(e){this.mixer.update(e),this.queueShadowRender()}subscribeMixerEvent(e,t){this.mixer.addEventListener(e,t)}updateShadow(){const e=this.shadow;if(null!=e){const t="wall"===this.element.arPlacement?"back":"bottom";e.setScene(this,this.shadowSoftness,t),e.needsUpdate=!0}}renderShadow(e){const t=this.shadow;null!=t&&1==t.needsUpdate&&(t.render(e,this),t.needsUpdate=!1)}queueShadowRender(){null!=this.shadow&&(this.shadow.needsUpdate=!0)}setShadowIntensity(e){if(this.shadowIntensity=e,null!=this._currentGLTF&&(this.setBakedShadowVisibility(),!(e<=0&&null==this.shadow))){if(null==this.shadow){const e="wall"===this.element.arPlacement?"back":"bottom";this.shadow=new Am(this,this.shadowSoftness,e)}this.shadow.setIntensity(e)}}setShadowSoftness(e){this.shadowSoftness=e;const t=this.shadow;null!=t&&t.setSoftness(e)}setShadowOffset(e){const t=this.shadow;null!=t&&t.setOffset(e)}getHit(e=this){return pm.intersectObject(e,!0).find(e=>e.object.visible&&!e.object.userData.noHit)}hitFromController(e,t=this){return pm.setFromXRController(e),this.getHit(t)}hitFromPoint(e,t=this){return pm.setFromCamera(e,this.getCamera()),this.getHit(t)}positionAndNormalFromPoint(e,t=this){var s;const i=this.hitFromPoint(e,t);if(null==i)return null;return{position:i.point,normal:null!=i.face?i.face.normal.clone().applyNormalMatrix((new fs).getNormalMatrix(i.object.matrixWorld)):pm.ray.direction.clone().multiplyScalar(-1),uv:null!==(s=i.uv)&&void 0!==s?s:null}}surfaceFromPoint(e,t=this){const s=this.element.model;if(null==s)return null;const i=this.hitFromPoint(e,t);if(null==i||null==i.face)return null;const n=s[Pg](i),{meshes:a,primitives:r}=n.mesh.userData.associations,o=new Te,l=new Te,c=new Te,{a:A,b:h,c:d}=i.face,u=i.object;u.getVertexPosition(A,o),u.getVertexPosition(h,l),u.getVertexPosition(d,c);const p=new Ms(o,l,c),g=new Te;return p.getBarycoord(u.worldToLocal(i.point),g),`${a} ${r} ${A} ${h} ${d} ${g.x.toFixed(3)} ${g.y.toFixed(3)} ${g.z.toFixed(3)}`}addHotspot(e){this.target.add(e),this.annotationRenderer.domElement.appendChild(e.element),this.updateSurfaceHotspot(e)}removeHotspot(e){this.target.remove(e)}forHotspots(e){const{children:t}=this.target;for(let s=0,i=t.length;s<i;s++){const i=t[s];i instanceof rm&&e(i)}}updateSurfaceHotspot(e){if(null==e.surface||null==this.element.model)return;const t=bh(e.surface)[0].terms;if(8!=t.length)return void console.warn(e.surface+" does not have exactly 8 numbers.");const s=this.element.model[Ug](t[0].number,t[1].number);if(null==s)return void console.warn(e.surface+" does not match a node/primitive in this glTF! Skipping this hotspot.");const i=s.mesh.geometry.attributes.position.count,n=new Te(t[2].number,t[3].number,t[4].number);if(n.x>=i||n.y>=i||n.z>=i)return void console.warn(e.surface+" vertex indices out of range in this glTF! Skipping this hotspot.");const a=new Te(t[5].number,t[6].number,t[7].number);e.mesh=s.mesh,e.tri=n,e.bary=a,e.updateSurface()}animateSurfaceHotspots(){this.element.paused||this.forHotspots(e=>{e.updateSurface()})}updateHotspotsVisibility(e){this.forHotspots(t=>{hm.copy(e),dm.setFromMatrixPosition(t.matrixWorld),hm.sub(dm),um.copy(t.normal).transformDirection(this.target.matrixWorld),hm.dot(um)<0?t.hide():t.show()})}orientHotspots(e){this.forHotspots(t=>{t.orient(e)})}setHotspotsVisibility(e){this.forHotspots(t=>{t.visible=e})}updateSchema(e){var t;const{schemaElement:s,element:i}=this,{alt:n,poster:a,iosSrc:r}=i;if(null!=e){const i=[{"@type":"MediaObject",contentUrl:e,encodingFormat:"gltf"===(null===(t=e.split(".").pop())||void 0===t?void 0:t.toLowerCase())?"model/gltf+json":"model/gltf-binary"}];r&&i.push({"@type":"MediaObject",contentUrl:r,encodingFormat:"model/vnd.usdz+zip"});const o={"@context":"http://schema.org/","@type":"3DModel",image:null!=a?a:void 0,name:null!=n?n:void 0,encoding:i};s.textContent=JSON.stringify(o),document.head.appendChild(s)}else null!=s.parentElement&&s.parentElement.removeChild(s)}}class bm extends EventTarget{constructor(){super(...arguments),this.ongoingActivities=new Set,this.totalProgress=0}get ongoingActivityCount(){return this.ongoingActivities.size}beginActivity(e){const t={progress:0,completed:!1};return this.ongoingActivities.add(t),1===this.ongoingActivityCount&&this.announceTotalProgress(t,0,e),s=>{let i;return i=Math.max(bo(s,0,1),t.progress),i!==t.progress&&this.announceTotalProgress(t,i,e),t.progress}}announceTotalProgress(e,t,s){let i=0,n=0;1==t&&(e.completed=!0);for(const o of this.ongoingActivities){const{progress:e}=o;i+=1-e,o.completed&&n++}const a=e.progress;e.progress=t,this.totalProgress+=(t-a)*(1-this.totalProgress)/i;const r=n===this.ongoingActivityCount?1:this.totalProgress;this.dispatchEvent(new CustomEvent("progress",{detail:{totalProgress:r,reason:s}})),n===this.ongoingActivityCount&&(this.totalProgress=0,this.ongoingActivities.clear())}}var xm,ym,vm,wm,Im,Cm,Em,Bm,Qm,Sm,_m,km,Tm,Mm=function(e,t,s,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(r=(a<3?n(r):a>3?n(t,s,r):n(t,s))||r);return a>3&&r&&Object.defineProperty(t,s,r),r};const Rm=document.createElement("canvas"),Dm=Symbol("fallbackResizeHandler"),Nm=Symbol("defaultAriaLabel"),Fm=Symbol("resizeObserver"),jm=Symbol("clearModelTimeout"),Lm=Symbol("onContextLost"),Pm=Symbol("loaded"),Um=Symbol("status"),Om=Symbol("onFocus"),Gm=Symbol("onBlur"),Hm=Symbol("updateSize"),qm=Symbol("intersectionObserver"),zm=Symbol("isElementInViewport"),Vm=Symbol("announceModelVisibility"),Km=Symbol("ariaLabel"),Jm=Symbol("altDefaulted"),Ym=Symbol("statusElement"),Wm=Symbol("updateStatus"),$m=Symbol("loadedTime"),Xm=Symbol("updateSource"),Zm=Symbol("markLoaded"),ef=Symbol("container"),tf=Symbol("input"),sf=Symbol("canvas"),nf=Symbol("scene"),af=Symbol("needsRender"),rf=Symbol("tick"),of=Symbol("onModelLoad"),lf=Symbol("onResize"),cf=Symbol("renderer"),Af=Symbol("progressTracker"),hf=Symbol("getLoaded"),df=Symbol("getModelIsVisible"),uf=Symbol("shouldAttemptPreload"),pf=e=>({x:e.x,y:e.y,z:e.z,toString(){return`${this.x}m ${this.y}m ${this.z}m`}}),gf=e=>({u:e.x,v:e.y,toString(){return`${this.u} ${this.v}`}});class mf extends Ar{static get is(){return"model-viewer"}static set modelCacheSize(e){iA[tA].evictionThreshold=e}static get modelCacheSize(){return iA[tA].evictionThreshold}static set minimumRenderScale(e){e>1&&console.warn("<model-viewer> minimumRenderScale has been clamped to a maximum value of 1."),e<=0&&console.warn("<model-viewer> minimumRenderScale has been clamped to a minimum value of 0.25."),cp.singleton.minScale=e}static get minimumRenderScale(){return cp.singleton.minScale}get loaded(){return this[hf]()}get[(xm=zm,ym=Pm,vm=$m,wm=Um,Im=jm,Cm=Dm,Em=Vm,Bm=Fm,Qm=qm,Sm=Af,cf)](){return cp.singleton}get modelIsVisible(){return this[df]()}constructor(){super(),this.alt=null,this.src=null,this.withCredentials=!1,this.generateSchema=!1,this[xm]=!1,this[ym]=!1,this[vm]=0,this[wm]="",this[Im]=null,this[Cm]=fo(()=>{const e=this.getBoundingClientRect();this[Hm](e)},50),this[Em]=fo(e=>{const t=this.modelIsVisible;t!==e&&this.dispatchEvent(new CustomEvent("model-visibility",{detail:{visible:t}}))},0),this[Bm]=null,this[Qm]=null,this[Sm]=new bm,this[_m]=()=>{this[Ym].textContent=this[Um]},this[km]=()=>{this[Ym].textContent=""},this[Tm]=e=>{this.dispatchEvent(new CustomEvent("error",{detail:{type:"webglcontextlost",sourceError:e.sourceEvent}}))},this.attachShadow({mode:"open"});const e=this.shadowRoot;let t,s;if((e=>{$r(Eo,e)})(e),this[ef]=e.querySelector(".container"),this[tf]=e.querySelector(".userInput"),this[sf]=e.querySelector("canvas"),this[Ym]=e.querySelector("#status"),this[Nm]=this[tf].getAttribute("aria-label"),this.isConnected){const e=this.getBoundingClientRect();t=e.width,s=e.height}else t=300,s=150;this[nf]=new fm({canvas:this[sf],element:this,width:t,height:s}),Promise.resolve().then(()=>{this[Hm](this.getBoundingClientRect())}),io&&(this[Fm]=new ResizeObserver(e=>{if(!this[cf].isPresenting)for(let t of e)t.target===this&&this[Hm](t.contentRect)})),no?this[qm]=new IntersectionObserver(e=>{for(let t of e)if(t.target===this){const e=this.modelIsVisible;this[zm]=t.isIntersecting,this[Vm](e),this[zm]&&!this.loaded&&this[Xm]()}},{root:null,rootMargin:"0px",threshold:1e-5}):this[zm]=!0}connectedCallback(){super.connectedCallback&&super.connectedCallback(),io?this[Fm].observe(this):self.addEventListener("resize",this[Dm]),no&&this[qm].observe(this),this.addEventListener("focus",this[Om]),this.addEventListener("blur",this[Gm]);const e=this[cf];e.addEventListener("contextlost",this[Lm]),e.registerScene(this[nf]),null!=this[jm]&&(self.clearTimeout(this[jm]),this[jm]=null,this.requestUpdate("src",null))}disconnectedCallback(){super.disconnectedCallback&&super.disconnectedCallback(),io?this[Fm].unobserve(this):self.removeEventListener("resize",this[Dm]),no&&this[qm].unobserve(this),this.removeEventListener("focus",this[Om]),this.removeEventListener("blur",this[Gm]);const e=this[cf];e.removeEventListener("contextlost",this[Lm]),e.unregisterScene(this[nf]),this[jm]=self.setTimeout(()=>{this[nf].dispose(),this[jm]=null},10)}updated(e){super.updated(e),e.has("src")&&(null==this.src?(this[Pm]=!1,this[$m]=0,this[nf].reset()):this.src!==this[nf].url&&(this[Pm]=!1,this[$m]=0,this[Xm]())),e.has("alt")&&this[tf].setAttribute("aria-label",this[Km]),e.has("generateSchema")&&(this.generateSchema?this[nf].updateSchema(this.src):this[nf].updateSchema(null))}toDataURL(e,t){return this[cf].displayCanvas(this[nf]).toDataURL(e,t)}async toBlob(e){const t=e?e.mimeType:void 0,s=e?e.qualityArgument:void 0,i=e?e.idealAspect:void 0,{width:n,height:a,idealAspect:r,aspect:o}=this[nf],{dpr:l,scaleFactor:c}=this[cf];let A=n*c*l,h=a*c*l,d=0,u=0;if(!0===i)if(r>o){const e=h;h=Math.round(A/r),u=(e-h)/2}else{const e=A;A=Math.round(h*r),d=(e-A)/2}Rm.width=A,Rm.height=h;try{return new Promise(async(e,i)=>{Rm.getContext("2d").drawImage(this[cf].displayCanvas(this[nf]),d,u,A,h,0,0,A,h),Rm.toBlob(t=>{if(!t)return i(new Error("Unable to retrieve canvas blob"));e(t)},t,s)})}finally{this[Hm]({width:n,height:a})}}registerEffectComposer(e){e.setRenderer(this[cf].threeRenderer),e.setMainCamera(this[nf].getCamera()),e.setMainScene(this[nf]),this[nf].effectRenderer=e}unregisterEffectComposer(){this[nf].effectRenderer=null}registerRenderer(e){this[nf].externalRenderer=e}unregisterRenderer(){this[nf].externalRenderer=null}get[Km](){return this[Jm]}get[Jm](){return null==this.alt||"null"===this.alt?this[Nm]:this.alt}[hf](){return this[Pm]}[df](){return this.loaded&&this[zm]}[uf](){return!!this.src&&this[zm]}[Hm]({width:e,height:t}){0!==e&&0!==t&&(this[ef].style.width=`${e}px`,this[ef].style.height=`${t}px`,this[lf]({width:e,height:t}))}[rf](e,t){var s;null===(s=this[nf].effectRenderer)||void 0===s||s.beforeRender(e,t)}[Zm](){this[Pm]||(this[Pm]=!0,this[$m]=performance.now())}[af](){this[nf].queueRender()}[of](){}[Wm](e){this[Um]=e;const t=this.getRootNode();null!=t&&t.activeElement===this&&this[Ym].textContent!=e&&(this[Ym].textContent=e)}[(_m=Om,km=Gm,lf)](e){this[nf].setSize(e.width,e.height)}async[(Tm=Lm,Xm)](){const e=this[nf];if(this.loaded||!this[uf]()||this.src===e.url)return;this.generateSchema&&e.updateSchema(this.src),this[Wm]("Loading"),e.stopAnimation();const t=this[Af].beginActivity("model-load"),s=this.src;try{const i=e.setSource(s,e=>t(.95*bo(e,0,1))),n=this[Io]();await Promise.all([i,n]),this[Zm](),this[of](),this.updateComplete.then(()=>{this.dispatchEvent(new CustomEvent("before-render"))}),await new Promise(e=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{this.dispatchEvent(new CustomEvent("load",{detail:{url:s}})),e()})})})}catch(i){this.dispatchEvent(new CustomEvent("error",{detail:{type:"loadfailure",sourceError:i}}))}finally{t(1)}}}Mm([ur({type:String})],mf.prototype,"alt",void 0),Mm([ur({type:String})],mf.prototype,"src",void 0),Mm([ur({type:Boolean,attribute:"with-credentials"})],mf.prototype,"withCredentials",void 0),Mm([ur({type:Boolean,attribute:"generate-schema"})],mf.prototype,"generateSchema",void 0);var ff=function(e,t,s,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(r=(a<3?n(r):a>3?n(t,s,r):n(t,s))||r);return a>3&&r&&Object.defineProperty(t,s,r),r};const bf=Symbol("changeAnimation"),xf=Symbol("appendAnimation"),yf=Symbol("detachAnimation"),vf=Symbol("paused"),wf={repetitions:1/0,pingpong:!1},If={pingpong:!1,repetitions:null,weight:1,timeScale:1,fade:!1,warp:!1,relativeWarp:!0,time:null},Cf={fade:!0},Ef=Symbol("hotspotMap"),Bf=Symbol("mutationCallback"),Qf=Symbol("observer"),Sf=Symbol("addHotspot"),_f=Symbol("removeHotspot"),kf=new ke;var Tf=Uint8Array,Mf=Uint16Array,Rf=Int32Array,Df=new Tf([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Nf=new Tf([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Ff=new Tf([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),jf=function(e,t){for(var s=new Mf(31),i=0;i<31;++i)s[i]=t+=1<<e[i-1];var n=new Rf(s[30]);for(i=1;i<30;++i)for(var a=s[i];a<s[i+1];++a)n[a]=a-s[i]<<5|i;return{b:s,r:n}},Lf=jf(Df,2),Pf=Lf.b,Uf=Lf.r;Pf[28]=258,Uf[258]=28;for(var Of=jf(Nf,0).r,Gf=new Mf(32768),Hf=0;Hf<32768;++Hf){var qf=(43690&Hf)>>1|(21845&Hf)<<1;qf=(61680&(qf=(52428&qf)>>2|(13107&qf)<<2))>>4|(3855&qf)<<4,Gf[Hf]=((65280&qf)>>8|(255&qf)<<8)>>1}var zf=function(e,t,s){for(var i=e.length,n=0,a=new Mf(t);n<i;++n)e[n]&&++a[e[n]-1];var r,o=new Mf(t);for(n=1;n<t;++n)o[n]=o[n-1]+a[n-1]<<1;if(s){r=new Mf(1<<t);var l=15-t;for(n=0;n<i;++n)if(e[n])for(var c=n<<4|e[n],A=t-e[n],h=o[e[n]-1]++<<A,d=h|(1<<A)-1;h<=d;++h)r[Gf[h]>>l]=c}else for(r=new Mf(i),n=0;n<i;++n)e[n]&&(r[n]=Gf[o[e[n]-1]++]>>15-e[n]);return r},Vf=new Tf(288);for(Hf=0;Hf<144;++Hf)Vf[Hf]=8;for(Hf=144;Hf<256;++Hf)Vf[Hf]=9;for(Hf=256;Hf<280;++Hf)Vf[Hf]=7;for(Hf=280;Hf<288;++Hf)Vf[Hf]=8;var Kf=new Tf(32);for(Hf=0;Hf<32;++Hf)Kf[Hf]=5;var Jf=zf(Vf,9,0),Yf=zf(Kf,5,0),Wf=function(e){return(e+7)/8|0},$f=function(e,t,s){return(null==s||s>e.length)&&(s=e.length),new Tf(e.subarray(t,s))},Xf=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Zf=function(e,t,s){var i=new Error(t||Xf[e]);if(i.code=e,Error.captureStackTrace&&Error.captureStackTrace(i,Zf),!s)throw i;return i},eb=function(e,t,s){s<<=7&t;var i=t/8|0;e[i]|=s,e[i+1]|=s>>8},tb=function(e,t,s){s<<=7&t;var i=t/8|0;e[i]|=s,e[i+1]|=s>>8,e[i+2]|=s>>16},sb=function(e,t){for(var s=[],i=0;i<e.length;++i)e[i]&&s.push({s:i,f:e[i]});var n=s.length,a=s.slice();if(!n)return{t:cb,l:0};if(1==n){var r=new Tf(s[0].s+1);return r[s[0].s]=1,{t:r,l:1}}s.sort(function(e,t){return e.f-t.f}),s.push({s:-1,f:25001});var o=s[0],l=s[1],c=0,A=1,h=2;for(s[0]={s:-1,f:o.f+l.f,l:o,r:l};A!=n-1;)o=s[s[c].f<s[h].f?c++:h++],l=s[c!=A&&s[c].f<s[h].f?c++:h++],s[A++]={s:-1,f:o.f+l.f,l:o,r:l};var d=a[0].s;for(i=1;i<n;++i)a[i].s>d&&(d=a[i].s);var u=new Mf(d+1),p=ib(s[A-1],u,0);if(p>t){i=0;var g=0,m=p-t,f=1<<m;for(a.sort(function(e,t){return u[t.s]-u[e.s]||e.f-t.f});i<n;++i){var b=a[i].s;if(!(u[b]>t))break;g+=f-(1<<p-u[b]),u[b]=t}for(g>>=m;g>0;){var x=a[i].s;u[x]<t?g-=1<<t-u[x]++-1:++i}for(;i>=0&&g;--i){var y=a[i].s;u[y]==t&&(--u[y],++g)}p=t}return{t:new Tf(u),l:p}},ib=function(e,t,s){return-1==e.s?Math.max(ib(e.l,t,s+1),ib(e.r,t,s+1)):t[e.s]=s},nb=function(e){for(var t=e.length;t&&!e[--t];);for(var s=new Mf(++t),i=0,n=e[0],a=1,r=function(e){s[i++]=e},o=1;o<=t;++o)if(e[o]==n&&o!=t)++a;else{if(!n&&a>2){for(;a>138;a-=138)r(32754);a>2&&(r(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(r(n),--a;a>6;a-=6)r(8304);a>2&&(r(a-3<<5|8208),a=0)}for(;a--;)r(n);a=1,n=e[o]}return{c:s.subarray(0,i),n:t}},ab=function(e,t){for(var s=0,i=0;i<t.length;++i)s+=e[i]*t[i];return s},rb=function(e,t,s){var i=s.length,n=Wf(t+2);e[n]=255&i,e[n+1]=i>>8,e[n+2]=255^e[n],e[n+3]=255^e[n+1];for(var a=0;a<i;++a)e[n+a+4]=s[a];return 8*(n+4+i)},ob=function(e,t,s,i,n,a,r,o,l,c,A){eb(t,A++,s),++n[256];for(var h=sb(n,15),d=h.t,u=h.l,p=sb(a,15),g=p.t,m=p.l,f=nb(d),b=f.c,x=f.n,y=nb(g),v=y.c,w=y.n,I=new Mf(19),C=0;C<b.length;++C)++I[31&b[C]];for(C=0;C<v.length;++C)++I[31&v[C]];for(var E=sb(I,7),B=E.t,Q=E.l,S=19;S>4&&!B[Ff[S-1]];--S);var _,k,T,M,R=c+5<<3,D=ab(n,Vf)+ab(a,Kf)+r,N=ab(n,d)+ab(a,g)+r+14+3*S+ab(I,B)+2*I[16]+3*I[17]+7*I[18];if(l>=0&&R<=D&&R<=N)return rb(t,A,e.subarray(l,l+c));if(eb(t,A,1+(N<D)),A+=2,N<D){_=zf(d,u,0),k=d,T=zf(g,m,0),M=g;var F=zf(B,Q,0);eb(t,A,x-257),eb(t,A+5,w-1),eb(t,A+10,S-4),A+=14;for(C=0;C<S;++C)eb(t,A+3*C,B[Ff[C]]);A+=3*S;for(var j=[b,v],L=0;L<2;++L){var P=j[L];for(C=0;C<P.length;++C){var U=31&P[C];eb(t,A,F[U]),A+=B[U],U>15&&(eb(t,A,P[C]>>5&127),A+=P[C]>>12)}}}else _=Jf,k=Vf,T=Yf,M=Kf;for(C=0;C<o;++C){var O=i[C];if(O>255){tb(t,A,_[(U=O>>18&31)+257]),A+=k[U+257],U>7&&(eb(t,A,O>>23&31),A+=Df[U]);var G=31&O;tb(t,A,T[G]),A+=M[G],G>3&&(tb(t,A,O>>5&8191),A+=Nf[G])}else tb(t,A,_[O]),A+=k[O]}return tb(t,A,_[256]),A+k[256]},lb=new Rf([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),cb=new Tf(0),Ab=function(){for(var e=new Int32Array(256),t=0;t<256;++t){for(var s=t,i=9;--i;)s=(1&s&&-306674912)^s>>>1;e[t]=s}return e}(),hb=function(){var e=-1;return{p:function(t){for(var s=e,i=0;i<t.length;++i)s=Ab[255&s^t[i]]^s>>>8;e=s},d:function(){return~e}}},db=function(e,t,s,i,n){if(!n&&(n={l:1},t.dictionary)){var a=t.dictionary.subarray(-32768),r=new Tf(a.length+e.length);r.set(a),r.set(e,a.length),e=r,n.w=a.length}return function(e,t,s,i,n,a){var r=a.z||e.length,o=new Tf(i+r+5*(1+Math.ceil(r/7e3))+n),l=o.subarray(i,o.length-n),c=a.l,A=7&(a.r||0);if(t){A&&(l[0]=a.r>>3);for(var h=lb[t-1],d=h>>13,u=8191&h,p=(1<<s)-1,g=a.p||new Mf(32768),m=a.h||new Mf(p+1),f=Math.ceil(s/3),b=2*f,x=function(t){return(e[t]^e[t+1]<<f^e[t+2]<<b)&p},y=new Rf(25e3),v=new Mf(288),w=new Mf(32),I=0,C=0,E=a.i||0,B=0,Q=a.w||0,S=0;E+2<r;++E){var _=x(E),k=32767&E,T=m[_];if(g[k]=T,m[_]=k,Q<=E){var M=r-E;if((I>7e3||B>24576)&&(M>423||!c)){A=ob(e,l,0,y,v,w,C,B,S,E-S,A),B=I=C=0,S=E;for(var R=0;R<286;++R)v[R]=0;for(R=0;R<30;++R)w[R]=0}var D=2,N=0,F=u,j=k-T&32767;if(M>2&&_==x(E-j))for(var L=Math.min(d,M)-1,P=Math.min(32767,E),U=Math.min(258,M);j<=P&&--F&&k!=T;){if(e[E+D]==e[E+D-j]){for(var O=0;O<U&&e[E+O]==e[E+O-j];++O);if(O>D){if(D=O,N=j,O>L)break;var G=Math.min(j,O-2),H=0;for(R=0;R<G;++R){var q=E-j+R&32767,z=q-g[q]&32767;z>H&&(H=z,T=q)}}}j+=(k=T)-(T=g[k])&32767}if(N){y[B++]=268435456|Uf[D]<<18|Of[N];var V=31&Uf[D],K=31&Of[N];C+=Df[V]+Nf[K],++v[257+V],++w[K],Q=E+D,++I}else y[B++]=e[E],++v[e[E]]}}for(E=Math.max(E,Q);E<r;++E)y[B++]=e[E],++v[e[E]];A=ob(e,l,c,y,v,w,C,B,S,E-S,A),c||(a.r=7&A|l[A/8|0]<<3,A-=7,a.h=m,a.p=g,a.i=E,a.w=Q)}else{for(E=a.w||0;E<r+c;E+=65535){var J=E+65535;J>=r&&(l[A/8|0]=c,J=r),A=rb(l,A+1,e.subarray(E,J))}a.i=r}return $f(o,0,i+Wf(A)+n)}(e,null==t.level?6:t.level,null==t.mem?n.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):20:12+t.mem,s,i,n)},ub=function(e,t){var s={};for(var i in e)s[i]=e[i];for(var i in t)s[i]=t[i];return s},pb=function(e,t,s){for(;s;++t)e[t]=s,s>>>=8};function gb(e,t){return db(e,t||{},0,0)}var mb=function(e,t,s,i){for(var n in e){var a=e[n],r=t+n,o=i;Array.isArray(a)&&(o=ub(i,a[1]),a=a[0]),a instanceof Tf?s[r]=[a,o]:(s[r+="/"]=[new Tf(0),o],mb(a,r,s,i))}},fb="undefined"!=typeof TextEncoder&&new TextEncoder,bb="undefined"!=typeof TextDecoder&&new TextDecoder;try{bb.decode(cb,{stream:!0})}catch(hv){}function xb(e,t){if(fb)return fb.encode(e);for(var s=e.length,i=new Tf(e.length+(e.length>>1)),n=0,a=function(e){i[n++]=e},r=0;r<s;++r){if(n+5>i.length){var o=new Tf(n+8+(s-r<<1));o.set(i),i=o}var l=e.charCodeAt(r);l<128||t?a(l):l<2048?(a(192|l>>6),a(128|63&l)):l>55295&&l<57344?(a(240|(l=65536+(1047552&l)|1023&e.charCodeAt(++r))>>18),a(128|l>>12&63),a(128|l>>6&63),a(128|63&l)):(a(224|l>>12),a(128|l>>6&63),a(128|63&l))}return $f(i,0,n)}var yb=function(e){var t=0;if(e)for(var s in e){var i=e[s].length;i>65535&&Zf(9),t+=i+4}return t},vb=function(e,t,s,i,n,a,r,o){var l=i.length,c=s.extra,A=o&&o.length,h=yb(c);pb(e,t,null!=r?33639248:67324752),t+=4,null!=r&&(e[t++]=20,e[t++]=s.os),e[t]=20,t+=2,e[t++]=s.flag<<1|(a<0&&8),e[t++]=n&&8,e[t++]=255&s.compression,e[t++]=s.compression>>8;var d=new Date(null==s.mtime?Date.now():s.mtime),u=d.getFullYear()-1980;if((u<0||u>119)&&Zf(10),pb(e,t,u<<25|d.getMonth()+1<<21|d.getDate()<<16|d.getHours()<<11|d.getMinutes()<<5|d.getSeconds()>>1),t+=4,-1!=a&&(pb(e,t,s.crc),pb(e,t+4,a<0?-a-2:a),pb(e,t+8,s.size)),pb(e,t+12,l),pb(e,t+14,h),t+=16,null!=r&&(pb(e,t,A),pb(e,t+6,s.attrs),pb(e,t+10,r),t+=14),e.set(i,t),t+=l,h)for(var p in c){var g=c[p],m=g.length;pb(e,t,+p),pb(e,t+2,m),e.set(g,t+4),t+=4+m}return A&&(e.set(o,t),t+=A),t};function wb(e,t){t||(t={});var s={},i=[];mb(e,"",s,t);var n=0,a=0;for(var r in s){var o=s[r],l=o[0],c=o[1],A=0==c.level?0:8,h=(I=xb(r)).length,d=c.comment,u=d&&xb(d),p=u&&u.length,g=yb(c.extra);h>65535&&Zf(11);var m=A?gb(l,c):l,f=m.length,b=hb();b.p(l),i.push(ub(c,{size:l.length,crc:b.d(),c:m,f:I,m:u,u:h!=r.length||u&&d.length!=p,o:n,compression:A})),n+=30+h+g+f,a+=76+2*(h+g)+(p||0)+f}for(var x=new Tf(a+22),y=n,v=a-n,w=0;w<i.length;++w){var I=i[w];vb(x,I.o,I,I.f,I.u,I.c.length);var C=30+I.f.length+yb(I.extra);x.set(I.c,I.o+C),vb(x,n,I,I.f,I.u,I.c.length,I.o,I.m),n+=16+C+(I.m?I.m.length:0)}return function(e,t,s,i,n){pb(e,t,101010256),pb(e,t+8,s),pb(e,t+10,s),pb(e,t+12,i),pb(e,t+16,n)}(x,n,i.length,v,y),x}class Ib{constructor(e,t="",s=[],i=[]){this.name=e,this.type=t,this.metadata=s,this.properties=i,this.children=[]}addMetadata(e,t){this.metadata.push({key:e,value:t})}addProperty(e,t=[]){this.properties.push({property:e,metadata:t})}addChild(e){this.children.push(e)}toString(e=0){const t="\t".repeat(e),s=this.metadata.map(e=>{const s=e.key,i=e.value;if(Array.isArray(i)){const e=[];return e.push(`${s} = {`),i.forEach(s=>{e.push(`${t}\t\t${s}`)}),e.push(`${t}\t}`),e.join("\n")}return`${s} = ${i}`}),i=s.length?` (\n${s.map(e=>`${t}\t${e}`).join("\n")}\n${t})`:"",n=this.properties.map(e=>{const s=e.property,i=e.metadata.length?` (\n${e.metadata.map(e=>`${t}\t\t${e}`).join("\n")}\n${t}\t)`:"";return`${t}\t${s}${i}`}),a=this.children.map(t=>t.toString(e+1)),r=[];if(n.length>0&&r.push(...n),a.length>0){n.length>0&&r.push("");for(let e=0;e<a.length;e++)r.push(a[e]),e<a.length-1&&r.push("")}const o=r.join("\n"),l=this.type?this.type+" ":"";return`${t}def ${l}"${this.name}"${i}\n${t}{\n${o}\n${t}}`}}class Cb{constructor(){this.textureUtils=null}setTextureUtils(e){this.textureUtils=e}parse(e,t,s,i){this.parseAsync(e,i).then(t).catch(s)}async parseAsync(e,t={}){t=Object.assign({ar:{anchoring:{type:"plane"},planeAnchoring:{alignment:"horizontal"}},includeAnchoringProperties:!0,onlyVisible:!0,quickLookCompatible:!1,maxTextureSize:1024},t);const s=new Set,i={},n="model.usda";i[n]=null;const a=new Ib("Root","Xform"),r=new Ib("Scenes","Scope");r.addMetadata("kind",'"sceneLibrary"'),a.addChild(r);const o="Scene",l=new Ib(o,"Xform");let c;l.addMetadata("customData",["bool preliminary_collidesWithEnvironment = 0",`string sceneName = "${o}"`]),l.addMetadata("sceneName",`"${o}"`),t.includeAnchoringProperties&&(l.addProperty(`token preliminary:anchoring:type = "${t.ar.anchoring.type}"`),l.addProperty(`token preliminary:planeAnchoring:alignment = "${t.ar.planeAnchoring.alignment}"`)),r.addChild(l);const A={},h={};_b(e,l,A,s,i,t);const d=function(e,t,s=!1){const i=new Ib("Materials");for(const n in e){const a=e[n];i.addChild(jb(a,t,s))}return i}(A,h,t.quickLookCompatible);c=Sb()+"\n"+a.toString()+"\n\n"+d.toString(),i[n]=xb(c),c=null;for(const p in h){let e=h[p];if(!0===e.isCompressedTexture){if(null===this.textureUtils)throw new Error("THREE.USDZExporter: setTextureUtils() must be called to process compressed textures.");e=await this.textureUtils.decompress(e)}const s=Bb(e.image,e.flipY,t.maxTextureSize),n=await new Promise(e=>s.toBlob(e,"image/png",1));i[`textures/Texture_${p}.png`]=new Uint8Array(await n.arrayBuffer())}let u=0;for(const p in i){const e=i[p];u+=34+p.length;const t=63&u;if(4!==t){const s=new Uint8Array(64-t);i[p]=[e,{extra:{12345:s}}]}u=e.length}return wb(i,{level:0})}}function Eb(e,t){let s=e.name;return s=s.replace(/[^A-Za-z0-9_]/g,""),/^[0-9]/.test(s)&&(s="_"+s),""===s&&(s=e.isCamera?"Camera":"Object"),t.has(s)&&(s=s+"_"+e.id),t.add(s),s}function Bb(e,t,s){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const i=s/Math.max(e.width,e.height),n=document.createElement("canvas");n.width=e.width*Math.min(1,i),n.height=e.height*Math.min(1,i);const a=n.getContext("2d");return!0===t&&(a.translate(0,n.height),a.scale(1,-1)),a.drawImage(e,0,0,n.width,n.height),n}throw new Error("THREE.USDZExporter: No valid image data found. Unable to process texture.")}const Qb=7;function Sb(){return'#usda 1.0\n(\n\tcustomLayerData = {\n\t\tstring creator = "Three.js USDZExporter"\n\t}\n\tdefaultPrim = "Root"\n\tmetersPerUnit = 1\n\tupAxis = "Y"\n)\n'}function _b(e,t,s,i,n,a){for(let r=0,o=e.children.length;r<o;r++){const o=e.children[r];if(!1===o.visible&&!0===a.onlyVisible)continue;let l;if(o.isMesh){const e=o.geometry,t=o.material;if(t.isMeshStandardMaterial){const a="geometries/Geometry_"+e.id+".usda";if(!(a in n)){const t=Db(e);n[a]=xb(Sb()+"\n"+t.toString())}t.uuid in s||(s[t.uuid]=t),l=Tb(o,e,s[t.uuid],i)}else console.warn("THREE.USDZExporter: Unsupported material type (USDZ only supports MeshStandardMaterial)",o)}else l=o.isCamera?Ub(o,i):kb(o,i);l&&(t.addChild(l),_b(o,l,s,i,n,a))}}function kb(e,t){const s=Eb(e,t),i=Mb(e.matrix);e.matrix.determinant()<0&&console.warn("THREE.USDZExporter: USDZ does not support negative scales",e);const n=new Ib(s,"Xform");return n.addProperty(`matrix4d xformOp:transform = ${i}`),n.addProperty('uniform token[] xformOpOrder = ["xformOp:transform"]'),n}function Tb(e,t,s,i){const n=kb(e,i);return n.addMetadata("prepend references",`@./geometries/Geometry_${t.id}.usda@</Geometry>`),n.addMetadata("prepend apiSchemas",'["MaterialBindingAPI"]'),n.addProperty(`rel material:binding = </Materials/Material_${s.id}>`),n}function Mb(e){const t=e.elements;return`( ${Rb(t,0)}, ${Rb(t,4)}, ${Rb(t,8)}, ${Rb(t,12)} )`}function Rb(e,t){return`(${e[t+0]}, ${e[t+1]}, ${e[t+2]}, ${e[t+3]})`}function Db(e){const t=new Ib("Geometry"),s=function(e){const t="Geometry",s=e.attributes,i=s.position.count,n=new Ib(t,"Mesh");n.addProperty(`int[] faceVertexCounts = [${function(e){const t=null!==e.index?e.index.count:e.attributes.position.count;return Array(t/3).fill(3).join(", ")}(e)}]`),n.addProperty(`int[] faceVertexIndices = [${function(e){const t=e.index,s=[];if(null!==t)for(let i=0;i<t.count;i++)s.push(t.getX(i));else{const t=e.attributes.position.count;for(let e=0;e<t;e++)s.push(e)}return s.join(", ")}(e)}]`),n.addProperty(`normal3f[] normals = [${Nb(s.normal,i)}]`,['interpolation = "vertex"']),n.addProperty(`point3f[] points = [${Nb(s.position,i)}]`);for(let r=0;r<4;r++){const e=r>0?r:"",t=s["uv"+e];void 0!==t&&n.addProperty(`texCoord2f[] primvars:st${e} = [${Fb(t)}]`,['interpolation = "vertex"'])}const a=s.color;void 0!==a&&n.addProperty(`color3f[] primvars:displayColor = [${Nb(a,i)}]`,['interpolation = "vertex"']);return n.addProperty('uniform token subdivisionScheme = "none"'),n}(e);return t.addChild(s),t}function Nb(e,t){if(void 0===e)return console.warn("USDZExporter: Normals missing."),Array(t).fill("(0, 0, 0)").join(", ");const s=[];for(let i=0;i<e.count;i++){const t=e.getX(i),n=e.getY(i),a=e.getZ(i);s.push(`(${t.toPrecision(Qb)}, ${n.toPrecision(Qb)}, ${a.toPrecision(Qb)})`)}return s.join(", ")}function Fb(e){const t=[];for(let s=0;s<e.count;s++){const i=e.getX(s),n=e.getY(s);t.push(`(${i.toPrecision(Qb)}, ${1-n.toPrecision(Qb)})`)}return t.join(", ")}function jb(e,t,s=!1){const i=new Ib(`Material_${e.id}`,"Material");function n(i,n,a){const r=i.source.id+"_"+i.flipY;t[r]=i;const o=i.channel>0?"st"+i.channel:"st",l={1e3:"repeat",1001:"clamp",1002:"mirror"},c=i.repeat.clone(),A=i.offset.clone(),h=i.rotation,d=Math.sin(h),u=Math.cos(h);A.y=1-A.y-c.y,s?(A.x=A.x/c.x,A.y=A.y/c.y,A.x+=d/c.x,A.y+=u-1):(A.x+=d*c.x,A.y+=(1-u)*c.y);const p=new Ib(`PrimvarReader_${n}`,"Shader");p.addProperty('uniform token info:id = "UsdPrimvarReader_float2"'),p.addProperty("float2 inputs:fallback = (0.0, 0.0)"),p.addProperty(`string inputs:varname = "${o}"`),p.addProperty("float2 outputs:result");const g=new Ib(`Transform2d_${n}`,"Shader");g.addProperty('uniform token info:id = "UsdTransform2d"'),g.addProperty(`float2 inputs:in.connect = </Materials/Material_${e.id}/PrimvarReader_${n}.outputs:result>`),g.addProperty(`float inputs:rotation = ${(h*(180/Math.PI)).toFixed(Qb)}`),g.addProperty(`float2 inputs:scale = ${Pb(c)}`),g.addProperty(`float2 inputs:translation = ${Pb(A)}`),g.addProperty("float2 outputs:result");const m=new Ib(`Texture_${i.id}_${n}`,"Shader");return m.addProperty('uniform token info:id = "UsdUVTexture"'),m.addProperty(`asset inputs:file = @textures/Texture_${r}.png@`),m.addProperty(`float2 inputs:st.connect = </Materials/Material_${e.id}/Transform2d_${n}.outputs:result>`),void 0!==a&&m.addProperty(`float4 inputs:scale = ${function(e){return`(${e.r}, ${e.g}, ${e.b}, 1.0)`}(a)}`),"normal"===n&&(m.addProperty("float4 inputs:scale = (2, 2, 2, 1)"),m.addProperty("float4 inputs:bias = (-1, -1, -1, 0)")),m.addProperty(`token inputs:sourceColorSpace = "${i.colorSpace===Bt?"raw":"sRGB"}"`),m.addProperty(`token inputs:wrapS = "${l[i.wrapS]}"`),m.addProperty(`token inputs:wrapT = "${l[i.wrapT]}"`),m.addProperty("float outputs:r"),m.addProperty("float outputs:g"),m.addProperty("float outputs:b"),m.addProperty("float3 outputs:rgb"),(e.transparent||e.alphaTest>0)&&m.addProperty("float outputs:a"),[p,g,m]}e.side===$e&&console.warn("THREE.USDZExporter: USDZ does not support double sided materials",e);const a=new Ib("PreviewSurface","Shader");if(a.addProperty('uniform token info:id = "UsdPreviewSurface"'),null!==e.map){a.addProperty(`color3f inputs:diffuseColor.connect = </Materials/Material_${e.id}/Texture_${e.map.id}_diffuse.outputs:rgb>`),e.transparent?a.addProperty(`float inputs:opacity.connect = </Materials/Material_${e.id}/Texture_${e.map.id}_diffuse.outputs:a>`):e.alphaTest>0&&(a.addProperty(`float inputs:opacity.connect = </Materials/Material_${e.id}/Texture_${e.map.id}_diffuse.outputs:a>`),a.addProperty(`float inputs:opacityThreshold = ${e.alphaTest}`));n(e.map,"diffuse",e.color).forEach(e=>i.addChild(e))}else a.addProperty(`color3f inputs:diffuseColor = ${Lb(e.color)}`);if(null!==e.emissiveMap){a.addProperty(`color3f inputs:emissiveColor.connect = </Materials/Material_${e.id}/Texture_${e.emissiveMap.id}_emissive.outputs:rgb>`);const t=new be(e.emissive.r*e.emissiveIntensity,e.emissive.g*e.emissiveIntensity,e.emissive.b*e.emissiveIntensity);n(e.emissiveMap,"emissive",t).forEach(e=>i.addChild(e))}else e.emissive.getHex()>0&&a.addProperty(`color3f inputs:emissiveColor = ${Lb(e.emissive)}`);if(null!==e.normalMap){a.addProperty(`normal3f inputs:normal.connect = </Materials/Material_${e.id}/Texture_${e.normalMap.id}_normal.outputs:rgb>`);n(e.normalMap,"normal").forEach(e=>i.addChild(e))}if(null!==e.aoMap){a.addProperty(`float inputs:occlusion.connect = </Materials/Material_${e.id}/Texture_${e.aoMap.id}_occlusion.outputs:r>`);const t=new be(e.aoMapIntensity,e.aoMapIntensity,e.aoMapIntensity);n(e.aoMap,"occlusion",t).forEach(e=>i.addChild(e))}if(null!==e.roughnessMap){a.addProperty(`float inputs:roughness.connect = </Materials/Material_${e.id}/Texture_${e.roughnessMap.id}_roughness.outputs:g>`);const t=new be(e.roughness,e.roughness,e.roughness);n(e.roughnessMap,"roughness",t).forEach(e=>i.addChild(e))}else a.addProperty(`float inputs:roughness = ${e.roughness}`);if(null!==e.metalnessMap){a.addProperty(`float inputs:metallic.connect = </Materials/Material_${e.id}/Texture_${e.metalnessMap.id}_metallic.outputs:b>`);const t=new be(e.metalness,e.metalness,e.metalness);n(e.metalnessMap,"metallic",t).forEach(e=>i.addChild(e))}else a.addProperty(`float inputs:metallic = ${e.metalness}`);if(null!==e.alphaMap){a.addProperty(`float inputs:opacity.connect = </Materials/Material_${e.id}/Texture_${e.alphaMap.id}_opacity.outputs:r>`),a.addProperty("float inputs:opacityThreshold = 0.0001");n(e.alphaMap,"opacity").forEach(e=>i.addChild(e))}else a.addProperty(`float inputs:opacity = ${e.opacity}`);if(e.isMeshPhysicalMaterial){if(null!==e.clearcoatMap){a.addProperty(`float inputs:clearcoat.connect = </Materials/Material_${e.id}/Texture_${e.clearcoatMap.id}_clearcoat.outputs:r>`);const t=new be(e.clearcoat,e.clearcoat,e.clearcoat);n(e.clearcoatMap,"clearcoat",t).forEach(e=>i.addChild(e))}else a.addProperty(`float inputs:clearcoat = ${e.clearcoat}`);if(null!==e.clearcoatRoughnessMap){a.addProperty(`float inputs:clearcoatRoughness.connect = </Materials/Material_${e.id}/Texture_${e.clearcoatRoughnessMap.id}_clearcoatRoughness.outputs:g>`);const t=new be(e.clearcoatRoughness,e.clearcoatRoughness,e.clearcoatRoughness);n(e.clearcoatRoughnessMap,"clearcoatRoughness",t).forEach(e=>i.addChild(e))}else a.addProperty(`float inputs:clearcoatRoughness = ${e.clearcoatRoughness}`);a.addProperty(`float inputs:ior = ${e.ior}`)}return a.addProperty("int inputs:useSpecularWorkflow = 0"),a.addProperty("token outputs:surface"),i.addChild(a),i.addProperty(`token outputs:surface.connect = </Materials/Material_${e.id}/PreviewSurface.outputs:surface>`),i}function Lb(e){return`(${e.r}, ${e.g}, ${e.b})`}function Pb(e){return`(${e.x}, ${e.y})`}function Ub(e,t){const s=Eb(e,t),i=Mb(e.matrix);e.matrix.determinant()<0&&console.warn("THREE.USDZExporter: USDZ does not support negative scales",e);const n=new Ib(s,"Camera");n.addProperty(`matrix4d xformOp:transform = ${i}`),n.addProperty('uniform token[] xformOpOrder = ["xformOp:transform"]');const a=e.isOrthographicCamera?"orthographic":"perspective";n.addProperty(`token projection = "${a}"`);const r=`(${e.near.toPrecision(Qb)}, ${e.far.toPrecision(Qb)})`;let o,l;if(n.addProperty(`float2 clippingRange = ${r}`),o=e.isOrthographicCamera?(10*(Math.abs(e.left)+Math.abs(e.right))).toPrecision(Qb):e.getFilmWidth().toPrecision(Qb),n.addProperty(`float horizontalAperture = ${o}`),l=e.isOrthographicCamera?(10*(Math.abs(e.top)+Math.abs(e.bottom))).toPrecision(Qb):e.getFilmHeight().toPrecision(Qb),n.addProperty(`float verticalAperture = ${l}`),e.isPerspectiveCamera){const t=e.getFocalLength().toPrecision(Qb);n.addProperty(`float focalLength = ${t}`);const s=e.focus.toPrecision(Qb);n.addProperty(`float focusDistance = ${s}`)}return n}var Ob=function(e,t,s,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(r=(a<3?n(r):a>3?n(t,s,r):n(t,s))||r);return a>3&&r&&Object.defineProperty(t,s,r),r};let Gb=!1,Hb=!1;const qb="#model-viewer-no-ar-fallback",zb=(Vb=["quick-look","scene-viewer","webxr","none"],e=>{try{const t=bh(e),s=(t.length?t[0].terms:[]).filter(e=>e&&"ident"===e.type).map(e=>e.value).filter(e=>Vb.indexOf(e)>-1);return new Set(s)}catch(t){}return new Set});var Vb;const Kb="quick-look",Jb="scene-viewer",Yb="webxr",Wb="none",$b=Symbol("arButtonContainer"),Xb=Symbol("enterARWithWebXR"),Zb=Symbol("openSceneViewer"),ex=Symbol("openIOSARQuickLook"),tx=Symbol("canActivateAR"),sx=Symbol("arMode"),ix=Symbol("arModes"),nx=Symbol("arAnchor"),ax=Symbol("preload"),rx=Symbol("onARButtonContainerClick"),ox=Symbol("onARStatus"),lx=Symbol("onARTracking"),cx=Symbol("onARTap"),Ax=Symbol("selectARMode"),hx=Symbol("triggerLoad");var dx=function(e,t,s,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(r=(a<3?n(r):a>3?n(t,s,r):n(t,s))||r);return a>3&&r&&Object.defineProperty(t,s,r),r};const ux="auto",px="auto",gx="eager",mx=Symbol("defaultProgressBarElement"),fx=Symbol("posterContainerElement"),bx=Symbol("defaultPosterElement"),xx=Symbol("shouldDismissPoster"),yx=Symbol("hidePoster"),vx=Symbol("modelIsRevealed"),wx=Symbol("updateProgressBar"),Ix=Symbol("ariaLabelCallToAction"),Cx=Symbol("onProgress");var Ex=function(e,t,s,i){var n,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(r=(a<3?n(r):a>3?n(t,s,r):n(t,s))||r);return a>3&&r&&Object.defineProperty(t,s,r),r};const Bx=Math.PI/32,Qx={basis:[Qh(fh(Bx,"rad"))],keywords:{auto:[null]}},Sx=Symbol("autoRotateStartTime"),_x=Symbol("radiansPerSecond"),kx=Symbol("syncRotationRate"),Tx=Symbol("onCameraChange"),Mx=(e=>{var t,s,i;class n extends e{constructor(){super(...arguments),this[t]=new Map,this[s]=e=>{e.forEach(e=>{e instanceof MutationRecord&&"childList"!==e.type||(e.addedNodes.forEach(e=>{this[Sf](e)}),e.removedNodes.forEach(e=>{this[_f](e)}),this[af]())})},this[i]=new MutationObserver(this[Bf])}connectedCallback(){super.connectedCallback();for(let t=0;t<this.children.length;++t)this[Sf](this.children[t]);const{ShadyDOM:e}=self;null==e?this[Qf].observe(this,{childList:!0}):this[Qf]=e.observeChildren(this,this[Bf])}disconnectedCallback(){super.disconnectedCallback();const{ShadyDOM:e}=self;null==e?this[Qf].disconnect():e.unobserveChildren(this[Qf])}[(t=Ef,s=Bf,i=Qf,of)](){super[of]();const e=this[nf];e.forHotspots(t=>{e.updateSurfaceHotspot(t)})}[rf](e,t){super[rf](e,t);const s=this[nf],{annotationRenderer:i}=s,n=s.getCamera();s.shouldRender()&&(s.animateSurfaceHotspots(),s.updateHotspotsVisibility(n.position),i.domElement.style.display="",i.render(s,n))}updateHotspot(e){const t=this[Ef].get(e.name);null!=t&&(t.updatePosition(e.position),t.updateNormal(e.normal),t.surface=e.surface,this[nf].updateSurfaceHotspot(t),this[af]())}queryHotspot(e){const t=this[Ef].get(e);if(null==t)return null;const s=pf(t.position),i=pf(t.normal),n=t.facingCamera,a=this[nf],r=a.getCamera(),o=new Te;o.setFromMatrixPosition(t.matrixWorld),o.project(r);const l=a.width/2,c=a.height/2;o.x=o.x*l+l,o.y=-o.y*c+c;const A=pf(new Te(o.x,o.y,o.z));return Number.isFinite(A.x)&&Number.isFinite(A.y)?{position:s,normal:i,canvasPosition:A,facingCamera:n}:null}positionAndNormalFromPoint(e,t){const s=this[nf],i=s.getNDC(e,t),n=s.positionAndNormalFromPoint(i);if(null==n)return null;kf.copy(s.target.matrixWorld).invert();const a=pf(n.position.applyMatrix4(kf)),r=pf(n.normal.transformDirection(kf));let o=null;return null!=n.uv&&(o=gf(n.uv)),{position:a,normal:r,uv:o}}surfaceFromPoint(e,t){const s=this[nf],i=s.getNDC(e,t);return s.surfaceFromPoint(i)}[Sf](e){if(!(e instanceof HTMLElement&&0===e.slot.indexOf("hotspot")))return;let t=this[Ef].get(e.slot);null!=t?t.increment():(t=new rm({name:e.slot,position:e.dataset.position,normal:e.dataset.normal,surface:e.dataset.surface}),this[Ef].set(e.slot,t),this[nf].addHotspot(t)),this[nf].queueRender()}[_f](e){if(!(e instanceof HTMLElement))return;const t=this[Ef].get(e.slot);t&&(t.decrement()&&(this[nf].removeHotspot(t),this[Ef].delete(e.slot)),this[nf].queueRender())}}return n})((e=>{var t,s,i;class n extends e{constructor(){super(...arguments),this[t]=void 0,this[s]=null,this[i]=null,this.variantName=null,this.orientation="0 0 0",this.scale="1 1 1"}get model(){return this[Wg]}get availableVariants(){return this.model?this.model[Gg]():[]}get originalGltfJson(){return this[Yg]}[(t=Wg,s=Jg,i=Yg,$g)](){return()=>{this[af]()}}[Xg](e){return e.colorSpace=ue,e.wrapS=qe,e.wrapT=qe,new Pp(this[$g](),e)}async createTexture(e,t="image/png"){const{textureUtils:s}=this[cf],i=await s.loadImage(e,this.withCredentials);return i.userData.mimeType=t,this[Xg](i)}async createLottieTexture(e,t=1){const{textureUtils:s}=this[cf],i=await s.loadLottie(e,t,this.withCredentials);return this[Xg](i)}createVideoTexture(e){const t=document.createElement("video");t.crossOrigin=this.withCredentials?"use-credentials":"anonymous",t.src=e,t.muted=!0,t.playsInline=!0,t.loop=!0,t.play();const s=new _s(t);return this[Xg](s)}createCanvasTexture(){const e=document.createElement("canvas"),t=new ks(e);return this[Xg](t)}async updated(e){if(super.updated(e),e.has("variantName")){const e=this[Af].beginActivity("variant-update");e(.1);const t=this[Wg],{variantName:s}=this;null!=t&&(await t[jg](s),this[af](),this.dispatchEvent(new CustomEvent("variant-applied"))),e(1)}if(e.has("orientation")||e.has("scale")){if(!this.loaded)return;const e=this[nf];e.applyTransform(),e.updateBoundingBox(),e.updateShadow(),this[cf].arRenderer.onUpdateScene(),this[af]()}}[of](){super[of]();const{currentGLTF:e}=this[nf];if(null!=e){const{correlatedSceneGraph:t}=e;null!=t&&e!==this[Jg]&&(this[Wg]=new Vg(t,this[$g]()),this[Yg]=JSON.parse(JSON.stringify(t.gltf))),"variants"in e.userData&&this.requestUpdate("variantName")}this[Jg]=e}async exportScene(e){const t=this[nf];return new Promise(async(s,i)=>{const n={binary:!0,onlyVisible:!0,maxTextureSize:1/0,includeCustomExtensions:!1,forceIndices:!1};Object.assign(n,e),n.animations=t.animations,n.truncateDrawRange=!0;const a=t.shadow;let r=!1;null!=a&&(r=a.visible,a.visible=!1),await this[Wg][Fg]();(new uA).register(e=>new lh(e)).parse(t.model,e=>s(new Blob([n.binary?e:JSON.stringify(e)],{type:n.binary?"application/octet-stream":"application/json"})),()=>i("glTF export failed"),n),null!=a&&(a.visible=r)})}materialFromPoint(e,t){const s=this[Wg];if(null==s)return null;const i=this[nf],n=i.getNDC(e,t),a=i.hitFromPoint(n);return null==a||null==a.face?null:s[Lg](a)}}return Kg([ur({type:String,attribute:"variant-name"})],n.prototype,"variantName",void 0),Kg([ur({type:String,attribute:"orientation"})],n.prototype,"orientation",void 0),Kg([ur({type:String,attribute:"scale"})],n.prototype,"scale",void 0),n})((e=>{var t,s,i;class n extends e{constructor(){super(...arguments),this.autoRotate=!1,this.autoRotateDelay=3e3,this.rotationPerSecond="auto",this[t]=performance.now(),this[s]=0,this[i]=e=>{this.autoRotate&&"user-interaction"===e.detail.source&&(this[Sx]=performance.now())}}connectedCallback(){super.connectedCallback(),this.addEventListener("camera-change",this[Tx]),this[Sx]=performance.now()}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("camera-change",this[Tx]),this[Sx]=performance.now()}updated(e){super.updated(e),e.has("autoRotate")&&(this[Sx]=performance.now())}[(t=Sx,s=_x,kx)](e){this[_x]=e[0]}[rf](e,t){if(super[rf](e,t),!this.autoRotate||!this[df]()||this[cf].isPresenting)return;const s=Math.min(t,e-this[Sx]-this.autoRotateDelay);s>0&&(this[nf].yaw=this.turntableRotation+this[_x]*s*.001)}get turntableRotation(){return this[nf].yaw}resetTurntableRotation(e=0){this[nf].yaw=e}}return i=Tx,Ex([ur({type:Boolean,attribute:"auto-rotate"})],n.prototype,"autoRotate",void 0),Ex([ur({type:Number,attribute:"auto-rotate-delay"})],n.prototype,"autoRotateDelay",void 0),Ex([ud({intrinsics:Qx,updateHandler:kx}),ur({type:String,attribute:"rotation-per-second"})],n.prototype,"rotationPerSecond",void 0),n})((e=>{var t,s,i;class n extends e{constructor(){super(...arguments),this.environmentImage=null,this.skyboxImage=null,this.shadowIntensity=0,this.shadowSoftness=1,this.exposure=1,this.toneMapping="auto",this.skyboxHeight="0",this[t]=null,this[s]=null,this[i]=null}updated(e){super.updated(e),e.has("shadowIntensity")&&(this[nf].setShadowIntensity(.5*this.shadowIntensity),this[af]()),e.has("shadowSoftness")&&(this[nf].setShadowSoftness(this.shadowSoftness),this[af]()),e.has("exposure")&&(this[nf].exposure=this.exposure,this[af]()),e.has("toneMapping")&&(this[nf].toneMapping="aces"===this.toneMapping?ne:"agx"===this.toneMapping?ae:"reinhard"===this.toneMapping?re:"cineon"===this.toneMapping?oe:"linear"===this.toneMapping?le:"none"===this.toneMapping?ce:Ae,this[af]()),(e.has("environmentImage")||e.has("skyboxImage"))&&this[uf]()&&this[Io](),e.has("skyboxHeight")&&(this[nf].setGroundedSkybox(),this[af]())}hasBakedShadow(){return this[nf].bakedShadows.size>0}async[(t=vo,s=wo,i=Co,Io)](){const{skyboxImage:e,environmentImage:t}=this;null!=this[Co]&&(this[Co](),this[Co]=null);const{textureUtils:s}=this[cf];if(null==s)return;const i=this[Af].beginActivity("environment-update");try{const{environmentMap:n,skybox:a}=await s.generateEnvironmentMapAndSkybox(po(e),t,e=>i(bo(e,0,1)),this.withCredentials);this[vo]!==n&&(this[vo]=n,this.dispatchEvent(new CustomEvent("environment-change"))),this[wo]=null!=a?a.name===n.name?n:a:null,this[nf].setEnvironmentAndSkybox(this[vo],this[wo])}catch(n){if(n instanceof Error)throw this[nf].setEnvironmentAndSkybox(null,null),n}finally{i(1)}}}return yo([ur({type:String,attribute:"environment-image"})],n.prototype,"environmentImage",void 0),yo([ur({type:String,attribute:"skybox-image"})],n.prototype,"skyboxImage",void 0),yo([ur({type:Number,attribute:"shadow-intensity"})],n.prototype,"shadowIntensity",void 0),yo([ur({type:Number,attribute:"shadow-softness"})],n.prototype,"shadowSoftness",void 0),yo([ur({type:Number})],n.prototype,"exposure",void 0),yo([ur({type:String,attribute:"tone-mapping"})],n.prototype,"toneMapping",void 0),yo([ur({type:String,attribute:"skybox-height"})],n.prototype,"skyboxHeight",void 0),n})((e=>{var t,s,i,n,a,r,o,l,c,A,h,d,u,p,g,m,f,b;class x extends e{constructor(){super(...arguments),this.cameraControls=!1,this.cameraOrbit=yd,this.cameraTarget="auto auto auto",this.fieldOfView="auto",this.minCameraOrbit="auto",this.maxCameraOrbit="auto",this.minFieldOfView="auto",this.maxFieldOfView="auto",this.interactionPromptThreshold=3e3,this.interactionPrompt=Id,this.interactionPromptStyle=Ed,this.orbitSensitivity=1,this.zoomSensitivity=1,this.panSensitivity=1,this.touchAction=Bd,this.disableZoom=!1,this.disablePan=!1,this.disableTap=!1,this.interpolationDecay=50,this.a11y=null,this[t]=this.shadowRoot.querySelector(".interaction-prompt"),this[s]=this.shadowRoot.querySelector("#prompt"),this[i]=[this.shadowRoot.querySelector("#finger0"),this.shadowRoot.querySelector("#finger1")],this[n]=this.shadowRoot.querySelector(".pan-target"),this[a]=0,this[r]=1/0,this[o]=!1,this[l]=!1,this[c]=fu.AUTOMATIC,this[A]=new bu(this[nf].camera,this[tf],this[nf]),this[h]=new ms,this[d]=!1,this[u]=!1,this[p]=!1,this[g]={},this[m]=()=>{const e=this[jd].changeSource;this[eu]=e,e===fu.USER_INTERACTION&&(this[$d]=!0,this[Gd]())},this[f]=()=>{this[Hd](),this[af]();const e=this[jd].changeSource;this.dispatchEvent(new CustomEvent("camera-change",{detail:{source:e}}))},this[b]=e=>{this[ef].classList.toggle("pointer-tumbling","pointer-change-start"===e.type)}}get inputSensitivity(){return this[jd].inputSensitivity}set inputSensitivity(e){this[jd].inputSensitivity=e}getCameraOrbit(){const{theta:e,phi:t,radius:s}=this[tu];return{theta:e,phi:t,radius:s,toString(){return`${this.theta}rad ${this.phi}rad ${this.radius}m`}}}getCameraTarget(){return pf(this[cf].isPresenting?this[cf].arRenderer.target:this[nf].getDynamicTarget())}getFieldOfView(){return this[jd].getFieldOfView()}getMinimumFieldOfView(){return this[jd].options.minimumFieldOfView}getMaximumFieldOfView(){return this[jd].options.maximumFieldOfView}getIdealAspect(){return this[nf].idealAspect}jumpCameraToGoal(){this[su]=!0,this.requestUpdate(su,!1)}resetInteractionPrompt(){this[Zd]=0,this[Xd]=1/0,this[$d]=!1,this[Wd]=this.interactionPrompt===Id&&this.cameraControls}zoom(e){const t=new WheelEvent("wheel",{deltaY:-30*e});this[tf].dispatchEvent(t)}connectedCallback(){super.connectedCallback(),this[jd].addEventListener("user-interaction",this[Kd]),this[jd].addEventListener("pointer-change-start",this[Yd]),this[jd].addEventListener("pointer-change-end",this[Yd])}disconnectedCallback(){super.disconnectedCallback(),this[jd].removeEventListener("user-interaction",this[Kd]),this[jd].removeEventListener("pointer-change-start",this[Yd]),this[jd].removeEventListener("pointer-change-end",this[Yd])}updated(e){super.updated(e);const t=this[jd],s=this[nf];if(e.has("cameraControls")&&(this.cameraControls?(t.enableInteraction(),this.interactionPrompt===Id&&(this[Wd]=!0)):(t.disableInteraction(),this[Gd]()),this[tf].setAttribute("aria-label",this[Km])),e.has("disableZoom")&&(t.disableZoom=this.disableZoom),e.has("disablePan")&&(t.enablePan=!this.disablePan),e.has("disableTap")&&(t.enableTap=!this.disableTap),(e.has("interactionPrompt")||e.has("cameraControls")||e.has("src"))&&(this.interactionPrompt===Id&&this.cameraControls&&!this[$d]?this[Wd]=!0:this[Gd]()),e.has("interactionPromptStyle")&&(this[Ud].style.opacity=this.interactionPromptStyle==Cd?"1":"0"),e.has("touchAction")){const e=this.touchAction;t.applyOptions({touchAction:e}),t.updateTouchActionStyle()}e.has("orbitSensitivity")&&(t.orbitSensitivity=this.orbitSensitivity),e.has("zoomSensitivity")&&(t.zoomSensitivity=this.zoomSensitivity),e.has("panSensitivity")&&(t.panSensitivity=this.panSensitivity),e.has("interpolationDecay")&&(t.setDamperDecayTime(this.interpolationDecay),s.setTargetDamperDecayTime(this.interpolationDecay)),e.has("a11y")&&this[zd](),!0===this[su]&&Promise.resolve().then(()=>{t.jumpToGoal(),s.jumpToGoal(),this[Jd](),this[su]=!1})}async updateFraming(){const e=this[nf],t=e.adjustedFoV(e.framedFoVDeg);await e.updateFraming();const s=e.adjustedFoV(e.framedFoVDeg),i=this[jd].getFieldOfView()/t;this[jd].setFieldOfView(s*i),this[nu]=!0,this.requestUpdate("maxFieldOfView"),this.requestUpdate("fieldOfView"),this.requestUpdate("minCameraOrbit"),this.requestUpdate("maxCameraOrbit"),this.requestUpdate("cameraOrbit"),await this.updateComplete}interact(e,t,s){const i=this[tf],n=this[Od];if("1"===n[0].style.opacity)return void console.warn("interact() failed because an existing interaction is running.");const a=new Array;a.push({x:md(t.x),y:md(t.y)});const r=[{x:a[0].x(0),y:a[0].y(0)}];null!=s&&(a.push({x:md(s.x),y:md(s.y)}),r.push({x:a[1].x(0),y:a[1].y(0)}));let o=performance.now();const{width:l,height:c}=this[nf],A=this.getBoundingClientRect(),h=e=>{for(const[t,s]of r.entries()){const{style:a}=n[t];a.transform=`translateX(${l*s.x}px) translateY(${c*s.y}px)`,"pointerdown"===e?a.opacity="1":"pointerup"===e&&(a.opacity="0");const r={pointerId:t-5678,pointerType:"touch",target:i,clientX:l*s.x+A.x,clientY:c*s.y+A.y,altKey:!0};i.dispatchEvent(new PointerEvent(e,r))}},d=()=>{const t=this[eu];if(t!==fu.AUTOMATIC||!i.isConnected){for(const e of this[Od])e.style.opacity="0";return h("pointercancel"),this.dispatchEvent(new CustomEvent("interact-stopped",{detail:{source:t}})),void document.removeEventListener("visibilitychange",u)}const s=Math.min(1,(performance.now()-o)/e);for(const[e,i]of r.entries())i.x=a[e].x(s),i.y=a[e].y(s);h("pointermove"),s<1?requestAnimationFrame(d):(h("pointerup"),this.dispatchEvent(new CustomEvent("interact-stopped",{detail:{source:fu.AUTOMATIC}})),document.removeEventListener("visibilitychange",u))},u=()=>{let e=0;"hidden"===document.visibilityState?e=performance.now()-o:o=performance.now()-e};document.addEventListener("visibilitychange",u),h("pointerdown"),this[eu]=fu.AUTOMATIC,requestAnimationFrame(d)}[(t=Pd,s=Ud,i=Od,n=Ld,a=Zd,r=Xd,o=$d,l=Wd,c=eu,A=jd,h=tu,d=su,u=iu,p=nu,g=qd,ru)](e){const t=this[jd],s=this[nf];s.framedFoVDeg=180*e[0]/Math.PI,t.changeSource=fu.NONE,t.setFieldOfView(s.adjustedFoV(s.framedFoVDeg)),this[Kd]()}[au](e){const t=this[jd];if(this[nu]){const{theta:t,phi:s}=this.getCameraOrbit();e[0]=t,e[1]=s,this[nu]=!1}t.changeSource=fu.NONE,t.setOrbit(e[0],e[1],e[2]),this[Kd]()}[lu](e){this[jd].applyOptions({minimumAzimuthalAngle:e[0],minimumPolarAngle:e[1],minimumRadius:e[2]}),this.jumpCameraToGoal()}[cu](e){this[jd].applyOptions({maximumAzimuthalAngle:e[0],maximumPolarAngle:e[1],maximumRadius:e[2]}),this[Vd](e[2]),this.jumpCameraToGoal()}[Au](e){this[jd].applyOptions({minimumFieldOfView:180*e[0]/Math.PI}),this.jumpCameraToGoal()}[hu](e){const t=this[nf].adjustedFoV(180*e[0]/Math.PI);this[jd].applyOptions({maximumFieldOfView:t}),this.jumpCameraToGoal()}[ou](e){const[t,s,i]=e;this[cf].arRenderer.isPresenting||this[nf].setTarget(t,s,i),this[jd].changeSource=fu.NONE,this[cf].arRenderer.updateTarget(),this[Kd]()}[rf](e,t){if(super[rf](e,t),this[cf].isPresenting||!this[df]())return;const s=this[jd],i=this[nf],n=performance.now();if(this[Wd]&&this.loaded&&n>this[$m]+this.interactionPromptThreshold&&(this[Wd]=!1,this[Xd]=n,this[Pd].classList.add("visible")),isFinite(this[Xd])&&this.interactionPromptStyle===Ed){const e=(n-this[Xd])/5e3%1,t=bd(e),a=xd(e);if(this[Ud].style.opacity=`${a}`,t!==this[Zd]){const e=t*i.width*.05,n=(t-this[Zd])*Math.PI/16;this[Ud].style.transform=`translateX(${e}px)`,s.changeSource=fu.AUTOMATIC,s.adjustOrbit(n,0,0),this[Zd]=t}}const a=s.update(e,t),r=i.updateTarget(t);(a||r)&&this[Jd]()}[Gd](){this[Wd]=!1,this[Pd].classList.remove("visible"),this[Xd]=1/0}[Vd](e){const t=Math.max(this[nf].farRadius(),e),s=Math.abs(2*t);this[jd].updateNearFar(0,s)}[Hd](){const{theta:e,phi:t}=this[jd].getCameraSpherical(this[tu]),s=(4+Math.floor((e%Fd+Nd)/Rd))%4,i=Math.floor(t/Dd),n=`${wd[i]}${vd[s]}`,a=n;a in this[qd]?this[Wm](this[qd][a]):this[Wm](`View from stage ${n}`)}get[Km](){let e=". Use mouse, touch or arrow keys to move.";return"interaction-prompt"in this[qd]&&(e=`. ${this[qd]["interaction-prompt"]}`),super[Km].replace(/\.$/,"")+(this.cameraControls?e:"")}async[lf](e){const t=this[jd],s=this[nf],i=s.adjustedFoV(s.framedFoVDeg);super[lf](e);const n=s.adjustedFoV(s.framedFoVDeg)/i,a=t.getFieldOfView()*(isFinite(n)?n:1);t.updateAspect(this[nf].aspect),this.requestUpdate("maxFieldOfView",this.maxFieldOfView),await this.updateComplete,this[jd].setFieldOfView(a),this.jumpCameraToGoal()}[of](){super[of](),this[iu]?this[nu]=!0:this[iu]=!0,this.requestUpdate("maxFieldOfView",this.maxFieldOfView),this.requestUpdate("fieldOfView",this.fieldOfView),this.requestUpdate("minCameraOrbit",this.minCameraOrbit),this.requestUpdate("maxCameraOrbit",this.maxCameraOrbit),this.requestUpdate("cameraOrbit",this.cameraOrbit),this.requestUpdate("cameraTarget",this.cameraTarget),this.jumpCameraToGoal()}[(m=Kd,f=Jd,b=Yd,zd)](){if("string"==typeof this.a11y)if(this.a11y.startsWith("{"))try{this[qd]=JSON.parse(this.a11y)}catch(e){console.warn("Error parsing a11y JSON:",e)}else this.a11y.length>0?console.warn("Error not supported format, should be a JSON string:",this.a11y):this[qd]={};else"object"==typeof this.a11y&&null!=this.a11y?this[qd]=Object.assign({},this.a11y):this[qd]={};this[tf].setAttribute("aria-label",this[Km])}}return fd([ur({type:Boolean,attribute:"camera-controls"})],x.prototype,"cameraControls",void 0),fd([ud({intrinsics:_d,observeEffects:!0,updateHandler:au}),ur({type:String,attribute:"camera-orbit",hasChanged:()=>!0})],x.prototype,"cameraOrbit",void 0),fd([ud({intrinsics:Md,observeEffects:!0,updateHandler:ou}),ur({type:String,attribute:"camera-target",hasChanged:()=>!0})],x.prototype,"cameraTarget",void 0),fd([ud({intrinsics:Qd,observeEffects:!0,updateHandler:ru}),ur({type:String,attribute:"field-of-view",hasChanged:()=>!0})],x.prototype,"fieldOfView",void 0),fd([ud({intrinsics:kd,updateHandler:lu}),ur({type:String,attribute:"min-camera-orbit",hasChanged:()=>!0})],x.prototype,"minCameraOrbit",void 0),fd([ud({intrinsics:Td,updateHandler:cu}),ur({type:String,attribute:"max-camera-orbit",hasChanged:()=>!0})],x.prototype,"maxCameraOrbit",void 0),fd([ud({intrinsics:Sd,updateHandler:Au}),ur({type:String,attribute:"min-field-of-view",hasChanged:()=>!0})],x.prototype,"minFieldOfView",void 0),fd([ud({intrinsics:Qd,updateHandler:hu}),ur({type:String,attribute:"max-field-of-view",hasChanged:()=>!0})],x.prototype,"maxFieldOfView",void 0),fd([ur({type:Number,attribute:"interaction-prompt-threshold"})],x.prototype,"interactionPromptThreshold",void 0),fd([ur({type:String,attribute:"interaction-prompt"})],x.prototype,"interactionPrompt",void 0),fd([ur({type:String,attribute:"interaction-prompt-style"})],x.prototype,"interactionPromptStyle",void 0),fd([ur({type:Number,attribute:"orbit-sensitivity"})],x.prototype,"orbitSensitivity",void 0),fd([ur({type:Number,attribute:"zoom-sensitivity"})],x.prototype,"zoomSensitivity",void 0),fd([ur({type:Number,attribute:"pan-sensitivity"})],x.prototype,"panSensitivity",void 0),fd([ur({type:String,attribute:"touch-action"})],x.prototype,"touchAction",void 0),fd([ur({type:Boolean,attribute:"disable-zoom"})],x.prototype,"disableZoom",void 0),fd([ur({type:Boolean,attribute:"disable-pan"})],x.prototype,"disablePan",void 0),fd([ur({type:Boolean,attribute:"disable-tap"})],x.prototype,"disableTap",void 0),fd([ur({type:Number,attribute:"interpolation-decay"})],x.prototype,"interpolationDecay",void 0),fd([ur()],x.prototype,"a11y",void 0),x})((e=>{var t,s,i,n,a,r,o,l,c,A;class h extends e{constructor(){super(...arguments),this.ar=!1,this.arScale="auto",this.arUsdzMaxTextureSize="auto",this.arPlacement="floor",this.arModes="webxr scene-viewer quick-look",this.iosSrc=null,this.xrEnvironment=!1,this[t]=!1,this[s]=this.shadowRoot.querySelector(".ar-button"),this[i]=document.createElement("a"),this[n]=new Set,this[a]=Wb,this[r]=!1,this[o]=e=>{e.preventDefault(),this.activateAR()},this[l]=({status:e})=>{e!==yu&&this[cf].arRenderer.presentedScene!==this[nf]||(this.setAttribute("ar-status",e),this.dispatchEvent(new CustomEvent("ar-status",{detail:{status:e}})),e===yu?this.removeAttribute("ar-tracking"):e===vu&&this.setAttribute("ar-tracking",Cu))},this[c]=({status:e})=>{this.setAttribute("ar-tracking",e),this.dispatchEvent(new CustomEvent("ar-tracking",{detail:{status:e}}))},this[A]=e=>{"_apple_ar_quicklook_button_tapped"==e.data&&this.dispatchEvent(new CustomEvent("quick-look-button-tapped"))}}get canActivateAR(){return this[sx]!==Wb}connectedCallback(){super.connectedCallback(),this[cf].arRenderer.addEventListener("status",this[ox]),this.setAttribute("ar-status",yu),this[cf].arRenderer.addEventListener("tracking",this[lx]),this[nx].addEventListener("message",this[cx])}disconnectedCallback(){super.disconnectedCallback(),this[cf].arRenderer.removeEventListener("status",this[ox]),this[cf].arRenderer.removeEventListener("tracking",this[lx]),this[nx].removeEventListener("message",this[cx])}update(e){super.update(e),e.has("arScale")&&(this[nf].canScale="fixed"!==this.arScale),e.has("arPlacement")&&(this[nf].updateShadow(),this[af]()),e.has("arModes")&&(this[ix]=zb(this.arModes)),(e.has("ar")||e.has("arModes")||e.has("src")||e.has("iosSrc")||e.has("arUsdzMaxTextureSize"))&&this[Ax]()}async activateAR(){switch(this[sx]){case Kb:await this[ex]();break;case Yb:await this[Xb]();break;case Jb:this[Zb]();break;default:console.warn("No AR Mode can be activated. This is probably due to missing configuration or device capabilities")}}async[(t=tx,s=$b,i=nx,n=ix,a=sx,r=ax,o=rx,l=ox,c=lx,A=cx,Ax)](){var e;let t=Wb;if(this.ar){if(null!=this.src)for(const s of this[ix]){if("webxr"===s&&ao&&!Gb&&await this[cf].arRenderer.supportsPresentation()){t=Yb;break}if("scene-viewer"===s&&!Hb&&(Ao||navigator.userAgentData&&navigator.userAgentData.getHighEntropyValues&&(null===(e=(await navigator.userAgentData.getHighEntropyValues(["formFactor"])).formFactor)||void 0===e?void 0:e.includes("XR")))){t=Jb;break}if("quick-look"===s&&uo){t=Kb;break}}t===Wb&&null!=this.iosSrc&&uo&&(t=Kb)}if(t!==Wb)this[$b].classList.add("enabled"),this[$b].addEventListener("click",this[rx]);else if(this[$b].classList.contains("enabled")){this[$b].removeEventListener("click",this[rx]),this[$b].classList.remove("enabled");const e=Iu;this.setAttribute("ar-status",e),this.dispatchEvent(new CustomEvent("ar-status",{detail:{status:e}}))}this[sx]=t}async[Xb](){console.log("Attempting to present in AR with WebXR..."),await this[hx]();try{this[$b].removeEventListener("click",this[rx]);const{arRenderer:e}=this[cf];e.placeOnWall="wall"===this.arPlacement,await e.present(this[nf],this.xrEnvironment)}catch(e){console.warn("Error while trying to present in AR with WebXR"),console.error(e),await this[cf].arRenderer.stopPresenting(),Gb=!0,console.warn("Falling back to next ar-mode"),await this[Ax](),this.activateAR()}finally{this[Ax]()}}async[hx](){this.loaded||(this[ax]=!0,this[Xm](),await((e,t,s=null)=>new Promise(i=>{e.addEventListener(t,function n(a){s&&!s(a)||(i(a),e.removeEventListener(t,n))})}))(this,"load"),this[ax]=!1)}[uf](){return super[uf]()||this[ax]}[Zb](){const e=self.location.toString(),t=new URL(e),s=new URL(this.src,e);s.hash&&(s.hash="");const i=new URLSearchParams(s.search);if(t.hash=qb,i.set("mode","ar_preferred"),i.has("disable_occlusion")||i.set("disable_occlusion","true"),"fixed"===this.arScale&&i.set("resizable","false"),"wall"===this.arPlacement&&i.set("enable_vertical_placement","true"),i.has("sound")){const t=new URL(i.get("sound"),e);i.set("sound",t.toString())}if(i.has("link")){const t=new URL(i.get("link"),e);i.set("link",t.toString())}const n=`intent://arvr.google.com/scene-viewer/1.2?${i.toString()+"&file="+encodeURIComponent(s.toString())}#Intent;scheme=https;package=com.google.android.googlequicksearchbox;action=android.intent.action.VIEW;S.browser_fallback_url=${encodeURIComponent(t.toString())};end;`;self.addEventListener("hashchange",()=>{self.location.hash===qb&&(Hb=!0,self.history.back(),console.warn("Error while trying to present in AR with Scene Viewer"),console.warn("Falling back to next ar-mode"),this[Ax]())},{once:!0}),this[nx].setAttribute("href",n),console.log("Attempting to present in AR with Scene Viewer..."),this[nx].click()}async[ex](){const e=!this.iosSrc;this[$b].classList.remove("enabled");const t=e?await this.prepareUSDZ():this.iosSrc,s=new URL(t,self.location.toString());if(e){const e=self.location.toString(),t=new URL(e),i=new URL(this.src,t);i.hash&&(s.hash=i.hash)}"fixed"===this.arScale&&(s.hash&&(s.hash+="&"),s.hash+="allowsContentScaling=0");const i=this[nx];i.setAttribute("rel","ar");const n=document.createElement("img");i.appendChild(n),i.setAttribute("href",s.toString()),e&&i.setAttribute("download","model.usdz"),i.style.display="none",i.isConnected||this.shadowRoot.appendChild(i),console.log("Attempting to present in AR with Quick Look..."),i.click(),i.removeChild(n),e&&URL.revokeObjectURL(t),this[$b].classList.add("enabled")}async prepareUSDZ(){const e=this[Af].beginActivity("usdz-conversion");await this[hx]();const{model:t,shadow:s,target:i}=this[nf];if(null==t)return"";let n=!1;null!=s&&(n=s.visible,s.visible=!1),e(.2);const a=new Cb;i.remove(t),t.position.copy(i.position),t.updateWorldMatrix(!1,!0);const r=await a.parseAsync(t,{maxTextureSize:isNaN(this.arUsdzMaxTextureSize)?1/0:Math.max(parseInt(this.arUsdzMaxTextureSize),16)});t.position.set(0,0,0),i.add(t);const o=new Blob([r],{type:"model/vnd.usdz+zip"}),l=URL.createObjectURL(o);return e(1),null!=s&&(s.visible=n),l}}return Ob([ur({type:Boolean,attribute:"ar"})],h.prototype,"ar",void 0),Ob([ur({type:String,attribute:"ar-scale"})],h.prototype,"arScale",void 0),Ob([ur({type:String,attribute:"ar-usdz-max-texture-size"})],h.prototype,"arUsdzMaxTextureSize",void 0),Ob([ur({type:String,attribute:"ar-placement"})],h.prototype,"arPlacement",void 0),Ob([ur({type:String,attribute:"ar-modes"})],h.prototype,"arModes",void 0),Ob([ur({type:String,attribute:"ios-src"})],h.prototype,"iosSrc",void 0),Ob([ur({type:Boolean,attribute:"xr-environment"})],h.prototype,"xrEnvironment",void 0),h})((e=>{var t,s,i,n,a,r,o,l;class c extends e{static set dracoDecoderLocation(e){iA.setDRACODecoderLocation(e)}static get dracoDecoderLocation(){return iA.getDRACODecoderLocation()}static set ktx2TranscoderLocation(e){iA.setKTX2TranscoderLocation(e)}static get ktx2TranscoderLocation(){return iA.getKTX2TranscoderLocation()}static set meshoptDecoderLocation(e){iA.setMeshoptDecoderLocation(e)}static get meshoptDecoderLocation(){return iA.getMeshoptDecoderLocation()}static set lottieLoaderLocation(e){cp.singleton.textureUtils.lottieLoaderUrl=e}static get lottieLoaderLocation(){return cp.singleton.textureUtils.lottieLoaderUrl}static mapURLs(e){cp.singleton.loader[eA].manager.setURLModifier(e)}dismissPoster(){this.loaded?this[yx]():(this[xx]=!0,this[Xm]())}showPoster(){const e=this[fx];if(e.classList.contains("show"))return;e.classList.add("show"),this[tf].classList.remove("show");const t=this[bx];t.removeAttribute("tabindex"),t.removeAttribute("aria-hidden");const s=this.modelIsVisible;this[vx]=!1,this[Vm](s)}getDimensions(){return pf(this[nf].size)}getBoundingBoxCenter(){return pf(this[nf].boundingBox.getCenter(new Te))}constructor(...e){super(...e),this.poster=null,this.reveal=ux,this.loading=px,this[t]=!1,this[s]=!1,this[i]=this.shadowRoot.querySelector(".slot.poster"),this[n]=this.shadowRoot.querySelector("#default-poster"),this[a]=this.shadowRoot.querySelector("#default-progress-bar > .bar"),this[r]=this[bx].getAttribute("aria-label"),this[o]=((e,t)=>{let s=null;const i=(...i)=>{null==s&&(e(...i),s=self.setTimeout(()=>s=null,t))};return i.flush=()=>{null!=s&&(self.clearTimeout(s),s=null)},i})(e=>{const t=this[mx].parentNode;requestAnimationFrame(()=>{this[mx].style.transform=`scaleX(${e})`,0===e&&(t.removeChild(this[mx]),t.appendChild(this[mx])),this[mx].classList.toggle("hide",1===e)})},100),this[l]=e=>{const t=e.detail.totalProgress,s=e.detail.reason;1===t&&(this[wx].flush(),this.loaded&&(this[xx]||this.reveal===ux)&&this[yx]()),this[wx](t),this.dispatchEvent(new CustomEvent("progress",{detail:{totalProgress:t,reason:s}}))};const c=self.ModelViewerElement||{},A=c.dracoDecoderLocation||"https://www.gstatic.com/draco/versioned/decoders/1.5.6/";iA.setDRACODecoderLocation(A);const h=c.ktx2TranscoderLocation||"https://www.gstatic.com/basis-universal/versioned/2021-04-15-ba1c3e4/";iA.setKTX2TranscoderLocation(h),c.meshoptDecoderLocation&&iA.setMeshoptDecoderLocation(c.meshoptDecoderLocation);const d=c.lottieLoaderLocation||"https://cdn.jsdelivr.net/npm/three@0.149.0/examples/jsm/loaders/LottieLoader.js";cp.singleton.textureUtils.lottieLoaderUrl=d}connectedCallback(){super.connectedCallback(),this.loaded||this.showPoster(),this[Af].addEventListener("progress",this[Cx])}disconnectedCallback(){super.disconnectedCallback(),this[Af].removeEventListener("progress",this[Cx])}async updated(e){super.updated(e),e.has("poster")&&null!=this.poster&&(this[bx].style.backgroundImage=`url(${this.poster})`),e.has("alt")&&this[bx].setAttribute("aria-label",this[Jm]),(e.has("reveal")||e.has("loading"))&&this[Xm]()}[(t=vx,s=xx,i=fx,n=bx,a=mx,r=Ix,o=wx,l=Cx,uf)](){return!!this.src&&(this[xx]||this.loading===gx||this.reveal===ux&&this[zm])}[yx](){this[xx]=!1;const e=this[fx];if(!e.classList.contains("show"))return;e.classList.remove("show"),this[tf].classList.add("show");const t=this.modelIsVisible;this[vx]=!0,this[Vm](t);const s=this.getRootNode();s&&s.activeElement===this&&this[tf].focus();const i=this[bx];i.setAttribute("aria-hidden","true"),i.tabIndex=-1,this.dispatchEvent(new CustomEvent("poster-dismissed"))}[df](){return super[df]()&&this[vx]}}return dx([ur({type:String})],c.prototype,"poster",void 0),dx([ur({type:String})],c.prototype,"reveal",void 0),dx([ur({type:String})],c.prototype,"loading",void 0),c})((e=>{var t;class s extends e{constructor(...e){super(e),this.autoplay=!1,this.animationName=void 0,this.animationCrossfadeDuration=300,this[t]=!0,this[nf].subscribeMixerEvent("loop",e=>{const t=e.action._loopCount,s=e.action._clip.name,i=e.action._clip.uuid,n=this[nf].markedAnimations.find(e=>e.name===s);if(n){this[nf].updateAnimationLoop(n.name,n.loopMode,n.repetitionCount);const e=this[nf].markedAnimations.filter(e=>e.name!==s);this[nf].markedAnimations=e}this.dispatchEvent(new CustomEvent("loop",{detail:{count:t,name:s,uuid:i}}))}),this[nf].subscribeMixerEvent("finished",e=>{if(this[nf].appendedAnimations.includes(e.action._clip.name)){const t=this[nf].appendedAnimations.filter(t=>t!==e.action._clip.name);this[nf].appendedAnimations=t}else this[vf]=!0;this.dispatchEvent(new CustomEvent("finished"))})}get availableAnimations(){return this.loaded?this[nf].animationNames:[]}get duration(){return this[nf].duration}get paused(){return this[vf]}get currentTime(){return this[nf].animationTime}get appendedAnimations(){return this[nf].appendedAnimations}set currentTime(e){this[nf].animationTime=e,this[af]()}get timeScale(){return this[nf].animationTimeScale}set timeScale(e){this[nf].animationTimeScale=e}pause(){this[vf]||(this[vf]=!0,this.dispatchEvent(new CustomEvent("pause")))}play(e){this.availableAnimations.length>0&&(this[vf]=!1,this[bf](e),this.dispatchEvent(new CustomEvent("play")))}appendAnimation(e,t){this.availableAnimations.length>0&&(this[vf]=!1,this[xf](e,t),this.dispatchEvent(new CustomEvent("append-animation")))}detachAnimation(e,t){this.availableAnimations.length>0&&(this[vf]=!1,this[yf](e,t),this.dispatchEvent(new CustomEvent("detach-animation")))}[(t=vf,of)](){super[of](),this[vf]=!0,null!=this.animationName&&this[bf](),this.autoplay&&this.play()}[rf](e,t){super[rf](e,t),this[vf]||!this[df]()&&!this[cf].isPresenting||(this[nf].updateAnimation(t/1e3),this[af]())}updated(e){super.updated(e),e.has("autoplay")&&this.autoplay&&this.play(),e.has("animationName")&&this[bf]()}[bf](e=wf){var t;const s=null!==(t=e.repetitions)&&void 0!==t?t:1/0,i=e.pingpong?Fs:1===s?Ls:js;this[nf].playAnimation(this.animationName,this.animationCrossfadeDuration/1e3,i,s),this[vf]&&(this[nf].updateAnimation(0),this[af]())}[xf](e="",t=If){var s;const i=null!==(s=t.repetitions)&&void 0!==s?s:1/0,n=t.pingpong?Fs:1===i?Ls:js,a=!!t.repetitions||"pingpong"in t;this[nf].appendAnimation(e||this.animationName,n,i,t.weight,t.timeScale,t.fade,t.warp,t.relativeWarp,t.time,a),this[vf]&&(this[nf].updateAnimation(0),this[af]())}[yf](e="",t=Cf){this[nf].detachAnimation(e||this.animationName,t.fade),this[vf]&&(this[nf].updateAnimation(0),this[af]())}}return ff([ur({type:Boolean})],s.prototype,"autoplay",void 0),ff([ur({type:String,attribute:"animation-name"})],s.prototype,"animationName",void 0),ff([ur({type:Number,attribute:"animation-crossfade-duration"})],s.prototype,"animationCrossfadeDuration",void 0),s})(mf))))))));customElements.define("model-viewer",Mx);const Rx=({modelUrl:e,posterUrl:t,title:s})=>ie.jsxs("div",{className:"spatial-container flex flex-col items-center justify-center p-4 bg-nexus-obsidian/80 backdrop-blur-xl rounded-3xl border border-white/10 shadow-2xl",children:[ie.jsx("h3",{className:"text-2xl font-orbitron text-glow mb-4",children:s}),ie.jsx("div",{className:"model-viewer-wrapper w-full aspect-square relative rounded-2xl overflow-hidden bg-black/40",children:ie.jsx("model-viewer",{src:e,poster:t,alt:s,ar:!0,"ar-modes":"webxr scene-viewer quick-look","camera-controls":!0,"auto-rotate":!0,"shadow-intensity":"1",style:{width:"100%",height:"100%",backgroundColor:"transparent"},children:ie.jsx("button",{slot:"ar-button",className:"absolute bottom-4 right-4 bg-nexus-violet px-6 py-2 rounded-full font-bold shadow-lg flex items-center gap-2",children:ie.jsx("span",{children:" VER EN AR"})})})}),ie.jsxs("div",{className:"viture-info mt-6 p-4 rounded-xl bg-white/5 border border-white/5 text-sm text-nexus-silver text-center",children:[ie.jsxs("p",{children:["Optimizado para ",ie.jsx("b",{children:"Viture One XR"})]}),ie.jsx("p",{className:"opacity-60 text-xs mt-1",children:"HFOV 43 | Proyeccin Espacial Activa"})]})]}),Dx=[{id:"core-server",name:"Nexus Nucleus v1",description:"El corazn de AIGestion. Procesamiento neuronal distribuido de alto rendimiento.",modelUrl:"https://modelviewer.dev/shared-assets/models/Astronaut.glb",posterUrl:"https://modelviewer.dev/shared-assets/models/Astronaut.png",category:"HARDWARE"},{id:"drone",name:"AIG Sentinel Drone",description:"Vigilancia y mantenimiento automatizado en entornos XR.",modelUrl:"https://modelviewer.dev/shared-assets/models/RobotExpressive.glb",posterUrl:"https://modelviewer.dev/shared-assets/models/RobotExpressive.png",category:"INFRASTRUCTURE"},{id:"satellite",name:"Neural Satellite",description:"Nodo orbital para la sincronizacin global de inteligencia soberana.",modelUrl:"https://modelviewer.dev/shared-assets/models/NeilArmstrong.glb",posterUrl:"https://modelviewer.dev/shared-assets/models/NeilArmstrong.png",category:"ORBITAL"}],Nx=()=>{const[e,t]=Us.useState(Dx[0]),[s,i]=Us.useState(!1);return ie.jsxs("div",{className:"w-full flex flex-col lg:flex-row gap-12 items-center lg:items-start",children:[ie.jsx("div",{className:"w-full lg:w-2/3 relative",children:ie.jsx(zs,{mode:"wait",children:s?ie.jsxs(qs.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"relative aspect-video rounded-3xl overflow-hidden glass-morphism border border-cyan-400/30 flex flex-col items-center justify-center bg-cyan-400/5",children:[ie.jsxs("div",{className:"relative",children:[ie.jsx(qs.div,{className:"w-32 h-32 border-2 border-cyan-400/40 rounded-full",animate:{scale:[1,1.5,1],opacity:[.5,1,.5]},transition:{duration:2,repeat:1/0}}),ie.jsx(ti,{className:"w-12 h-12 text-cyan-400 absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 animate-pulse"})]}),ie.jsx("div",{className:"mt-8 text-cyan-400 font-orbitron tracking-[0.4em] text-xs",children:"CALIBRANDO ESPACIO REAL..."}),ie.jsx(qs.div,{className:"absolute left-0 right-0 h-1 bg-cyan-400/50 shadow-[0_0_15px_#00f5ff]",animate:{top:["0%","100%","0%"]},transition:{duration:1.5,repeat:1/0,ease:"linear"}})]},"scanning"):ie.jsxs(qs.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"relative aspect-video rounded-3xl overflow-hidden glass-morphism border border-white/10",children:[ie.jsx(Rx,{modelUrl:e.modelUrl,posterUrl:e.posterUrl,title:e.name}),ie.jsxs("div",{className:"absolute top-6 left-6 flex flex-col gap-2 pointer-events-none",children:[ie.jsx("span",{className:"bg-cyan-400 text-black text-[10px] font-bold px-2 py-0.5 rounded-full self-start",children:"ASSET READY"}),ie.jsxs("span",{className:"text-white/40 text-[10px] font-mono uppercase tracking-[0.2em]",children:["ID: ",e.id.toUpperCase()]})]})]},e.id)})}),ie.jsxs("div",{className:"w-full lg:w-1/3 space-y-8",children:[ie.jsxs("div",{className:"space-y-4",children:[ie.jsxs("div",{className:"flex items-center gap-3",children:[ie.jsx(si,{className:"w-6 h-6 text-cyan-400"}),ie.jsx("h3",{className:"text-2xl font-orbitron font-bold text-white uppercase tracking-tighter",children:"LABORATORIO DE PROYECCIN"})]}),ie.jsx("p",{className:"text-nexus-silver/70 text-sm leading-relaxed",children:"Selecciona un activo de la infraestructura Nexus y proyctalo en tu entorno fsico para anlisis detallado."})]}),ie.jsx("div",{className:"grid grid-cols-1 gap-4",children:Dx.map(s=>ie.jsxs("button",{onClick:()=>t(s),className:"p-4 rounded-2xl border transition-all flex items-start gap-4 text-left group\n                "+(e.id===s.id?"bg-cyan-400/10 border-cyan-400/50 shadow-[0_0_20px_rgba(0,245,255,0.1)]":"bg-white/5 border-white/10 hover:border-white/30"),children:[ie.jsx("div",{className:"p-3 rounded-xl transition-colors "+(e.id===s.id?"bg-cyan-400 text-black":"bg-white/5 text-white/50 group-hover:text-white"),children:ie.jsx(ii,{className:"w-5 h-5"})}),ie.jsxs("div",{children:[ie.jsx("div",{className:"text-sm font-bold text-white mb-1",children:s.name}),ie.jsx("div",{className:"text-[10px] text-white/40 uppercase tracking-widest",children:s.category})]})]},s.id))}),ie.jsxs("div",{className:"glass-morphism p-6 rounded-3xl border border-white/10 space-y-4",children:[ie.jsxs("div",{className:"flex items-center gap-2 text-cyan-400",children:[ie.jsx(ni,{className:"w-4 h-4"}),ie.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:"Detalles del Activo"})]}),ie.jsxs("p",{className:"text-xs text-nexus-silver/90 leading-relaxed italic",children:['"',e.description,'"']}),ie.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-4 border-t border-white/5",children:[ie.jsxs("div",{children:[ie.jsx("div",{className:"text-[10px] text-white/40 uppercase mb-1",children:"Escala"}),ie.jsx("div",{className:"text-xs font-bold text-white text-glow",children:"1:1 REAL"})]}),ie.jsxs("div",{children:[ie.jsx("div",{className:"text-[10px] text-white/40 uppercase mb-1",children:"Tracking"}),ie.jsx("div",{className:"text-xs font-bold text-white text-glow",children:"SPATIAL+"})]})]})]}),ie.jsxs(qs.button,{onClick:()=>{i(!0),setTimeout(()=>i(!1),3e3)},disabled:s,className:"w-full py-6 rounded-full glass-morphism border border-cyan-400/50 text-cyan-400 font-orbitron font-bold tracking-[0.2em] flex items-center justify-center gap-3 group hover:bg-cyan-400 hover:text-black transition-all",whileHover:{scale:1.02},whileTap:{scale:.98},children:[ie.jsx(ai,{className:"w-5 h-5 group-hover:scale-125 transition-transform"}),s?"DIAGNOSTICANDO...":"PROYECTAR EN MI MAPA"]})]})]})},Fx=({position:e,label:t,value:s,icon:i})=>ie.jsxs("div",{className:`fixed p-4 border-cyan-400/40 z-50 pointer-events-none transition-all duration-500 scale-90 md:scale-100 ${{"top-left":"top-8 left-8 border-t-2 border-l-2","top-right":"top-8 right-8 border-t-2 border-r-2 text-right","bottom-left":"bottom-8 left-8 border-b-2 border-l-2","bottom-right":"bottom-8 right-8 border-b-2 border-r-2 text-right"}[e]}`,children:[ie.jsxs("div",{className:"flex items-center gap-3 mb-1 text-cyan-400/60 font-orbitron text-[10px] tracking-[0.2em] uppercase",children:[e.includes("left")?i:null,t,e.includes("right")?i:null]}),ie.jsx("div",{className:"text-cyan-400 font-mono text-sm font-bold tracking-widest bg-cyan-400/5 px-2 py-1 rounded",children:s})]}),jx=({onComplete:e})=>{const[t,s]=Us.useState(0),i=[{text:"SCANNING RETINA...",icon:ie.jsx(ui,{className:"w-8 h-8"})},{text:"CONNECTING NEURAL LINK...",icon:ie.jsx(li,{className:"w-8 h-8"})},{text:"CALIBRATING VITURE OPTICS...",icon:ie.jsx(pi,{className:"w-8 h-8"})},{text:"SYNC COMPLETE. WELCOME TO NEXUS.",icon:ie.jsx(di,{className:"w-8 h-8"})}];return Us.useEffect(()=>{const t=setInterval(()=>{s(s=>s<i.length-1?s+1:(clearInterval(t),setTimeout(e,1e3),s))},1200);return()=>clearInterval(t)},[e]),ie.jsx(qs.div,{className:"fixed inset-0 z-[100] bg-black flex flex-col items-center justify-center",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:ie.jsxs("div",{className:"relative",children:[ie.jsx(qs.div,{className:"absolute -inset-12 border-2 border-cyan-500/20 rounded-full",animate:{rotate:360,scale:[1,1.1,1]},transition:{duration:4,repeat:1/0,ease:"linear"}}),ie.jsx(qs.div,{className:"absolute -inset-8 border-2 border-purple-500/20 rounded-full",animate:{rotate:-360,scale:[1,1.05,1]},transition:{duration:6,repeat:1/0,ease:"linear"}}),ie.jsxs(qs.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},className:"relative z-10 p-12 glass-morphism rounded-full border border-cyan-500/30 text-cyan-400 flex flex-col items-center gap-6",children:[i[t].icon,ie.jsx("div",{className:"font-orbitron tracking-[0.3em] text-xs font-bold text-center max-w-[200px]",children:i[t].text}),ie.jsx("div",{className:"w-32 h-1 bg-white/10 rounded-full overflow-hidden",children:ie.jsx(qs.div,{className:"h-full bg-cyan-400",initial:{width:0},animate:{width:"100%"},transition:{duration:1.2,ease:"linear"}})})]},t)]})})},Lx=()=>{const[e,t]=Us.useState(!1),[s,i]=Us.useState(!1),[n,a]=Us.useState("experiences"),[r,o]=Us.useState(0),[l,c]=Us.useState(0),A=Us.useRef(null),{playHover:h,playClick:d,playWuaw:u,playPulse:p,play:g}=(()=>{const e=Us.useCallback(e=>{try{Ha(e)}catch(t){}},[]),t=Us.useCallback(()=>e("hover_glass"),[e]),s=Us.useCallback(()=>e("click_activate"),[e]),i=Us.useCallback(()=>e("wuaw_subtle"),[e]),n=Us.useCallback(()=>e("data_pulse"),[e]);return{play:e,playHover:t,playClick:s,playWuaw:i,playPulse:n}})(),m=Vs(0),f=Vs(0),b=Ks(m,{stiffness:50,damping:20}),x=Ks(f,{stiffness:50,damping:20}),y=[{id:"quantum-leap",title:"SALTO CUNTICO",subtitle:"Antes: 2D  Despus: 11D",description:"Experimenta la computacin cuntica en 11 dimensiones. Ve los datos fluyendo como ros de luz interactivos.",beforeIcon:"",afterIcon:"",color:"from-purple-600 to-violet-800",particles:100,badge:"EXPERIMENTAL"},{id:"neural-interface",title:"INTERFAZ NEURAL",subtitle:"Antes: Teclado  Despus: Mente",description:"Conecta directamente con tu cerebro. Controla sistemas con el poder de tus pensamientos y biometra activa.",beforeIcon:"",afterIcon:"",color:"from-cyan-600 to-blue-800",particles:150,badge:"SYNC ACTIVE"},{id:"metaverse-office",title:"OFICINA METAVERSO",subtitle:"Antes: Cubculo  Despus: Infinito",description:"Tu oficina ahora es el universo entero. Reuniones en galaxias lejanas con colaboracin hologrfica.",beforeIcon:"",afterIcon:"",color:"from-green-600 to-emerald-800",particles:200,badge:"WORKSPACE"},{id:"war-room",title:"WAR ROOM ESTRATGICO",subtitle:"Antes: Excel  Despus: Campo de Batalla Digital",description:"Visualiza tu empresa como un organismo vivo. Toma decisiones en tiempo real con mapas tcticos globales.",beforeIcon:"",afterIcon:"",color:"from-red-600 to-orange-800",particles:250,badge:"TACTICAL"}],v=Us.useCallback(e=>{const{clientX:t,clientY:s}=e,{innerWidth:i,innerHeight:n}=window,a=40*(t/i-.5),r=40*(s/n-.5);m.set(a),f.set(r)},[m,f]);Us.useEffect(()=>{if(e){const e=setInterval(()=>{c(e=>e<100?e+1:100)},30);return g("nexus_hum"),()=>{clearInterval(e)}}c(0)},[e,g]);const w=y[r];return ie.jsxs("section",{id:"viture-xr",className:"relative min-h-screen overflow-hidden bg-black selection:bg-cyan-500/30",onMouseMove:e?v:void 0,children:[ie.jsx(zs,{children:s&&ie.jsx(jx,{onComplete:()=>{var e;i(!1),t(!0),p(),(null==(e=A.current)?void 0:e.requestFullscreen)&&A.current.requestFullscreen().catch(()=>console.log("Fullscreen failed")),document.body.style.cursor="none",document.body.classList.add("xr-active")}})}),ie.jsxs("div",{className:"absolute inset-0 z-0",children:[ie.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-900/40 via-black to-cyan-900/40"}),ie.jsx("div",{className:"absolute inset-0",children:[...Array(w.particles)].map((e,t)=>ie.jsx(qs.div,{className:`absolute w-1 h-1 bg-gradient-to-r ${w.color} rounded-full blur-[1px]`,style:{left:100*Math.random()+"%",top:100*Math.random()+"%"},animate:{z:[0,100,0],y:[0,-400],opacity:[0,.8,0],scale:[0,1.5,0]},transition:{duration:5+5*Math.random(),repeat:1/0,delay:5*Math.random()}},t))}),ie.jsx(qs.div,{className:"absolute inset-x-[-10%] inset-y-[-10%] z-[-1] opacity-20 pointer-events-none",style:{x:b,y:x},children:ie.jsx("div",{className:"w-full h-full bg-[url('/images/nexus/grid.svg')] bg-repeat opacity-30"})})]}),ie.jsxs("div",{ref:A,className:"relative z-10 min-h-screen flex flex-col items-center",children:[ie.jsx(zs,{children:e&&ie.jsxs(ie.Fragment,{children:[ie.jsx(Fx,{position:"top-left",label:"Signal",value:"SIGNAL: 98% AC",icon:ie.jsx(ri,{className:"w-3 h-3"})}),ie.jsx(Fx,{position:"top-right",label:"Retina",value:"ID: ALEX-01-GOD",icon:ie.jsx(ai,{className:"w-3 h-3"})}),ie.jsx(Fx,{position:"bottom-left",label:"Power",value:"CELL: 84% CRYO",icon:ie.jsx(oi,{className:"w-3 h-3"})}),ie.jsx(Fx,{position:"bottom-right",label:"Core",value:"TEMP: 32C KELV",icon:ie.jsx(li,{className:"w-3 h-3"})}),ie.jsxs("div",{className:"fixed top-12 left-1/2 -translate-x-1/2 flex gap-4 z-50",children:[ie.jsx("button",{onClick:()=>{d(),a("experiences")},className:"px-6 py-2 rounded-full font-orbitron text-[10px] tracking-[0.2em] transition-all border "+("experiences"===n?"bg-cyan-400 text-black border-cyan-400":"bg-black/50 text-cyan-400 border-cyan-400/30"),children:"EXPERIENCIAS"}),ie.jsx("button",{onClick:()=>{d(),a("ar_projection")},className:"px-6 py-2 rounded-full font-orbitron text-[10px] tracking-[0.2em] transition-all border "+("ar_projection"===n?"bg-purple-600 text-white border-purple-600":"bg-black/50 text-purple-400 border-purple-600/30"),children:"PROYECCIN AR"})]}),ie.jsx(qs.div,{className:"fixed bottom-12 left-1/2 -translate-x-1/2 px-6 py-2 glass-morphism border border-white/20 rounded-full font-orbitron text-[10px] tracking-[0.4em] text-white/40 uppercase z-50 pointer-events-none",initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},children:"experiences"===n?`PROCESADOR NEURAL ACTIVO // MODO XR NIVEL ${l}`:"LABORATORIO DE PROYECCIN ACTIVO // MAPEO ESPACIAL"})]})}),ie.jsx(qs.div,{className:"flex-1 flex flex-col items-center justify-center p-6 w-full max-w-7xl transition-all duration-1000 "+(e?"scale-95":"scale-100"),style:{x:e?b:0,y:e?x:0},children:e?ie.jsx(ie.Fragment,{children:"experiences"===n?ie.jsxs("div",{className:"grid lg:grid-cols-2 gap-16 items-center w-full",children:[ie.jsxs(qs.div,{className:"relative aspect-video rounded-3xl overflow-hidden glass-morphism border border-white/10 group",initial:{opacity:0,x:-50},animate:{opacity:1,x:0},children:[ie.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${w.color} opacity-40 mix-blend-overlay`}),ie.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center p-12",children:[ie.jsx(qs.div,{className:"text-8xl mb-8",animate:{scale:[1,1.1,1],rotate:[0,5,-5,0]},transition:{duration:4,repeat:1/0},children:w.afterIcon}),ie.jsxs("div",{className:"text-center",children:[ie.jsx("span",{className:"text-[10px] font-bold text-cyan-400 tracking-[0.5em] uppercase mb-4 block",children:w.badge}),ie.jsx("h3",{className:"text-4xl font-orbitron font-bold text-white mb-2",children:w.title}),ie.jsx("p",{className:"text-nexus-silver/80 italic",children:w.subtitle})]})]}),ie.jsx(qs.div,{className:"absolute left-0 right-0 h-1 bg-cyan-400/50 blur-[2px] z-20",animate:{top:["0%","100%"]},transition:{duration:3,repeat:1/0,ease:"linear"}})]}),ie.jsxs("div",{className:"space-y-12",children:[ie.jsxs("div",{className:"space-y-6",children:[ie.jsx("div",{className:"flex gap-2",children:y.map((e,t)=>ie.jsx("button",{onClick:()=>{d(),o(t)},className:"w-3 h-3 rounded-full transition-all duration-500 "+(r===t?"bg-cyan-400 w-12":"bg-white/20 hover:bg-white/40")},t))}),ie.jsx("h3",{className:`text-4xl md:text-6xl font-orbitron font-black bg-gradient-to-r ${w.color} bg-clip-text text-transparent`,children:w.title}),ie.jsx("p",{className:"text-nexus-silver/90 text-xl font-light leading-relaxed",children:w.description})]}),ie.jsx("div",{className:"grid grid-cols-2 gap-6",children:[{icon:ie.jsx(ci,{className:"w-5 h-5"}),label:"Holografa",val:"Activa"},{icon:ie.jsx(Ai,{className:"w-5 h-5"}),label:"Latencia",val:"0.1ms"},{icon:ie.jsx(hi,{className:"w-5 h-5"}),label:"Resolucin",val:"8K Spatial"},{icon:ie.jsx(di,{className:"w-5 h-5"}),label:"Seguridad",val:"E2E Quantum"}].map((e,t)=>ie.jsxs("div",{className:"glass-morphism p-4 rounded-2xl border border-white/5 flex items-center gap-4",children:[ie.jsx("div",{className:"text-cyan-400",children:e.icon}),ie.jsxs("div",{children:[ie.jsx("div",{className:"text-[10px] text-white/40 uppercase tracking-tighter",children:e.label}),ie.jsx("div",{className:"text-xs font-bold text-white tracking-widest",children:e.val})]})]},t))}),ie.jsx(qs.button,{onClick:()=>{d(),t(!1),c(0),document.body.style.cursor="auto",document.body.classList.remove("xr-active"),document.fullscreenElement&&document.exitFullscreen()},className:"px-8 py-4 border border-red-500/30 text-red-500 rounded-full font-orbitron text-xs font-bold tracking-[0.2em] hover:bg-red-500/10 transition-colors",children:"TERMINAR SESIN XR"})]})]}):ie.jsx(Nx,{})}):ie.jsxs("div",{className:"text-center",children:[ie.jsxs(qs.div,{className:"inline-flex items-center gap-3 px-6 py-3 bg-gradient-to-r from-purple-600/20 to-cyan-600/20 shadow-[0_0_20px_rgba(138,43,226,0.2)] border border-purple-400/30 rounded-full mb-8",initial:{scale:.8},animate:{scale:1},children:[ie.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse shadow-[0_0_10px_#4ade80]"}),ie.jsx("span",{className:"text-green-400 font-orbitron text-[10px] font-bold tracking-[0.2em] uppercase",children:"Viture Pro XR Ready"})]}),ie.jsxs("h1",{className:"text-6xl md:text-9xl font-orbitron font-black text-white mb-6 leading-none",children:[ie.jsx("span",{className:"block text-transparent bg-clip-text bg-gradient-to-br from-white via-white to-white/40",children:"EXPERIENCIA"}),ie.jsx("span",{className:"block text-transparent bg-clip-text bg-gradient-to-r from-purple-400 via-cyan-400 to-purple-400 bg-[length:200%_auto] animate-gradient-flow",children:"VITURE XR"})]}),ie.jsx("p",{className:"text-xl text-nexus-silver/60 mb-12 max-w-2xl mx-auto font-light leading-relaxed italic",children:'"No es solo ver el futuro; es vivir dentro de l con la precisin de 11 dimensiones."'}),ie.jsxs(qs.button,{onClick:()=>{u(),i(!0)},className:"group relative px-12 py-6 glass-morphism rounded-full text-white font-bold text-xl overflow-hidden border border-white/20 transition-all hover:border-cyan-400/50",whileHover:{scale:1.05},whileTap:{scale:.95},onMouseEnter:h,children:[ie.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-purple-600/20 to-cyan-600/20 opacity-0 group-hover:opacity-100 transition-opacity"}),ie.jsxs("span",{className:"relative z-10 flex items-center gap-4 tracking-[0.1em]",children:[ie.jsx(ai,{className:"w-6 h-6 text-cyan-400"}),"ENTRAR EN LA MATRIZ"]})]})]})})]}),ie.jsx(zs,{children:e&&ie.jsxs(qs.div,{className:"fixed inset-0 pointer-events-none z-40",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[ie.jsx("div",{className:"absolute inset-0 bg-radial-at-center from-transparent via-transparent to-black/60"}),ie.jsx("div",{className:"absolute inset-0 opacity-10 mix-blend-screen bg-gradient-to-r from-red-500/10 via-green-500/10 to-blue-500/10"}),ie.jsx("div",{className:"absolute inset-0 bg-[url('/images/nexus/scanlines.svg')] opacity-[0.03] pointer-events-none"}),ie.jsxs("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-8 h-8 opacity-20",children:[ie.jsx("div",{className:"absolute inset-0 border border-cyan-400/50 rounded-full"}),ie.jsx("div",{className:"absolute top-1/2 left-0 right-0 h-[1px] bg-cyan-400/50"}),ie.jsx("div",{className:"absolute left-1/2 top-0 bottom-0 w-[1px] bg-cyan-400/50"})]})]})})]})},Px=Us.createContext(void 0),Ux=({children:e})=>{const[t,s]=Us.useState("dashboard"),[i,n]=Us.useState(!0),a=()=>n(e=>!e);return ie.jsx(Px.Provider,{value:{activeActivity:t,setActiveActivity:e=>{t===e?a():(s(e),n(!0))},isSidebarOpen:i,toggleSidebar:a,setSidebarOpen:n},children:e})},Ox=()=>{const e=Us.useContext(Px);if(!e)throw new Error("useWorkbench must be used within a WorkbenchProvider");return e},Gx=({activityBar:e,sideBar:t,mainArea:s,bottomPanel:i,statusBar:n})=>{const{isSidebarOpen:a}=Ox();return ie.jsxs("div",{className:"flex flex-col h-screen w-screen overflow-hidden bg-[#050505] text-white selection:bg-cyan-500/30 font-sans",children:[ie.jsxs("div",{className:"fixed inset-0 pointer-events-none z-0 overflow-hidden",children:[ie.jsx("div",{className:"absolute top-[-20%] left-[-10%] w-[60%] h-[60%] bg-purple-900/10 blur-[150px] rounded-full mix-blend-screen opacity-50"}),ie.jsx("div",{className:"absolute bottom-[-20%] right-[-10%] w-[60%] h-[60%] bg-cyan-900/10 blur-[150px] rounded-full mix-blend-screen opacity-50"})]}),ie.jsxs("div",{className:"flex flex-1 overflow-hidden z-10 backdrop-blur-[1px]",children:[ie.jsx("aside",{className:"w-[60px] flex-shrink-0 border-r border-white/5 bg-[#0a0a0a]/90 backdrop-blur-xl z-30 flex flex-col justify-between shadow-[4px_0_30px_rgba(0,0,0,0.5)]",children:e}),ie.jsx(qs.aside,{initial:!1,animate:{width:a?300:0,opacity:a?1:0},transition:{duration:.3,ease:[.22,1,.36,1]},className:"flex-shrink-0 border-r border-white/5 bg-[#0e0e0e]/80 backdrop-blur-md overflow-hidden relative",children:ie.jsxs("div",{className:"w-[300px] h-full relative",children:[ie.jsx("div",{className:"absolute inset-y-0 right-0 w-[1px] bg-gradient-to-b from-transparent via-white/10 to-transparent opacity-50"}),t]})}),ie.jsxs("main",{className:"flex-1 flex flex-col min-w-0 bg-transparent overflow-hidden relative",children:[ie.jsx("div",{className:"flex-1 overflow-hidden relative rounded-tl-xl border-t border-l border-white/5 bg-[#121212]/60 backdrop-blur-sm shadow-inner mx-1 mt-1 transition-all",children:s}),ie.jsx(zs,{children:i&&ie.jsx(qs.div,{initial:{height:0},animate:{height:200},exit:{height:0},className:"h-[200px] border-t border-white/10 bg-[#1e1e1e]",children:i})})]})]}),ie.jsx("footer",{className:"h-[24px] bg-[#007acc]/90 backdrop-blur-md text-white text-[10px] flex items-center px-3 select-none z-50 shadow-[0_-2px_10px_rgba(0,0,0,0.3)] justify-between border-t border-white/10",children:n})]})},Hx=()=>{const{activeActivity:e,setActiveActivity:t}=Ox(),s=[{id:"dashboard",icon:gi,label:"Dashboard"},{id:"search",icon:mi,label:"Search"},{id:"ai",icon:fi,label:"Daniela AI"},{id:"files",icon:bi,label:"Projects"}];return ie.jsxs("div",{className:"flex flex-col items-center py-4 h-full justify-between w-full",children:[ie.jsx("div",{className:"flex flex-col items-center gap-6 w-full",children:s.map(s=>{const i=s.icon,n=e===s.id;return ie.jsxs("button",{onClick:()=>t(s.id),title:s.label,className:`relative group p-2 transition-all duration-300 w-full flex justify-center\n                 ${n?"text-cyan-400":"text-gray-500 hover:text-gray-300 hover:bg-white/5"}\n               `,children:[n&&ie.jsxs(ie.Fragment,{children:[ie.jsx("div",{className:"absolute left-0 top-1/2 -translate-y-1/2 w-[3px] h-[24px] bg-cyan-400 rounded-r-full shadow-[0_0_10px_2px_rgba(34,211,238,0.5)]"}),ie.jsx("div",{className:"absolute inset-0 bg-cyan-400/5 blur-lg"})]}),ie.jsx(i,{size:26,strokeWidth:n?2:1.5,className:"transition-transform duration-300 "+(n?"scale-110 drop-shadow-[0_0_8px_rgba(34,211,238,0.6)]":"group-hover:scale-105")})]},s.id)})}),ie.jsx("div",{className:"flex flex-col items-center gap-6 w-full pb-4",children:ie.jsxs("button",{onClick:()=>t("settings"),title:"Settings",className:"p-2 transition-colors relative "+("settings"===e?"text-purple-400":"text-gray-500 hover:text-white hover:rotate-90 duration-500"),children:["settings"===e&&ie.jsx("div",{className:"absolute inset-0 bg-purple-500/10 blur-xl"}),ie.jsx(xi,{size:24,strokeWidth:1.5,className:"settings"===e?"drop-shadow-[0_0_8px_rgba(168,85,247,0.6)]":""})]})})]})},qx=()=>ie.jsxs("div",{className:"flex flex-col h-full bg-gradient-to-b from-[#1a1a1a] to-[#0d0d0d]",children:[ie.jsxs("div",{className:"p-3 border-b border-white/5 flex items-center gap-2 bg-white/5",children:[ie.jsx(yi,{size:14,className:"text-purple-400"}),ie.jsx("span",{className:"text-xs font-bold tracking-wider text-purple-100 uppercase",children:"Daniela AI Assistant"})]}),ie.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[ie.jsxs("div",{className:"flex gap-3",children:[ie.jsx("div",{className:"w-6 h-6 rounded-full bg-purple-600/20 flex items-center justify-center shrink-0 border border-purple-500/30",children:ie.jsx("span",{className:"text-[10px] font-bold text-purple-300",children:"AI"})}),ie.jsx("div",{className:"bg-white/5 p-3 rounded-tr-xl rounded-b-xl border border-white/10 text-sm text-gray-300 leading-relaxed max-w-[90%] shadow-lg backdrop-blur-sm",children:ie.jsx("p",{children:"Hello! I'm integrated into your workbench. I can help you analyze metrics, refactor code, or manage deployment tasks. What's on your mind?"})})]}),ie.jsxs("div",{className:"flex gap-3 flex-row-reverse",children:[ie.jsx("div",{className:"w-6 h-6 rounded-full bg-cyan-600/20 flex items-center justify-center shrink-0 border border-cyan-500/30",children:ie.jsx("span",{className:"text-[10px] font-bold text-cyan-300",children:"ME"})}),ie.jsx("div",{className:"bg-cyan-500/10 p-3 rounded-tl-xl rounded-b-xl border border-cyan-500/20 text-sm text-cyan-100 leading-relaxed shadow-[0_0_15px_rgba(6,182,212,0.1)]",children:ie.jsx("p",{children:"Analyze the current bundle size for me."})})]})]}),ie.jsxs("div",{className:"p-3 border-t border-white/10 bg-[#151515]",children:[ie.jsxs("div",{className:"relative",children:[ie.jsx("input",{type:"text",placeholder:"Ask Daniela...",className:"w-full bg-[#0a0a0a] border border-white/10 rounded-lg pl-3 pr-10 py-2.5 text-sm focus:outline-none focus:border-purple-500/50 focus:ring-1 focus:ring-purple-900/50 transition-all shadow-inner text-gray-200"}),ie.jsxs("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 flex items-center gap-1",children:[ie.jsx("button",{className:"p-1.5 hover:bg-white/10 rounded text-gray-400 hover:text-white transition-colors",children:ie.jsx(vi,{size:14})}),ie.jsx("button",{className:"p-1.5 hover:bg-purple-500/20 rounded text-purple-400 hover:text-purple-200 transition-colors",children:ie.jsx(wi,{size:14})})]})]}),ie.jsxs("div",{className:"text-[10px] text-gray-600 mt-2 flex justify-center gap-3",children:[ie.jsx("span",{className:"cursor-pointer hover:text-purple-400 transition-colors",children:"Generate Component"}),ie.jsx("span",{className:"cursor-pointer hover:text-purple-400 transition-colors",children:"Fix Bugs"}),ie.jsxs("span",{className:"cursor-pointer hover:text-purple-400 transition-colors",children:[" ","Explain Code"]})]})]})]}),zx=()=>{const{activeActivity:e}=Ox();return ie.jsxs("div",{className:"h-full flex flex-col font-sans",children:[ie.jsx("div",{className:"h-[40px] flex items-center px-4 text-[11px] font-bold uppercase tracking-[0.2em] text-cyan-200/50 select-none border-b border-white/5 bg-gradient-to-r from-white/5 to-transparent shadow-sm",children:e}),ie.jsxs("div",{className:"flex-1 overflow-y-auto p-0 scrollbar-thin scrollbar-thumb-white/10 scrollbar-track-transparent",children:["dashboard"===e&&ie.jsxs("div",{className:"text-sm",children:[ie.jsx("div",{className:"px-4 py-3 text-[10px] font-bold text-gray-500 uppercase opacity-70 tracking-widest",children:"Main Views"}),ie.jsx("ul",{className:"space-y-1 px-2",children:["Overview","Analytics","Real-time","System Health"].map(e=>ie.jsxs("li",{className:"cursor-pointer hover:bg-cyan-500/10 hover:text-cyan-300 text-gray-400 p-2 rounded-md transition-all duration-200 flex items-center gap-3 group border border-transparent hover:border-cyan-500/20",children:[ie.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-cyan-500/20 group-hover:bg-cyan-400 transition-colors shadow-[0_0_5px_rgba(6,182,212,0)] group-hover:shadow-[0_0_8px_rgba(6,182,212,0.5)]"}),e]},e))})]}),"ai"===e&&ie.jsx("div",{className:"h-full flex flex-col",children:ie.jsx(qx,{})}),"search"===e&&ie.jsx("div",{className:"flex flex-col gap-2 p-3",children:ie.jsxs("div",{className:"relative group",children:[ie.jsx("input",{type:"text",placeholder:"Search anything...",className:"w-full bg-[#181818] border border-[#303030] text-gray-200 text-xs p-2.5 pl-3 rounded-md focus:outline-none focus:border-cyan-500/50 focus:ring-1 focus:ring-cyan-900/50 placeholder:text-gray-600 transition-all shadow-inner group-hover:bg-[#1f1f1f]"}),ie.jsx("div",{className:"absolute right-2 top-2.5 text-[10px] text-gray-600 bg-[#222] px-1.5 rounded border border-[#333] opacity-70",children:"Ctrl+F"})]})})]})]})},Vx=()=>{const[e,t]=Us.useState([{role:"ai",text:"Hola, soy Daniela. En qu puedo ayudarte hoy?"}]),[s,i]=Us.useState(""),{isListening:n,transcript:a,isSpeaking:r,toggleListening:o,speak:l}=(()=>{const[e,t]=Us.useState(!1),[s,i]=Us.useState(""),[n,a]=Us.useState(!1),r=Us.useCallback(()=>{e?l():o()},[e]),o=()=>{t(!0);const{webkitSpeechRecognition:e}=window;if(!e)return;const s=new e;s.lang="es-ES",s.continuous=!1,s.interimResults=!0,s.onresult=e=>{const t=e.results,s=t[t.length-1][0].transcript;i(s)},s.onend=()=>{t(!1)},s.start()},l=()=>{t(!1)};return{isListening:e,transcript:s,isSpeaking:n,toggleListening:r,speak:e=>{a(!0);const t=new SpeechSynthesisUtterance(e);t.lang="es-ES",t.rate=1,t.pitch=1.1;const s=window.speechSynthesis.getVoices().find(e=>e.name.includes("Female")||e.name.includes("Google Espaol"));s&&(t.voice=s),t.onend=()=>a(!1),window.speechSynthesis.speak(t)}}})(),c=Us.useRef(null);Us.useEffect(()=>{a&&i(a)},[a]),Us.useEffect(()=>{var e;null==(e=c.current)||e.scrollIntoView({behavior:"smooth"})},[e]);const A=()=>{s.trim()&&(t(e=>[...e,{role:"user",text:s}]),i(""),setTimeout(()=>{const e=["Entendido. Estoy procesando esa solicitud.","He actualizado los parmetros del sistema segn tus indicaciones.","Analizando los datos... Aqu tienes el reporte.","Excelente eleccin. Procediendo con la ejecucin.","Sistemas nominales. Deseas algo ms?"],s=e[Math.floor(Math.random()*e.length)];t(e=>[...e,{role:"ai",text:s}]),l(s)},1e3))};return ie.jsxs("div",{className:"flex flex-col h-full bg-white/5 rounded-2xl border border-white/10 overflow-hidden",children:[ie.jsxs("div",{className:"p-4 border-b border-white/5 flex justify-between items-center bg-black/20",children:[ie.jsxs("div",{className:"flex items-center gap-3",children:[ie.jsxs("div",{className:"relative",children:[ie.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden border-2 border-nexus-cyan",children:ie.jsx("img",{src:"/images/daniela-avatar.jpg",alt:"Daniela",className:"w-full h-full object-cover",onError:e=>e.currentTarget.src="https://ui-avatars.com/api/?name=Daniela+AI&background=00f5ff&color=fff"})}),ie.jsx("div",{className:"absolute -bottom-1 -right-1 w-3 h-3 bg-green-500 rounded-full border-2 border-black"})]}),ie.jsxs("div",{children:[ie.jsx("h3",{className:"text-white font-bold text-sm",children:"Daniela AI"}),ie.jsx("p",{className:"text-nexus-cyan text-xs font-mono",children:"ONLINE // V2.4"})]})]}),ie.jsx("div",{className:"flex gap-2",children:r&&ie.jsxs("div",{className:"flex gap-1 h-3 items-end",children:[ie.jsx(qs.div,{className:"w-1 bg-nexus-cyan",animate:{height:[4,12,4]},transition:{repeat:1/0,duration:.5}}),ie.jsx(qs.div,{className:"w-1 bg-nexus-cyan",animate:{height:[6,10,2]},transition:{repeat:1/0,duration:.4}}),ie.jsx(qs.div,{className:"w-1 bg-nexus-cyan",animate:{height:[2,8,3]},transition:{repeat:1/0,duration:.6}})]})})]}),ie.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[e.map((e,t)=>ie.jsx(qs.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex "+("user"===e.role?"justify-end":"justify-start"),children:ie.jsx("div",{className:"max-w-[80%] p-3 rounded-2xl text-sm "+("user"===e.role?"bg-nexus-violet/20 text-white rounded-tr-sm border border-nexus-violet/30":"bg-white/10 text-gray-200 rounded-tl-sm border border-white/5"),children:e.text})},t)),ie.jsx("div",{ref:c})]}),ie.jsx("div",{className:"p-4 border-t border-white/5 bg-black/20",children:ie.jsxs("div",{className:"relative flex items-center gap-2",children:[ie.jsx("button",{onClick:o,className:"p-3 rounded-full transition-all "+(n?"bg-red-500/20 text-red-400 animate-pulse border border-red-500/50":"bg-white/5 text-gray-400 hover:text-white hover:bg-white/10"),children:n?ie.jsx(Ii,{size:20}):ie.jsx(vi,{size:20})}),ie.jsx("input",{type:"text",value:s,onChange:e=>i(e.target.value),onKeyDown:e=>"Enter"===e.key&&A(),placeholder:"Escribe un mensaje...",className:"flex-1 bg-white/5 border border-white/10 rounded-full px-4 py-3 text-white text-sm focus:outline-none focus:border-nexus-cyan/50 placeholder-gray-500"}),ie.jsx("button",{onClick:A,className:"p-3 bg-nexus-cyan text-black rounded-full hover:bg-cyan-400 transition-colors",children:ie.jsx(wi,{size:18})})]})})]})},Kx=({user:e,onLogout:t})=>{var s,i;const[n,a]=Us.useState("daniela"),[r,o]=Us.useState(!1),{status:l,messages:c,emotionalAnalysis:A,suggestedActions:h,isProcessing:d}=(()=>{const[e,t]=Us.useState("idle"),[s,i]=Us.useState([]),[n,a]=Us.useState(null),[r,o]=Us.useState([]),[l,c]=Us.useState(!1),[A,h]=Us.useState(!1),[d,u]=Us.useState(null),p={emotion:"neutral",confidence:.85,sentiment:"positive"},g=[{id:"1",text:"Ver dashboard principal",type:"navigation",priority:"high",context:"main"},{id:"2",text:"Analizar mtricas",type:"analysis",priority:"medium",context:"analytics"},{id:"3",text:"Contactar soporte",type:"support",priority:"low",context:"help"}];Us.useEffect(()=>{t("connecting"),setTimeout(()=>{t("active"),a(p),o(g)},1e3)},[]);const m=Us.useCallback(async()=>{l||(c(!0),u(null),setTimeout(()=>{const e={id:Date.now().toString(),role:"user",content:"Hola Daniela, cmo ests?",timestamp:new Date,emotionalAnalysis:p};i(t=>[...t,e]),setTimeout(()=>{const e={id:(Date.now()+1).toString(),role:"assistant",content:"Hola! Estoy perfectamente, gracias por preguntar. En qu puedo ayudarte hoy?",timestamp:new Date,emotionalAnalysis:p};i(t=>[...t,e]),c(!1)},1500)},2e3))},[l]),f=Us.useCallback(()=>{l&&c(!1)},[l]),b=Us.useCallback(async e=>{if(A)return;h(!0),u(null);const t={id:Date.now().toString(),role:"user",content:e,timestamp:new Date,emotionalAnalysis:p};i(e=>[...e,t]),setTimeout(()=>{const e=["Entendido. Estoy procesando tu solicitud.","He analizado tu petin. Aqu est la respuesta.","Interesante. Djame generar un reporte para ti.","Perfecto. Ejecutando la accin solicitada.","Comprendido. Hay algo ms en lo que pueda ayudarte?"],t={id:(Date.now()+1).toString(),role:"assistant",content:e[Math.floor(Math.random()*e.length)],timestamp:new Date,emotionalAnalysis:p};i(e=>[...e,t]),h(!1)},1e3)},[A]),x=Us.useCallback(()=>{i([]),u(null)},[]);return{status:e,messages:s,emotionalAnalysis:n,suggestedActions:r,isRecording:l,isProcessing:A,error:d,startRecording:m,stopRecording:f,sendTextMessage:b,clearConversation:x}})(e.email),u=[{id:"daniela",label:"Daniela AI",icon:Bi,color:"from-nexus-cyan to-nexus-violet"},{id:"analytics",label:"Analytics",icon:Qi,color:"from-green-500 to-emerald-600"},{id:"settings",label:"Configuracin",icon:xi,color:"from-orange-500 to-red-600"}],p={free:"text-nexus-silver",premium:"text-nexus-violet",enterprise:"text-nexus-gold"};return ie.jsxs("div",{className:"min-h-screen bg-nexus-obsidian text-white",children:[ie.jsx("div",{className:"lg:hidden fixed top-4 left-4 z-50",children:ie.jsx("button",{onClick:()=>o(!r),className:"p-2 rounded-lg bg-white/5 backdrop-blur-3xl border border-white/10",children:r?ie.jsx(Zs,{className:"w-5 h-5"}):ie.jsx(ei,{className:"w-5 h-5"})})}),ie.jsx(zs,{children:ie.jsxs(ie.Fragment,{children:[r&&ie.jsx(qs.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>o(!1),className:"lg:hidden fixed inset-0 bg-black/50 z-40"}),ie.jsxs(qs.aside,{initial:{x:-300},animate:{x:0},exit:{x:-300},transition:{type:"spring",damping:25},className:"fixed lg:relative z-50 w-72 h-screen bg-nexus-obsidian-deep border-r border-white/10 "+(r?"block":"hidden lg:block"),children:[ie.jsx("div",{className:"p-6 border-b border-white/10",children:ie.jsxs("div",{className:"flex items-center gap-4",children:[ie.jsx("div",{className:"w-12 h-12 rounded-full bg-linear-to-br from-nexus-cyan to-nexus-violet flex items-center justify-center",children:ie.jsx(Ci,{className:"w-6 h-6 text-white"})}),ie.jsxs("div",{children:[ie.jsx("h3",{className:"font-semibold text-white",children:e.name}),ie.jsx("p",{className:"text-sm text-nexus-silver",children:e.email}),ie.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[ie.jsx(Ei,{className:"w-3 h-3 text-nexus-cyan"}),ie.jsx("span",{className:`text-xs font-medium ${p[e.subscription]}`,children:e.subscription.toUpperCase()})]})]})]})}),ie.jsx("nav",{className:"p-4",children:ie.jsx("div",{className:"space-y-2",children:u.map(e=>{const t=e.icon;return ie.jsxs("button",{onClick:()=>{a(e.id),o(!1)},className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-all "+(n===e.id?`bg-linear-to-r ${e.color} text-white shadow-lg`:"text-nexus-silver hover:bg-white/5 hover:text-white"),children:[ie.jsx(t,{className:"w-5 h-5"}),ie.jsx("span",{className:"font-medium",children:e.label})]},e.id)})})}),ie.jsx("div",{className:"p-4 border-t border-white/10",children:ie.jsxs("div",{className:"space-y-4",children:[ie.jsxs("div",{className:"flex items-center justify-between",children:[ie.jsx("span",{className:"text-nexus-silver text-sm",children:"Conversaciones"}),ie.jsx("span",{className:"text-white font-semibold",children:c.length})]}),ie.jsxs("div",{className:"flex items-center justify-between",children:[ie.jsx("span",{className:"text-nexus-silver text-sm",children:"Estado"}),ie.jsx("span",{className:"text-sm font-medium "+(d?"text-yellow-400":"active"===l?"text-green-400":"error"===l?"text-red-400":"text-nexus-silver"),children:d?"Procesando":"active"===l?"Activo":"error"===l?"Error":"Inactivo"})]}),ie.jsxs("div",{className:"flex items-center justify-between",children:[ie.jsx("span",{className:"text-nexus-silver text-sm",children:"Suscripcin"}),ie.jsx("span",{className:`text-xs font-medium ${p[e.subscription]}`,children:e.subscription})]})]})}),ie.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-4 border-t border-white/10",children:ie.jsxs("button",{onClick:t,className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg text-nexus-silver hover:bg-white/5 hover:text-white transition-all",children:[ie.jsx(Si,{className:"w-5 h-5"}),ie.jsx("span",{children:"Cerrar Sesin"})]})})]})]})}),ie.jsxs("div",{className:"lg:ml-72 min-h-screen",children:[ie.jsx("header",{className:"bg-nexus-obsidian-deep border-b border-white/10 px-6 py-4",children:ie.jsxs("div",{className:"flex items-center justify-between",children:[ie.jsxs("div",{children:[ie.jsx("h1",{className:"text-2xl font-orbitron font-bold text-white",children:null==(s=u.find(e=>e.id===n))?void 0:s.label}),ie.jsxs("p",{className:"text-nexus-silver text-sm mt-1",children:["daniela"===n&&"Tu asistente de IA emocional","analytics"===n&&"Mtricas y anlisis de uso","settings"===n&&"Configuracin de tu cuenta"]})]}),ie.jsxs("div",{className:"flex items-center gap-4",children:[ie.jsxs("div",{className:"flex items-center gap-2",children:[ie.jsx("div",{className:"w-2 h-2 rounded-full "+(d?"bg-yellow-400 animate-pulse":"active"===l?"bg-green-400":"error"===l?"bg-red-400":"bg-nexus-silver")}),ie.jsx("span",{className:"text-sm text-nexus-silver hidden sm:block",children:d?"Procesando...":"active"===l?"Daniela Activa":"error"===l?"Error":"Inactivo"})]}),ie.jsxs("div",{className:"hidden sm:flex items-center gap-3",children:[ie.jsx("div",{className:"w-8 h-8 rounded-full bg-linear-to-br from-nexus-cyan to-nexus-violet flex items-center justify-center",children:ie.jsx(Ci,{className:"w-4 h-4 text-white"})}),ie.jsxs("div",{className:"text-right",children:[ie.jsx("p",{className:"text-sm font-medium text-white",children:e.name}),ie.jsx("p",{className:"text-xs text-nexus-silver",children:e.subscription})]})]})]})]})}),ie.jsx("main",{className:"p-6",children:ie.jsxs(zs,{mode:"wait",children:["daniela"===n&&ie.jsx(qs.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:ie.jsx(Vx,{})},"daniela"),"analytics"===n&&ie.jsxs(qs.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"space-y-6",children:[ie.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[ie.jsxs("div",{className:"bg-white/5 backdrop-blur-3xl border border-white/10 rounded-xl p-6",children:[ie.jsxs("div",{className:"flex items-center justify-between mb-4",children:[ie.jsx("h3",{className:"text-lg font-semibold text-white",children:"Conversaciones"}),ie.jsx(_i,{className:"w-5 h-5 text-nexus-cyan"})]}),ie.jsx("div",{className:"text-3xl font-bold text-white",children:c.length}),ie.jsx("p",{className:"text-nexus-silver text-sm",children:"Total este mes"})]}),ie.jsxs("div",{className:"bg-white/5 backdrop-blur-3xl border border-white/10 rounded-xl p-6",children:[ie.jsxs("div",{className:"flex items-center justify-between mb-4",children:[ie.jsx("h3",{className:"text-lg font-semibold text-white",children:"Estado Emocional"}),ie.jsx(ki,{className:"w-5 h-5 text-green-400"})]}),ie.jsx("div",{className:"text-3xl font-bold text-white",children:(null==(i=null==A?void 0:A.emotion)?void 0:i.toUpperCase())||"NEUTRAL"}),ie.jsxs("p",{className:"text-nexus-silver text-sm",children:["Confianza: ",(null==A?void 0:A.confidence)?`${Math.round(100*A.confidence)}%`:"N/A"]})]}),ie.jsxs("div",{className:"bg-white/5 backdrop-blur-3xl border border-white/10 rounded-xl p-6",children:[ie.jsxs("div",{className:"flex items-center justify-between mb-4",children:[ie.jsx("h3",{className:"text-lg font-semibold text-white",children:"Sugerencias"}),ie.jsx(Bi,{className:"w-5 h-5 text-nexus-violet"})]}),ie.jsx("div",{className:"text-3xl font-bold text-white",children:h.length}),ie.jsx("p",{className:"text-nexus-silver text-sm",children:"Acciones disponibles"})]}),ie.jsxs("div",{className:"bg-white/5 backdrop-blur-3xl border border-white/10 rounded-xl p-6",children:[ie.jsxs("div",{className:"flex items-center justify-between mb-4",children:[ie.jsx("h3",{className:"text-lg font-semibold text-white",children:"Suscripcin"}),ie.jsx(Ei,{className:"w-5 h-5 text-nexus-gold"})]}),ie.jsx("div",{className:"text-3xl font-bold text-white uppercase",children:e.subscription}),ie.jsx("p",{className:"text-nexus-silver text-sm",children:"Plan actual"})]})]}),ie.jsxs("div",{className:"bg-white/5 backdrop-blur-3xl border border-white/10 rounded-xl p-6",children:[ie.jsx("h3",{className:"text-xl font-semibold text-white mb-6",children:"Actividad Reciente"}),ie.jsx("div",{className:"h-64 flex items-center justify-center text-nexus-silver",children:ie.jsxs("div",{className:"text-center",children:[ie.jsx(Qi,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),ie.jsx("p",{children:"Grficos de actividad prximamente"})]})})]})]},"analytics"),"settings"===n&&ie.jsxs(qs.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"space-y-6",children:[ie.jsxs("div",{className:"bg-white/5 backdrop-blur-3xl border border-white/10 rounded-xl p-6",children:[ie.jsx("h3",{className:"text-xl font-semibold text-white mb-6",children:"Configuracin de Cuenta"}),ie.jsxs("div",{className:"space-y-6",children:[ie.jsxs("div",{children:[ie.jsx("label",{className:"block text-sm font-medium text-nexus-silver mb-2",children:"Nombre"}),ie.jsx("input",{type:"text",defaultValue:e.name,className:"w-full px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-nexus-cyan/50"})]}),ie.jsxs("div",{children:[ie.jsx("label",{className:"block text-sm font-medium text-nexus-silver mb-2",children:"Email"}),ie.jsx("input",{type:"email",defaultValue:e.email,disabled:!0,className:"w-full px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-nexus-silver cursor-not-allowed"})]}),ie.jsxs("div",{children:[ie.jsx("label",{className:"block text-sm font-medium text-nexus-silver mb-2",children:"Suscripcin Actual"}),ie.jsx("div",{className:"p-4 bg-white/5 border border-white/10 rounded-lg",children:ie.jsxs("div",{className:"flex items-center justify-between",children:[ie.jsx("span",{className:"text-white font-medium",children:e.subscription}),ie.jsx("button",{className:"px-4 py-2 bg-linear-to-r from-nexus-cyan to-nexus-violet text-white rounded-lg text-sm font-medium hover:from-nexus-cyan/80 hover:to-nexus-violet/80 transition-all",children:"Actualizar"})]})})]})]})]}),ie.jsxs("div",{className:"bg-white/5 backdrop-blur-3xl border border-white/10 rounded-xl p-6",children:[ie.jsx("h3",{className:"text-xl font-semibold text-white mb-6",children:"Preferencias de Daniela"}),ie.jsxs("div",{className:"space-y-6",children:[ie.jsxs("div",{children:[ie.jsx("label",{className:"block text-sm font-medium text-nexus-silver mb-2",children:"Voz de Daniela"}),ie.jsxs("select",{className:"w-full px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-nexus-cyan/50",children:[ie.jsx("option",{children:"Bella (Default)"}),ie.jsx("option",{children:"Adam"}),ie.jsx("option",{children:"Domi"}),ie.jsx("option",{children:"Elli"}),ie.jsx("option",{children:"Emily"})]})]}),ie.jsxs("div",{children:[ie.jsx("label",{className:"block text-sm font-medium text-nexus-silver mb-2",children:"Idioma"}),ie.jsxs("select",{className:"w-full px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-nexus-cyan/50",children:[ie.jsx("option",{children:"Espaol"}),ie.jsx("option",{children:"English"}),ie.jsx("option",{children:"Portugus"})]})]}),ie.jsx("div",{children:ie.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-nexus-silver mb-2",children:[ie.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded border-white/10 bg-white/5 text-nexus-cyan"}),"Notificaciones por email"]})})]})]})]},"settings")]})})]})]})},Jx=({user:e,onLogout:t})=>{const{activeActivity:s}=Ox();return ie.jsx("div",{className:"w-full h-full overflow-hidden bg-transparent",children:ie.jsx("div",{className:"h-full w-full overflow-y-auto custom-scrollbar",children:(()=>{switch(s){case"dashboard":default:return ie.jsx(Kx,{user:e,onLogout:t});case"search":return ie.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500",children:[ie.jsx("div",{className:"text-2xl font-light mb-2",children:"Global Search"}),ie.jsx("p",{children:"Search results will appear here"})]});case"settings":return ie.jsxs("div",{className:"p-10 text-white font-sans bg-[#050505] min-h-full",children:[ie.jsx("h1",{className:"text-3xl font-bold mb-8 text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-purple-500",children:"Settings"}),ie.jsxs("div",{className:"grid gap-6 max-w-xl",children:[ie.jsxs("div",{className:"bg-[#111] p-6 rounded-xl border border-white/5 shadow-2xl relative overflow-hidden group",children:[ie.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-cyan-500/5 to-purple-500/5 opacity-0 group-hover:opacity-100 transition-opacity"}),ie.jsx("label",{className:"block text-sm font-bold mb-3 text-gray-300",children:"Theme Preference"}),ie.jsxs("select",{className:"w-full bg-black/50 border border-white/10 rounded-lg p-3 text-sm focus:border-cyan-500/50 outline-none text-gray-300 backdrop-blur-sm",children:[ie.jsx("option",{children:"Cyberpunk Dark (Default)"}),ie.jsx("option",{children:"Nebula Blue"}),ie.jsx("option",{children:"Matrix Green"})]})]}),ie.jsxs("div",{className:"bg-[#111] p-6 rounded-xl border border-white/5 shadow-2xl relative overflow-hidden group",children:[ie.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-purple-500/5 to-pink-500/5 opacity-0 group-hover:opacity-100 transition-opacity"}),ie.jsx("label",{className:"block text-sm font-bold mb-3 text-gray-300",children:"Daniela Personality"}),ie.jsxs("select",{className:"w-full bg-black/50 border border-white/10 rounded-lg p-3 text-sm focus:border-purple-500/50 outline-none text-gray-300 backdrop-blur-sm",children:[ie.jsx("option",{children:"Professional (Technical)"}),ie.jsx("option",{children:"Casual (Friendly)"}),ie.jsx("option",{children:"Creative (Brainstorming)"})]})]})]})]})}})()})})},Yx=()=>ie.jsxs(ie.Fragment,{children:[ie.jsxs("div",{className:"flex items-center gap-4",children:[ie.jsxs("div",{className:"flex items-center gap-1.5 hover:bg-white/10 px-2 py-0.5 rounded cursor-pointer transition-colors group",children:[ie.jsx(Ti,{size:12,className:"text-cyan-400 group-hover:drop-shadow-[0_0_5px_cyan]"}),ie.jsx("span",{className:"font-semibold text-gray-300 group-hover:text-white",children:"main"})]}),ie.jsxs("div",{className:"flex items-center gap-1.5 hover:bg-white/10 px-2 py-0.5 rounded cursor-pointer transition-colors",children:[ie.jsx(Mi,{size:12,className:"text-gray-400"}),ie.jsx("span",{className:"text-gray-400 text-[10px]",children:"Todo Perfecto"})]})]}),ie.jsxs("div",{className:"flex items-center gap-4",children:[ie.jsxs("div",{className:"flex items-center gap-2 hover:bg-white/10 px-2 py-0.5 rounded cursor-pointer transition-colors",children:[ie.jsx("span",{className:"text-gray-500",children:"Ln 14, Col 32"}),ie.jsx("span",{className:"text-gray-500",children:"UTF-8"}),ie.jsx("span",{className:"text-cyan-600 font-bold text-[10px]",children:"TSX"})]}),ie.jsxs("div",{className:"flex items-center gap-1.5 hover:bg-purple-500/10 px-2 py-0.5 rounded cursor-pointer transition-colors group",children:[ie.jsx(Ri,{size:12,className:"text-purple-400 animate-pulse"}),ie.jsx("div",{className:"w-12 h-4 relative overflow-hidden hidden md:block",children:ie.jsxs(qs.svg,{viewBox:"0 0 100 20",className:"absolute inset-0 w-full h-full text-purple-400/30",children:[ie.jsx(qs.path,{d:"M 0,10 L 20,10 L 25,2 L 30,18 L 35,10 L 100,10",fill:"none",stroke:"currentColor",strokeWidth:"1",animate:{x:[0,-100]},transition:{duration:2,repeat:1/0,ease:"linear"}}),ie.jsx(qs.path,{d:"M 100,10 L 120,10 L 125,2 L 130,18 L 135,10 L 200,10",fill:"none",stroke:"currentColor",strokeWidth:"1",animate:{x:[0,-100]},transition:{duration:2,repeat:1/0,ease:"linear"}})]})}),ie.jsx("span",{className:"text-purple-300 group-hover:text-purple-200 transition-colors",children:"Cerebro: Muy bien"})]}),ie.jsxs("div",{className:"flex items-center gap-1.5 hover:bg-green-500/10 px-2 py-0.5 rounded cursor-pointer transition-colors",children:[ie.jsx(Di,{size:12,className:"text-green-400"}),ie.jsx("span",{className:"text-green-300",children:"Conectado"})]}),ie.jsx(Ni,{size:12,className:"text-gray-400 hover:text-white cursor-pointer"})]})]}),Wx=({user:e,onLogout:t})=>ie.jsx(Ux,{children:ie.jsx(Gx,{activityBar:ie.jsx(Hx,{}),sideBar:ie.jsx(zx,{}),mainArea:ie.jsx(Jx,{user:e,onLogout:t}),statusBar:ie.jsx(Yx,{})})}),$x=()=>{const{cursorX:e,cursorY:t,glowX:s,glowY:i}=(()=>{const e=Vs(0),t=Vs(0),s=Ys(e,e=>e-8),i=Ys(t,e=>e-8),n=Ys(e,e=>e-20),a=Ys(t,e=>e-20);return Us.useEffect(()=>{const s=s=>{e.set(s.clientX),t.set(s.clientY)};return window.addEventListener("mousemove",s),()=>window.removeEventListener("mousemove",s)},[e,t]),{cursorX:s,cursorY:i,glowX:n,glowY:a}})();return ie.jsxs(ie.Fragment,{children:[ie.jsx(qs.div,{className:"fixed w-4 h-4 bg-nexus-cyan rounded-full pointer-events-none z-50 mix-blend-screen",style:{x:e,y:t,boxShadow:"0 0 10px rgba(0, 245, 255, 0.8), 0 0 20px rgba(0, 245, 255, 0.4)"}}),ie.jsx(qs.div,{className:"fixed w-16 h-16 rounded-full pointer-events-none z-40 mix-blend-screen",style:{x:s,y:i,background:"radial-gradient(circle, rgba(0, 245, 255, 0.2) 0%, transparent 70%)",filter:"blur(20px)"}}),ie.jsx("style",{children:"\n        * {\n          cursor: none;\n        }\n        input, textarea, button, a {\n          cursor: none;\n        }\n      "})]})},Xx=()=>{const e=Vs(0),t=Vs(0);Us.useEffect(()=>{const s=s=>{e.set(s.clientX),t.set(s.clientY)};return window.addEventListener("mousemove",s),()=>window.removeEventListener("mousemove",s)},[e,t]);const s=Ws`radial-gradient(
    circle at ${e}px ${t}px,
    rgba(138, 43, 226, 0.3) 0%,
    rgba(0, 245, 255, 0.1) 25%,
    rgba(255, 215, 0, 0.05) 50%,
    transparent 100%
  )`;return ie.jsxs(qs.div,{onMouseMove:s=>{const{clientX:i,clientY:n}=s;e.set(i),t.set(n)},style:{backgroundImage:s},className:"fixed inset-0 z-0 transition-opacity duration-300 pointer-events-none",children:[ie.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-nexus-violet/5 via-transparent to-nexus-obsidian"}),ie.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-nexus-cyan/5 via-transparent to-nexus-obsidian"}),ie.jsx(qs.div,{animate:{x:[0,50,0],y:[0,30,0]},transition:{duration:8,repeat:1/0,repeatType:"mirror"},className:"absolute top-20 -left-40 w-80 h-80 bg-gradient-to-r from-nexus-violet/20 to-transparent rounded-full blur-3xl"}),ie.jsx(qs.div,{animate:{x:[0,-50,0],y:[0,-30,0]},transition:{duration:8,repeat:1/0,repeatType:"mirror",delay:1},className:"absolute bottom-20 -right-40 w-80 h-80 bg-gradient-to-l from-nexus-cyan/20 to-transparent rounded-full blur-3xl"})]})},Zx=({title:e,message:t,type:s="info",onClose:i})=>{const n={info:ie.jsx(ni,{className:"text-nexus-cyan",size:20}),success:ie.jsx(Li,{className:"text-green-400",size:20}),warning:ie.jsx(ji,{className:"text-yellow-400",size:20}),error:ie.jsx(Fi,{className:"text-red-400",size:20})};return ie.jsxs(qs.div,{initial:{opacity:0,x:100,scale:.9},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:50,scale:.95,filter:"blur(10px)"},className:`pointer-events-auto min-w-[320px] max-w-md premium-glass p-1 border ${{info:"border-nexus-cyan/30",success:"border-green-500/30",warning:"border-yellow-500/30",error:"border-red-500/30"}[s]} rounded-2xl shadow-[0_20px_50px_rgba(0,0,0,0.5)] overflow-hidden group`,children:[ie.jsxs("div",{className:"relative p-4 flex gap-4",children:[ie.jsx("div",{className:"flex-shrink-0 mt-1",children:n[s]}),ie.jsxs("div",{className:"flex-grow",children:[ie.jsx("h4",{className:"font-orbitron text-xs font-bold text-white tracking-widest uppercase mb-1 drop-shadow-glow",children:e}),ie.jsx("p",{className:"text-nexus-silver/70 text-sm leading-relaxed",children:t})]}),ie.jsx("button",{onClick:i,className:"flex-shrink-0 text-white/20 hover:text-white transition-colors",children:ie.jsx(Zs,{size:16})}),ie.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/0 via-white/5 to-white/0 translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-1000 ease-in-out pointer-events-none"})]}),ie.jsx(qs.div,{initial:{width:"100%"},animate:{width:"0%"},transition:{duration:5,ease:"linear"},className:"h-[2px] bg-gradient-to-r "+("info"===s?"from-nexus-cyan to-nexus-violet":"from-current to-transparent opacity-50")})]})},ey=Us.createContext(void 0),ty=({children:e})=>{const[t,s]=Us.useState([]),{playPop:i}=Ta(),n=Us.useCallback((e,t,n="info")=>{const a=Math.random().toString(36).substr(2,9);i(),s(s=>[...s,{id:a,title:e,message:t,type:n}]),setTimeout(()=>{s(e=>e.filter(e=>e.id!==a))},5e3)},[i]);return ie.jsxs(ey.Provider,{value:{notify:n},children:[e,ie.jsx("div",{className:"fixed bottom-8 right-8 z-[9999] flex flex-col gap-4 pointer-events-none",children:ie.jsx(zs,{children:t.map(e=>ie.jsx(Zx,{title:e.title,message:e.message,type:e.type,onClose:()=>s(t=>t.filter(t=>t.id!==e.id))},e.id))})})]})},sy=({onLogin:e,loading:t,error:s})=>{const[i,n]=Us.useState({email:"",password:""}),[a,r]=Us.useState(!1),[o,l]=Us.useState({}),c=e=>{const{name:t,value:s}=e.target;n(e=>({...e,[t]:s})),o[t]&&l(e=>({...e,[t]:void 0}))};return ie.jsx("div",{className:"min-h-screen bg-nexus-obsidian flex items-center justify-center px-4",children:ie.jsxs(qs.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"w-full max-w-md",children:[ie.jsxs("div",{className:"text-center mb-8",children:[ie.jsx(qs.div,{initial:{scale:.8},animate:{scale:1},transition:{duration:.5,delay:.2},className:"w-20 h-20 mx-auto mb-6 rounded-full bg-linear-to-br from-nexus-cyan to-nexus-violet flex items-center justify-center",children:ie.jsx("span",{className:"text-2xl font-bold text-white",children:"DA"})}),ie.jsx("h1",{className:"text-3xl font-orbitron font-black text-white mb-2",children:"Bienvenido a Daniela"}),ie.jsx("p",{className:"text-nexus-silver/60 text-sm",children:"Tu asistente de IA emocional est lista para ayudarte"})]}),ie.jsx("div",{className:"p-8 bg-nexus-obsidian/40 backdrop-blur-xl border border-white/10 rounded-lg",children:ie.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),(()=>{const e={};return i.email?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i.email)||(e.email="Email invlido"):e.email="El email es requerido",i.password?i.password.length<6&&(e.password="La contrasea debe tener al menos 6 caracteres"):e.password="La contrasea es requerida",l(e),0===Object.keys(e).length})())try{await e(i.email,i.password)}catch(s){}},className:"space-y-6",children:[ie.jsxs("div",{className:"space-y-2",children:[ie.jsx("label",{className:"text-sm font-orbitron text-nexus-cyan",children:"Email"}),ie.jsxs("div",{className:"relative",children:[ie.jsx(Pi,{className:"absolute left-3 top-3 h-5 w-5 text-nexus-silver/40"}),ie.jsx("input",{type:"email",name:"email",value:i.email,onChange:c,placeholder:"tu@email.com",disabled:t,className:"w-full pl-10 pr-4 py-2 bg-nexus-obsidian/60 border border-white/10 rounded-lg text-white placeholder-nexus-silver/40 focus:outline-none focus:border-nexus-cyan disabled:opacity-50"})]}),o.email&&ie.jsx("p",{className:"text-red-400 text-sm",children:o.email})]}),ie.jsxs("div",{className:"space-y-2",children:[ie.jsx("label",{className:"text-sm font-orbitron text-nexus-cyan",children:"Contrasea"}),ie.jsxs("div",{className:"relative",children:[ie.jsx($s,{className:"absolute left-3 top-3 h-5 w-5 text-nexus-silver/40"}),ie.jsx("input",{type:a?"text":"password",name:"password",value:i.password,onChange:c,placeholder:"",disabled:t,className:"w-full pl-10 pr-10 py-2 bg-nexus-obsidian/60 border border-white/10 rounded-lg text-white placeholder-nexus-silver/40 focus:outline-none focus:border-nexus-cyan disabled:opacity-50"}),ie.jsx("button",{type:"button",onClick:()=>r(!a),className:"absolute right-3 top-3 text-nexus-silver/40 hover:text-nexus-silver/60 disabled:opacity-50",disabled:t,children:a?ie.jsx(Ui,{className:"h-5 w-5"}):ie.jsx(Oi,{className:"h-5 w-5"})})]}),o.password&&ie.jsx("p",{className:"text-red-400 text-sm",children:o.password})]}),s&&ie.jsx(qs.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-red-500/10 border border-red-500/20 rounded-lg p-3",children:ie.jsxs("div",{className:"flex items-center text-red-400 text-sm",children:[ie.jsx(Gi,{className:"h-4 w-4 mr-2"}),s]})}),ie.jsx("button",{type:"submit",disabled:t,className:"w-full py-2 px-4 bg-nexus-violet text-white font-orbitron tracking-widest rounded-lg hover:bg-nexus-violet/80 disabled:opacity-50 transition-colors",children:t?"Iniciando sesin...":"Iniciar Sesin"}),ie.jsxs("div",{className:"space-y-3 text-center",children:[ie.jsx("button",{type:"button",className:"text-nexus-cyan hover:text-nexus-cyan/80 text-sm transition-colors disabled:opacity-50",disabled:t,children:"Olvidaste tu contrasea?"}),ie.jsxs("div",{className:"text-nexus-silver/40 text-sm",children:["Nuevo usuario?"," ",ie.jsx("button",{type:"button",className:"text-nexus-violet hover:text-nexus-violet/80 text-sm transition-colors disabled:opacity-50",disabled:t,children:"Regstrate gratis"})]})]})]})}),ie.jsx(qs.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.5},className:"mt-8 text-center",children:ie.jsxs("p",{className:"text-nexus-silver/40 text-xs",children:["Al iniciar sesin, aceptas nuestros"," ",ie.jsx("button",{className:"text-nexus-cyan hover:text-nexus-cyan/80 underline",children:"trminos y condiciones"})]})})]})})},iy=({onLogin:e,isAuthenticated:t})=>{const[s,i]=Us.useState(!1),[n,a]=Us.useState("");return t?ie.jsx(sa,{to:"/dashboard",replace:!0}):ie.jsx("div",{className:"min-h-screen bg-nexus-obsidian flex items-center justify-center",children:ie.jsx(sy,{onLogin:async(t,s)=>{i(!0),a("");try{await e(t,s)}catch(n){a(n instanceof Error?n.message:"Error al iniciar sesin")}finally{i(!1)}},loading:s,error:n})})},ny=({text:e,className:t=""})=>ie.jsxs("div",{className:`relative inline-block ${t}`,children:[ie.jsx("span",{className:"relative z-10",children:e}),ie.jsx("span",{className:"absolute top-0 left-0 -z-10 text-nexus-cyan opacity-50 animate-pulse translate-x-[2px]",children:e}),ie.jsx("span",{className:"absolute top-0 left-0 -z-10 text-nexus-violet opacity-50 animate-pulse -translate-x-[2px]",children:e})]}),ay=()=>{const{playHover:e,playClick:t,playWhoosh:s}=Ta(),{scrollY:i}=Js(),n=Ys(i,[0,500],[0,200]),a=Ys(i,[0,300],[1,0]),r=[{title:"Sala de Reuniones",description:"Un lugar donde puedes hablar con otras personas como si estuvieras all mismo. Ideal para charlar y compartir ideas.",icon:Hi,color:"from-blue-500/20 to-cyan-500/20",border:"group-hover:neon-glow-cyan"},{title:"Exposicin de Inventos",description:"Mira nuestros proyectos y productos en 3D. Puedes moverlos y verlos desde todos los ngulos.",icon:yi,color:"from-purple-500/20 to-pink-500/20",border:"group-hover:neon-glow-violet"},{title:"Tu Mesa de Trabajo",description:"Un espacio tranquilo donde tienes toda la informacin de tu negocio siempre a mano.",icon:hi,color:"from-green-500/20 to-emerald-500/20",border:"group-hover:shadow-[0_0_30px_rgba(16,185,129,0.3)]"},{title:"Fotos con IA",description:"Usa nuestra tecnologa para crear imgenes increbles de tu oficina o productos al instante.",icon:qi,color:"from-orange-500/20 to-yellow-500/20",border:"group-hover:shadow-[0_0_30px_rgba(245,158,11,0.3)]"}],o=({children:t,className:s=""})=>{const i=Us.useRef(null),n=Vs(0),a=Vs(0),r=Ys(a,[-.5,.5],[15,-15]),o=Ys(n,[-.5,.5],[-15,15]);return ie.jsx(qs.div,{ref:i,onMouseMove:e=>{if(!i.current)return;const t=i.current.getBoundingClientRect(),s=t.width,r=t.height,o=(e.clientX-t.left)/s-.5,l=(e.clientY-t.top)/r-.5;n.set(o),a.set(l)},onMouseLeave:()=>{n.set(0),a.set(0)},onMouseEnter:()=>e(),style:{rotateX:r,rotateY:o,transformStyle:"preserve-3d"},className:s,children:t})};return ie.jsxs("div",{className:"min-h-screen bg-nexus-obsidian pt-32 pb-24 px-6 relative overflow-hidden perspective-1000",children:[ie.jsx("div",{className:"fixed inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-[0.03] pointer-events-none z-50 mix-blend-overlay"}),ie.jsx(qs.div,{style:{y:n},className:"absolute inset-0 bg-radial-at-top from-nexus-violet/10 via-transparent to-transparent pointer-events-none"}),ie.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-nexus-cyan/5 blur-[120px] rounded-full pointer-events-none animate-pulse-glow"}),ie.jsxs("div",{className:"max-w-6xl mx-auto relative z-10",children:[ie.jsxs(qs.header,{style:{opacity:a},initial:{opacity:0,scale:.9,filter:"blur(10px)"},animate:{opacity:1,scale:1,filter:"blur(0px)"},transition:{duration:.8,ease:"circOut"},className:"text-center mb-20",children:[ie.jsx("h1",{className:"text-4xl md:text-7xl font-orbitron font-black text-transparent bg-clip-text bg-gradient-to-r from-white via-nexus-silver to-white mb-6 animate-pulse-glow drop-shadow-[0_0_15px_rgba(255,255,255,0.3)]",children:ie.jsx(ny,{text:"TU OFICINA DEL FUTURO"})}),ie.jsxs("p",{className:"text-nexus-silver/70 text-lg md:text-xl max-w-3xl mx-auto leading-relaxed",children:[ie.jsx("span",{className:"text-nexus-cyan-glow",children:""})," Antes de entrar, queremos que sepas que vas a viajar a un mundo virtual. Es como un videojuego, pero hecho para que tu empresa sea la mejor del mundo."]})]}),ie.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-20",children:r.map((e,t)=>{const s=e.icon;return ie.jsx(o,{className:"perspective-1000",children:ie.jsxs(qs.div,{initial:{opacity:0,x:t%2==0?-50:50},whileInView:{opacity:1,x:0},viewport:{once:!0},transition:{delay:.1*t,type:"spring"},className:`relative z-10 h-full p-8 rounded-[2rem] bg-gradient-to-br ${e.color} border border-white/5 backdrop-blur-sm group transition-all duration-300 ${e.border}`,children:[ie.jsxs("div",{className:"flex gap-6 items-start transform-style-3d group-hover:translate-z-10 transition-transform",children:[ie.jsx("div",{className:"p-4 bg-black/40 rounded-2xl border border-white/10 group-hover:scale-110 group-hover:shadow-[0_0_20px_rgba(255,255,255,0.2)] transition-all duration-500",children:ie.jsx(s,{className:"w-8 h-8 text-white"})}),ie.jsxs("div",{children:[ie.jsx("h2",{className:"text-2xl font-orbitron font-bold mb-3 text-white group-hover:text-glow-cyan transition-all",children:e.title}),ie.jsx("p",{className:"text-nexus-silver/80 text-sm leading-relaxed font-light",children:e.description})]})]}),ie.jsx("div",{className:"absolute inset-0 rounded-[2rem] bg-gradient-to-tr from-white/0 via-white/5 to-white/0 opacity-0 group-hover:opacity-100 transition-opacity duration-700 pointer-events-none"})]})},e.title)})}),ie.jsxs(qs.section,{initial:{opacity:0,y:50},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"premium-glass p-12 rounded-[3rem] text-center border-white/10 relative overflow-hidden group",children:[ie.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-nexus-violet/20 via-transparent to-nexus-cyan/20 opacity-50 group-hover:opacity-100 transition-opacity duration-1000"}),ie.jsx("div",{className:"absolute -inset-[100%] top-0 block h-[200%] w-[10px] -rotate-[20deg] bg-white/20 blur-[5px] animate-[shine_5s_infinite_linear]"}),ie.jsx("h3",{className:"text-3xl font-orbitron font-bold mb-6 text-white relative z-10",children:"Ests listo para el viaje?"}),ie.jsx("p",{className:"text-nexus-silver/70 mb-10 max-w-xl mx-auto relative z-10",children:"Haz clic en el botn de abajo y te llevaremos directamente a tu sede oficial. Solo necesitas tu ratn para moverte y explorar."}),ie.jsx("div",{className:"flex justify-center",children:ie.jsx(Da,{strength:50,children:ie.jsxs(ua,{to:"/virtual-office/go",onMouseEnter:()=>e(),onMouseDown:()=>t(),onClick:()=>s(),className:"relative z-10 btn-enterprise px-12 py-5 rounded-full text-lg font-orbitron font-black tracking-widest inline-flex items-center gap-4 hover:scale-110 active:scale-95 transition-all shadow-[0_0_50px_rgba(138,43,226,0.5)] group-hover:shadow-[0_0_80px_rgba(0,245,255,0.5)]",children:["ENTRAR AHORA ",ie.jsx(zi,{className:"w-6 h-6 animate-pulse"})]})})}),ie.jsxs("div",{className:"mt-12 flex justify-center gap-8 opacity-40 text-[10px] uppercase tracking-[0.3em] font-mono",children:[ie.jsxs("span",{className:"flex items-center gap-2",children:[ie.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"})," Conexin Segura"]}),ie.jsxs("span",{className:"flex items-center gap-2",children:[ie.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500 animate-pulse delay-75"})," Modo Inmersivo"]}),ie.jsxs("span",{className:"flex items-center gap-2",children:[ie.jsx("div",{className:"w-2 h-2 rounded-full bg-purple-500 animate-pulse delay-150"})," ","100% Gratis"]})]})]})]})]})},ry=()=>{const[e,t]=Us.useState(!1),[s,i]=Us.useState({cpu:12,memory:45}),[n,a]=Us.useState(null);return Us.useEffect(()=>{try{const e=setInterval(()=>{i(e=>({cpu:Math.floor(30*Math.random())+10,memory:Math.floor(20*Math.random())+40}))},2e3);return()=>clearInterval(e)}catch(hv){a(hv.message)}},[]),n?ie.jsxs("div",{className:"p-10 bg-black text-red-500",children:["Error Crtico: ",n]}):ie.jsxs("div",{className:"weapon-dashboard min-h-screen p-4 bg-nexus-obsidian-deep text-white overflow-hidden relative",children:[ie.jsx("header",{className:"flex justify-between items-start mb-8 z-10 relative",children:ie.jsxs("div",{children:[ie.jsx("h1",{className:"text-3xl font-bold text-nexus-cyan animate-pulse",children:"GOD MODE ACTIVE"}),ie.jsx("p",{className:"text-xs text-gray-400",children:"System Stable // v3.0"})]})}),ie.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[ie.jsxs("div",{className:"bg-white/10 p-6 rounded-xl border border-white/10",children:[ie.jsxs("h2",{className:"text-xl mb-4 flex items-center gap-2",children:[ie.jsx(Ri,{className:"w-6 h-6 text-green-400"}),"SYSTEM STATUS"]}),ie.jsxs("div",{className:"flex justify-around",children:[ie.jsxs("div",{className:"text-center",children:[ie.jsxs("div",{className:"text-2xl font-bold text-nexus-cyan",children:[s.cpu,"%"]}),ie.jsx("div",{className:"text-[10px] uppercase",children:"CPU Load"})]}),ie.jsxs("div",{className:"text-center",children:[ie.jsxs("div",{className:"text-2xl font-bold text-nexus-violet",children:[s.memory,"GB"]}),ie.jsx("div",{className:"text-[10px] uppercase",children:"Memory"})]})]})]}),ie.jsx("button",{className:"bg-nexus-cyan/20 text-nexus-cyan border border-nexus-cyan p-4 rounded-xl font-bold tracking-widest hover:bg-nexus-cyan hover:text-black transition-all",children:"DANIELA CORE"}),ie.jsx("button",{className:"bg-nexus-violet/20 text-nexus-violet border border-nexus-violet p-4 rounded-xl font-bold tracking-widest hover:bg-nexus-violet hover:text-black transition-all",children:"ADMIN ACCESS"}),ie.jsx("button",{onClick:()=>window.location.reload(),className:"mt-8 text-xs text-gray-500 underline",children:"Reload Shell"})]})]})},oy=()=>ie.jsx("div",{className:"min-h-[400px] bg-nexus-obsidian-deep flex items-center justify-center",children:ie.jsx("div",{className:"text-nexus-cyan-glow font-orbitron tracking-[0.5em] text-xs animate-pulse",children:"LOADING..."})}),ly=()=>ie.jsxs("footer",{className:"py-32 bg-nexus-obsidian-deep border-t border-white/5 relative overflow-hidden",children:[ie.jsx("div",{className:"absolute inset-0 bg-radial-at-bottom from-nexus-violet/5 via-transparent to-transparent pointer-events-none"}),ie.jsxs("div",{className:"max-w-7xl mx-auto px-6 grid md:grid-cols-4 gap-16 relative z-10",children:[ie.jsx("div",{className:"col-span-1 md:col-span-2",children:ie.jsxs(qs.div,{initial:{opacity:0,x:-20},whileInView:{opacity:1,x:0},viewport:{once:!0},children:[ie.jsx("img",{src:"/images/brand/logo.png",alt:"AIGestion",className:"h-10 mb-8 filter brightness-110 drop-shadow-[0_0_10px_rgba(138,43,226,0.3)]"}),ie.jsxs("p",{className:"text-nexus-silver/50 text-lg max-w-sm mb-12 font-light leading-relaxed italic",children:['"Arquitectura de Inteligencia Soberana. ',ie.jsx("br",{}),'El ncleo neuronal para las empresas del maana."']}),ie.jsx("div",{className:"text-[10px] text-nexus-silver/20 font-mono uppercase tracking-[0.4em] mt-12",children:" 2026 AIGestion.net | God Level AI Restored v2.1 (Fixes Applied)"})]})}),ie.jsxs("div",{children:[ie.jsx("h4",{className:"font-orbitron text-xs text-nexus-cyan-glow mb-8 uppercase tracking-[0.3em] font-bold",children:"Ecosistema"}),ie.jsxs("ul",{className:"space-y-6 text-[10px] text-nexus-silver/40 font-orbitron tracking-widest uppercase",children:[ie.jsx("li",{className:"hover:text-white transition-colors cursor-pointer hover:translate-x-1 duration-300",children:"Casos de Uso"}),ie.jsx("li",{className:"hover:text-white transition-colors cursor-pointer hover:translate-x-1 duration-300",children:"Daniela AI"}),ie.jsx("li",{className:"hover:text-white transition-colors cursor-pointer hover:translate-x-1 duration-300",children:"Nodos Globales"})]})]}),ie.jsxs("div",{children:[ie.jsx("h4",{className:"font-orbitron text-xs text-nexus-violet-glow mb-8 uppercase tracking-[0.3em] font-bold",children:"Metaverso"}),ie.jsxs("ul",{className:"space-y-6 text-[10px] text-nexus-silver/40 font-orbitron tracking-widest uppercase",children:[ie.jsx("li",{className:"hover:text-white transition-colors cursor-pointer hover:translate-x-1 duration-300",children:"Sedes Decentraland"}),ie.jsx("li",{className:"hover:text-white transition-colors cursor-pointer hover:translate-x-1 duration-300",children:"Virtual Office"}),ie.jsx("li",{className:"hover:text-white transition-colors cursor-pointer hover:translate-x-1 duration-300 text-nexus-cyan-glow font-bold",children:"Acceso Terminal"})]})]})]})]}),cy=({loading:e,isAuthenticated:t,currentUser:s,handleLogin:i,handleLogout:n})=>{const{notify:a}=(()=>{const e=Us.useContext(ey);if(!e)throw new Error("useNotification must be used within a NotificationProvider");return e})(),r=Hn();return Us.useEffect(()=>{document.startViewTransition&&document.startViewTransition(()=>{})},[r.pathname]),Us.useEffect(()=>{e||a("SISTEMA ACTIVADO","Protocolos Antigravity God Mode Online","success")},[e,a]),ie.jsxs("div",{className:"bg-nexus-obsidian min-h-screen text-white font-sans selection:bg-nexus-violet selection:text-white relative",children:[ie.jsx(Xx,{}),ie.jsx($x,{}),ie.jsx(Ga,{}),t?null:ie.jsx(Pa,{}),ie.jsxs(aa,{children:[ie.jsx(ia,{path:"/login",element:t?ie.jsx(sa,{to:"/dashboard"}):ie.jsx(iy,{onLogin:i,isAuthenticated:t})}),ie.jsx(ia,{path:"/dashboard",element:t?ie.jsx(Wx,{user:s,onLogout:n}):ie.jsx(sa,{to:"/login"})}),ie.jsx(ia,{path:"/",element:t?ie.jsx(sa,{to:"/dashboard"}):ie.jsxs("main",{children:[ie.jsx(HeroSection,{title:ie.jsxs(ie.Fragment,{children:["AIGESTION",ie.jsx("span",{className:"text-nexus-cyan font-light",children:".NET"})]}),subtitle:"Arquitectura de Inteligencia Soberana",description:"El ncleo neuronal para las empresas del maana. Sincronizacin absoluta entre inteligencia artificial, IoT y logstica global.",videoSrc:"/videos/cinematic/space-intro.mp4",ctas:[{label:"AUTORIZAR ACCESO",onClick:()=>window.location.href="#contact"},{label:"VER ECOSISTEMA",onClick:()=>{},variant:"outline"}]}),ie.jsx(Us.Suspense,{fallback:ie.jsx(oy,{}),children:ie.jsx(DanielaShowcase,{})}),ie.jsx(Us.Suspense,{fallback:ie.jsx(oy,{}),children:ie.jsx(NexusAndroid,{})}),ie.jsx(Us.Suspense,{fallback:ie.jsx(oy,{}),children:ie.jsx(EnhancedROI,{})}),ie.jsx(Us.Suspense,{fallback:ie.jsx(oy,{}),children:ie.jsx(DecentralandOffice,{})}),ie.jsx(Us.Suspense,{fallback:ie.jsx(oy,{}),children:ie.jsx(ContactSection,{})}),ie.jsx(Lx,{})]})}),ie.jsx(ia,{path:"/lab",element:ie.jsx("div",{className:"pt-32 pb-20 px-6",children:ie.jsx("h1",{className:"text-4xl font-orbitron text-white text-center",children:"Lab Section"})})}),ie.jsx(ia,{path:"/weapon",element:ie.jsx(ry,{})}),ie.jsx(ia,{path:"/daniela",element:ie.jsx(DanielaDemo,{})}),ie.jsx(ia,{path:"/daniela/demo",element:ie.jsx(DanielaDemo,{})}),ie.jsx(ia,{path:"/virtual-office",element:ie.jsx(ay,{})}),ie.jsx(ia,{path:"/virtual-office/go",element:ie.jsx(DecentralandOffice,{})})]}),ie.jsx(ly,{}),ie.jsx(Ma,{}),ie.jsx(CommandPalette,{}),ie.jsx(DanielaOmniWidget,{}),ie.jsx(Oa,{}),ie.jsx(ba,{}),ie.jsx(Ra,{}),ie.jsx(Ua,{})]})};const Ay=Us.forwardRef(({className:e,variant:t="primary",size:s="md",loading:i=!1,icon:n,iconPosition:a="left",children:r,disabled:o,...l},c)=>{const A=function(...e){return Ki(Ji(e))}("inline-flex items-center justify-center","font-medium rounded-lg","transition-all duration-200","focus:outline-none focus:ring-2 focus:ring-offset-2","disabled:opacity-50 disabled:cursor-not-allowed",...{primary:["bg-blue-600 text-white hover:bg-blue-700","focus:ring-blue-500","dark:bg-blue-500 dark:hover:bg-blue-600"],secondary:["bg-gray-600 text-white hover:bg-gray-700","focus:ring-gray-500","dark:bg-gray-700 dark:hover:bg-gray-600"],outline:["border border-gray-300 bg-white text-gray-700 hover:bg-gray-50","focus:ring-blue-500","dark:border-gray-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"],ghost:["text-gray-700 hover:bg-gray-100","focus:ring-gray-500","dark:text-gray-300 dark:hover:bg-gray-800"],destructive:["bg-red-600 text-white hover:bg-red-700","focus:ring-red-500","dark:bg-red-500 dark:hover:bg-red-600"]}[t],{sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg",xl:"px-8 py-4 text-xl"}[s],e),h=()=>i?ie.jsx(Vi,{className:"w-4 h-4 animate-spin"}):n;return ie.jsx("button",{ref:c,className:A,disabled:o||i,...l,children:n&&"right"===a?ie.jsxs(ie.Fragment,{children:[r,h()&&ie.jsx("span",{className:"ml-2",children:h()})]}):ie.jsxs(ie.Fragment,{children:[h()&&ie.jsx("span",{className:"mr-2",children:h()}),r]})})});Ay.displayName="Button";class hy extends Us.Component{constructor(e){super(e),W(this,"handleReset",()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0})}),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){var s,i;console.error("ErrorBoundary caught an error:",e,t),this.setState({error:e,errorInfo:t}),null==(i=(s=this.props).onError)||i.call(s,e,t),console.warn("Error logging service not configured")}render(){return this.state.hasError?this.props.fallback?this.props.fallback:ie.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:ie.jsxs("div",{className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 text-center",children:[ie.jsx("div",{className:"mb-4",children:ie.jsx("div",{className:"mx-auto w-16 h-16 bg-red-100 dark:bg-red-900 rounded-full flex items-center justify-center",children:ie.jsx("svg",{className:"w-8 h-8 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:ie.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"})})})}),ie.jsx("h1",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:"Oops! Something went wrong"}),ie.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"We're sorry, but something unexpected happened. Our team has been notified."}),ie.jsxs("div",{className:"space-y-3",children:[ie.jsx(Ay,{onClick:this.handleReset,className:"w-full",children:"Try Again"}),ie.jsx(Ay,{variant:"outline",onClick:()=>window.location.reload(),className:"w-full",children:"Reload Page"})]}),!1]})}):this.props.children}}const dy=Us.createContext(void 0),uy=({children:e})=>{const[t,s]=Us.useState(!0),[i,n]=Us.useState(!1),{playSuccess:a}=Ta();Us.useEffect(()=>{t?document.body.classList.add("nexus-god-mode"):document.body.classList.remove("nexus-god-mode")},[t]),Us.useEffect(()=>{const e=setTimeout(()=>{a()},1e3);return()=>clearTimeout(e)},[]);const r=()=>n(e=>!e),o=Hs.useMemo(()=>({godMode:t,setGodMode:s,reduceMotion:i,toggleReduceMotion:r}),[t,i]);return ie.jsx(dy.Provider,{value:o,children:e})},py=Yi("https://nbymcxvlcfyhebzjurml.supabase.co","sb_publishable_CqCI6d-vk4X6vlsOL69g_Q_BYH5K4yG"),gy=["admin@aigestion.net","nemisanalex@gmail.com"];var my=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},fy={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},by=new(i=class{constructor(){Z(this,t,fy),Z(this,s,!1)}setTimeoutProvider(e){ee(this,t,e)}setTimeout(e,s){return X(this,t).setTimeout(e,s)}clearTimeout(e){X(this,t).clearTimeout(e)}setInterval(e,s){return X(this,t).setInterval(e,s)}clearInterval(e){X(this,t).clearInterval(e)}},t=new WeakMap,s=new WeakMap,i);var xy="undefined"==typeof window||"Deno"in globalThis;function yy(){}function vy(e,t){return"function"==typeof e?e(t):e}function wy(e,t){const{type:s="all",exact:i,fetchStatus:n,predicate:a,queryKey:r,stale:o}=e;if(r)if(i){if(t.queryHash!==Cy(r,t.options))return!1}else if(!By(t.queryKey,r))return!1;if("all"!==s){const e=t.isActive();if("active"===s&&!e)return!1;if("inactive"===s&&e)return!1}return("boolean"!=typeof o||t.isStale()===o)&&((!n||n===t.state.fetchStatus)&&!(a&&!a(t)))}function Iy(e,t){const{exact:s,status:i,predicate:n,mutationKey:a}=e;if(a){if(!t.options.mutationKey)return!1;if(s){if(Ey(t.options.mutationKey)!==Ey(a))return!1}else if(!By(t.options.mutationKey,a))return!1}return(!i||t.state.status===i)&&!(n&&!n(t))}function Cy(e,t){return((null==t?void 0:t.queryKeyHashFn)||Ey)(e)}function Ey(e){return JSON.stringify(e,(e,t)=>ky(t)?Object.keys(t).sort().reduce((e,s)=>(e[s]=t[s],e),{}):t)}function By(e,t){return e===t||typeof e==typeof t&&(!(!e||!t||"object"!=typeof e||"object"!=typeof t)&&Object.keys(t).every(s=>By(e[s],t[s])))}var Qy=Object.prototype.hasOwnProperty;function Sy(e,t,s=0){if(e===t)return e;if(s>500)return t;const i=_y(e)&&_y(t);if(!(i||ky(e)&&ky(t)))return t;const n=(i?e:Object.keys(e)).length,a=i?t:Object.keys(t),r=a.length,o=i?new Array(r):{};let l=0;for(let c=0;c<r;c++){const r=i?c:a[c],A=e[r],h=t[r];if(A===h){o[r]=A,(i?c<n:Qy.call(e,r))&&l++;continue}if(null===A||null===h||"object"!=typeof A||"object"!=typeof h){o[r]=h;continue}const d=Sy(A,h,s+1);o[r]=d,d===A&&l++}return n===r&&l===n?e:o}function _y(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function ky(e){if(!Ty(e))return!1;const t=e.constructor;if(void 0===t)return!0;const s=t.prototype;return!!Ty(s)&&(!!s.hasOwnProperty("isPrototypeOf")&&Object.getPrototypeOf(e)===Object.prototype)}function Ty(e){return"[object Object]"===Object.prototype.toString.call(e)}function My(e,t,s){return"function"==typeof s.structuralSharing?s.structuralSharing(e,t):!1!==s.structuralSharing?Sy(e,t):t}function Ry(e,t,s=0){const i=[...e,t];return s&&i.length>s?i.slice(1):i}function Dy(e,t,s=0){const i=[t,...e];return s&&i.length>s?i.slice(0,-1):i}var Ny=Symbol();function Fy(e,t){return!e.queryFn&&(null==t?void 0:t.initialPromise)?()=>t.initialPromise:e.queryFn&&e.queryFn!==Ny?e.queryFn:()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`))}var jy=new(o=class extends my{constructor(){super(),Z(this,n),Z(this,a),Z(this,r),ee(this,r,e=>{if(!xy&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}})}onSubscribe(){X(this,a)||this.setEventListener(X(this,r))}onUnsubscribe(){var e;this.hasListeners()||(null==(e=X(this,a))||e.call(this),ee(this,a,void 0))}setEventListener(e){var t;ee(this,r,e),null==(t=X(this,a))||t.call(this),ee(this,a,e(e=>{"boolean"==typeof e?this.setFocused(e):this.onFocus()}))}setFocused(e){X(this,n)!==e&&(ee(this,n,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(t=>{t(e)})}isFocused(){var e;return"boolean"==typeof X(this,n)?X(this,n):"hidden"!==(null==(e=globalThis.document)?void 0:e.visibilityState)}},n=new WeakMap,a=new WeakMap,r=new WeakMap,o);var Ly=function(e){setTimeout(e,0)};var Py=function(){let e=[],t=0,s=e=>{e()},i=e=>{e()},n=Ly;const a=i=>{t?e.push(i):n(()=>{s(i)})};return{batch:a=>{let r;t++;try{r=a()}finally{t--,t||(()=>{const t=e;e=[],t.length&&n(()=>{i(()=>{t.forEach(e=>{s(e)})})})})()}return r},batchCalls:e=>(...t)=>{a(()=>{e(...t)})},schedule:a,setNotifyFunction:e=>{s=e},setBatchNotifyFunction:e=>{i=e},setScheduler:e=>{n=e}}}(),Uy=new(h=class extends my{constructor(){super(),Z(this,l,!0),Z(this,c),Z(this,A),ee(this,A,e=>{if(!xy&&window.addEventListener){const t=()=>e(!0),s=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",s)}}})}onSubscribe(){X(this,c)||this.setEventListener(X(this,A))}onUnsubscribe(){var e;this.hasListeners()||(null==(e=X(this,c))||e.call(this),ee(this,c,void 0))}setEventListener(e){var t;ee(this,A,e),null==(t=X(this,c))||t.call(this),ee(this,c,e(this.setOnline.bind(this)))}setOnline(e){X(this,l)!==e&&(ee(this,l,e),this.listeners.forEach(t=>{t(e)}))}isOnline(){return X(this,l)}},l=new WeakMap,c=new WeakMap,A=new WeakMap,h);function Oy(e){return Math.min(1e3*2**e,3e4)}function Gy(e){return"online"!==(e??"online")||Uy.isOnline()}var Hy=class extends Error{constructor(e){super("CancelledError"),this.revert=null==e?void 0:e.revert,this.silent=null==e?void 0:e.silent}};function qy(e){let t,s=!1,i=0;const n=function(){let e,t;const s=new Promise((s,i)=>{e=s,t=i});function i(e){Object.assign(s,e),delete s.resolve,delete s.reject}return s.status="pending",s.catch(()=>{}),s.resolve=t=>{i({status:"fulfilled",value:t}),e(t)},s.reject=e=>{i({status:"rejected",reason:e}),t(e)},s}(),a=()=>"pending"!==n.status,r=()=>jy.isFocused()&&("always"===e.networkMode||Uy.isOnline())&&e.canRun(),o=()=>Gy(e.networkMode)&&e.canRun(),l=e=>{a()||(null==t||t(),n.resolve(e))},c=e=>{a()||(null==t||t(),n.reject(e))},A=()=>new Promise(s=>{var i;t=e=>{(a()||r())&&s(e)},null==(i=e.onPause)||i.call(e)}).then(()=>{var s;t=void 0,a()||null==(s=e.onContinue)||s.call(e)}),h=()=>{if(a())return;let t;const n=0===i?e.initialPromise:void 0;try{t=n??e.fn()}catch(o){t=Promise.reject(o)}Promise.resolve(t).then(l).catch(t=>{var n;if(a())return;const o=e.retry??(xy?0:3),l=e.retryDelay??Oy,d="function"==typeof l?l(i,t):l,u=!0===o||"number"==typeof o&&i<o||"function"==typeof o&&o(i,t);var p;!s&&u?(i++,null==(n=e.onFail)||n.call(e,i,t),(p=d,new Promise(e=>{by.setTimeout(e,p)})).then(()=>r()?void 0:A()).then(()=>{s?c(t):h()})):c(t)})};return{promise:n,status:()=>n.status,cancel:t=>{var s;if(!a()){const i=new Hy(t);c(i),null==(s=e.onCancel)||s.call(e,i)}},continue:()=>(null==t||t(),n),cancelRetry:()=>{s=!0},continueRetry:()=>{s=!1},canStart:o,start:()=>(o()?h():A().then(h),n)}}var zy=(u=class{constructor(){Z(this,d)}destroy(){this.clearGcTimeout()}scheduleGc(){var e;this.clearGcTimeout(),"number"==typeof(e=this.gcTime)&&e>=0&&e!==1/0&&ee(this,d,by.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(xy?1/0:3e5))}clearGcTimeout(){X(this,d)&&(by.clearTimeout(X(this,d)),ee(this,d,void 0))}},d=new WeakMap,u),Vy=(I=class extends zy{constructor(e){super(),Z(this,v),Z(this,p),Z(this,g),Z(this,m),Z(this,f),Z(this,b),Z(this,x),Z(this,y),ee(this,y,!1),ee(this,x,e.defaultOptions),this.setOptions(e.options),this.observers=[],ee(this,f,e.client),ee(this,m,X(this,f).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,ee(this,p,Jy(this.options)),this.state=e.state??X(this,p),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return null==(e=X(this,b))?void 0:e.promise}setOptions(e){if(this.options={...X(this,x),...e},this.updateGcTime(this.options.gcTime),this.state&&void 0===this.state.data){const e=Jy(this.options);void 0!==e.data&&(this.setState(Ky(e.data,e.dataUpdatedAt)),ee(this,p,e))}}optionalRemove(){this.observers.length||"idle"!==this.state.fetchStatus||X(this,m).remove(this)}setData(e,t){const s=My(this.state.data,e,this.options);return te(this,v,w).call(this,{data:s,type:"success",dataUpdatedAt:null==t?void 0:t.updatedAt,manual:null==t?void 0:t.manual}),s}setState(e,t){te(this,v,w).call(this,{type:"setState",state:e,setStateOptions:t})}cancel(e){var t,s;const i=null==(t=X(this,b))?void 0:t.promise;return null==(s=X(this,b))||s.cancel(e),i?i.then(yy).catch(yy):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(X(this,p))}isActive(){return this.observers.some(e=>{return!1!==(t=e.options.enabled,s=this,"function"==typeof t?t(s):t);var t,s})}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Ny||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0&&this.observers.some(e=>"static"===vy(e.options.staleTime,this))}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):void 0===this.state.data||this.state.isInvalidated}isStaleByTime(e=0){return void 0===this.state.data||"static"!==e&&(!!this.state.isInvalidated||!function(e,t){return Math.max(e+(t||0)-Date.now(),0)}(this.state.dataUpdatedAt,e))}onFocus(){var e;const t=this.observers.find(e=>e.shouldFetchOnWindowFocus());null==t||t.refetch({cancelRefetch:!1}),null==(e=X(this,b))||e.continue()}onOnline(){var e;const t=this.observers.find(e=>e.shouldFetchOnReconnect());null==t||t.refetch({cancelRefetch:!1}),null==(e=X(this,b))||e.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),X(this,m).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(t=>t!==e),this.observers.length||(X(this,b)&&(X(this,y)?X(this,b).cancel({revert:!0}):X(this,b).cancelRetry()),this.scheduleGc()),X(this,m).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||te(this,v,w).call(this,{type:"invalidate"})}async fetch(e,t){var s,i,n,a,r,o,l,c,A,h,d,u;if("idle"!==this.state.fetchStatus&&"rejected"!==(null==(s=X(this,b))?void 0:s.status()))if(void 0!==this.state.data&&(null==t?void 0:t.cancelRefetch))this.cancel({silent:!0});else if(X(this,b))return X(this,b).continueRetry(),X(this,b).promise;if(e&&this.setOptions(e),!this.options.queryFn){const e=this.observers.find(e=>e.options.queryFn);e&&this.setOptions(e.options)}const p=new AbortController,x=e=>{Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(ee(this,y,!0),p.signal)})},I=()=>{const e=Fy(this.options,t),s=(()=>{const e={client:X(this,f),queryKey:this.queryKey,meta:this.meta};return x(e),e})();return ee(this,y,!1),this.options.persister?this.options.persister(e,s,this):e(s)},C=(()=>{const e={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:X(this,f),state:this.state,fetchFn:I};return x(e),e})();null==(i=this.options.behavior)||i.onFetch(C,this),ee(this,g,this.state),"idle"!==this.state.fetchStatus&&this.state.fetchMeta===(null==(n=C.fetchOptions)?void 0:n.meta)||te(this,v,w).call(this,{type:"fetch",meta:null==(a=C.fetchOptions)?void 0:a.meta}),ee(this,b,qy({initialPromise:null==t?void 0:t.initialPromise,fn:C.fetchFn,onCancel:e=>{e instanceof Hy&&e.revert&&this.setState({...X(this,g),fetchStatus:"idle"}),p.abort()},onFail:(e,t)=>{te(this,v,w).call(this,{type:"failed",failureCount:e,error:t})},onPause:()=>{te(this,v,w).call(this,{type:"pause"})},onContinue:()=>{te(this,v,w).call(this,{type:"continue"})},retry:C.options.retry,retryDelay:C.options.retryDelay,networkMode:C.options.networkMode,canRun:()=>!0}));try{const e=await X(this,b).start();if(void 0===e)throw new Error(`${this.queryHash} data is undefined`);return this.setData(e),null==(o=(r=X(this,m).config).onSuccess)||o.call(r,e,this),null==(c=(l=X(this,m).config).onSettled)||c.call(l,e,this.state.error,this),e}catch(E){if(E instanceof Hy){if(E.silent)return X(this,b).promise;if(E.revert){if(void 0===this.state.data)throw E;return this.state.data}}throw te(this,v,w).call(this,{type:"error",error:E}),null==(h=(A=X(this,m).config).onError)||h.call(A,E,this),null==(u=(d=X(this,m).config).onSettled)||u.call(d,this.state.data,E,this),E}finally{this.scheduleGc()}}},p=new WeakMap,g=new WeakMap,m=new WeakMap,f=new WeakMap,b=new WeakMap,x=new WeakMap,y=new WeakMap,v=new WeakSet,w=function(e){this.state=(t=>{switch(e.type){case"failed":return{...t,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...t,fetchStatus:"paused"};case"continue":return{...t,fetchStatus:"fetching"};case"fetch":return{...t,...(s=t.data,i=this.options,{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Gy(i.networkMode)?"fetching":"paused",...void 0===s&&{error:null,status:"pending"}}),fetchMeta:e.meta??null};case"success":const n={...t,...Ky(e.data,e.dataUpdatedAt),dataUpdateCount:t.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return ee(this,g,e.manual?n:void 0),n;case"error":const a=e.error;return{...t,error:a,errorUpdateCount:t.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:t.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...t,isInvalidated:!0};case"setState":return{...t,...e.state}}var s,i})(this.state),Py.batch(()=>{this.observers.forEach(e=>{e.onQueryUpdate()}),X(this,m).notify({query:this,type:"updated",action:e})})},I);function Ky(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Jy(e){const t="function"==typeof e.initialData?e.initialData():e.initialData,s=void 0!==t,i=s?"function"==typeof e.initialDataUpdatedAt?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:s?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:s?"success":"pending",fetchStatus:"idle"}}function Yy(e){return{onFetch:(t,s)=>{var i,n,a,r,o;const l=t.options,c=null==(a=null==(n=null==(i=t.fetchOptions)?void 0:i.meta)?void 0:n.fetchMore)?void 0:a.direction,A=(null==(r=t.state.data)?void 0:r.pages)||[],h=(null==(o=t.state.data)?void 0:o.pageParams)||[];let d={pages:[],pageParams:[]},u=0;const p=async()=>{let s=!1;const i=e=>{!function(e,t,s){let i,n=!1;Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(i??(i=t()),n||(n=!0,i.aborted?s():i.addEventListener("abort",s,{once:!0})),i)})}(e,()=>t.signal,()=>s=!0)},n=Fy(t.options,t.fetchOptions),a=async(e,a,r)=>{if(s)return Promise.reject();if(null==a&&e.pages.length)return Promise.resolve(e);const o=(()=>{const e={client:t.client,queryKey:t.queryKey,pageParam:a,direction:r?"backward":"forward",meta:t.options.meta};return i(e),e})(),l=await n(o),{maxPages:c}=t.options,A=r?Dy:Ry;return{pages:A(e.pages,l,c),pageParams:A(e.pageParams,a,c)}};if(c&&A.length){const e="backward"===c,t={pages:A,pageParams:h},s=(e?$y:Wy)(l,t);d=await a(t,s,e)}else{const t=e??A.length;do{const e=0===u?h[0]??l.initialPageParam:Wy(l,d);if(u>0&&null==e)break;d=await a(d,e),u++}while(u<t)}return d};t.options.persister?t.fetchFn=()=>{var e,i;return null==(i=(e=t.options).persister)?void 0:i.call(e,p,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},s)}:t.fetchFn=p}}}function Wy(e,{pages:t,pageParams:s}){const i=t.length-1;return t.length>0?e.getNextPageParam(t[i],t,s[i],s):void 0}function $y(e,{pages:t,pageParams:s}){var i;return t.length>0?null==(i=e.getPreviousPageParam)?void 0:i.call(e,t[0],t,s[0],s):void 0}var Xy=(k=class extends zy{constructor(e){super(),Z(this,S),Z(this,C),Z(this,E),Z(this,B),Z(this,Q),ee(this,C,e.client),this.mutationId=e.mutationId,ee(this,B,e.mutationCache),ee(this,E,[]),this.state=e.state||{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0},this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){X(this,E).includes(e)||(X(this,E).push(e),this.clearGcTimeout(),X(this,B).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){ee(this,E,X(this,E).filter(t=>t!==e)),this.scheduleGc(),X(this,B).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){X(this,E).length||("pending"===this.state.status?this.scheduleGc():X(this,B).remove(this))}continue(){var e;return(null==(e=X(this,Q))?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var t,s,i,n,a,r,o,l,c,A,h,d,u,p,g,m,f,b;const x=()=>{te(this,S,_).call(this,{type:"continue"})},y={client:X(this,C),meta:this.options.meta,mutationKey:this.options.mutationKey};ee(this,Q,qy({fn:()=>this.options.mutationFn?this.options.mutationFn(e,y):Promise.reject(new Error("No mutationFn found")),onFail:(e,t)=>{te(this,S,_).call(this,{type:"failed",failureCount:e,error:t})},onPause:()=>{te(this,S,_).call(this,{type:"pause"})},onContinue:x,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>X(this,B).canRun(this)}));const v="pending"===this.state.status,w=!X(this,Q).canStart();try{if(v)x();else{te(this,S,_).call(this,{type:"pending",variables:e,isPaused:w}),X(this,B).config.onMutate&&await X(this,B).config.onMutate(e,this,y);const i=await(null==(s=(t=this.options).onMutate)?void 0:s.call(t,e,y));i!==this.state.context&&te(this,S,_).call(this,{type:"pending",context:i,variables:e,isPaused:w})}const h=await X(this,Q).start();return await(null==(n=(i=X(this,B).config).onSuccess)?void 0:n.call(i,h,e,this.state.context,this,y)),await(null==(r=(a=this.options).onSuccess)?void 0:r.call(a,h,e,this.state.context,y)),await(null==(l=(o=X(this,B).config).onSettled)?void 0:l.call(o,h,null,this.state.variables,this.state.context,this,y)),await(null==(A=(c=this.options).onSettled)?void 0:A.call(c,h,null,e,this.state.context,y)),te(this,S,_).call(this,{type:"success",data:h}),h}catch(I){try{await(null==(d=(h=X(this,B).config).onError)?void 0:d.call(h,I,e,this.state.context,this,y))}catch(hv){Promise.reject(hv)}try{await(null==(p=(u=this.options).onError)?void 0:p.call(u,I,e,this.state.context,y))}catch(hv){Promise.reject(hv)}try{await(null==(m=(g=X(this,B).config).onSettled)?void 0:m.call(g,void 0,I,this.state.variables,this.state.context,this,y))}catch(hv){Promise.reject(hv)}try{await(null==(b=(f=this.options).onSettled)?void 0:b.call(f,void 0,I,e,this.state.context,y))}catch(hv){Promise.reject(hv)}throw te(this,S,_).call(this,{type:"error",error:I}),I}finally{X(this,B).runNext(this)}}},C=new WeakMap,E=new WeakMap,B=new WeakMap,Q=new WeakMap,S=new WeakSet,_=function(e){this.state=(t=>{switch(e.type){case"failed":return{...t,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...t,isPaused:!0};case"continue":return{...t,isPaused:!1};case"pending":return{...t,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...t,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...t,data:void 0,error:e.error,failureCount:t.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}})(this.state),Py.batch(()=>{X(this,E).forEach(t=>{t.onMutationUpdate(e)}),X(this,B).notify({mutation:this,type:"updated",action:e})})},k);var Zy=(D=class extends my{constructor(e={}){super(),Z(this,T),Z(this,M),Z(this,R),this.config=e,ee(this,T,new Set),ee(this,M,new Map),ee(this,R,0)}build(e,t,s){const i=new Xy({client:e,mutationCache:this,mutationId:++se(this,R)._,options:e.defaultMutationOptions(t),state:s});return this.add(i),i}add(e){X(this,T).add(e);const t=ev(e);if("string"==typeof t){const s=X(this,M).get(t);s?s.push(e):X(this,M).set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(X(this,T).delete(e)){const t=ev(e);if("string"==typeof t){const s=X(this,M).get(t);if(s)if(s.length>1){const t=s.indexOf(e);-1!==t&&s.splice(t,1)}else s[0]===e&&X(this,M).delete(t)}}this.notify({type:"removed",mutation:e})}canRun(e){const t=ev(e);if("string"==typeof t){const s=X(this,M).get(t),i=null==s?void 0:s.find(e=>"pending"===e.state.status);return!i||i===e}return!0}runNext(e){var t;const s=ev(e);if("string"==typeof s){const i=null==(t=X(this,M).get(s))?void 0:t.find(t=>t!==e&&t.state.isPaused);return(null==i?void 0:i.continue())??Promise.resolve()}return Promise.resolve()}clear(){Py.batch(()=>{X(this,T).forEach(e=>{this.notify({type:"removed",mutation:e})}),X(this,T).clear(),X(this,M).clear()})}getAll(){return Array.from(X(this,T))}find(e){const t={exact:!0,...e};return this.getAll().find(e=>Iy(t,e))}findAll(e={}){return this.getAll().filter(t=>Iy(e,t))}notify(e){Py.batch(()=>{this.listeners.forEach(t=>{t(e)})})}resumePausedMutations(){const e=this.getAll().filter(e=>e.state.isPaused);return Py.batch(()=>Promise.all(e.map(e=>e.continue().catch(yy))))}},T=new WeakMap,M=new WeakMap,R=new WeakMap,D);function ev(e){var t;return null==(t=e.options.scope)?void 0:t.id}var tv=(F=class extends my{constructor(e={}){super(),Z(this,N),this.config=e,ee(this,N,new Map)}build(e,t,s){const i=t.queryKey,n=t.queryHash??Cy(i,t);let a=this.get(n);return a||(a=new Vy({client:e,queryKey:i,queryHash:n,options:e.defaultQueryOptions(t),state:s,defaultOptions:e.getQueryDefaults(i)}),this.add(a)),a}add(e){X(this,N).has(e.queryHash)||(X(this,N).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=X(this,N).get(e.queryHash);t&&(e.destroy(),t===e&&X(this,N).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){Py.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return X(this,N).get(e)}getAll(){return[...X(this,N).values()]}find(e){const t={exact:!0,...e};return this.getAll().find(e=>wy(t,e))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter(t=>wy(e,t)):t}notify(e){Py.batch(()=>{this.listeners.forEach(t=>{t(e)})})}onFocus(){Py.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){Py.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},N=new WeakMap,F),sv=(z=class{constructor(e={}){Z(this,j),Z(this,L),Z(this,P),Z(this,U),Z(this,O),Z(this,G),Z(this,H),Z(this,q),ee(this,j,e.queryCache||new tv),ee(this,L,e.mutationCache||new Zy),ee(this,P,e.defaultOptions||{}),ee(this,U,new Map),ee(this,O,new Map),ee(this,G,0)}mount(){se(this,G)._++,1===X(this,G)&&(ee(this,H,jy.subscribe(async e=>{e&&(await this.resumePausedMutations(),X(this,j).onFocus())})),ee(this,q,Uy.subscribe(async e=>{e&&(await this.resumePausedMutations(),X(this,j).onOnline())})))}unmount(){var e,t;se(this,G)._--,0===X(this,G)&&(null==(e=X(this,H))||e.call(this),ee(this,H,void 0),null==(t=X(this,q))||t.call(this),ee(this,q,void 0))}isFetching(e){return X(this,j).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return X(this,L).findAll({...e,status:"pending"}).length}getQueryData(e){var t;const s=this.defaultQueryOptions({queryKey:e});return null==(t=X(this,j).get(s.queryHash))?void 0:t.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),s=X(this,j).build(this,t),i=s.state.data;return void 0===i?this.fetchQuery(e):(e.revalidateIfStale&&s.isStaleByTime(vy(t.staleTime,s))&&this.prefetchQuery(t),Promise.resolve(i))}getQueriesData(e){return X(this,j).findAll(e).map(({queryKey:e,state:t})=>[e,t.data])}setQueryData(e,t,s){const i=this.defaultQueryOptions({queryKey:e}),n=X(this,j).get(i.queryHash),a=function(e,t){return"function"==typeof e?e(t):e}(t,null==n?void 0:n.state.data);if(void 0!==a)return X(this,j).build(this,i).setData(a,{...s,manual:!0})}setQueriesData(e,t,s){return Py.batch(()=>X(this,j).findAll(e).map(({queryKey:e})=>[e,this.setQueryData(e,t,s)]))}getQueryState(e){var t;const s=this.defaultQueryOptions({queryKey:e});return null==(t=X(this,j).get(s.queryHash))?void 0:t.state}removeQueries(e){const t=X(this,j);Py.batch(()=>{t.findAll(e).forEach(e=>{t.remove(e)})})}resetQueries(e,t){const s=X(this,j);return Py.batch(()=>(s.findAll(e).forEach(e=>{e.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const s={revert:!0,...t},i=Py.batch(()=>X(this,j).findAll(e).map(e=>e.cancel(s)));return Promise.all(i).then(yy).catch(yy)}invalidateQueries(e,t={}){return Py.batch(()=>(X(this,j).findAll(e).forEach(e=>{e.invalidate()}),"none"===(null==e?void 0:e.refetchType)?Promise.resolve():this.refetchQueries({...e,type:(null==e?void 0:e.refetchType)??(null==e?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const s={...t,cancelRefetch:t.cancelRefetch??!0},i=Py.batch(()=>X(this,j).findAll(e).filter(e=>!e.isDisabled()&&!e.isStatic()).map(e=>{let t=e.fetch(void 0,s);return s.throwOnError||(t=t.catch(yy)),"paused"===e.state.fetchStatus?Promise.resolve():t}));return Promise.all(i).then(yy)}fetchQuery(e){const t=this.defaultQueryOptions(e);void 0===t.retry&&(t.retry=!1);const s=X(this,j).build(this,t);return s.isStaleByTime(vy(t.staleTime,s))?s.fetch(t):Promise.resolve(s.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(yy).catch(yy)}fetchInfiniteQuery(e){return e.behavior=Yy(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(yy).catch(yy)}ensureInfiniteQueryData(e){return e.behavior=Yy(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Uy.isOnline()?X(this,L).resumePausedMutations():Promise.resolve()}getQueryCache(){return X(this,j)}getMutationCache(){return X(this,L)}getDefaultOptions(){return X(this,P)}setDefaultOptions(e){ee(this,P,e)}setQueryDefaults(e,t){X(this,U).set(Ey(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...X(this,U).values()],s={};return t.forEach(t=>{By(e,t.queryKey)&&Object.assign(s,t.defaultOptions)}),s}setMutationDefaults(e,t){X(this,O).set(Ey(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...X(this,O).values()],s={};return t.forEach(t=>{By(e,t.mutationKey)&&Object.assign(s,t.defaultOptions)}),s}defaultQueryOptions(e){if(e._defaulted)return e;const t={...X(this,P).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=Cy(t.queryKey,t)),void 0===t.refetchOnReconnect&&(t.refetchOnReconnect="always"!==t.networkMode),void 0===t.throwOnError&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===Ny&&(t.enabled=!1),t}defaultMutationOptions(e){return(null==e?void 0:e._defaulted)?e:{...X(this,P).mutations,...(null==e?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){X(this,j).clear(),X(this,L).clear()}},j=new WeakMap,L=new WeakMap,P=new WeakMap,U=new WeakMap,O=new WeakMap,G=new WeakMap,H=new WeakMap,q=new WeakMap,z),iv=Us.createContext(void 0),nv=({client:e,children:t})=>(Us.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),ie.jsx(iv.Provider,{value:e,children:t}));function av({children:e}){const[t]=Us.useState(()=>new sv({defaultOptions:{queries:{staleTime:3e5,retry:(e,t)=>{if(t&&"object"==typeof t&&"status"in t){const e=t.status;if(e>=400&&e<500)return!1}return e<3},refetchOnWindowFocus:!1,refetchOnReconnect:!0},mutations:{retry:1}}}));return ie.jsxs(nv,{client:t,children:[e,!1]})}function rv(){const{loading:e,isAuthenticated:t,currentUser:s,login:i,logout:n}=function(){const[e,t]=Us.useState({session:null,user:null,loading:!0,isAuthenticated:!1,isAdmin:!1,isMobileApp:!1}),s=Us.useCallback(()=>"localhost"===window.location.hostname||window.location.protocol.includes("capacitor")||"file:"===window.location.protocol||""===window.location.port,[]),i=Us.useCallback(e=>{const t=e.user_metadata||{};return{email:e.email,name:t.name||e.email.split("@")[0],subscription:t.subscription||"free",role:t.role||"client",avatar:t.avatar}},[]),n=Us.useCallback(e=>{const t=gy.includes(e.email)||"admin"===e.role,i=s();return!(!t||i||(window.location.href="https://admin.aigestion.net",0))},[s]),a=Us.useCallback(async e=>{t(e=>({...e,loading:!0}));try{if(null==e?void 0:e.user){const a=i(e.user);if(n(a))return;t({session:e,user:a,loading:!1,isAuthenticated:!0,isAdmin:gy.includes(a.email)||"admin"===a.role,isMobileApp:s()})}else t({session:null,user:null,loading:!1,isAuthenticated:!1,isAdmin:!1,isMobileApp:s()})}catch(a){console.error("Session handling error:",a),t(e=>({...e,loading:!1,isAuthenticated:!1,user:null,session:null}))}},[i,n,s]),r=Us.useCallback(async(e,s)=>{var i;t(e=>({...e,loading:!0}));try{const{data:t,error:n}=await py.auth.signInWithPassword({email:e,password:s});if(n)throw n;(null==(i=t.session)?void 0:i.user)&&await a(t.session)}catch(n){throw t(e=>({...e,loading:!1})),n}},[a]),o=Us.useCallback(async()=>{t(e=>({...e,loading:!0}));try{await py.auth.signOut(),await a(null)}catch(e){console.error("Logout error:",e),t({session:null,user:null,loading:!1,isAuthenticated:!1,isAdmin:!1,isMobileApp:s()})}},[a,s]),l=Us.useCallback(async()=>{try{const{data:e,error:t}=await py.auth.refreshSession();if(t)throw t;await a(e.session)}catch(e){console.error("Session refresh error:",e),await a(null)}},[a]),c=Us.useCallback(async s=>{if(!e.user||!e.session)throw new Error("No authenticated user");t(e=>({...e,loading:!0}));try{const{error:e}=await py.auth.updateUser({data:s});if(e)throw e;await l()}catch(i){throw t(e=>({...e,loading:!1})),i}},[e.user,e.session,l]);return Us.useEffect(()=>{if(!py)return console.warn("Supabase not configured; using demo mode"),void t(e=>({...e,loading:!1}));py.auth.getSession().then(({data:{session:e}})=>a(e)).catch(e=>{console.error("Initial session error:",e),t(e=>({...e,loading:!1}))});const{data:{subscription:e}}=py.auth.onAuthStateChange((e,t)=>{a(t)});return()=>e.unsubscribe()},[a]),{...e,login:r,logout:o,refreshSession:l,updateUser:c}}();return e?ie.jsx(oy,{}):ie.jsx(hy,{children:ie.jsx(av,{children:ie.jsx(Aa,{children:ie.jsx(wa,{children:ie.jsx(uy,{children:ie.jsx(ty,{children:ie.jsx(cy,{loading:e,isAuthenticated:t,currentUser:s,handleLogin:i,handleLogout:n})})})})})})})}const ov=Us.createContext(void 0),lv=({children:e})=>{const[t,s]=Us.useState(!1),[i,n]=Us.useState(null),a={isLoading:t,setIsLoading:s,error:i,setError:n};return ie.jsx(ov.Provider,{value:a,children:e})},cv=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),Av=document.getElementById("root");if(Av)try{Ps.createRoot(Av).render(ie.jsx(Hs.StrictMode,{children:ie.jsx(lv,{children:ie.jsx(rv,{})})})),cv&&console.log(" Mobile device detected - App loaded successfully")}catch(dv){console.error(" Failed to render React app:",dv),cv&&(Av.innerHTML='\n        <div style="padding: 20px; text-align: center; color: white; font-family: system-ui;">\n          <h2> AIGestion / NEXUS V1</h2>\n          <p>Cargando aplicacin optimizada para mvil...</p>\n          <button onclick="window.location.reload()" style="\n            background: #7c3aed;\n            color: white;\n            border: none;\n            padding: 10px 20px;\n            border-radius: 5px;\n            margin-top: 10px;\n          ">Recargar</button>\n        </div>\n      ')}else console.error("Root element not found!");"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(e=>{console.log("SW registered: ",e)}).catch(e=>{console.log("SW registration failed: ",e),cv&&console.warn("Service Worker registration failed on mobile - continuing without SW")})});
