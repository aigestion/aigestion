{"file":"C:\\Users\\Alejandro\\AIGestion\\backend\\src\\services\\tiktok.service.ts","mappings":";;;;;;;;;;;;AAAA,kDAA0B;AAC1B,yCAAuC;AAEvC,qDAA2C;AAC3C,4CAAyC;AAGlC,IAAM,aAAa,GAAnB,MAAM,aAAa;IACP,OAAO,GAAG,gCAAgC,CAAC;IAE5D;;;;;OAKG;IACH,KAAK,CAAC,YAAY,CAAC,SAAiB,EAAE,KAAa;QACjD,IAAI,CAAC,gBAAG,CAAC,mBAAmB,EAAE,CAAC;YAC7B,eAAM,CAAC,IAAI,CAAC,oCAAoC,CAAC,CAAC;YAClD,OAAO,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,uBAAuB,EAAE,CAAC;QAC5D,CAAC;QAED,IAAI,CAAC;YACH,2CAA2C;YAC3C,uDAAuD;YACvD,mEAAmE;YAEnE,MAAM,QAAQ,GAAG,MAAM,eAAK,CAAC,IAAI,CAC/B,GAAG,IAAI,CAAC,OAAO,2BAA2B,EAC1C;gBACE,SAAS,EAAE;oBACT,KAAK,EAAE,KAAK;oBACZ,aAAa,EAAE,oBAAoB;oBACnC,YAAY,EAAE,KAAK;oBACnB,eAAe,EAAE,KAAK;oBACtB,cAAc,EAAE,KAAK;iBACtB;gBACD,WAAW,EAAE;oBACX,MAAM,EAAE,aAAa;oBACrB,8DAA8D;iBAC/D;aACF,EACD;gBACE,OAAO,EAAE;oBACP,aAAa,EAAE,UAAU,gBAAG,CAAC,mBAAmB,EAAE;oBAClD,cAAc,EAAE,iCAAiC;iBAClD;aACF,CACF,CAAC;YAEF,eAAM,CAAC,IAAI,CAAC,iCAAiC,CAAC,CAAC;YAC/C,OAAO,QAAQ,CAAC,IAAI,CAAC;QACvB,CAAC;QAAC,OAAO,KAAU,EAAE,CAAC;YACpB,eAAM,CAAC,KAAK,CAAC,EAAE,KAAK,EAAE,KAAK,CAAC,QAAQ,EAAE,IAAI,IAAI,KAAK,CAAC,OAAO,EAAE,EAAE,4BAA4B,CAAC,CAAC;YAC7F,MAAM,KAAK,CAAC;QACd,CAAC;IACH,CAAC;CACF,CAAA;AAlDY,sCAAa;wBAAb,aAAa;IADzB,IAAA,sBAAU,GAAE;GACA,aAAa,CAkDzB","names":[],"sources":["C:\\Users\\Alejandro\\AIGestion\\backend\\src\\services\\tiktok.service.ts"],"sourcesContent":["import axios from 'axios';\nimport { injectable } from 'inversify';\n\nimport { env } from '../config/env.schema';\nimport { logger } from '../utils/logger';\n\n@injectable()\nexport class TikTokService {\n  private readonly baseUrl = 'https://open.tiktokapis.com/v2';\n\n  /**\n   * Publish a video to TikTok\n   * Note: Direct video upload via API is complex (init, upload, finish).\n   * This implementation initiates the process or posts a video via URL if supported by specific endpoints,\n   * otherwise it serves as a robust placeholder for the full flow.\n   */\n  async publishVideo(_videoUrl: string, title: string): Promise<any> {\n    if (!env.TIKTOK_ACCESS_TOKEN) {\n      logger.warn('TIKTOK_ACCESS_TOKEN not configured');\n      return { success: false, error: 'Configuration missing' };\n    }\n\n    try {\n      // Example implementation for v2 post usage\n      // TikTok API typically requires uploading binary data.\n      // This is a simplified \"Direct Post\" call structure for reference.\n\n      const response = await axios.post(\n        `${this.baseUrl}/post/publish/video/init/`,\n        {\n          post_info: {\n            title: title,\n            privacy_level: 'PUBLIC_TO_EVERYONE',\n            disable_duet: false,\n            disable_comment: false,\n            disable_stitch: false,\n          },\n          source_info: {\n            source: 'FILE_UPLOAD',\n            // In a real implementation, you'd upload the file chunks here\n          },\n        },\n        {\n          headers: {\n            Authorization: `Bearer ${env.TIKTOK_ACCESS_TOKEN}`,\n            'Content-Type': 'application/json; charset=UTF-8',\n          },\n        },\n      );\n\n      logger.info('TikTok video upload initialized');\n      return response.data;\n    } catch (error: any) {\n      logger.error({ error: error.response?.data || error.message }, 'Error publishing to TikTok');\n      throw error;\n    }\n  }\n}\n"],"version":3}