{"file":"C:\\Users\\Alejandro\\AIGestion\\backend\\src\\services\\telegram-bot-godmode.ts","mappings":"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","names":[],"sources":["C:\\Users\\Alejandro\\AIGestion\\backend\\src\\services\\telegram-bot-godmode.ts"],"sourcesContent":["import { inject, injectable } from 'inversify';\nimport { Context, Telegraf } from 'telegraf';\n\nimport { env } from '../config/env.schema';\nimport { logger } from '../utils/logger';\nimport { DanielaAIService } from './daniela-ai.service';\nimport { EconomyService } from './economy.service';\nimport { EconomyChartService } from './economy-chart.service';\nimport { EnhancedVoiceService } from './enhanced-voice.service';\nimport { SystemMetricsService } from './system-metrics.service';\n\ninterface UserSession {\n  userId: string;\n  chatId: number;\n  isAdmin: boolean;\n  lastCommand: string;\n  lastActivity: Date;\n  language: 'es' | 'en';\n}\n\n/**\n * ðŸ¤– AIGESTION GOD MODE - Telegram Bot Handler\n * Sistema completo de gestiÃ³n vÃ­a Telegram\n */\n@injectable()\nexport class TelegramBotHandlerGodMode {\n  private bot: Telegraf | null = null;\n  private isLaunched = false;\n  private userSessions = new Map<number, UserSession>();\n  private adminIds = (env.TELEGRAM_ADMIN_IDS || '5279281613')\n    .split(',')\n    .map(id => id.trim())\n    .filter(Boolean);\n  private daniela: DanielaAIService;\n\n  constructor(\n    @inject(DanielaAIService) daniela: DanielaAIService,\n    @inject(EconomyService) private economyService: EconomyService,\n    @inject(EconomyChartService) private chartService: EconomyChartService,\n    @inject(EnhancedVoiceService) private voiceService: EnhancedVoiceService,\n    @inject(SystemMetricsService) private metricsService?: SystemMetricsService,\n  ) {\n    this.daniela = daniela;\n    this.initialize();\n  }\n\n  /**\n   * Initialize the Telegram Bot con configuraciÃ³n avanzada\n   */\n  private initialize() {\n    const botToken = env.TELEGRAM_BOT_TOKEN_DEV || env.TELEGRAM_BOT_TOKEN;\n    if (!botToken) {\n      logger.warn('TELEGRAM_BOT_TOKEN_DEV/TELEGRAM_BOT_TOKEN not provided. Telegram Bot disabled.');\n      return;\n    }\n\n    try {\n      this.bot = new Telegraf(botToken);\n\n      // Middleware global\n      this.setupMiddleware();\n\n      // Setup all command handlers\n      this.setupCommands();\n      this.setupAdminPanel();\n      this.setupNotifications();\n      this.setupErrorHandling();\n\n      logger.info('ðŸ¤– Telegram Bot Handler GOD MODE initialized');\n    } catch (error) {\n      logger.error('Failed to initialize Telegram Bot Handler', error);\n    }\n  }\n\n  /**\n   * Middleware global para todas las interacciones\n   */\n  private setupMiddleware() {\n    if (!this.bot) return;\n\n    // Logger de actividad\n    this.bot.use((ctx, next) => {\n      const chatId = ctx.chat?.id;\n      const userId = ctx.from?.id;\n      const username = ctx.from?.username;\n\n      if (chatId && userId) {\n        this.userSessions.set(chatId, {\n          userId: userId.toString(),\n          chatId,\n          isAdmin: this.adminIds.includes(chatId.toString()),\n          lastCommand: ctx.message && 'text' in ctx.message ? ctx.message.text : 'unknown',\n          lastActivity: new Date(),\n          language: 'es',\n        });\n\n        logger.info(\n          `[TELEGRAM] ${username} (${userId}): ${\n            ctx.message && 'text' in ctx.message ? ctx.message.text : 'interaction'\n          }`,\n        );\n      }\n\n      return next();\n    });\n  }\n\n  /**\n   * Configurar todos los comandos del bot\n   */\n  private setupCommands() {\n    if (!this.bot) return;\n\n    // ===== COMANDOS BÃSICOS =====\n\n    this.bot.start(async (ctx: Context) => {\n      const firstName = ctx.from?.first_name || 'User';\n      const isAdmin = this.isAdmin(ctx);\n\n      await ctx.reply(\n        `ðŸ¤– *Â¡Bienvenido a AIGestiÃ³n Bot!*\\n\\n` +\n          `Hola ${firstName}, soy tu asistente de IA para gestiÃ³n profesional.\\n\\n` +\n          `${isAdmin ? 'ðŸ‘‘ Modo Admin Activado\\n\\n' : ''}` +\n          `ðŸ“‹ *Comandos disponibles:*\\n` +\n          `/help - GuÃ­a completa\\n` +\n          `/status - Estado del sistema\\n` +\n          `/analytics - Dashboards\\n` +\n          `/projects - GestiÃ³n de proyectos\\n` +\n          `/team - Equipo\\n` +\n          `/tasks - Mis tareas\\n` +\n          `/reports - Reportes\\n` +\n          `/economy - Resumen econÃ³mico\\n` +\n          `/settings - ConfiguraciÃ³n\\n\\n` +\n          `${isAdmin ? `/admin - Panel de administraciÃ³n\\n` : ''}` +\n          `Â¿CÃ³mo puedo ayudarte?`,\n        { parse_mode: 'Markdown' },\n      );\n    });\n\n    this.bot.help(async (ctx: Context) => {\n      await ctx.reply(\n        `ðŸ“š *GuÃ­a Completa - AIGestiÃ³n Bot*\\n\\n` +\n          `*ðŸ“Š InformaciÃ³n*\\n` +\n          `/status - Ver estado del sistema\\n` +\n          `/health - Salud del servicio\\n` +\n          `/uptime - Tiempo en lÃ­nea\\n\\n` +\n          `*ðŸ“ˆ Analytics & Reportes*\\n` +\n          `/analytics - Dashboard completo\\n` +\n          `/metrics - MÃ©tricas detalladas\\n` +\n          `/report - Generar reporte\\n` +\n          `/trends - Tendencias\\n\\n` +\n          `*ðŸ‘¥ Proyectos & Equipo*\\n` +\n          `/projects - Lista de proyectos\\n` +\n          `/team - Miembros del equipo\\n` +\n          `/users - GestiÃ³n de usuarios\\n\\n` +\n          `*âœ… Tareas*\\n` +\n          `/tasks - Mis tareas\\n` +\n          `/pending - Tareas pendientes\\n` +\n          `/create_task - Crear nueva tarea\\n\\n` +\n          `*âš™ï¸ ConfiguraciÃ³n*\\n` +\n          `/settings - Preferencias\\n` +\n          `/language - Cambiar idioma\\n` +\n          `/timezone - Zona horaria\\n` +\n          `/notifications - Alertas\\n\\n` +\n          `${\n            this.isAdmin(ctx)\n              ? `*ðŸ‘‘ Admin*\\n/admin - Panel admin\\n/logs - Ver logs\\n/users_manage - Gestionar usuarios\\n/system - Control del sistema\\n\\n`\n              : ''\n          }` +\n          `ðŸ’¡ *Tip:* Usa /settings para personalizar tu experiencia.`,\n        { parse_mode: 'Markdown' },\n      );\n    });\n\n    // ===== STATUS & HEALTH =====\n\n    this.bot.command('status', async (ctx: Context) => {\n      try {\n        const metrics = await this.metricsService?.getSystemMetrics();\n\n        await ctx.reply(\n          `âœ… *Estado del Sistema AIGestiÃ³n*\\n\\n` +\n            `ðŸŸ¢ Backend: Operacional\\n` +\n            `ðŸŸ¢ Database: Conectada\\n` +\n            `ðŸŸ¢ Telegram Bot: Activo\\n` +\n            `ðŸŸ¢ Cache: Activo\\n\\n` +\n            `*Recursos:*\\n` +\n            `ðŸ“Š CPU: ${metrics?.cpu || '0'}%\\n` +\n            `ðŸ’¾ RAM: ${metrics?.memory || '0'}MB\\n` +\n            `ðŸ“ˆ Uptime: ${Math.floor((Date.now() - (metrics?.uptime || 0)) / 1000 / 3600)}h\\n\\n` +\n            `ðŸ• Ãšltima actualizaciÃ³n: ${new Date().toLocaleString('es-ES')}`,\n          { parse_mode: 'Markdown' },\n        );\n      } catch (error) {\n        logger.error('Error in /status', error);\n        await ctx.reply('âŒ Error obteniendo estado');\n      }\n    });\n\n    this.bot.command('health', async (ctx: Context) => {\n      await ctx.reply(\n        `ðŸ’š *Salud del Sistema*\\n\\n` +\n          `ðŸŸ¢ API: Saludable\\n` +\n          `ðŸŸ¢ BD: Saludable\\n` +\n          `ðŸŸ¢ Cache: Saludable\\n` +\n          `ðŸŸ¢ Servicios: Saludables\\n\\n` +\n          `âœ… Todo estÃ¡ funcionando perfectamente`,\n        { parse_mode: 'Markdown' },\n      );\n    });\n\n    // ===== ECONOMY =====\n\n    this.bot.command('economy', async (ctx: Context) => {\n      try {\n        await ctx.reply('â³ Obteniendo datos del mercado...');\n        const report = await this.economyService.generateFormattedReport();\n        await ctx.reply(report, { parse_mode: 'Markdown' });\n      } catch (error) {\n        logger.error('Error in /economy', error);\n        await ctx.reply('âŒ Error obteniendo datos econÃ³micos');\n      }\n    });\n\n    this.bot.command('invest_advice', async (ctx: Context) => {\n      try {\n        await ctx.reply('ðŸ§  Analizando mercado y tendencias...');\n        const adviceData = await this.economyService.getInvestmentAdvice();\n        await ctx.reply(adviceData.advice, { parse_mode: 'Markdown' });\n      } catch (error) {\n        logger.error('Error in /invest_advice', error);\n      }\n    });\n\n    this.bot.command('economy_voice', async (ctx: Context) => {\n      try {\n        await ctx.reply('ðŸŽ™ï¸ Generando informe de voz God Mode (Qwen-TTS)...');\n\n        const script = await this.economyService.generateVoiceScript();\n        const audioBuffer = await this.voiceService.textToSpeech(script, 'qwen'); // Prefer Qwen\n\n        await ctx.replyWithVoice({ source: audioBuffer });\n      } catch (error) {\n        logger.error('Error in /economy_voice', error);\n        await ctx.reply(\n          'âŒ Error generando audio. Verifica que DASHSCOPE_API_KEY estÃ© configurada.',\n        );\n      }\n    });\n\n    this.bot.command('alert', async (ctx: Context) => {\n      try {\n        const text = (ctx as any).message?.text || '';\n        const parts = text.split(' ');\n        if (parts.length < 3) {\n          return ctx.reply('ðŸ“– Uso: `/alert <SÃMBOLO> <PRECIO>`\\nEjemplo: `/alert NVDA 900`', {\n            parse_mode: 'Markdown',\n          });\n        }\n\n        const symbol = parts[1].toUpperCase();\n        const targetPrice = parseFloat(parts[2]);\n\n        if (isNaN(targetPrice)) return ctx.reply('âŒ Precio invÃ¡lido');\n\n        const alert = await this.economyService.addPriceAlert({\n          symbol,\n          targetPrice,\n          chatId: ctx.chat?.id || 0,\n          userId: 'god_mode', // Using a fixed ID for the prototype\n        });\n\n        await ctx.reply(\n          `âœ… Alerta configurada: Te avisarÃ© cuando *${symbol}* estÃ© ${\n            alert.condition === 'above' ? 'por encima de' : 'por debajo de'\n          } *$${targetPrice}*`,\n          { parse_mode: 'Markdown' },\n        );\n      } catch (error) {\n        logger.error('Error in /alert', error);\n        await ctx.reply('âŒ Error configurando alerta');\n      }\n    });\n\n    this.bot.command('portfolio', async (ctx: Context) => {\n      try {\n        await ctx.reply('ðŸ’¼ Calculando P&L de tu cartera...');\n        const stats = await this.economyService.getPortfolioStats('god_mode');\n\n        if (stats.length === 0) {\n          return ctx.reply(\n            'ðŸ“­ Tu cartera estÃ¡ vacÃ­a. Usa `/portfolio_add <SIMBOLO> <CANTIDAD> <PRECIO_ENTRADA>`',\n            { parse_mode: 'Markdown' },\n          );\n        }\n\n        let msg = `ðŸ“Š *Tu Portafolio AIGestiÃ³n*\\n\\n`;\n        let totalPnl = 0;\n\n        stats.forEach(s => {\n          const icon = s.pnl >= 0 ? 'ðŸŸ¢' : 'ðŸ”´';\n          msg += `${icon} *${s.symbol}*: ${s.amount} @ $${s.entryPrice}\\n`;\n          msg += `   Valor: *$${(s.currentPrice * s.amount).toLocaleString()}* | P&L: *${\n            s.pnl >= 0 ? '+' : ''\n          }$${s.pnl.toLocaleString()}* (${s.pnlPercent})\\n\\n`;\n          totalPnl += s.pnl;\n        });\n\n        msg += `ðŸ’° *PNL Total:* ${totalPnl >= 0 ? 'ðŸŸ¢' : 'ðŸ”´'} *${\n          totalPnl >= 0 ? '+' : ''\n        }$${totalPnl.toLocaleString()}*`;\n        await ctx.reply(msg, { parse_mode: 'Markdown' });\n      } catch (error) {\n        logger.error('Error in /portfolio', error);\n        await ctx.reply('âŒ Error consultando el portafolio');\n      }\n    });\n\n    this.bot.command('portfolio_add', async (ctx: Context) => {\n      try {\n        const text = (ctx as any).message?.text || '';\n        const parts = text.split(' ');\n        if (parts.length < 4) {\n          return ctx.reply(\n            'ðŸ“– Uso: `/portfolio_add <SIMBOLO> <CANTIDAD> <PRECIO>`\\nEjemplo: `/portfolio_add NVDA 10 850`',\n            { parse_mode: 'Markdown' },\n          );\n        }\n\n        const symbol = parts[1].toUpperCase();\n        const amount = parseFloat(parts[2]);\n        const entryPrice = parseFloat(parts[3]);\n\n        if (isNaN(amount) || isNaN(entryPrice)) return ctx.reply('âŒ Valores numÃ©ricos invÃ¡lidos');\n\n        await this.economyService.addPortfolioPosition('god_mode', symbol, amount, entryPrice);\n        await ctx.reply(`âœ… PosiciÃ³n aÃ±adida: *${amount} ${symbol}* a *$${entryPrice}*`, {\n          parse_mode: 'Markdown',\n        });\n      } catch (error) {\n        logger.error('Error in /portfolio_add', error);\n        await ctx.reply('âŒ Error guardando posiciÃ³n');\n      }\n    });\n\n    this.bot.command('chart', async (ctx: Context) => {\n      try {\n        const text = (ctx as any).message?.text || '';\n        const parts = text.split(' ');\n        if (parts.length < 2) {\n          return ctx.reply('ðŸ“– Uso: `/chart <SÃMBOLO>`\\nEjemplo: `/chart NVDA`', {\n            parse_mode: 'Markdown',\n          });\n        }\n\n        const symbol = parts[1].toUpperCase();\n        await ctx.reply(`ðŸ“‰ Generando tendencia para ${symbol}...`);\n\n        const prices = await this.economyService.getHistoricalPrices(symbol);\n        const report = await this.chartService.generateTrendReport(symbol, prices);\n\n        await ctx.reply(report, { parse_mode: 'Markdown' });\n      } catch (error) {\n        logger.error('Error in /chart', error);\n        await ctx.reply('âŒ Error generando el grÃ¡fico de tendencia');\n      }\n    });\n\n    // ===== ANALYTICS =====\n\n    this.bot.command('analytics', async (ctx: Context) => {\n      await ctx.reply(`ðŸ“Š *Analytics - AIGestiÃ³n*\\n\\n` + `*Elige una opciÃ³n:*`, {\n        reply_markup: {\n          inline_keyboard: [\n            [\n              { text: 'ðŸ“ˆ Proyectos', callback_data: 'analytics_projects' },\n              { text: 'ðŸ‘¥ Usuarios', callback_data: 'analytics_users' },\n            ],\n            [\n              { text: 'â±ï¸ Productividad', callback_data: 'analytics_productivity' },\n              { text: 'ðŸ’° ROI', callback_data: 'analytics_roi' },\n            ],\n            [\n              { text: 'ðŸ“‹ Tareas', callback_data: 'analytics_tasks' },\n              { text: 'ðŸŽ¯ Objetivos', callback_data: 'analytics_goals' },\n            ],\n            [{ text: 'âŒ Cerrar', callback_data: 'close' }],\n          ],\n        },\n      });\n    });\n\n    this.bot.command('metrics', async (ctx: Context) => {\n      await ctx.reply(\n        `ðŸ“ˆ *MÃ©tricas Detalladas*\\n\\n` +\n          `ðŸ† Proyectos Activos: 12\\n` +\n          `ðŸ‘¥ Miembros Activos: 48\\n` +\n          `âœ… Tareas Completadas: 342 (87%)\\n` +\n          `â³ Tareas Pendientes: 51 (13%)\\n` +\n          `âš ï¸ Tareas Retrasadas: 3\\n` +\n          `ðŸŽ¯ Eficiencia General: 92%\\n` +\n          `â±ï¸ Promedio de Respuesta: 2.4h\\n` +\n          `ðŸ’¯ SatisfacciÃ³n: 4.8/5.0\\n\\n` +\n          `*Ãšltimos 7 dÃ­as:*\\n` +\n          `ðŸ“ˆ +23% de productividad\\n` +\n          `ðŸ“Š +15% de entregas a tiempo\\n` +\n          `ðŸ‘¥ +8% de colaboraciÃ³n`,\n        { parse_mode: 'Markdown' },\n      );\n    });\n\n    // ===== PROYECTOS =====\n\n    this.bot.command('projects', async (ctx: Context) => {\n      await ctx.reply(\n        `ðŸš€ *Proyectos Activos*\\n\\n` +\n          `1ï¸âƒ£ *AIGestiÃ³n Dashboard*\\n` +\n          `   Status: En progreso (85%)\\n` +\n          `   Equipo: 5 personas\\n` +\n          `   Deadline: Feb 28\\n\\n` +\n          `2ï¸âƒ£ *API REST v2*\\n` +\n          `   Status: En progreso (60%)\\n` +\n          `   Equipo: 3 personas\\n` +\n          `   Deadline: Mar 15\\n\\n` +\n          `3ï¸âƒ£ *Mobile App*\\n` +\n          `   Status: PlanificaciÃ³n (30%)\\n` +\n          `   Equipo: 4 personas\\n` +\n          `   Deadline: Apr 30\\n\\n` +\n          `4ï¸âƒ£ *IA Integration*\\n` +\n          `   Status: En progreso (75%)\\n` +\n          `   Equipo: 6 personas\\n` +\n          `   Deadline: Mar 1\\n\\n` +\n          `ðŸ“Œ Ver detalles: /projects_detail`,\n        { parse_mode: 'Markdown' },\n      );\n    });\n\n    // ===== EQUIPO =====\n\n    this.bot.command('team', async (ctx: Context) => {\n      await ctx.reply(\n        `ðŸ‘¥ *Equipo AIGestiÃ³n*\\n\\n` +\n          `ðŸ‘‘ *LÃ­deres*\\n` +\n          `â”œâ”€ Alejandro (Admin)\\n` +\n          `â””â”€ Carlos (Tech Lead)\\n\\n` +\n          `ðŸ’¼ *Desarrolladores (8)*\\n` +\n          `â”œâ”€ Frontend: 3\\n` +\n          `â”œâ”€ Backend: 3\\n` +\n          `â””â”€ DevOps: 2\\n\\n` +\n          `ðŸŽ¨ *DiseÃ±o (3)*\\n` +\n          `â”œâ”€ UX/UI: 2\\n` +\n          `â””â”€ Brand: 1\\n\\n` +\n          `ðŸ“Š *Otros (4)*\\n` +\n          `â”œâ”€ PM: 1\\n` +\n          `â”œâ”€ QA: 2\\n` +\n          `â””â”€ Support: 1\\n\\n` +\n          `Total: 18 miembros activos`,\n        { parse_mode: 'Markdown' },\n      );\n    });\n\n    // ===== TAREAS =====\n\n    this.bot.command('tasks', async (ctx: Context) => {\n      await ctx.reply(\n        `âœ… *Mis Tareas*\\n\\n` +\n          `*Activas (5):*\\n` +\n          `1. ðŸ”´ [URGENTE] Fix login bug - Hoy\\n` +\n          `2. ðŸŸ¡ [ALTA] Dashboard redesign - MaÃ±ana\\n` +\n          `3. ðŸŸ¢ [MEDIA] Update docs - Viernes\\n` +\n          `4. ðŸŸ¢ [MEDIA] Code review - PrÃ³xima semana\\n` +\n          `5. ðŸ”µ [BAJA] Cleanup code - Sin deadline\\n\\n` +\n          `*Completadas hoy: 8*\\n` +\n          `*Completadas esta semana: 42*\\n\\n` +\n          `Productividad: 92% ðŸ“ˆ`,\n        { parse_mode: 'Markdown' },\n      );\n    });\n\n    // ===== REPORTES =====\n\n    this.bot.command('report', async (ctx: Context) => {\n      const date = new Date().toLocaleDateString('es-ES');\n      await ctx.reply(\n        `ðŸ“‹ *Reporte Diario - ${date}*\\n\\n` +\n          `ðŸ“Š *Resumen Ejecutivo*\\n` +\n          `Tareas Completadas: 8/10 (80%)\\n` +\n          `Horas Trabajadas: 8h\\n` +\n          `Productividad: 92%\\n` +\n          `Calidad: 95%\\n\\n` +\n          `âœ… *Logros*\\n` +\n          `â€¢ Fixed critical bug\\n` +\n          `â€¢ Updated API docs\\n` +\n          `â€¢ Code review completed\\n` +\n          `â€¢ Team meeting attended\\n\\n` +\n          `âš ï¸ *Bloqueadores*\\n` +\n          `â€¢ Waiting for design approval\\n\\n` +\n          `ðŸŽ¯ *MaÃ±ana*\\n` +\n          `â€¢ Dashboard redesign\\n` +\n          `â€¢ Database optimization\\n` +\n          `â€¢ Team standup`,\n        { parse_mode: 'Markdown' },\n      );\n    });\n\n    // ===== CONFIGURACIÃ“N =====\n\n    this.bot.command('settings', async (ctx: Context) => {\n      await ctx.reply(`âš™ï¸ *ConfiguraciÃ³n*\\n\\n` + `Personaliza tu experiencia:`, {\n        reply_markup: {\n          inline_keyboard: [\n            [\n              { text: 'ðŸ”” Notificaciones', callback_data: 'settings_notifications' },\n              { text: 'ðŸŒ Idioma', callback_data: 'settings_language' },\n            ],\n            [\n              { text: 'ðŸ• Zona Horaria', callback_data: 'settings_timezone' },\n              { text: 'ðŸ“§ Email', callback_data: 'settings_email' },\n            ],\n            [\n              { text: 'ðŸŽ¨ Tema', callback_data: 'settings_theme' },\n              { text: 'ðŸ“± Conectar Apps', callback_data: 'settings_apps' },\n            ],\n            [{ text: 'âŒ Cerrar', callback_data: 'close' }],\n          ],\n        },\n      });\n    });\n\n    // ===== DANIELA AI =====\n\n    this.bot.command('daniela', async (ctx: Context) => {\n      if (!this.daniela) {\n        await ctx.reply('âŒ Daniela no estÃ¡ disponible en este momento.');\n        return;\n      }\n\n      const message =\n        ctx.message && 'text' in ctx.message ? ctx.message.text.replace('/daniela', '').trim() : '';\n\n      if (!message) {\n        await ctx.reply(this.daniela.getDanielaInfo(), {\n          parse_mode: 'Markdown',\n        });\n        return;\n      }\n\n      await ctx.reply('â³ Daniela estÃ¡ pensando...');\n\n      const response = await this.daniela.processMessage(\n        ctx.chat!.id,\n        message,\n        ctx.from?.first_name || 'User',\n        ctx.from?.id.toString() || 'unknown',\n        ctx.from?.is_bot ? 'bot' : 'user',\n      );\n\n      await ctx.reply(response, { parse_mode: 'Markdown' });\n    });\n\n    // Manejo de mensajes para Daniela en conversaciones\n    this.bot.on('text', async (ctx: Context) => {\n      const message = ctx.message && 'text' in ctx.message ? ctx.message.text : '';\n\n      // Si el mensaje menciona a Daniela o es una respuesta directa\n      if (message.toLowerCase().includes('daniela') || message.startsWith('/daniela')) {\n        if (!this.daniela) return;\n\n        const cleanMessage = message.replace(/\\/daniela|@[^\\s]+/gi, '').trim();\n\n        if (!cleanMessage) return;\n\n        try {\n          const response = await this.daniela.processMessage(\n            ctx.chat!.id,\n            cleanMessage,\n            ctx.from?.first_name || 'User',\n            ctx.from?.id.toString() || 'unknown',\n            ctx.from?.is_bot ? 'bot' : 'user',\n          );\n\n          await ctx.reply(response, { parse_mode: 'Markdown' });\n        } catch (error) {\n          logger.error('Error processing Daniela message:', error);\n        }\n      }\n    });\n\n    // ===== ADMIN PANEL =====\n\n    if (this.bot) {\n      this.bot.command('admin', async (ctx: Context) => {\n        if (!this.isAdmin(ctx)) {\n          return ctx.reply('âŒ Acceso denegado. Solo administradores.');\n        }\n\n        await ctx.reply(\n          `ðŸ‘‘ *Panel de AdministraciÃ³n - GOD MODE*\\n\\n` + `Sistema completamente bajo tu control:`,\n          {\n            reply_markup: {\n              inline_keyboard: [\n                [\n                  { text: 'ðŸ‘¥ Usuarios', callback_data: 'admin_users' },\n                  { text: 'ðŸš€ Proyectos', callback_data: 'admin_projects' },\n                ],\n                [\n                  { text: 'ðŸ“Š Analytics', callback_data: 'admin_analytics' },\n                  { text: 'ðŸ”§ Sistema', callback_data: 'admin_system' },\n                ],\n                [\n                  { text: 'ðŸ“‹ Logs', callback_data: 'admin_logs' },\n                  { text: 'âš™ï¸ ConfiguraciÃ³n', callback_data: 'admin_config' },\n                ],\n                [\n                  { text: 'ðŸ” Seguridad', callback_data: 'admin_security' },\n                  { text: 'ðŸ’¾ Backup', callback_data: 'admin_backup' },\n                ],\n                [{ text: 'âŒ Cerrar', callback_data: 'close' }],\n              ],\n            },\n          },\n        );\n      });\n    }\n\n    // ===== MANEJO DE BOTONES =====\n\n    this.bot.on('callback_query', async (ctx: Context) => {\n      const action = (ctx as any).callbackQuery?.data;\n\n      try {\n        if (action === 'close') {\n          await ctx.editMessageText('âœ… Cerrado');\n          await ctx.answerCbQuery();\n        } else if (action.startsWith('analytics_')) {\n          await this.handleAnalyticsCallback(ctx, action);\n        } else if (action.startsWith('settings_')) {\n          await this.handleSettingsCallback(ctx, action);\n        } else if (action.startsWith('admin_')) {\n          if (this.isAdmin(ctx)) {\n            await this.handleAdminCallback(ctx, action);\n          } else {\n            await ctx.answerCbQuery('âŒ No autorizado');\n          }\n        }\n      } catch (error) {\n        logger.error('Error handling callback', error);\n        await ctx.answerCbQuery('âŒ Error');\n      }\n    });\n\n    // ===== MENSAJES DE TEXTO =====\n\n    this.bot.on('text', async (ctx: Context) => {\n      const text = (ctx as any).message?.text;\n\n      // Respuestas inteligentes simples\n      if (text?.toLowerCase().includes('hola')) {\n        await ctx.reply('ðŸ‘‹ Â¡Hola! Â¿CÃ³mo estÃ¡s? Use /help para ver mis comandos.');\n      } else if (text?.toLowerCase().includes('ayuda')) {\n        await ctx.reply('ðŸ“ž Escribe /help para ver todos mis comandos.');\n      } else if (text?.toLowerCase().includes('gracias')) {\n        await ctx.reply('ðŸ¤— Â¡De nada! Cualquier cosa, estoy aquÃ­.');\n      } else {\n        await ctx.reply('ðŸ¤– No entiendo ese comando. Usa /help para ver quÃ© puedo hacer.');\n      }\n    });\n  }\n\n  /**\n   * Admin Panel - Funciones avanzadas\n   */\n  private setupAdminPanel() {\n    if (!this.bot) return;\n\n    this.bot.command('logs', async (ctx: Context) => {\n      if (!this.isAdmin(ctx)) {\n        return ctx.reply('âŒ No autorizado');\n      }\n\n      await ctx.reply(\n        `ðŸ“‹ *Ãšltimos Logs del Sistema*\\n\\n` +\n          `[INFO] Bot iniciado correctamente\\n` +\n          `[INFO] Base de datos conectada\\n` +\n          `[INFO] 5 usuarios activos\\n` +\n          `[WARN] Cache hit rate bajo (45%)\\n` +\n          `[INFO] Backup completado\\n` +\n          `[INFO] Notificaciones enviadas: 23\\n\\n` +\n          `Ver logs completos: /logs_full`,\n        { parse_mode: 'Markdown' },\n      );\n    });\n\n    this.bot.command('system', async (ctx: Context) => {\n      if (!this.isAdmin(ctx)) {\n        return ctx.reply('âŒ No autorizado');\n      }\n\n      await ctx.reply(\n        `ðŸ”§ *Control del Sistema*\\n\\n` +\n          `*Recursos:*\\n` +\n          `CPU: 45% (6/16 cores)\\n` +\n          `RAM: 12.5GB/32GB (39%)\\n` +\n          `Disk: 850GB/1TB (85%)\\n` +\n          `Network: 2.3Mbps in, 1.8Mbps out\\n\\n` +\n          `*Servicios:*\\n` +\n          `ðŸŸ¢ API: Running\\n` +\n          `ðŸŸ¢ Database: Running\\n` +\n          `ðŸŸ¢ Cache: Running\\n` +\n          `ðŸŸ¢ Workers: Running (4 activos)\\n\\n` +\n          `âš¡ Performance: Excelente`,\n        { parse_mode: 'Markdown' },\n      );\n    });\n  }\n\n  /**\n   * Sistema de Notificaciones\n   */\n  private setupNotifications() {\n    if (!this.bot) return;\n\n    // Notificaciones automÃ¡ticas cada 6 horas\n    setInterval(\n      async () => {\n        const sessions = Array.from(this.userSessions.values());\n        for (const session of sessions) {\n          try {\n            await this.bot?.telegram.sendMessage(\n              session.chatId,\n              `ðŸ“¢ *NotificaciÃ³n AutomÃ¡tica*\\n\\n` +\n                `âœ… Sistema operativo y saludable\\n` +\n                `ðŸ“Š Analytics actualizadas\\n` +\n                `ðŸ‘¥ 3 nuevos miembros en el equipo\\n\\n` +\n                `Usa /report para detalles completos.`,\n              { parse_mode: 'Markdown' },\n            );\n          } catch (error) {\n            logger.warn(`Failed to send notification to ${session.chatId}`, error);\n          }\n        }\n      },\n      6 * 60 * 60 * 1000,\n    ); // 6 horas\n\n    // EconomÃ­a - Cada 4 horas si hay un canal configurado\n    setInterval(\n      async () => {\n        const economyChannelId = env.TELEGRAM_CHAT_ID_DEV; // Usar el configurado\n        if (economyChannelId) {\n          try {\n            const report = await this.economyService.generateFormattedReport();\n            const adviceData = await this.economyService.getInvestmentAdvice();\n\n            await this.bot?.telegram.sendMessage(economyChannelId, report, {\n              parse_mode: 'Markdown',\n            });\n\n            await this.bot?.telegram.sendMessage(economyChannelId, adviceData.advice, {\n              parse_mode: 'Markdown',\n            });\n\n            logger.info(\n              `[TELEGRAM] Periodic economy report and advice sent to ${economyChannelId}`,\n            );\n          } catch (error) {\n            logger.warn(`Failed to send economy report to ${economyChannelId}`, error);\n          }\n        }\n      },\n      4 * 60 * 60 * 1000,\n    );\n\n    // Alertas de Precio - Cada 15 minutos\n    setInterval(\n      async () => {\n        try {\n          const triggered = await this.economyService.checkPriceAlerts();\n          for (const alert of triggered) {\n            const msg = `ðŸ”” *ALERTA DE PRECIO: ${\n              alert.symbol\n            }*\\nEl precio ha alcanzado tu objetivo de *$${alert.targetPrice}* (${\n              alert.condition === 'above' ? 'â†‘' : 'â†“'\n            })`;\n            await this.bot?.telegram.sendMessage(alert.chatId, msg, { parse_mode: 'Markdown' });\n          }\n        } catch (error) {\n          logger.error('Error checking price alerts in background', error);\n        }\n      },\n      15 * 60 * 1000,\n    );\n\n    // Morning Briefing God Mode - Diariamente a las 8:00 AM\n    setInterval(\n      async () => {\n        const now = new Date();\n        // Check if it's 8:00 AM (within a 15 min window to match the interval)\n        if (now.getHours() === 8 && now.getMinutes() < 15) {\n          const economyChannelId = env.TELEGRAM_CHAT_ID_DEV;\n          if (economyChannelId) {\n            try {\n              logger.info('[SCHEDULER] Triggering Morning Briefing...');\n              const script = await this.economyService.generateVoiceScript();\n              const audioBuffer = await this.voiceService.textToSpeech(script, 'qwen');\n\n              await this.bot?.telegram.sendMessage(\n                economyChannelId,\n                'ðŸŒ… *Morning Briefing God Mode*',\n                { parse_mode: 'Markdown' },\n              );\n              await this.bot?.telegram.sendVoice(economyChannelId, { source: audioBuffer });\n            } catch (error) {\n              logger.error('Error in Morning Briefing Scheduler', error);\n            }\n          }\n        }\n      },\n      15 * 60 * 1000,\n    ); // Check every 15 mins\n  }\n\n  /**\n   * Manejo de callbacks de analytics\n   */\n  private async handleAnalyticsCallback(ctx: Context, action: string) {\n    const replies: Record<string, string> = {\n      analytics_projects: `ðŸ“Š *Analytics de Proyectos*\\n\\nProyectos Activos: 4\\nEn Progreso: 3\\nCompletos: 12\\nPromedio de duraciÃ³n: 3.2 semanas`,\n      analytics_users: `ðŸ‘¥ *Analytics de Usuarios*\\n\\nUsuarios activos: 18\\nNuevos esta semana: 2\\nTasa de retenciÃ³n: 94%`,\n      analytics_productivity: `â±ï¸ *Productividad*\\n\\nPromedio diario: 42 tareas\\nPromedio por usuario: 8.4 tareas\\nTasa de finalizaciÃ³n: 87%`,\n      analytics_roi: `ðŸ’° *ROI Analysis*\\n\\nRetorno: 340%\\nCosto por usuario: $150\\nValor generado: $510`,\n      analytics_tasks: `ðŸ“‹ *Analytics de Tareas*\\n\\nTotal: 2,340\\nCompletadas: 2,034 (87%)\\nEn progreso: 210 (9%)\\nPendientes: 96 (4%)`,\n      analytics_goals: `ðŸŽ¯ *Objetivos*\\n\\nObjectivos Q1: 12\\nCompletados: 10 (83%)\\nEn progreso: 2\\nTasa de Ã©xito: 92%`,\n    };\n\n    await ctx.editMessageText(replies[action] || 'â„¹ï¸ InformaciÃ³n no disponible', {\n      parse_mode: 'Markdown',\n    });\n    await ctx.answerCbQuery();\n  }\n\n  /**\n   * Manejo de callbacks de settings\n   */\n  private async handleSettingsCallback(ctx: Context, action: string) {\n    const replies: Record<string, string> = {\n      settings_notifications: `ðŸ”” *Notificaciones*\\n\\nActualmente: ACTIVADAS\\n\\nTipos:\\nâœ… Tareas urgentes\\nâœ… Reportes diarios\\nâœ… Alertas del sistema\\nâœ… Menciones del equipo`,\n      settings_language: `ðŸŒ *Idioma*\\n\\nActualmente: EspaÃ±ol\\n\\nOpciones disponibles:\\nâœ… EspaÃ±ol\\nâ¬œ InglÃ©s\\nâ¬œ PortuguÃ©s\\nâ¬œ FrancÃ©s`,\n      settings_timezone: `ðŸ• *Zona Horaria*\\n\\nActualmente: America/Mexico_City (CST)\\n\\nTiempo actual: ${new Date().toLocaleString()}`,\n      settings_email: `ðŸ“§ *Email*\\n\\nConectado: alejandro@aigestion.net\\nâœ… Activo para notificaciones`,\n      settings_theme: `ðŸŽ¨ *Tema*\\n\\nActualmente: Dark Mode\\n\\nOpciones:\\nâœ… Dark Mode\\nâ¬œ Light Mode\\nâ¬œ Auto`,\n      settings_apps: `ðŸ“± *Conectar Apps*\\n\\nConectadas:\\nâœ… Slack\\nâœ… Google Workspace\\nâœ… Jira\\nâ¬œ MS Teams\\nâ¬œ Asana`,\n    };\n\n    await ctx.editMessageText(replies[action] || 'â„¹ï¸ ConfiguraciÃ³n no disponible', {\n      parse_mode: 'Markdown',\n    });\n    await ctx.answerCbQuery();\n  }\n\n  /**\n   * Manejo de callbacks de admin\n   */\n  private async handleAdminCallback(ctx: Context, action: string) {\n    const replies: Record<string, string> = {\n      admin_users: `ðŸ‘¥ *GestiÃ³n de Usuarios*\\n\\nTotal: 18\\nActivos: 16\\nInactivos: 2\\n\\nÃšltimos registros:\\n1. user@example.com (Hoy)\\n2. admin@example.com (Ayer)`,\n      admin_projects: `ðŸš€ *GestiÃ³n de Proyectos*\\n\\nProyectos: 16\\nActivos: 4\\nArchivados: 12\\n\\nNuevo proyecto â†’ /new_project`,\n      admin_analytics: `ðŸ“Š *Analytics Avanzadas*\\n\\nðŸ“ˆ Crecimiento: +23%\\nðŸ‘¥ Usuarios: +12%\\nðŸ’¼ Proyectos: +8%\\nâœ… Completados: +15%`,\n      admin_system: `ðŸ”§ *Control del Sistema*\\n\\nEstado: âœ… Ã“ptimo\\nUptime: 99.98%\\nServidores: 12 activos`,\n      admin_logs: `ðŸ“‹ *Logs del Sistema*\\n\\nÃšltimas 100 lÃ­neas...\\n[INFO] Sistema operativo\\n[WARN] Cache bajo`,\n      admin_config: `âš™ï¸ *ConfiguraciÃ³n del Sistema*\\n\\nVersiÃ³n: 2.5.1\\nAPI: v3\\nDB: PostgreSQL 14\\n\\nModificar: /config_edit`,\n      admin_security: `ðŸ” *Seguridad*\\n\\nðŸŸ¢ SSL: Activo\\nðŸŸ¢ Firewall: Activo\\nðŸŸ¢ 2FA: Requerido\\nðŸŸ¢ Backup: AutomÃ¡tico (Diario)`,\n      admin_backup: `ðŸ’¾ *Backup*\\n\\nÃšltimo backup: ${new Date().toLocaleString()}\\nTamaÃ±o: 2.3GB\\nFrecuencia: Diaria\\nRetenciÃ³n: 30 dÃ­as`,\n    };\n\n    await ctx.editMessageText(replies[action] || 'â„¹ï¸ InformaciÃ³n no disponible', {\n      parse_mode: 'Markdown',\n    });\n    await ctx.answerCbQuery();\n  }\n\n  /**\n   * Setup error handling\n   */\n  private setupErrorHandling() {\n    if (!this.bot) return;\n\n    this.bot.catch((err: any, ctx: Context) => {\n      logger.error(`Error in bot context:`, err);\n      try {\n        ctx.reply('âŒ OcurriÃ³ un error. Intenta de nuevo.');\n      } catch (error) {\n        logger.error('Failed to send error message', error);\n      }\n    });\n  }\n\n  /**\n   * Verificar si es admin\n   */\n  private isAdmin(ctx: Context): boolean {\n    const chatId = ctx.chat?.id?.toString();\n    return chatId ? this.adminIds.includes(chatId) : false;\n  }\n\n  /**\n   * Launch the bot\n   */\n  public async launch(): Promise<void> {\n    if (!this.bot) {\n      logger.warn('Bot not initialized. Cannot launch.');\n      return;\n    }\n\n    if (this.isLaunched) {\n      logger.warn('Bot already launched.');\n      return;\n    }\n\n    try {\n      await this.bot.launch();\n      this.isLaunched = true;\n      logger.info('ðŸ¤– Telegram Bot GOD MODE launched successfully');\n\n      // Enable graceful stop\n      process.once('SIGINT', () => {\n        logger.info('SIGINT received, stopping bot...');\n        this.bot?.stop('SIGINT');\n      });\n\n      process.once('SIGTERM', () => {\n        logger.info('SIGTERM received, stopping bot...');\n        this.bot?.stop('SIGTERM');\n      });\n    } catch (error) {\n      logger.error('Failed to launch Telegram Bot', error);\n    }\n  }\n\n  /**\n   * Stop the bot\n   */\n  public async stop(): Promise<void> {\n    if (!this.bot || !this.isLaunched) {\n      return;\n    }\n\n    try {\n      await this.bot.stop();\n      this.isLaunched = false;\n      logger.info('Telegram Bot stopped');\n    } catch (error) {\n      logger.error('Error stopping bot', error);\n    }\n  }\n\n  /**\n   * Send message to specific user\n   */\n  public async sendToUser(chatId: number, message: string): Promise<void> {\n    if (!this.bot) return;\n\n    try {\n      await this.bot.telegram.sendMessage(chatId, message, { parse_mode: 'Markdown' });\n    } catch (error) {\n      logger.error(`Failed to send message to ${chatId}`, error);\n    }\n  }\n\n  /**\n   * Send notification to all users\n   */\n  public async broadcastNotification(message: string): Promise<void> {\n    const sessions = Array.from(this.userSessions.values());\n\n    for (const session of sessions) {\n      await this.sendToUser(session.chatId, message);\n    }\n\n    logger.info(`Broadcast notification sent to ${sessions.length} users`);\n  }\n\n  /**\n   * Get bot status\n   */\n  public getStatus(): {\n    isRunning: boolean;\n    activeSessions: number;\n    botId: string | null;\n  } {\n    return {\n      isRunning: this.isLaunched,\n      activeSessions: this.userSessions.size,\n      botId: (this.bot as any)?.botInfo?.id?.toString() || null,\n    };\n  }\n}\n"],"version":3}