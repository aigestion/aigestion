{"file":"C:\\Users\\Alejandro\\AIGestion\\backend\\src\\services\\zero-trust.service.ts","mappings":";;;;;;;;;;;;AAAA,yCAAuC;AACvC,4CAAyC;AAUlC,IAAM,gBAAgB,GAAtB,MAAM,gBAAgB;IACV,gBAAgB,GAAG,EAAE,CAAC;IAEvC,gBAAe,CAAC;IAEhB;;;OAGG;IACH,KAAK,CAAC,YAAY,CAAC,OAAsB;QACvC,eAAM,CAAC,IAAI,CACT,yCAAyC,OAAO,CAAC,MAAM,cAAc,OAAO,CAAC,QAAQ,EAAE,CACxF,CAAC;QAEF,0BAA0B;QAC1B,IAAI,OAAO,CAAC,YAAY,GAAG,IAAI,CAAC,gBAAgB,EAAE,CAAC;YACjD,eAAM,CAAC,IAAI,CAAC,mDAAmD,OAAO,CAAC,YAAY,GAAG,CAAC,CAAC;YACxF,OAAO,EAAE,OAAO,EAAE,KAAK,EAAE,MAAM,EAAE,8BAA8B,EAAE,CAAC;QACpE,CAAC;QAED,yCAAyC;QACzC,IAAI,OAAO,CAAC,QAAQ,KAAK,SAAS,IAAI,OAAO,CAAC,QAAQ,CAAC,QAAQ,CAAC,YAAY,CAAC,EAAE,CAAC;YAC9E,eAAM,CAAC,IAAI,CAAC,yDAAyD,CAAC,CAAC;YACvE,OAAO,EAAE,OAAO,EAAE,KAAK,EAAE,MAAM,EAAE,2BAA2B,EAAE,CAAC;QACjE,CAAC;QAED,OAAO,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC;IAC3B,CAAC;IAED;;OAEG;IACH,KAAK,CAAC,gBAAgB,CAAC,MAAc,EAAE,KAAa;QAClD,eAAM,CAAC,IAAI,CAAC,wCAAwC,MAAM,aAAa,KAAK,EAAE,CAAC,CAAC;QAChF,4EAA4E;QAC5E,OAAO,OAAO,MAAM,CAAC,IAAI,CAAC,GAAG,MAAM,IAAI,IAAI,CAAC,GAAG,EAAE,IAAI,KAAK,EAAE,CAAC,CAAC,QAAQ,CAAC,QAAQ,CAAC,EAAE,CAAC;IACrF,CAAC;CACF,CAAA;AArCY,4CAAgB;2BAAhB,gBAAgB;IAD5B,IAAA,sBAAU,GAAE;;GACA,gBAAgB,CAqC5B","names":[],"sources":["C:\\Users\\Alejandro\\AIGestion\\backend\\src\\services\\zero-trust.service.ts"],"sourcesContent":["import { injectable } from 'inversify';\nimport { logger } from '../utils/logger';\n\nexport interface AccessContext {\n  userId: string;\n  deviceId: string;\n  location: string;\n  postureScore: number; // 0-100\n}\n\n@injectable()\nexport class ZeroTrustService {\n  private readonly MIN_SAFE_POSTURE = 80;\n\n  constructor() {}\n\n  /**\n   * Verifies if a request should be allowed based on Zero Trust context.\n   * Never trusts, always verifies.\n   */\n  async verifyAccess(context: AccessContext): Promise<{ allowed: boolean; reason?: string }> {\n    logger.info(\n      `[ZeroTrust] Verifying access for user ${context.userId} on device ${context.deviceId}`,\n    );\n\n    // 1. Check device posture\n    if (context.postureScore < this.MIN_SAFE_POSTURE) {\n      logger.warn(`[ZeroTrust] Access denied: Poor device posture (${context.postureScore})`);\n      return { allowed: false, reason: 'Device posture non-compliant' };\n    }\n\n    // 2. Impossible Travel Check (Simulated)\n    if (context.location === 'unknown' || context.location.includes('suspicious')) {\n      logger.warn(`[ZeroTrust] Access denied: Suspicious location detected`);\n      return { allowed: false, reason: 'Suspicious login location' };\n    }\n\n    return { allowed: true };\n  }\n\n  /**\n   * Generates a JIT (Just-In-Time) token for high-privilege operations.\n   */\n  async generateJitToken(userId: string, scope: string): Promise<string> {\n    logger.info(`[ZeroTrust] Generating JIT token for ${userId} in scope ${scope}`);\n    // Implementation would involve a short-lived cryptographically signed token\n    return `jit_${Buffer.from(`${userId}:${Date.now()}:${scope}`).toString('base64')}`;\n  }\n}\n"],"version":3}