819fa6c258eea0c94df925d946bc8995
"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.schema = exports.RootMutation = exports.RootQuery = exports.MissionType = exports.ProjectType = exports.GitStatsType = exports.GitContributorType = exports.GitCommitType = exports.DockerContainerType = exports.SystemMetricsType = exports.LoginResponseType = exports.UserType = void 0;
const child_process_1 = require("child_process");
const graphql_1 = require("graphql");
const os_1 = __importDefault(require("os"));
const util_1 = require("util");
const User_1 = require("../models/User");
const Project_1 = require("../models/Project");
const Mission_1 = require("../models/Mission");
const redis_1 = require("../utils/redis");
const inversify_config_1 = require("../config/inversify.config");
const execAsync = (0, util_1.promisify)(child_process_1.exec);
/**
 * GraphQL User Type
 */
exports.UserType = new graphql_1.GraphQLObjectType({
    name: 'User',
    description: 'Representa un usuario del sistema',
    fields: () => ({
        id: {
            type: new graphql_1.GraphQLNonNull(graphql_1.GraphQLID),
            description: 'ID único del usuario',
        },
        email: {
            type: new graphql_1.GraphQLNonNull(graphql_1.GraphQLString),
            description: 'Email del usuario',
        },
        name: {
            type: new graphql_1.GraphQLNonNull(graphql_1.GraphQLString),
            description: 'Nombre completo',
        },
        createdAt: {
            type: new graphql_1.GraphQLNonNull(graphql_1.GraphQLString),
            description: 'Timestamp de creación',
        },
        updatedAt: {
            type: new graphql_1.GraphQLNonNull(graphql_1.GraphQLString),
            description: 'Timestamp de actualización',
        },
        role: {
            type: graphql_1.GraphQLString,
            description: 'Rol del usuario',
        },
    }),
});
/**
 * GraphQL Login Response Type
 */
exports.LoginResponseType = new graphql_1.GraphQLObjectType({
    name: 'LoginResponse',
    description: 'Respuesta de inicio de sesión',
    fields: () => ({
        user: { type: exports.UserType },
        token: { type: graphql_1.GraphQLString },
        refreshToken: { type: graphql_1.GraphQLString },
        mfaRequired: { type: graphql_1.GraphQLFloat }, // Boolean is better but 0/1 works or GraphQLBoolean if available
    }),
});
/**
 * GraphQL System Metrics Type
 */
exports.SystemMetricsType = new graphql_1.GraphQLObjectType({
    name: 'SystemMetrics',
    description: 'Métricas de rendimiento del sistema',
    fields: () => ({
        cpu: { type: graphql_1.GraphQLFloat },
        memory: { type: graphql_1.GraphQLFloat },
        network: { type: graphql_1.GraphQLFloat },
        disk: { type: graphql_1.GraphQLFloat },
        uptime: { type: graphql_1.GraphQLFloat },
        platform: { type: graphql_1.GraphQLString },
        hostname: { type: graphql_1.GraphQLString },
        timestamp: { type: graphql_1.GraphQLFloat },
    }),
});
/**
 * GraphQL Docker Container Type
 */
exports.DockerContainerType = new graphql_1.GraphQLObjectType({
    name: 'DockerContainer',
    description: 'Información de un contenedor Docker',
    fields: () => ({
        ID: { type: graphql_1.GraphQLID },
        Names: { type: graphql_1.GraphQLString },
        Image: { type: graphql_1.GraphQLString },
        State: { type: graphql_1.GraphQLString },
        Status: { type: graphql_1.GraphQLString },
        Ports: { type: graphql_1.GraphQLString },
    }),
});
/**
 * GraphQL Git Commit Type
 */
exports.GitCommitType = new graphql_1.GraphQLObjectType({
    name: 'GitCommit',
    description: 'Información de un commit de Git',
    fields: () => ({
        hash: { type: graphql_1.GraphQLString },
        author: { type: graphql_1.GraphQLString },
        date: { type: graphql_1.GraphQLString },
        message: { type: graphql_1.GraphQLString },
    }),
});
/**
 * GraphQL Git Contributor Type
 */
exports.GitContributorType = new graphql_1.GraphQLObjectType({
    name: 'GitContributor',
    description: 'Información de un colaborador del proyecto',
    fields: () => ({
        name: { type: graphql_1.GraphQLString },
        commits: { type: graphql_1.GraphQLInt },
    }),
});
/**
 * GraphQL Git Stats Type
 */
exports.GitStatsType = new graphql_1.GraphQLObjectType({
    name: 'GitStats',
    description: 'Estadísticas generales del repositorio Git',
    fields: () => ({
        totalCommits: { type: graphql_1.GraphQLInt },
        contributors: { type: new graphql_1.GraphQLList(exports.GitContributorType) },
    }),
});
/**
 * GraphQL Project Type
 */
exports.ProjectType = new graphql_1.GraphQLObjectType({
    name: 'Project',
    description: 'Representa un proyecto en el sistema',
    fields: () => ({
        id: { type: new graphql_1.GraphQLNonNull(graphql_1.GraphQLID) },
        name: { type: new graphql_1.GraphQLNonNull(graphql_1.GraphQLString) },
        path: { type: graphql_1.GraphQLString },
        description: { type: graphql_1.GraphQLString },
        status: { type: graphql_1.GraphQLString },
        type: { type: graphql_1.GraphQLString },
        tags: { type: new graphql_1.GraphQLList(graphql_1.GraphQLString) },
        lastModified: { type: graphql_1.GraphQLString },
        createdAt: { type: graphql_1.GraphQLString },
        updatedAt: { type: graphql_1.GraphQLString },
    }),
});
/**
 * GraphQL Mission Type
 */
exports.MissionType = new graphql_1.GraphQLObjectType({
    name: 'Mission',
    description: 'Representa una misión o tarea autónoma',
    fields: () => ({
        id: { type: new graphql_1.GraphQLNonNull(graphql_1.GraphQLID) },
        objective: { type: new graphql_1.GraphQLNonNull(graphql_1.GraphQLString) },
        userId: { type: graphql_1.GraphQLString },
        status: { type: graphql_1.GraphQLString },
        plan: { type: graphql_1.GraphQLString },
        result: { type: graphql_1.GraphQLString },
        error: { type: graphql_1.GraphQLString },
        startedAt: { type: graphql_1.GraphQLString },
        completedAt: { type: graphql_1.GraphQLString },
        createdAt: { type: graphql_1.GraphQLString },
        updatedAt: { type: graphql_1.GraphQLString },
    }),
});
/**
 * GraphQL Root Query
 */
exports.RootQuery = new graphql_1.GraphQLObjectType({
    name: 'Query',
    description: 'Queries raíz disponibles',
    fields: {
        user: {
            type: exports.UserType,
            args: {
                id: { type: new graphql_1.GraphQLNonNull(graphql_1.GraphQLID) },
            },
            resolve: async (_obj, args, context) => {
                // Resolver implementation - conectar a DB
                return context.dataloaders.userLoader.load(args.id);
            },
        },
        users: {
            type: new graphql_1.GraphQLNonNull(new graphql_1.GraphQLList(exports.UserType)),
            args: {
                limit: { type: graphql_1.GraphQLString, defaultValue: '10' },
                offset: { type: graphql_1.GraphQLString, defaultValue: '0' },
            },
            resolve: async (_obj, args) => {
                const limit = parseInt(args.limit) || 10;
                const offset = parseInt(args.offset) || 0;
                return User_1.User.find().skip(offset).limit(limit);
            },
        },
        chat: {
            type: graphql_1.GraphQLString,
            args: {
                message: { type: new graphql_1.GraphQLNonNull(graphql_1.GraphQLString) },
            },
            resolve: async (_obj, args) => {
                return 'This is a mock AI response';
            },
        },
        systemMetrics: {
            type: exports.SystemMetricsType,
            resolve: async () => {
                try {
                    const cacheKey = 'system:metrics';
                    const cachedData = await (0, redis_1.getCache)(cacheKey);
                    if (cachedData) {
                        return cachedData;
                    }
                    const cpus = os_1.default.cpus();
                    const totalMem = os_1.default.totalmem();
                    const freeMem = os_1.default.freemem();
                    const usedMem = totalMem - freeMem;
                    const cpuUsage = cpus.reduce((acc, cpu) => {
                        const total = Object.values(cpu.times).reduce((a, b) => a + b, 0);
                        const idle = cpu.times.idle;
                        return acc + ((total - idle) / total) * 100;
                    }, 0) / cpus.length;
                    const metrics = {
                        cpu: parseFloat(cpuUsage.toFixed(2)),
                        memory: parseFloat(((usedMem / totalMem) * 100).toFixed(2)),
                        network: Math.random() * 100, // Placeholder
                        disk: 0, // Placeholder
                        uptime: os_1.default.uptime(),
                        platform: os_1.default.platform(),
                        hostname: os_1.default.hostname(),
                        timestamp: Date.now(),
                    };
                    await (0, redis_1.setCache)(cacheKey, JSON.stringify(metrics), 2);
                    return metrics;
                }
                catch (error) {
                    console.error('GraphQL SystemMetrics Error:', error);
                    throw new Error('Failed to fetch system metrics');
                }
            },
        },
        containers: {
            type: new graphql_1.GraphQLNonNull(new graphql_1.GraphQLList(new graphql_1.GraphQLNonNull(exports.DockerContainerType))),
            resolve: async () => {
                try {
                    const cacheKey = 'docker:containers';
                    const cachedData = await (0, redis_1.getCache)(cacheKey);
                    if (cachedData) {
                        return cachedData;
                    }
                    const { stdout } = await execAsync('docker ps -a --format "{{json .}}"');
                    const containers = stdout
                        .trim()
                        .split('\n')
                        .filter(line => line)
                        .map(line => {
                        try {
                            return JSON.parse(line);
                        }
                        catch {
                            return null;
                        }
                    })
                        .filter(Boolean);
                    await (0, redis_1.setCache)(cacheKey, JSON.stringify(containers), 5);
                    return containers;
                }
                catch (error) {
                    console.error('GraphQL DockerContainers Error:', error);
                    return [];
                }
            },
        },
        recentCommits: {
            type: new graphql_1.GraphQLNonNull(new graphql_1.GraphQLList(new graphql_1.GraphQLNonNull(exports.GitCommitType))),
            args: {
                limit: { type: graphql_1.GraphQLInt, defaultValue: 10 },
            },
            resolve: async (_obj, args) => {
                try {
                    const { stdout } = await execAsync(`git log -${args.limit} --pretty=format:"%H|%an|%ai|%s"`);
                    return stdout
                        .trim()
                        .split('\n')
                        .filter(line => line)
                        .map(line => {
                        const [hash, author, date, message] = line.split('|');
                        return { hash, author, date, message };
                    });
                }
                catch (error) {
                    console.error('GraphQL recentCommits Error:', error);
                    if (error.message?.includes('not a git repository')) {
                        return [
                            {
                                hash: 'demo',
                                author: 'Dev',
                                date: new Date().toISOString(),
                                message: 'Demo commit',
                            },
                        ];
                    }
                    return [];
                }
            },
        },
        gitBranches: {
            type: new graphql_1.GraphQLNonNull(new graphql_1.GraphQLList(new graphql_1.GraphQLNonNull(graphql_1.GraphQLString))),
            resolve: async () => {
                try {
                    const { stdout } = await execAsync('git branch -a');
                    return stdout
                        .trim()
                        .split('\n')
                        .map(branch => branch.trim().replace('* ', ''))
                        .filter(branch => branch);
                }
                catch (error) {
                    console.error('GraphQL gitBranches Error:', error);
                    return ['main'];
                }
            },
        },
        gitStats: {
            type: exports.GitStatsType,
            resolve: async () => {
                try {
                    const { stdout: commitCount } = await execAsync('git rev-list --count HEAD');
                    const { stdout: contributorsRaw } = await execAsync('git shortlog -sn HEAD');
                    const contributors = contributorsRaw
                        .trim()
                        .split('\n')
                        .map(line => {
                        const [commits, ...nameParts] = line.trim().split(/\s+/);
                        return {
                            name: nameParts.join(' '),
                            commits: parseInt(commits),
                        };
                    });
                    return {
                        totalCommits: parseInt(commitCount.trim()),
                        contributors,
                    };
                }
                catch (error) {
                    console.error('GraphQL gitStats Error:', error);
                    return { totalCommits: 0, contributors: [] };
                }
            },
        },
        projects: {
            type: new graphql_1.GraphQLNonNull(new graphql_1.GraphQLList(new graphql_1.GraphQLNonNull(exports.ProjectType))),
            args: {
                status: { type: graphql_1.GraphQLString },
                type: { type: graphql_1.GraphQLString },
                tags: { type: new graphql_1.GraphQLList(graphql_1.GraphQLString) },
                search: { type: graphql_1.GraphQLString },
                limit: { type: graphql_1.GraphQLInt, defaultValue: 20 },
                offset: { type: graphql_1.GraphQLInt, defaultValue: 0 },
            },
            resolve: async (_obj, args) => {
                const query = {};
                if (args.status)
                    query.status = args.status;
                if (args.type)
                    query.type = args.type;
                if (args.tags && args.tags.length > 0)
                    query.tags = { $in: args.tags };
                if (args.search)
                    query.$text = { $search: args.search };
                return Project_1.Project.find(query)
                    .sort(args.search ? { score: { $meta: 'textScore' } } : { updatedAt: -1 })
                    .skip(args.offset)
                    .limit(args.limit);
            },
        },
        searchProjects: {
            type: new graphql_1.GraphQLNonNull(new graphql_1.GraphQLList(new graphql_1.GraphQLNonNull(exports.ProjectType))),
            args: {
                query: { type: new graphql_1.GraphQLNonNull(graphql_1.GraphQLString) },
                limit: { type: graphql_1.GraphQLInt, defaultValue: 10 },
            },
            resolve: async (_obj, args) => {
                return Project_1.Project.find({ $text: { $search: args.query } })
                    .sort({ score: { $meta: 'textScore' } })
                    .limit(args.limit);
            },
        },
        missions: {
            type: new graphql_1.GraphQLNonNull(new graphql_1.GraphQLList(new graphql_1.GraphQLNonNull(exports.MissionType))),
            args: {
                status: { type: graphql_1.GraphQLString },
                userId: { type: graphql_1.GraphQLString },
                limit: { type: graphql_1.GraphQLInt, defaultValue: 20 },
                offset: { type: graphql_1.GraphQLInt, defaultValue: 0 },
            },
            resolve: async (_obj, args) => {
                const query = {};
                if (args.status)
                    query.status = args.status;
                if (args.userId)
                    query.userId = args.userId;
                return Mission_1.Mission.find(query).sort({ createdAt: -1 }).skip(args.offset).limit(args.limit);
            },
        },
    },
});
/**
 * GraphQL Mutations
 */
exports.RootMutation = new graphql_1.GraphQLObjectType({
    name: 'Mutation',
    description: 'Mutaciones disponibles',
    fields: {
        createUser: {
            type: exports.UserType,
            args: {
                email: { type: new graphql_1.GraphQLNonNull(graphql_1.GraphQLString) },
                name: { type: new graphql_1.GraphQLNonNull(graphql_1.GraphQLString) },
            },
            resolve: async (_obj, args) => {
                return User_1.User.create({
                    email: args.email,
                    name: args.name,
                    password: 'AIGestion123!', // Default password for now
                    loginAttempts: 0,
                });
            },
        },
        login: {
            type: exports.LoginResponseType,
            args: {
                email: { type: new graphql_1.GraphQLNonNull(graphql_1.GraphQLString) },
                password: { type: new graphql_1.GraphQLNonNull(graphql_1.GraphQLString) },
            },
            resolve: async (_obj, args) => {
                const authService = inversify_config_1.container.get(inversify_config_1.TYPES.AuthService);
                const result = await authService.login({
                    email: args.email,
                    password: args.password,
                });
                return {
                    user: result.user,
                    token: result.token,
                    refreshToken: result.refreshToken,
                    mfaRequired: result.mfaRequired ? 1 : 0,
                };
            },
        },
    },
});
/**
 * GraphQL Schema
 */
exports.schema = new graphql_1.GraphQLSchema({
    query: exports.RootQuery,
    mutation: exports.RootMutation,
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxBbGVqYW5kcm9cXEFJR2VzdGlvblxcYmFja2VuZFxcc3JjXFxncmFwaHFsXFxzY2hlbWEudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsaURBQXFDO0FBQ3JDLHFDQVNpQjtBQUNqQiw0Q0FBb0I7QUFDcEIsK0JBQWlDO0FBRWpDLHlDQUFzQztBQUN0QywrQ0FBNEM7QUFDNUMsK0NBQTRDO0FBQzVDLDBDQUFvRDtBQUNwRCxpRUFBOEQ7QUFHOUQsTUFBTSxTQUFTLEdBQUcsSUFBQSxnQkFBUyxFQUFDLG9CQUFJLENBQUMsQ0FBQztBQUVsQzs7R0FFRztBQUNVLFFBQUEsUUFBUSxHQUFHLElBQUksMkJBQWlCLENBQUM7SUFDNUMsSUFBSSxFQUFFLE1BQU07SUFDWixXQUFXLEVBQUUsbUNBQW1DO0lBQ2hELE1BQU0sRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO1FBQ2IsRUFBRSxFQUFFO1lBQ0YsSUFBSSxFQUFFLElBQUksd0JBQWMsQ0FBQyxtQkFBUyxDQUFDO1lBQ25DLFdBQVcsRUFBRSxzQkFBc0I7U0FDcEM7UUFDRCxLQUFLLEVBQUU7WUFDTCxJQUFJLEVBQUUsSUFBSSx3QkFBYyxDQUFDLHVCQUFhLENBQUM7WUFDdkMsV0FBVyxFQUFFLG1CQUFtQjtTQUNqQztRQUNELElBQUksRUFBRTtZQUNKLElBQUksRUFBRSxJQUFJLHdCQUFjLENBQUMsdUJBQWEsQ0FBQztZQUN2QyxXQUFXLEVBQUUsaUJBQWlCO1NBQy9CO1FBQ0QsU0FBUyxFQUFFO1lBQ1QsSUFBSSxFQUFFLElBQUksd0JBQWMsQ0FBQyx1QkFBYSxDQUFDO1lBQ3ZDLFdBQVcsRUFBRSx1QkFBdUI7U0FDckM7UUFDRCxTQUFTLEVBQUU7WUFDVCxJQUFJLEVBQUUsSUFBSSx3QkFBYyxDQUFDLHVCQUFhLENBQUM7WUFDdkMsV0FBVyxFQUFFLDRCQUE0QjtTQUMxQztRQUNELElBQUksRUFBRTtZQUNKLElBQUksRUFBRSx1QkFBYTtZQUNuQixXQUFXLEVBQUUsaUJBQWlCO1NBQy9CO0tBQ0YsQ0FBQztDQUNI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QUMsQ0FBQztnQkFDbEUsTUFBTSxNQUFNLEdBQUcsTUFBTSxXQUFXLENBQUMsS0FBSyxDQUFDO29CQUNyQyxLQUFLLEVBQUUsSUFBSSxDQUFDLEtBQUs7b0JBQ2pCLFFBQVEsRUFBRSxJQUFJLENBQUMsUUFBUTtpQkFDeEIsQ0FBQyxDQUFDO2dCQUNILE9BQU87b0JBQ0wsSUFBSSxFQUFFLE1BQU0sQ0FBQyxJQUFJO29CQUNqQixLQUFLLEVBQUUsTUFBTSxDQUFDLEtBQUs7b0JBQ25CLFlBQVksRUFBRSxNQUFNLENBQUMsWUFBWTtvQkFDakMsV0FBVyxFQUFFLE1BQU0sQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztpQkFDeEMsQ0FBQztZQUNKLENBQUM7U0FDRjtLQUNGO0NBQ0YsQ0FBQyxDQUFDO0FBRUg7O0dBRUc7QUFDVSxRQUFBLE1BQU0sR0FBRyxJQUFJLHVCQUFhLENBQUM7SUFDdEMsS0FBSyxFQUFFLGlCQUFTO0lBQ2hCLFFBQVEsRUFBRSxvQkFBWTtDQUN2QixDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxBbGVqYW5kcm9cXEFJR2VzdGlvblxcYmFja2VuZFxcc3JjXFxncmFwaHFsXFxzY2hlbWEudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZXhlYyB9IGZyb20gJ2NoaWxkX3Byb2Nlc3MnO1xuaW1wb3J0IHtcbiAgR3JhcGhRTEZsb2F0LFxuICBHcmFwaFFMSUQsXG4gIEdyYXBoUUxJbnQsXG4gIEdyYXBoUUxMaXN0LFxuICBHcmFwaFFMTm9uTnVsbCxcbiAgR3JhcGhRTE9iamVjdFR5cGUsXG4gIEdyYXBoUUxTY2hlbWEsXG4gIEdyYXBoUUxTdHJpbmcsXG59IGZyb20gJ2dyYXBocWwnO1xuaW1wb3J0IG9zIGZyb20gJ29zJztcbmltcG9ydCB7IHByb21pc2lmeSB9IGZyb20gJ3V0aWwnO1xuXG5pbXBvcnQgeyBVc2VyIH0gZnJvbSAnLi4vbW9kZWxzL1VzZXInO1xuaW1wb3J0IHsgUHJvamVjdCB9IGZyb20gJy4uL21vZGVscy9Qcm9qZWN0JztcbmltcG9ydCB7IE1pc3Npb24gfSBmcm9tICcuLi9tb2RlbHMvTWlzc2lvbic7XG5pbXBvcnQgeyBnZXRDYWNoZSwgc2V0Q2FjaGUgfSBmcm9tICcuLi91dGlscy9yZWRpcyc7XG5pbXBvcnQgeyBjb250YWluZXIsIFRZUEVTIH0gZnJvbSAnLi4vY29uZmlnL2ludmVyc2lmeS5jb25maWcnO1xuaW1wb3J0IHsgQXV0aFNlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlcy9hdXRoLnNlcnZpY2UnO1xuXG5jb25zdCBleGVjQXN5bmMgPSBwcm9taXNpZnkoZXhlYyk7XG5cbi8qKlxuICogR3JhcGhRTCBVc2VyIFR5cGVcbiAqL1xuZXhwb3J0IGNvbnN0IFVzZXJUeXBlID0gbmV3IEdyYXBoUUxPYmplY3RUeXBlKHtcbiAgbmFtZTogJ1VzZXInLFxuICBkZXNjcmlwdGlvbjogJ1JlcHJlc2VudGEgdW4gdXN1YXJpbyBkZWwgc2lzdGVtYScsXG4gIGZpZWxkczogKCkgPT4gKHtcbiAgICBpZDoge1xuICAgICAgdHlwZTogbmV3IEdyYXBoUUxOb25OdWxsKEdyYXBoUUxJRCksXG4gICAgICBkZXNjcmlwdGlvbjogJ0lEIMO6bmljbyBkZWwgdXN1YXJpbycsXG4gICAgfSxcbiAgICBlbWFpbDoge1xuICAgICAgdHlwZTogbmV3IEdyYXBoUUxOb25OdWxsKEdyYXBoUUxTdHJpbmcpLFxuICAgICAgZGVzY3JpcHRpb246ICdFbWFpbCBkZWwgdXN1YXJpbycsXG4gICAgfSxcbiAgICBuYW1lOiB7XG4gICAgICB0eXBlOiBuZXcgR3JhcGhRTE5vbk51bGwoR3JhcGhRTFN0cmluZyksXG4gICAgICBkZXNjcmlwdGlvbjogJ05vbWJyZSBjb21wbGV0bycsXG4gICAgfSxcbiAgICBjcmVhdGVkQXQ6IHtcbiAgICAgIHR5cGU6IG5ldyBHcmFwaFFMTm9uTnVsbChHcmFwaFFMU3RyaW5nKSxcbiAgICAgIGRlc2NyaXB0aW9uOiAnVGltZXN0YW1wIGRlIGNyZWFjacOzbicsXG4gICAgfSxcbiAgICB1cGRhdGVkQXQ6IHtcbiAgICAgIHR5cGU6IG5ldyBHcmFwaFFMTm9uTnVsbChHcmFwaFFMU3RyaW5nKSxcbiAgICAgIGRlc2NyaXB0aW9uOiAnVGltZXN0YW1wIGRlIGFjdHVhbGl6YWNpw7NuJyxcbiAgICB9LFxuICAgIHJvbGU6IHtcbiAgICAgIHR5cGU6IEdyYXBoUUxTdHJpbmcsXG4gICAgICBkZXNjcmlwdGlvbjogJ1JvbCBkZWwgdXN1YXJpbycsXG4gICAgfSxcbiAgfSksXG59KTtcblxuLyoqXG4gKiBHcmFwaFFMIExvZ2luIFJlc3BvbnNlIFR5cGVcbiAqL1xuZXhwb3J0IGNvbnN0IExvZ2luUmVzcG9uc2VUeXBlID0gbmV3IEdyYXBoUUxPYmplY3RUeXBlKHtcbiAgbmFtZTogJ0xvZ2luUmVzcG9uc2UnLFxuICBkZXNjcmlwdGlvbjogJ1Jlc3B1ZXN0YSBkZSBpbmljaW8gZGUgc2VzacOzbicsXG4gIGZpZWxkczogKCkgPT4gKHtcbiAgICB1c2VyOiB7IHR5cGU6IFVzZXJUeXBlIH0sXG4gICAgdG9rZW46IHsgdHlwZTogR3JhcGhRTFN0cmluZyB9LFxuICAgIHJlZnJlc2hUb2tlbjogeyB0eXBlOiBHcmFwaFFMU3RyaW5nIH0sXG4gICAgbWZhUmVxdWlyZWQ6IHsgdHlwZTogR3JhcGhRTEZsb2F0IH0sIC8vIEJvb2xlYW4gaXMgYmV0dGVyIGJ1dCAwLzEgd29ya3Mgb3IgR3JhcGhRTEJvb2xlYW4gaWYgYXZhaWxhYmxlXG4gIH0pLFxufSk7XG5cbi8qKlxuICogR3JhcGhRTCBTeXN0ZW0gTWV0cmljcyBUeXBlXG4gKi9cbmV4cG9ydCBjb25zdCBTeXN0ZW1NZXRyaWNzVHlwZSA9IG5ldyBHcmFwaFFMT2JqZWN0VHlwZSh7XG4gIG5hbWU6ICdTeXN0ZW1NZXRyaWNzJyxcbiAgZGVzY3JpcHRpb246ICdNw6l0cmljYXMgZGUgcmVuZGltaWVudG8gZGVsIHNpc3RlbWEnLFxuICBmaWVsZHM6ICgpID0+ICh7XG4gICAgY3B1OiB7IHR5cGU6IEdyYXBoUUxGbG9hdCB9LFxuICAgIG1lbW9yeTogeyB0eXBlOiBHcmFwaFFMRmxvYXQgfSxcbiAgICBuZXR3b3JrOiB7IHR5cGU6IEdyYXBoUUxGbG9hdCB9LFxuICAgIGRpc2s6IHsgdHlwZTogR3JhcGhRTEZsb2F0IH0sXG4gICAgdXB0aW1lOiB7IHR5cGU6IEdyYXBoUUxGbG9hdCB9LFxuICAgIHBsYXRmb3JtOiB7IHR5cGU6IEdyYXBoUUxTdHJpbmcgfSxcbiAgICBob3N0bmFtZTogeyB0eXBlOiBHcmFwaFFMU3RyaW5nIH0sXG4gICAgdGltZXN0YW1wOiB7IHR5cGU6IEdyYXBoUUxGbG9hdCB9LFxuICB9KSxcbn0pO1xuXG4vKipcbiAqIEdyYXBoUUwgRG9ja2VyIENvbnRhaW5lciBUeXBlXG4gKi9cbmV4cG9ydCBjb25zdCBEb2NrZXJDb250YWluZXJUeXBlID0gbmV3IEdyYXBoUUxPYmplY3RUeXBlKHtcbiAgbmFtZTogJ0RvY2tlckNvbnRhaW5lcicsXG4gIGRlc2NyaXB0aW9uOiAnSW5mb3JtYWNpw7NuIGRlIHVuIGNvbnRlbmVkb3IgRG9ja2VyJyxcbiAgZmllbGRzOiAoKSA9PiAoe1xuICAgIElEOiB7IHR5cGU6IEdyYXBoUUxJRCB9LFxuICAgIE5hbWVzOiB7IHR5cGU6IEdyYXBoUUxTdHJpbmcgfSxcbiAgICBJbWFnZTogeyB0eXBlOiBHcmFwaFFMU3RyaW5nIH0sXG4gICAgU3RhdGU6IHsgdHlwZTogR3JhcGhRTFN0cmluZyB9LFxuICAgIFN0YXR1czogeyB0eXBlOiBHcmFwaFFMU3RyaW5nIH0sXG4gICAgUG9ydHM6IHsgdHlwZTogR3JhcGhRTFN0cmluZyB9LFxuICB9KSxcbn0pO1xuXG4vKipcbiAqIEdyYXBoUUwgR2l0IENvbW1pdCBUeXBlXG4gKi9cbmV4cG9ydCBjb25zdCBHaXRDb21taXRUeXBlID0gbmV3IEdyYXBoUUxPYmplY3RUeXBlKHtcbiAgbmFtZTogJ0dpdENvbW1pdCcsXG4gIGRlc2NyaXB0aW9uOiAnSW5mb3JtYWNpw7NuIGRlIHVuIGNvbW1pdCBkZSBHaXQnLFxuICBmaWVsZHM6ICgpID0+ICh7XG4gICAgaGFzaDogeyB0eXBlOiBHcmFwaFFMU3RyaW5nIH0sXG4gICAgYXV0aG9yOiB7IHR5cGU6IEdyYXBoUUxTdHJpbmcgfSxcbiAgICBkYXRlOiB7IHR5cGU6IEdyYXBoUUxTdHJpbmcgfSxcbiAgICBtZXNzYWdlOiB7IHR5cGU6IEdyYXBoUUxTdHJpbmcgfSxcbiAgfSksXG59KTtcblxuLyoqXG4gKiBHcmFwaFFMIEdpdCBDb250cmlidXRvciBUeXBlXG4gKi9cbmV4cG9ydCBjb25zdCBHaXRDb250cmlidXRvclR5cGUgPSBuZXcgR3JhcGhRTE9iamVjdFR5cGUoe1xuICBuYW1lOiAnR2l0Q29udHJpYnV0b3InLFxuICBkZXNjcmlwdGlvbjogJ0luZm9ybWFjacOzbiBkZSB1biBjb2xhYm9yYWRvciBkZWwgcHJveWVjdG8nLFxuICBmaWVsZHM6ICgpID0+ICh7XG4gICAgbmFtZTogeyB0eXBlOiBHcmFwaFFMU3RyaW5nIH0sXG4gICAgY29tbWl0czogeyB0eXBlOiBHcmFwaFFMSW50IH0sXG4gIH0pLFxufSk7XG5cbi8qKlxuICogR3JhcGhRTCBHaXQgU3RhdHMgVHlwZVxuICovXG5leHBvcnQgY29uc3QgR2l0U3RhdHNUeXBlID0gbmV3IEdyYXBoUUxPYmplY3RUeXBlKHtcbiAgbmFtZTogJ0dpdFN0YXRzJyxcbiAgZGVzY3JpcHRpb246ICdFc3RhZMOtc3RpY2FzIGdlbmVyYWxlcyBkZWwgcmVwb3NpdG9yaW8gR2l0JyxcbiAgZmllbGRzOiAoKSA9PiAoe1xuICAgIHRvdGFsQ29tbWl0czogeyB0eXBlOiBHcmFwaFFMSW50IH0sXG4gICAgY29udHJpYnV0b3JzOiB7IHR5cGU6IG5ldyBHcmFwaFFMTGlzdChHaXRDb250cmlidXRvclR5cGUpIH0sXG4gIH0pLFxufSk7XG5cbi8qKlxuICogR3JhcGhRTCBQcm9qZWN0IFR5cGVcbiAqL1xuZXhwb3J0IGNvbnN0IFByb2plY3RUeXBlID0gbmV3IEdyYXBoUUxPYmplY3RUeXBlKHtcbiAgbmFtZTogJ1Byb2plY3QnLFxuICBkZXNjcmlwdGlvbjogJ1JlcHJlc2VudGEgdW4gcHJveWVjdG8gZW4gZWwgc2lzdGVtYScsXG4gIGZpZWxkczogKCkgPT4gKHtcbiAgICBpZDogeyB0eXBlOiBuZXcgR3JhcGhRTE5vbk51bGwoR3JhcGhRTElEKSB9LFxuICAgIG5hbWU6IHsgdHlwZTogbmV3IEdyYXBoUUxOb25OdWxsKEdyYXBoUUxTdHJpbmcpIH0sXG4gICAgcGF0aDogeyB0eXBlOiBHcmFwaFFMU3RyaW5nIH0sXG4gICAgZGVzY3JpcHRpb246IHsgdHlwZTogR3JhcGhRTFN0cmluZyB9LFxuICAgIHN0YXR1czogeyB0eXBlOiBHcmFwaFFMU3RyaW5nIH0sXG4gICAgdHlwZTogeyB0eXBlOiBHcmFwaFFMU3RyaW5nIH0sXG4gICAgdGFnczogeyB0eXBlOiBuZXcgR3JhcGhRTExpc3QoR3JhcGhRTFN0cmluZykgfSxcbiAgICBsYXN0TW9kaWZpZWQ6IHsgdHlwZTogR3JhcGhRTFN0cmluZyB9LFxuICAgIGNyZWF0ZWRBdDogeyB0eXBlOiBHcmFwaFFMU3RyaW5nIH0sXG4gICAgdXBkYXRlZEF0OiB7IHR5cGU6IEdyYXBoUUxTdHJpbmcgfSxcbiAgfSksXG59KTtcblxuLyoqXG4gKiBHcmFwaFFMIE1pc3Npb24gVHlwZVxuICovXG5leHBvcnQgY29uc3QgTWlzc2lvblR5cGUgPSBuZXcgR3JhcGhRTE9iamVjdFR5cGUoe1xuICBuYW1lOiAnTWlzc2lvbicsXG4gIGRlc2NyaXB0aW9uOiAnUmVwcmVzZW50YSB1bmEgbWlzacOzbiBvIHRhcmVhIGF1dMOzbm9tYScsXG4gIGZpZWxkczogKCkgPT4gKHtcbiAgICBpZDogeyB0eXBlOiBuZXcgR3JhcGhRTE5vbk51bGwoR3JhcGhRTElEKSB9LFxuICAgIG9iamVjdGl2ZTogeyB0eXBlOiBuZXcgR3JhcGhRTE5vbk51bGwoR3JhcGhRTFN0cmluZykgfSxcbiAgICB1c2VySWQ6IHsgdHlwZTogR3JhcGhRTFN0cmluZyB9LFxuICAgIHN0YXR1czogeyB0eXBlOiBHcmFwaFFMU3RyaW5nIH0sXG4gICAgcGxhbjogeyB0eXBlOiBHcmFwaFFMU3RyaW5nIH0sXG4gICAgcmVzdWx0OiB7IHR5cGU6IEdyYXBoUUxTdHJpbmcgfSxcbiAgICBlcnJvcjogeyB0eXBlOiBHcmFwaFFMU3RyaW5nIH0sXG4gICAgc3RhcnRlZEF0OiB7IHR5cGU6IEdyYXBoUUxTdHJpbmcgfSxcbiAgICBjb21wbGV0ZWRBdDogeyB0eXBlOiBHcmFwaFFMU3RyaW5nIH0sXG4gICAgY3JlYXRlZEF0OiB7IHR5cGU6IEdyYXBoUUxTdHJpbmcgfSxcbiAgICB1cGRhdGVkQXQ6IHsgdHlwZTogR3JhcGhRTFN0cmluZyB9LFxuICB9KSxcbn0pO1xuXG4vKipcbiAqIEdyYXBoUUwgUm9vdCBRdWVyeVxuICovXG5leHBvcnQgY29uc3QgUm9vdFF1ZXJ5ID0gbmV3IEdyYXBoUUxPYmplY3RUeXBlKHtcbiAgbmFtZTogJ1F1ZXJ5JyxcbiAgZGVzY3JpcHRpb246ICdRdWVyaWVzIHJhw616IGRpc3BvbmlibGVzJyxcbiAgZmllbGRzOiB7XG4gICAgdXNlcjoge1xuICAgICAgdHlwZTogVXNlclR5cGUsXG4gICAgICBhcmdzOiB7XG4gICAgICAgIGlkOiB7IHR5cGU6IG5ldyBHcmFwaFFMTm9uTnVsbChHcmFwaFFMSUQpIH0sXG4gICAgICB9LFxuICAgICAgcmVzb2x2ZTogYXN5bmMgKF9vYmosIGFyZ3MsIGNvbnRleHQpID0+IHtcbiAgICAgICAgLy8gUmVzb2x2ZXIgaW1wbGVtZW50YXRpb24gLSBjb25lY3RhciBhIERCXG4gICAgICAgIHJldHVybiBjb250ZXh0LmRhdGFsb2FkZXJzLnVzZXJMb2FkZXIubG9hZChhcmdzLmlkKTtcbiAgICAgIH0sXG4gICAgfSxcbiAgICB1c2Vyczoge1xuICAgICAgdHlwZTogbmV3IEdyYXBoUUxOb25OdWxsKG5ldyBHcmFwaFFMTGlzdChVc2VyVHlwZSkpLFxuICAgICAgYXJnczoge1xuICAgICAgICBsaW1pdDogeyB0eXBlOiBHcmFwaFFMU3RyaW5nLCBkZWZhdWx0VmFsdWU6ICcxMCcgfSxcbiAgICAgICAgb2Zmc2V0OiB7IHR5cGU6IEdyYXBoUUxTdHJpbmcsIGRlZmF1bHRWYWx1ZTogJzAnIH0sXG4gICAgICB9LFxuICAgICAgcmVzb2x2ZTogYXN5bmMgKF9vYmosIGFyZ3MpID0+IHtcbiAgICAgICAgY29uc3QgbGltaXQgPSBwYXJzZUludChhcmdzLmxpbWl0KSB8fCAxMDtcbiAgICAgICAgY29uc3Qgb2Zmc2V0ID0gcGFyc2VJbnQoYXJncy5vZmZzZXQpIHx8IDA7XG4gICAgICAgIHJldHVybiBVc2VyLmZpbmQoKS5za2lwKG9mZnNldCkubGltaXQobGltaXQpO1xuICAgICAgfSxcbiAgICB9LFxuICAgIGNoYXQ6IHtcbiAgICAgIHR5cGU6IEdyYXBoUUxTdHJpbmcsXG4gICAgICBhcmdzOiB7XG4gICAgICAgIG1lc3NhZ2U6IHsgdHlwZTogbmV3IEdyYXBoUUxOb25OdWxsKEdyYXBoUUxTdHJpbmcpIH0sXG4gICAgICB9LFxuICAgICAgcmVzb2x2ZTogYXN5bmMgKF9vYmosIGFyZ3MpID0+IHtcbiAgICAgICAgcmV0dXJuICdUaGlzIGlzIGEgbW9jayBBSSByZXNwb25zZSc7XG4gICAgICB9LFxuICAgIH0sXG4gICAgc3lzdGVtTWV0cmljczoge1xuICAgICAgdHlwZTogU3lzdGVtTWV0cmljc1R5cGUsXG4gICAgICByZXNvbHZlOiBhc3luYyAoKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgY2FjaGVLZXkgPSAnc3lzdGVtOm1ldHJpY3MnO1xuICAgICAgICAgIGNvbnN0IGNhY2hlZERhdGEgPSBhd2FpdCBnZXRDYWNoZShjYWNoZUtleSk7XG5cbiAgICAgICAgICBpZiAoY2FjaGVkRGF0YSkge1xuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZERhdGE7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29uc3QgY3B1cyA9IG9zLmNwdXMoKTtcbiAgICAgICAgICBjb25zdCB0b3RhbE1lbSA9IG9zLnRvdGFsbWVtKCk7XG4gICAgICAgICAgY29uc3QgZnJlZU1lbSA9IG9zLmZyZWVtZW0oKTtcbiAgICAgICAgICBjb25zdCB1c2VkTWVtID0gdG90YWxNZW0gLSBmcmVlTWVtO1xuXG4gICAgICAgICAgY29uc3QgY3B1VXNhZ2UgPVxuICAgICAgICAgICAgY3B1cy5yZWR1Y2UoKGFjYywgY3B1KSA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IHRvdGFsID0gT2JqZWN0LnZhbHVlcyhjcHUudGltZXMpLnJlZHVjZSgoYSwgYikgPT4gYSArIGIsIDApO1xuICAgICAgICAgICAgICBjb25zdCBpZGxlID0gY3B1LnRpbWVzLmlkbGU7XG4gICAgICAgICAgICAgIHJldHVybiBhY2MgKyAoKHRvdGFsIC0gaWRsZSkgLyB0b3RhbCkgKiAxMDA7XG4gICAgICAgICAgICB9LCAwKSAvIGNwdXMubGVuZ3RoO1xuXG4gICAgICAgICAgY29uc3QgbWV0cmljcyA9IHtcbiAgICAgICAgICAgIGNwdTogcGFyc2VGbG9hdChjcHVVc2FnZS50b0ZpeGVkKDIpKSxcbiAgICAgICAgICAgIG1lbW9yeTogcGFyc2VGbG9hdCgoKHVzZWRNZW0gLyB0b3RhbE1lbSkgKiAxMDApLnRvRml4ZWQoMikpLFxuICAgICAgICAgICAgbmV0d29yazogTWF0aC5yYW5kb20oKSAqIDEwMCwgLy8gUGxhY2Vob2xkZXJcbiAgICAgICAgICAgIGRpc2s6IDAsIC8vIFBsYWNlaG9sZGVyXG4gICAgICAgICAgICB1cHRpbWU6IG9zLnVwdGltZSgpLFxuICAgICAgICAgICAgcGxhdGZvcm06IG9zLnBsYXRmb3JtKCksXG4gICAgICAgICAgICBob3N0bmFtZTogb3MuaG9zdG5hbWUoKSxcbiAgICAgICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgYXdhaXQgc2V0Q2FjaGUoY2FjaGVLZXksIEpTT04uc3RyaW5naWZ5KG1ldHJpY3MpLCAyKTtcbiAgICAgICAgICByZXR1cm4gbWV0cmljcztcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdHcmFwaFFMIFN5c3RlbU1ldHJpY3MgRXJyb3I6JywgZXJyb3IpO1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGZldGNoIHN5c3RlbSBtZXRyaWNzJyk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgfSxcbiAgICBjb250YWluZXJzOiB7XG4gICAgICB0eXBlOiBuZXcgR3JhcGhRTE5vbk51bGwobmV3IEdyYXBoUUxMaXN0KG5ldyBHcmFwaFFMTm9uTnVsbChEb2NrZXJDb250YWluZXJUeXBlKSkpLFxuICAgICAgcmVzb2x2ZTogYXN5bmMgKCkgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IGNhY2hlS2V5ID0gJ2RvY2tlcjpjb250YWluZXJzJztcbiAgICAgICAgICBjb25zdCBjYWNoZWREYXRhID0gYXdhaXQgZ2V0Q2FjaGUoY2FjaGVLZXkpO1xuXG4gICAgICAgICAgaWYgKGNhY2hlZERhdGEpIHtcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWREYXRhO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnN0IHsgc3Rkb3V0IH0gPSBhd2FpdCBleGVjQXN5bmMoJ2RvY2tlciBwcyAtYSAtLWZvcm1hdCBcInt7anNvbiAufX1cIicpO1xuICAgICAgICAgIGNvbnN0IGNvbnRhaW5lcnMgPSBzdGRvdXRcbiAgICAgICAgICAgIC50cmltKClcbiAgICAgICAgICAgIC5zcGxpdCgnXFxuJylcbiAgICAgICAgICAgIC5maWx0ZXIobGluZSA9PiBsaW5lKVxuICAgICAgICAgICAgLm1hcChsaW5lID0+IHtcbiAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShsaW5lKTtcbiAgICAgICAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuZmlsdGVyKEJvb2xlYW4pO1xuXG4gICAgICAgICAgYXdhaXQgc2V0Q2FjaGUoY2FjaGVLZXksIEpTT04uc3RyaW5naWZ5KGNvbnRhaW5lcnMpLCA1KTtcbiAgICAgICAgICByZXR1cm4gY29udGFpbmVycztcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdHcmFwaFFMIERvY2tlckNvbnRhaW5lcnMgRXJyb3I6JywgZXJyb3IpO1xuICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICB9LFxuICAgIHJlY2VudENvbW1pdHM6IHtcbiAgICAgIHR5cGU6IG5ldyBHcmFwaFFMTm9uTnVsbChuZXcgR3JhcGhRTExpc3QobmV3IEdyYXBoUUxOb25OdWxsKEdpdENvbW1pdFR5cGUpKSksXG4gICAgICBhcmdzOiB7XG4gICAgICAgIGxpbWl0OiB7IHR5cGU6IEdyYXBoUUxJbnQsIGRlZmF1bHRWYWx1ZTogMTAgfSxcbiAgICAgIH0sXG4gICAgICByZXNvbHZlOiBhc3luYyAoX29iaiwgYXJncykgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IHsgc3Rkb3V0IH0gPSBhd2FpdCBleGVjQXN5bmMoXG4gICAgICAgICAgICBgZ2l0IGxvZyAtJHthcmdzLmxpbWl0fSAtLXByZXR0eT1mb3JtYXQ6XCIlSHwlYW58JWFpfCVzXCJgLFxuICAgICAgICAgICk7XG5cbiAgICAgICAgICByZXR1cm4gc3Rkb3V0XG4gICAgICAgICAgICAudHJpbSgpXG4gICAgICAgICAgICAuc3BsaXQoJ1xcbicpXG4gICAgICAgICAgICAuZmlsdGVyKGxpbmUgPT4gbGluZSlcbiAgICAgICAgICAgIC5tYXAobGluZSA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IFtoYXNoLCBhdXRob3IsIGRhdGUsIG1lc3NhZ2VdID0gbGluZS5zcGxpdCgnfCcpO1xuICAgICAgICAgICAgICByZXR1cm4geyBoYXNoLCBhdXRob3IsIGRhdGUsIG1lc3NhZ2UgfTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcignR3JhcGhRTCByZWNlbnRDb21taXRzIEVycm9yOicsIGVycm9yKTtcbiAgICAgICAgICBpZiAoZXJyb3IubWVzc2FnZT8uaW5jbHVkZXMoJ25vdCBhIGdpdCByZXBvc2l0b3J5JykpIHtcbiAgICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBoYXNoOiAnZGVtbycsXG4gICAgICAgICAgICAgICAgYXV0aG9yOiAnRGV2JyxcbiAgICAgICAgICAgICAgICBkYXRlOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogJ0RlbW8gY29tbWl0JyxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF07XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICB9LFxuICAgIGdpdEJyYW5jaGVzOiB7XG4gICAgICB0eXBlOiBuZXcgR3JhcGhRTE5vbk51bGwobmV3IEdyYXBoUUxMaXN0KG5ldyBHcmFwaFFMTm9uTnVsbChHcmFwaFFMU3RyaW5nKSkpLFxuICAgICAgcmVzb2x2ZTogYXN5bmMgKCkgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IHsgc3Rkb3V0IH0gPSBhd2FpdCBleGVjQXN5bmMoJ2dpdCBicmFuY2ggLWEnKTtcbiAgICAgICAgICByZXR1cm4gc3Rkb3V0XG4gICAgICAgICAgICAudHJpbSgpXG4gICAgICAgICAgICAuc3BsaXQoJ1xcbicpXG4gICAgICAgICAgICAubWFwKGJyYW5jaCA9PiBicmFuY2gudHJpbSgpLnJlcGxhY2UoJyogJywgJycpKVxuICAgICAgICAgICAgLmZpbHRlcihicmFuY2ggPT4gYnJhbmNoKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdHcmFwaFFMIGdpdEJyYW5jaGVzIEVycm9yOicsIGVycm9yKTtcbiAgICAgICAgICByZXR1cm4gWydtYWluJ107XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgfSxcbiAgICBnaXRTdGF0czoge1xuICAgICAgdHlwZTogR2l0U3RhdHNUeXBlLFxuICAgICAgcmVzb2x2ZTogYXN5bmMgKCkgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IHsgc3Rkb3V0OiBjb21taXRDb3VudCB9ID0gYXdhaXQgZXhlY0FzeW5jKCdnaXQgcmV2LWxpc3QgLS1jb3VudCBIRUFEJyk7XG4gICAgICAgICAgY29uc3QgeyBzdGRvdXQ6IGNvbnRyaWJ1dG9yc1JhdyB9ID0gYXdhaXQgZXhlY0FzeW5jKCdnaXQgc2hvcnRsb2cgLXNuIEhFQUQnKTtcblxuICAgICAgICAgIGNvbnN0IGNvbnRyaWJ1dG9ycyA9IGNvbnRyaWJ1dG9yc1Jhd1xuICAgICAgICAgICAgLnRyaW0oKVxuICAgICAgICAgICAgLnNwbGl0KCdcXG4nKVxuICAgICAgICAgICAgLm1hcChsaW5lID0+IHtcbiAgICAgICAgICAgICAgY29uc3QgW2NvbW1pdHMsIC4uLm5hbWVQYXJ0c10gPSBsaW5lLnRyaW0oKS5zcGxpdCgvXFxzKy8pO1xuICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIG5hbWU6IG5hbWVQYXJ0cy5qb2luKCcgJyksXG4gICAgICAgICAgICAgICAgY29tbWl0czogcGFyc2VJbnQoY29tbWl0cyksXG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0b3RhbENvbW1pdHM6IHBhcnNlSW50KGNvbW1pdENvdW50LnRyaW0oKSksXG4gICAgICAgICAgICBjb250cmlidXRvcnMsXG4gICAgICAgICAgfTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdHcmFwaFFMIGdpdFN0YXRzIEVycm9yOicsIGVycm9yKTtcbiAgICAgICAgICByZXR1cm4geyB0b3RhbENvbW1pdHM6IDAsIGNvbnRyaWJ1dG9yczogW10gfTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICB9LFxuICAgIHByb2plY3RzOiB7XG4gICAgICB0eXBlOiBuZXcgR3JhcGhRTE5vbk51bGwobmV3IEdyYXBoUUxMaXN0KG5ldyBHcmFwaFFMTm9uTnVsbChQcm9qZWN0VHlwZSkpKSxcbiAgICAgIGFyZ3M6IHtcbiAgICAgICAgc3RhdHVzOiB7IHR5cGU6IEdyYXBoUUxTdHJpbmcgfSxcbiAgICAgICAgdHlwZTogeyB0eXBlOiBHcmFwaFFMU3RyaW5nIH0sXG4gICAgICAgIHRhZ3M6IHsgdHlwZTogbmV3IEdyYXBoUUxMaXN0KEdyYXBoUUxTdHJpbmcpIH0sXG4gICAgICAgIHNlYXJjaDogeyB0eXBlOiBHcmFwaFFMU3RyaW5nIH0sXG4gICAgICAgIGxpbWl0OiB7IHR5cGU6IEdyYXBoUUxJbnQsIGRlZmF1bHRWYWx1ZTogMjAgfSxcbiAgICAgICAgb2Zmc2V0OiB7IHR5cGU6IEdyYXBoUUxJbnQsIGRlZmF1bHRWYWx1ZTogMCB9LFxuICAgICAgfSxcbiAgICAgIHJlc29sdmU6IGFzeW5jIChfb2JqLCBhcmdzKSA9PiB7XG4gICAgICAgIGNvbnN0IHF1ZXJ5OiBhbnkgPSB7fTtcbiAgICAgICAgaWYgKGFyZ3Muc3RhdHVzKSBxdWVyeS5zdGF0dXMgPSBhcmdzLnN0YXR1cztcbiAgICAgICAgaWYgKGFyZ3MudHlwZSkgcXVlcnkudHlwZSA9IGFyZ3MudHlwZTtcbiAgICAgICAgaWYgKGFyZ3MudGFncyAmJiBhcmdzLnRhZ3MubGVuZ3RoID4gMCkgcXVlcnkudGFncyA9IHsgJGluOiBhcmdzLnRhZ3MgfTtcbiAgICAgICAgaWYgKGFyZ3Muc2VhcmNoKSBxdWVyeS4kdGV4dCA9IHsgJHNlYXJjaDogYXJncy5zZWFyY2ggfTtcblxuICAgICAgICByZXR1cm4gUHJvamVjdC5maW5kKHF1ZXJ5KVxuICAgICAgICAgIC5zb3J0KGFyZ3Muc2VhcmNoID8geyBzY29yZTogeyAkbWV0YTogJ3RleHRTY29yZScgfSB9IDogeyB1cGRhdGVkQXQ6IC0xIH0pXG4gICAgICAgICAgLnNraXAoYXJncy5vZmZzZXQpXG4gICAgICAgICAgLmxpbWl0KGFyZ3MubGltaXQpO1xuICAgICAgfSxcbiAgICB9LFxuICAgIHNlYXJjaFByb2plY3RzOiB7XG4gICAgICB0eXBlOiBuZXcgR3JhcGhRTE5vbk51bGwobmV3IEdyYXBoUUxMaXN0KG5ldyBHcmFwaFFMTm9uTnVsbChQcm9qZWN0VHlwZSkpKSxcbiAgICAgIGFyZ3M6IHtcbiAgICAgICAgcXVlcnk6IHsgdHlwZTogbmV3IEdyYXBoUUxOb25OdWxsKEdyYXBoUUxTdHJpbmcpIH0sXG4gICAgICAgIGxpbWl0OiB7IHR5cGU6IEdyYXBoUUxJbnQsIGRlZmF1bHRWYWx1ZTogMTAgfSxcbiAgICAgIH0sXG4gICAgICByZXNvbHZlOiBhc3luYyAoX29iaiwgYXJncykgPT4ge1xuICAgICAgICByZXR1cm4gUHJvamVjdC5maW5kKHsgJHRleHQ6IHsgJHNlYXJjaDogYXJncy5xdWVyeSB9IH0pXG4gICAgICAgICAgLnNvcnQoeyBzY29yZTogeyAkbWV0YTogJ3RleHRTY29yZScgfSB9KVxuICAgICAgICAgIC5saW1pdChhcmdzLmxpbWl0KTtcbiAgICAgIH0sXG4gICAgfSxcbiAgICBtaXNzaW9uczoge1xuICAgICAgdHlwZTogbmV3IEdyYXBoUUxOb25OdWxsKG5ldyBHcmFwaFFMTGlzdChuZXcgR3JhcGhRTE5vbk51bGwoTWlzc2lvblR5cGUpKSksXG4gICAgICBhcmdzOiB7XG4gICAgICAgIHN0YXR1czogeyB0eXBlOiBHcmFwaFFMU3RyaW5nIH0sXG4gICAgICAgIHVzZXJJZDogeyB0eXBlOiBHcmFwaFFMU3RyaW5nIH0sXG4gICAgICAgIGxpbWl0OiB7IHR5cGU6IEdyYXBoUUxJbnQsIGRlZmF1bHRWYWx1ZTogMjAgfSxcbiAgICAgICAgb2Zmc2V0OiB7IHR5cGU6IEdyYXBoUUxJbnQsIGRlZmF1bHRWYWx1ZTogMCB9LFxuICAgICAgfSxcbiAgICAgIHJlc29sdmU6IGFzeW5jIChfb2JqLCBhcmdzKSA9PiB7XG4gICAgICAgIGNvbnN0IHF1ZXJ5OiBhbnkgPSB7fTtcbiAgICAgICAgaWYgKGFyZ3Muc3RhdHVzKSBxdWVyeS5zdGF0dXMgPSBhcmdzLnN0YXR1cztcbiAgICAgICAgaWYgKGFyZ3MudXNlcklkKSBxdWVyeS51c2VySWQgPSBhcmdzLnVzZXJJZDtcbiAgICAgICAgcmV0dXJuIE1pc3Npb24uZmluZChxdWVyeSkuc29ydCh7IGNyZWF0ZWRBdDogLTEgfSkuc2tpcChhcmdzLm9mZnNldCkubGltaXQoYXJncy5saW1pdCk7XG4gICAgICB9LFxuICAgIH0sXG4gIH0sXG59KTtcblxuLyoqXG4gKiBHcmFwaFFMIE11dGF0aW9uc1xuICovXG5leHBvcnQgY29uc3QgUm9vdE11dGF0aW9uID0gbmV3IEdyYXBoUUxPYmplY3RUeXBlKHtcbiAgbmFtZTogJ011dGF0aW9uJyxcbiAgZGVzY3JpcHRpb246ICdNdXRhY2lvbmVzIGRpc3BvbmlibGVzJyxcbiAgZmllbGRzOiB7XG4gICAgY3JlYXRlVXNlcjoge1xuICAgICAgdHlwZTogVXNlclR5cGUsXG4gICAgICBhcmdzOiB7XG4gICAgICAgIGVtYWlsOiB7IHR5cGU6IG5ldyBHcmFwaFFMTm9uTnVsbChHcmFwaFFMU3RyaW5nKSB9LFxuICAgICAgICBuYW1lOiB7IHR5cGU6IG5ldyBHcmFwaFFMTm9uTnVsbChHcmFwaFFMU3RyaW5nKSB9LFxuICAgICAgfSxcbiAgICAgIHJlc29sdmU6IGFzeW5jIChfb2JqLCBhcmdzKSA9PiB7XG4gICAgICAgIHJldHVybiBVc2VyLmNyZWF0ZSh7XG4gICAgICAgICAgZW1haWw6IGFyZ3MuZW1haWwsXG4gICAgICAgICAgbmFtZTogYXJncy5uYW1lLFxuICAgICAgICAgIHBhc3N3b3JkOiAnQUlHZXN0aW9uMTIzIScsIC8vIERlZmF1bHQgcGFzc3dvcmQgZm9yIG5vd1xuICAgICAgICAgIGxvZ2luQXR0ZW1wdHM6IDAsXG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICB9LFxuICAgIGxvZ2luOiB7XG4gICAgICB0eXBlOiBMb2dpblJlc3BvbnNlVHlwZSxcbiAgICAgIGFyZ3M6IHtcbiAgICAgICAgZW1haWw6IHsgdHlwZTogbmV3IEdyYXBoUUxOb25OdWxsKEdyYXBoUUxTdHJpbmcpIH0sXG4gICAgICAgIHBhc3N3b3JkOiB7IHR5cGU6IG5ldyBHcmFwaFFMTm9uTnVsbChHcmFwaFFMU3RyaW5nKSB9LFxuICAgICAgfSxcbiAgICAgIHJlc29sdmU6IGFzeW5jIChfb2JqLCBhcmdzKSA9PiB7XG4gICAgICAgIGNvbnN0IGF1dGhTZXJ2aWNlID0gY29udGFpbmVyLmdldDxBdXRoU2VydmljZT4oVFlQRVMuQXV0aFNlcnZpY2UpO1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBhdXRoU2VydmljZS5sb2dpbih7XG4gICAgICAgICAgZW1haWw6IGFyZ3MuZW1haWwsXG4gICAgICAgICAgcGFzc3dvcmQ6IGFyZ3MucGFzc3dvcmQsXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHVzZXI6IHJlc3VsdC51c2VyLFxuICAgICAgICAgIHRva2VuOiByZXN1bHQudG9rZW4sXG4gICAgICAgICAgcmVmcmVzaFRva2VuOiByZXN1bHQucmVmcmVzaFRva2VuLFxuICAgICAgICAgIG1mYVJlcXVpcmVkOiByZXN1bHQubWZhUmVxdWlyZWQgPyAxIDogMCxcbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgfSxcbiAgfSxcbn0pO1xuXG4vKipcbiAqIEdyYXBoUUwgU2NoZW1hXG4gKi9cbmV4cG9ydCBjb25zdCBzY2hlbWEgPSBuZXcgR3JhcGhRTFNjaGVtYSh7XG4gIHF1ZXJ5OiBSb290UXVlcnksXG4gIG11dGF0aW9uOiBSb290TXV0YXRpb24sXG59KTtcbiJdLCJ2ZXJzaW9uIjozfQ==