7dee1a07f27c33f7418048e64524cd47
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.HistoryService = void 0;
const inversify_1 = require("inversify");
const metric_snapshot_model_1 = require("../models/metric-snapshot.model");
let HistoryService = class HistoryService {
    /**
     * Persiste una nueva instantánea.
     */
    async pushSnapshot(data) {
        const snapshot = await metric_snapshot_model_1.MetricSnapshot.create(data);
        return snapshot;
    }
    /**
     * Obtiene el historial de una métrica concreta.
     */
    async getHistory(metric) {
        return metric_snapshot_model_1.MetricSnapshot.find({ metric })
            .sort({ timestamp: -1 })
            .lean();
    }
};
exports.HistoryService = HistoryService;
exports.HistoryService = HistoryService = __decorate([
    (0, inversify_1.injectable)()
], HistoryService);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxBbGVqYW5kcm9cXEFJR2VzdGlvblxcYmFja2VuZFxcc3JjXFxzZXJ2aWNlc1xcaGlzdG9yeS5zZXJ2aWNlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBLHlDQUF1QztBQUV2QywyRUFBa0Y7QUFHM0UsSUFBTSxjQUFjLEdBQXBCLE1BQU0sY0FBYztJQUN6Qjs7T0FFRztJQUNILEtBQUssQ0FBQyxZQUFZLENBQUMsSUFBOEI7UUFDL0MsTUFBTSxRQUFRLEdBQUcsTUFBTSxzQ0FBYyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNuRCxPQUFPLFFBQVEsQ0FBQztJQUNsQixDQUFDO0lBRUQ7O09BRUc7SUFDSCxLQUFLLENBQUMsVUFBVSxDQUFDLE1BQWM7UUFDN0IsT0FBTyxzQ0FBYyxDQUFDLElBQUksQ0FBQyxFQUFFLE1BQU0sRUFBRSxDQUFDO2FBQ25DLElBQUksQ0FBQyxFQUFFLFNBQVMsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDO2FBQ3ZCLElBQUksRUFBa0MsQ0FBQztJQUM1QyxDQUFDO0NBQ0YsQ0FBQTtBQWpCWSx3Q0FBYzt5QkFBZCxjQUFjO0lBRDFCLElBQUEsc0JBQVUsR0FBRTtHQUNBLGNBQWMsQ0FpQjFCIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcQWxlamFuZHJvXFxBSUdlc3Rpb25cXGJhY2tlbmRcXHNyY1xcc2VydmljZXNcXGhpc3Rvcnkuc2VydmljZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBpbmplY3RhYmxlIH0gZnJvbSAnaW52ZXJzaWZ5JztcblxuaW1wb3J0IHsgSU1ldHJpY1NuYXBzaG90LCBNZXRyaWNTbmFwc2hvdCB9IGZyb20gJy4uL21vZGVscy9tZXRyaWMtc25hcHNob3QubW9kZWwnO1xuXG5AaW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgSGlzdG9yeVNlcnZpY2Uge1xuICAvKipcbiAgICogUGVyc2lzdGUgdW5hIG51ZXZhIGluc3RhbnTDoW5lYS5cbiAgICovXG4gIGFzeW5jIHB1c2hTbmFwc2hvdChkYXRhOiBQYXJ0aWFsPElNZXRyaWNTbmFwc2hvdD4pOiBQcm9taXNlPElNZXRyaWNTbmFwc2hvdD4ge1xuICAgIGNvbnN0IHNuYXBzaG90ID0gYXdhaXQgTWV0cmljU25hcHNob3QuY3JlYXRlKGRhdGEpO1xuICAgIHJldHVybiBzbmFwc2hvdDtcbiAgfVxuXG4gIC8qKlxuICAgKiBPYnRpZW5lIGVsIGhpc3RvcmlhbCBkZSB1bmEgbcOpdHJpY2EgY29uY3JldGEuXG4gICAqL1xuICBhc3luYyBnZXRIaXN0b3J5KG1ldHJpYzogc3RyaW5nKTogUHJvbWlzZTxJTWV0cmljU25hcHNob3RbXT4ge1xuICAgIHJldHVybiBNZXRyaWNTbmFwc2hvdC5maW5kKHsgbWV0cmljIH0pXG4gICAgICAuc29ydCh7IHRpbWVzdGFtcDogLTEgfSlcbiAgICAgIC5sZWFuKCkgYXMgdW5rbm93biBhcyBJTWV0cmljU25hcHNob3RbXTtcbiAgfVxufVxuIl0sInZlcnNpb24iOjN9