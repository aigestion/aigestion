f00896c31ddd37a7fca0ac0829dd3a55
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.SecurityDashboardService = void 0;
const inversify_1 = require("inversify");
const redis_1 = require("../cache/redis");
const logger_1 = require("../utils/logger");
const centralized_logging_service_1 = require("./centralized-logging.service");
const inversify_config_1 = require("../config/inversify.config");
const health_service_1 = require("./health.service");
const user_behavior_service_1 = require("./user-behavior.service");
let SecurityDashboardService = class SecurityDashboardService {
    redis;
    wafService;
    malwareScanner;
    twoFactorService;
    threatIntelService;
    behaviorService;
    loggingService;
    monitoringService;
    backupService;
    constructor() {
        this.redis = (0, redis_1.getRedisClient)();
        // Initialize services via container to ensure singleton usage
        this.wafService = inversify_config_1.container.get(inversify_config_1.TYPES.WAFService);
        this.malwareScanner = inversify_config_1.container.get(inversify_config_1.TYPES.MalwareScannerService);
        this.twoFactorService = inversify_config_1.container.get(inversify_config_1.TYPES.TwoFactorService);
        this.threatIntelService = inversify_config_1.container.get(inversify_config_1.TYPES.ThreatIntelligenceService);
        this.behaviorService = inversify_config_1.container.get(user_behavior_service_1.UserBehaviorService);
        this.loggingService = inversify_config_1.container.get(centralized_logging_service_1.CENTRAL_LOGGING_SERVICE_NAME);
        this.monitoringService = inversify_config_1.container.get(inversify_config_1.TYPES.MonitoringService);
        this.backupService = inversify_config_1.container.get(inversify_config_1.TYPES.BackupRestoreService);
    }
    /**
     * Get complete security dashboard data
     */
    async getDashboardData() {
        try {
            const [overview, waf, malware, twoFactor, threatIntel, behavior, logs, monitoring] = await Promise.all([
                this.getOverviewData(),
                this.getWAFData(),
                this.getMalwareData(),
                this.getTwoFactorData(),
                this.getThreatIntelData(),
                this.getBehaviorData(),
                this.getLogData(),
                this.getMonitoringData(),
            ]);
            const backupData = await this.backupService.getStats();
            return {
                overview,
                waf,
                malware,
                twoFactor,
                threatIntel,
                behavior,
                logs,
                monitoring,
                backup: {
                    stats: backupData,
                    recentJobs: backupData.recentBackups,
                },
            };
        }
        catch (error) {
            logger_1.logger.error('Failed to get dashboard data:', error);
            return this.getDefaultDashboardData();
        }
    }
    /**
     * Get overview data integrated with HealthService
     */
    async getOverviewData() {
        try {
            const healthService = inversify_config_1.container.get(health_service_1.HealthService);
            const health = await healthService.getDetailedHealth();
            const behaviorStats = await this.behaviorService.getStats();
            const threatAlerts = await this.threatIntelService.getRecentAlerts(50);
            const criticalThreats = threatAlerts.filter(alert => alert.severity === 'critical').length;
            let systemHealth = 'healthy';
            if (health.status === 'degraded' || behaviorStats.highRiskUsers > 5 || criticalThreats > 3) {
                systemHealth = 'critical';
            }
            else if (behaviorStats.highRiskUsers > 0 || criticalThreats > 0) {
                systemHealth = 'warning';
            }
            return {
                systemHealth,
                totalAlerts: behaviorStats.totalAnomalies + threatAlerts.length,
                criticalAlerts: criticalThreats,
                activeThreats: threatAlerts.length,
                lastScan: new Date(),
            };
        }
        catch (error) {
            logger_1.logger.error('Failed to get overview data:', error);
            return {
                systemHealth: 'healthy',
                totalAlerts: 0,
                criticalAlerts: 0,
                activeThreats: 0,
                lastScan: new Date(),
            };
        }
    }
    /**
     * Get WAF data
     */
    async getWAFData() {
        try {
            const stats = this.wafService.getMetrics();
            const recentAlerts = await this.threatIntelService.getRecentAlerts(50);
            const recentBlocks = recentAlerts.filter(alert => alert.action === 'block').length;
            const topAttacks = Object.entries(stats.topAttacks)
                .map(([_, attack]) => ({
                rule: attack.rule,
                count: attack.count,
                severity: this.getRuleSeverity(attack.rule),
            }))
                .sort((a, b) => b.count - a.count)
                .slice(0, 10);
            return {
                stats,
                recentBlocks,
                topAttacks,
                blockedIPs: [], // Would get from recent WAF blocks
            };
        }
        catch (error) {
            logger_1.logger.error('Failed to get WAF data:', error);
            return {
                stats: { totalRequests: 0, blockedRequests: 0, warnings: 0, rulesTriggered: {} },
                recentBlocks: 0,
                topAttacks: [],
                blockedIPs: [],
            };
        }
    }
    /**
     * Get malware data
     */
    async getMalwareData() {
        try {
            const stats = this.malwareScanner.getScanStats();
            const quarantinedFiles = await this.malwareScanner.getQuarantinedFiles();
            const recentDetections = quarantinedFiles
                .sort((a, b) => b.quarantinedAt.getTime() - a.quarantinedAt.getTime())
                .slice(0, 10)
                .map(file => ({
                file: file.originalPath,
                threat: file.threat,
                timestamp: file.quarantinedAt,
            }));
            return {
                stats,
                quarantinedFiles: quarantinedFiles.length,
                recentDetections,
            };
        }
        catch (error) {
            logger_1.logger.error('Failed to get malware data:', error);
            return {
                stats: { totalScans: 0, infectedFiles: 0, quarantinedFiles: 0, averageScanTime: 0 },
                quarantinedFiles: 0,
                recentDetections: [],
            };
        }
    }
    /**
     * Get 2FA data
     */
    async getTwoFactorData() {
        try {
            const stats = await this.twoFactorService.getStats();
            return {
                stats,
                enabledUsers: stats.enabledUsers,
                recentVerifications: stats.recentVerifications,
            };
        }
        catch (error) {
            logger_1.logger.error('Failed to get 2FA data:', error);
            return {
                stats: { totalUsers: 0, enabledUsers: 0, methodDistribution: {}, recentVerifications: 0 },
                enabledUsers: 0,
                recentVerifications: 0,
            };
        }
    }
    /**
     * Get threat intelligence data
     */
    async getThreatIntelData() {
        try {
            const stats = await this.threatIntelService.getStats();
            const recentAlerts = await this.threatIntelService.getRecentAlerts(50);
            return {
                stats,
                recentAlerts: recentAlerts.map(alert => ({
                    type: alert.type,
                    severity: alert.severity,
                    indicator: alert.indicator,
                    timestamp: alert.timestamp,
                })),
            };
        }
        catch (error) {
            logger_1.logger.error('Failed to get threat intel data:', error);
            return {
                stats: {
                    totalFeeds: 0,
                    activeFeeds: 0,
                    totalAlerts: 0,
                    alertsBySeverity: {},
                    alertsByType: {},
                    recentAlerts: 0,
                },
                recentAlerts: [],
            };
        }
    }
    /**
     * Get behavior analysis data
     */
    async getBehaviorData() {
        try {
            const stats = await this.behaviorService.getStats();
            const recentAnomalies = await this.behaviorService.getRecentAnomalies(50);
            return {
                stats,
                highRiskUsers: stats.highRiskUsers,
                recentAnomalies: recentAnomalies.map(anomaly => ({
                    userId: anomaly.userId,
                    type: anomaly.type,
                    severity: anomaly.severity,
                    timestamp: anomaly.detectedAt,
                })),
            };
        }
        catch (error) {
            logger_1.logger.error('Failed to get behavior data:', error);
            return {
                stats: {
                    totalProfiles: 0,
                    enabledUsers: 0,
                    anomaliesByType: {},
                    anomaliesBySeverity: {},
                    averageRiskScore: 0,
                    highRiskUsers: 0,
                },
                highRiskUsers: 0,
                recentAnomalies: [],
            };
        }
    }
    /**
     * Get log data
     */
    async getLogData() {
        try {
            const stats = await this.loggingService.getStats('hour');
            const recentErrors = await this.loggingService.getRecentErrors(20);
            const recentCritical = recentErrors.filter(log => log.level === 'critical').slice(0, 10);
            return {
                stats,
                recentErrors: recentErrors.map(log => ({
                    timestamp: log.timestamp,
                    level: log.level,
                    service: log.service,
                    message: log.message,
                })),
                recentCritical: recentCritical.map(log => ({
                    timestamp: log.timestamp,
                    message: log.message,
                    service: log.service,
                })),
            };
        }
        catch (error) {
            logger_1.logger.error('Failed to get log data:', error);
            return {
                stats: {
                    totalLogs: 0,
                    logsByLevel: {},
                    logsByService: {},
                    errorRate: 0,
                    averageResponseTime: 0,
                },
                recentErrors: [],
                recentCritical: [],
            };
        }
    }
    /**
     * Get monitoring data
     */
    async getMonitoringData() {
        try {
            const performance = await this.monitoringService.getPerformanceMetrics('hour');
            const alerts = await this.monitoringService.getRecentAlerts(20);
            return {
                performance,
                alerts: alerts.map(alert => ({
                    name: alert.name,
                    severity: alert.severity,
                    message: alert.message,
                    timestamp: alert.timestamp,
                })),
            };
        }
        catch (error) {
            logger_1.logger.error('Failed to get monitoring data:', error);
            return {
                performance: this.getDefaultPerformanceMetrics(),
                alerts: [],
            };
        }
    }
    /**
     * Get rule severity
     */
    getRuleSeverity(ruleName) {
        const severityMap = {
            SQL_INJECTION: 'critical',
            XSS_ATTACK: 'critical',
            COMMAND_INJECTION: 'critical',
            PATH_TRAVERSAL: 'high',
            SSRF_ATTACK: 'high',
            FILE_INCLUSION: 'high',
            BUFFER_OVERFLOW: 'medium',
            HEADER_INJECTION: 'medium',
            PARAMETER_POLLUTION: 'low',
        };
        return severityMap[ruleName] || 'medium';
    }
    /**
     * Get default performance metrics
     */
    getDefaultPerformanceMetrics() {
        return {
            responseTime: { avg: 0, min: 0, max: 0, p50: 0, p95: 0, p99: 0 },
            throughput: { requestsPerSecond: 0, requestsPerMinute: 0, requestsPerHour: 0 },
            errorRate: { total: 0, percentage: 0, byStatus: {} },
            resourceUsage: { cpu: 0, memory: 0, disk: 0, network: { inbound: 0, outbound: 0 } },
            database: { connections: 0, queryTime: { avg: 0, slow: 0 }, cacheHitRate: 0 },
        };
    }
    /**
     * Get default dashboard data
     */
    getDefaultDashboardData() {
        return {
            overview: {
                systemHealth: 'healthy',
                totalAlerts: 0,
                criticalAlerts: 0,
                activeThreats: 0,
                lastScan: new Date(),
            },
            waf: {
                stats: { totalRequests: 0, blockedRequests: 0, warnings: 0, rulesTriggered: {} },
                recentBlocks: 0,
                topAttacks: [],
                blockedIPs: [],
            },
            malware: {
                stats: { totalScans: 0, infectedFiles: 0, quarantinedFiles: 0, averageScanTime: 0 },
                quarantinedFiles: 0,
                recentDetections: [],
            },
            twoFactor: {
                stats: { totalUsers: 0, enabledUsers: 0, methodDistribution: {}, recentVerifications: 0 },
                enabledUsers: 0,
                recentVerifications: 0,
            },
            threatIntel: {
                stats: {
                    totalFeeds: 0,
                    activeFeeds: 0,
                    totalAlerts: 0,
                    alertsBySeverity: {},
                    alertsByType: {},
                    recentAlerts: 0,
                },
                recentAlerts: [],
            },
            behavior: {
                stats: {
                    totalProfiles: 0,
                    enabledUsers: 0,
                    anomaliesByType: {},
                    anomaliesBySeverity: {},
                    averageRiskScore: 0,
                    highRiskUsers: 0,
                },
                highRiskUsers: 0,
                recentAnomalies: [],
            },
            logs: {
                stats: {
                    totalLogs: 0,
                    logsByLevel: {},
                    logsByService: {},
                    errorRate: 0,
                    averageResponseTime: 0,
                },
                recentErrors: [],
                recentCritical: [],
            },
            monitoring: {
                performance: this.getDefaultPerformanceMetrics(),
                alerts: [],
            },
            backup: {
                stats: {
                    totalBackups: 0,
                    successfulBackups: 0,
                    failedBackups: 0,
                    totalSize: 0,
                    averageSize: 0,
                    backupsByType: {},
                    recentBackups: [],
                },
                recentJobs: [],
            },
        };
    }
    /**
     * Get real-time security metrics
     */
    async getRealTimeMetrics() {
        try {
            const performance = await this.monitoringService.getPerformanceMetrics('minute');
            const wafStats = this.wafService.getMetrics();
            const malwareStats = this.malwareScanner.getScanStats();
            return {
                timestamp: new Date(),
                threatsBlocked: wafStats.blockedRequests,
                scansCompleted: malwareStats.totalScans,
                authenticationAttempts: 0, // Would track from auth service
                activeSessions: 0, // Would track from session service
                systemLoad: performance.resourceUsage,
            };
        }
        catch (error) {
            logger_1.logger.error('Failed to get real-time metrics:', error);
            return {
                timestamp: new Date(),
                threatsBlocked: 0,
                scansCompleted: 0,
                authenticationAttempts: 0,
                activeSessions: 0,
                systemLoad: { cpu: 0, memory: 0, disk: 0 },
            };
        }
    }
    /**
     * Get security incidents
     */
    async getSecurityIncidents(limit = 50) {
        try {
            // This would integrate with an incident management system
            // For now, return recent alerts as incidents
            const threats = await this.threatIntelService.getRecentAlerts(limit);
            const wafBlocks = this.wafService.getMetrics();
            const malwareDetections = await this.malwareScanner.getQuarantinedFiles();
            const incidents = [
                ...threats.map(threat => ({
                    id: threat.id,
                    type: 'threat_detected',
                    severity: threat.severity,
                    title: `Threat Detected: ${threat.type}`,
                    description: threat.description,
                    timestamp: threat.timestamp,
                    status: 'open',
                    tags: [threat.type, threat.severity],
                })),
                ...Array.from({ length: Math.min(10, wafBlocks.blockedRequests) }, (_, index) => ({
                    id: `waf_block_${index}`,
                    type: 'waf_block',
                    severity: 'medium',
                    title: 'WAF Block',
                    description: `Request blocked by WAF: ${wafBlocks.topAttacks[index]?.rule || 'Unknown'}`,
                    timestamp: new Date(),
                    status: 'resolved',
                    tags: ['waf', 'security'],
                })),
                ...malwareDetections.slice(0, 10).map((file, index) => ({
                    id: `malware_${index}`,
                    type: 'malware_detected',
                    severity: 'high',
                    title: 'Malware Detected',
                    description: `Malware found in: ${file.originalPath}`,
                    timestamp: file.quarantinedAt,
                    status: 'open',
                    tags: ['malware', 'security'],
                })),
            ]
                .sort((a, b) => b.timestamp.getTime() - a.timestamp.getTime())
                .slice(0, limit);
            return incidents;
        }
        catch (error) {
            logger_1.logger.error('Failed to get security incidents:', error);
            return [];
        }
    }
    /**
     * Get security score
     */
    async getSecurityScore() {
        try {
            const overview = await this.getOverviewData();
            const wafMetrics = this.wafService.getMetrics(); // Renamed from wafStats
            const malwareStats = this.malwareScanner.getScanStats();
            const twoFactorStats = await this.twoFactorService.getStats();
            const monitoringOverview = this.monitoringService.getMetricsOverview();
            const backupStats = await this.backupService.getStats();
            // Calculate scores for each category
            const wafScore = this.calculateCategoryScore(wafMetrics); // Corrected variable name
            const malwareScore = this.calculateCategoryScore(malwareStats);
            const authScore = this.calculateCategoryScore(twoFactorStats);
            const monitoringScore = this.calculateCategoryScore(monitoringOverview);
            const backupScore = this.calculateCategoryScore(backupStats);
            const overall = Math.round((wafScore + malwareScore + authScore + monitoringScore + backupScore) / 5);
            const recommendations = this.generateRecommendations({
                waf: wafScore,
                malware: malwareScore,
                auth: authScore,
                monitoring: monitoringScore,
                backup: backupScore,
            });
            return {
                overall,
                categories: {
                    waf: wafScore,
                    malware: malwareScore,
                    authentication: authScore,
                    monitoring: monitoringScore,
                    backup: backupScore,
                },
                recommendations,
            };
        }
        catch (error) {
            logger_1.logger.error('Failed to get security score:', error);
            return {
                overall: 0,
                categories: {
                    waf: 0,
                    malware: 0,
                    authentication: 0,
                    monitoring: 0,
                    backup: 0,
                },
                recommendations: [],
            };
        }
    }
    /**
     * Calculate category score
     */
    calculateCategoryScore(stats) {
        // Simple scoring algorithm - would be more sophisticated in production
        let score = 50; // Base score
        if (stats.totalRequests > 0) {
            const blockRate = stats.blockedRequests / stats.totalRequests;
            if (blockRate > 0.05)
                score -= 20;
            if (blockRate > 0.1)
                score -= 30;
        }
        if (stats.enabledUsers > 0) {
            score += 20;
        }
        if (stats.totalScans > 0) {
            const infectionRate = stats.infectedFiles / stats.totalScans;
            if (infectionRate === 0)
                score += 20;
            if (infectionRate < 0.01)
                score += 10;
        }
        return Math.max(0, Math.min(100, score));
    }
    /**
     * Generate recommendations
     */
    generateRecommendations(scores) {
        const recommendations = [];
        if (scores.waf < 70) {
            recommendations.push('Consider enabling more WAF rules or adjusting sensitivity');
        }
        if (scores.malware < 70) {
            recommendations.push('Update malware signatures and scan more frequently');
        }
        if (scores.auth < 70) {
            recommendations.push('Encourage users to enable 2FA for better security');
        }
        if (scores.monitoring < 70) {
            recommendations.push('Set up more comprehensive monitoring and alerting');
        }
        if (scores.backup < 70) {
            recommendations.push('Ensure regular backups are scheduled and tested');
        }
        return recommendations;
    }
    /**
     * Export dashboard data
     */
    async exportDashboardData(format = 'json') {
        try {
            const data = await this.getDashboardData();
            if (format === 'json') {
                return JSON.stringify(data, null, 2);
            }
            else {
                // Convert to CSV
                const csvData = this.convertToCSV(data);
                return csvData;
            }
        }
        catch (error) {
            logger_1.logger.error('Failed to export dashboard data:', error);
            return '';
        }
    }
    /**
     * Convert to CSV format
     */
    convertToCSV(data) {
        const headers = ['Category', 'Metric', 'Value', 'Timestamp', 'Status'];
        const rows = [
            headers,
            ['Overview', 'System Health', data.overview.systemHealth, new Date().toISOString(), ''],
            ['Overview', 'Total Alerts', data.overview.totalAlerts, new Date().toISOString(), ''],
            ['Overview', 'Critical Alerts', data.overview.criticalAlerts, new Date().toISOString(), ''],
            ['Overview', 'Active Threats', data.overview.activeThreats, new Date().toISOString(), ''],
            ['WAF', 'Blocked Requests', data.waf.stats.blockedRequests, new Date().toISOString(), ''],
            ['WAF', 'Total Requests', data.waf.stats.totalRequests, new Date().toISOString(), ''],
            ['Malware', 'Quarantined Files', data.malware.quarantinedFiles, new Date().toISOString(), ''],
            ['Malware', 'Total Scans', data.malware.stats.totalScans, new Date().toISOString(), ''],
            ['2FA', 'Enabled Users', data.twoFactor.enabledUsers, new Date().toISOString(), ''],
            [
                'Threat Intel',
                'Total Alerts',
                data.threatIntel.stats.totalAlerts,
                new Date().toISOString(),
                '',
            ],
            ['Behavior', 'High Risk Users', data.behavior.highRiskUsers, new Date().toISOString(), ''],
            ['Logs', 'Total Logs', data.logs.stats.totalLogs, new Date().toISOString(), ''],
            ['Logs', 'Error Rate', `${data.logs.stats.errorRate}%`, new Date().toISOString(), ''],
            ['Monitoring', 'Active Alerts', data.monitoring.alerts.length, new Date().toISOString(), ''],
            ['Backup', 'Total Backups', data.backup.stats.totalBackups, new Date().toISOString(), ''],
            [
                'Backup',
                'Success Rate',
                `${((data.backup.stats.successfulBackups / data.backup.stats.totalBackups) * 100).toFixed(1)}%`,
                new Date().toISOString(),
                '',
            ],
        ];
        return rows.map(row => row.join(',')).join('\n');
    }
};
exports.SecurityDashboardService = SecurityDashboardService;
exports.SecurityDashboardService = SecurityDashboardService = __decorate([
    (0, inversify_1.injectable)(),
    __metadata("design:paramtypes", [])
], SecurityDashboardService);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxBbGVqYW5kcm9cXEFJR2VzdGlvblxcYmFja2VuZFxcc3JjXFxzZXJ2aWNlc1xcc2VjdXJpdHktZGFzaGJvYXJkLnNlcnZpY2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQUEseUNBQXVDO0FBRXZDLDBDQUFnRDtBQUNoRCw0Q0FBeUM7QUFFekMsK0VBR3VDO0FBRXZDLGlFQUE4RDtBQUM5RCxxREFBaUQ7QUFJakQsbUVBQThEO0FBMEZ2RCxJQUFNLHdCQUF3QixHQUE5QixNQUFNLHdCQUF3QjtJQUNsQixLQUFLLENBQWtCO0lBQ3ZCLFVBQVUsQ0FBYTtJQUN2QixjQUFjLENBQXdCO0lBQ3RDLGdCQUFnQixDQUFtQjtJQUNuQyxrQkFBa0IsQ0FBNEI7SUFDOUMsZUFBZSxDQUFzQjtJQUNyQyxjQUFjLENBQTRCO0lBQzFDLGlCQUFpQixDQUFvQjtJQUNyQyxhQUFhLENBQXVCO0lBRXJEO1FBQ0UsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFBLHNCQUFjLEdBQUUsQ0FBQztRQUU5Qiw4REFBOEQ7UUFDOUQsSUFBSSxDQUFDLFVBQVUsR0FBRyw0QkFBUyxDQUFDLEdBQUcsQ0FBYSx3QkFBSyxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQzlELElBQUksQ0FBQyxjQUFjLEdBQUcsNEJBQVMsQ0FBQyxHQUFHLENBQXdCLHdCQUFLLENBQUMscUJBQXFCLENBQUMsQ0FBQztRQUN4RixJQUFJLENBQUMsZ0JBQWdCLEdBQUcsNEJBQVMsQ0FBQyxHQUFHLENBQW1CLHdCQUFLLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztRQUNoRixJQUFJLENBQUMsa0JBQWtCLEdBQUcsNEJBQVMsQ0FBQyxHQUFHLENBQ3JDLHdCQUFLLENBQUMseUJBQXlCLENBQ2hDLENBQUM7UUFDRixJQUFJLENBQUMsZUFBZSxHQUFHLDRCQUFTLENBQUMsR0FBRyxDQUFzQiwyQ0FBbUIsQ0FBQyxDQUFDO1FBQy9FLElBQUksQ0FBQyxjQUFjLEdBQUcsNEJBQVMsQ0FBQyxHQUFHLENBQTRCLDBEQUE0QixDQUFD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LFlBQVksQ0FBQyxHQUFHLEdBQUcsQ0FBQyxDQUFDLE9BQU8sQ0FDdkYsQ0FBQyxDQUNGLEdBQUc7Z0JBQ0osSUFBSSxJQUFJLEVBQUUsQ0FBQyxXQUFXLEVBQUU7Z0JBQ3hCLEVBQUU7YUFDSDtTQUNGLENBQUM7UUFFRixPQUFPLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ25ELENBQUM7Q0FDRixDQUFBO0FBN3hCWSw0REFBd0I7bUNBQXhCLHdCQUF3QjtJQURwQyxJQUFBLHNCQUFVLEdBQUU7O0dBQ0Esd0JBQXdCLENBNnhCcEMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxBbGVqYW5kcm9cXEFJR2VzdGlvblxcYmFja2VuZFxcc3JjXFxzZXJ2aWNlc1xcc2VjdXJpdHktZGFzaGJvYXJkLnNlcnZpY2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaW5qZWN0YWJsZSB9IGZyb20gJ2ludmVyc2lmeSc7XG5pbXBvcnQgdHlwZSB7IFJlZGlzQ2xpZW50VHlwZSB9IGZyb20gJ3JlZGlzJztcbmltcG9ydCB7IGdldFJlZGlzQ2xpZW50IH0gZnJvbSAnLi4vY2FjaGUvcmVkaXMnO1xuaW1wb3J0IHsgbG9nZ2VyIH0gZnJvbSAnLi4vdXRpbHMvbG9nZ2VyJztcbmltcG9ydCB7IEJhY2t1cFJlc3RvcmVTZXJ2aWNlIH0gZnJvbSAnLi9iYWNrdXAtcmVzdG9yZS5zZXJ2aWNlJztcbmltcG9ydCB7XG4gIENFTlRSQUxfTE9HR0lOR19TRVJWSUNFX05BTUUsXG4gIENlbnRyYWxpemVkTG9nZ2luZ1NlcnZpY2UsXG59IGZyb20gJy4vY2VudHJhbGl6ZWQtbG9nZ2luZy5zZXJ2aWNlJztcbmltcG9ydCB7IE1hbHdhcmVTY2FubmVyU2VydmljZSB9IGZyb20gJy4vbWFsd2FyZS1zY2FubmVyLnNlcnZpY2UnO1xuaW1wb3J0IHsgY29udGFpbmVyLCBUWVBFUyB9IGZyb20gJy4uL2NvbmZpZy9pbnZlcnNpZnkuY29uZmlnJztcbmltcG9ydCB7IEhlYWx0aFNlcnZpY2UgfSBmcm9tICcuL2hlYWx0aC5zZXJ2aWNlJztcbmltcG9ydCB7IE1vbml0b3JpbmdTZXJ2aWNlIH0gZnJvbSAnLi9tb25pdG9yaW5nLnNlcnZpY2UnO1xuaW1wb3J0IHsgVGhyZWF0SW50ZWxsaWdlbmNlU2VydmljZSB9IGZyb20gJy4vdGhyZWF0LWludGVsbGlnZW5jZS5zZXJ2aWNlJztcbmltcG9ydCB7IFR3b0ZhY3RvclNlcnZpY2UgfSBmcm9tICcuL3R3by1mYWN0b3Iuc2VydmljZSc7XG5pbXBvcnQgeyBVc2VyQmVoYXZpb3JTZXJ2aWNlIH0gZnJvbSAnLi91c2VyLWJlaGF2aW9yLnNlcnZpY2UnO1xuaW1wb3J0IHsgV0FGU2VydmljZSB9IGZyb20gJy4vd2FmLnNlcnZpY2UnO1xuXG5pbnRlcmZhY2UgU2VjdXJpdHlEYXNoYm9hcmREYXRhIHtcbiAgb3ZlcnZpZXc6IHtcbiAgICBzeXN0ZW1IZWFsdGg6ICdoZWFsdGh5JyB8ICd3YXJuaW5nJyB8ICdjcml0aWNhbCc7XG4gICAgdG90YWxBbGVydHM6IG51bWJlcjtcbiAgICBjcml0aWNhbEFsZXJ0czogbnVtYmVyO1xuICAgIGFjdGl2ZVRocmVhdHM6IG51bWJlcjtcbiAgICBsYXN0U2NhbjogRGF0ZTtcbiAgfTtcbiAgd2FmOiB7XG4gICAgc3RhdHM6IGFueTtcbiAgICByZWNlbnRCbG9ja3M6IG51bWJlcjtcbiAgICB0b3BBdHRhY2tzOiBBcnJheTx7XG4gICAgICBydWxlOiBzdHJpbmc7XG4gICAgICBjb3VudDogbnVtYmVyO1xuICAgICAgc2V2ZXJpdHk6IHN0cmluZztcbiAgICB9PjtcbiAgICBibG9ja2VkSVBzOiBzdHJpbmdbXTtcbiAgfTtcbiAgbWFsd2FyZToge1xuICAgIHN0YXRzOiBhbnk7XG4gICAgcXVhcmFudGluZWRGaWxlczogbnVtYmVyO1xuICAgIHJlY2VudERldGVjdGlvbnM6IEFycmF5PHtcbiAgICAgIGZpbGU6IHN0cmluZztcbiAgICAgIHRocmVhdDogc3RyaW5nO1xuICAgICAgdGltZXN0YW1wOiBEYXRlO1xuICAgIH0+O1xuICB9O1xuICB0d29GYWN0b3I6IHtcbiAgICBzdGF0czogYW55O1xuICAgIGVuYWJsZWRVc2VyczogbnVtYmVyO1xuICAgIHJlY2VudFZlcmlmaWNhdGlvbnM6IG51bWJlcjtcbiAgfTtcbiAgdGhyZWF0SW50ZWw6IHtcbiAgICBzdGF0czogYW55O1xuICAgIHJlY2VudEFsZXJ0czogQXJyYXk8e1xuICAgICAgdHlwZTogc3RyaW5nO1xuICAgICAgc2V2ZXJpdHk6IHN0cmluZztcbiAgICAgIGluZGljYXRvcjogc3RyaW5nO1xuICAgICAgdGltZXN0YW1wOiBEYXRlO1xuICAgIH0+O1xuICB9O1xuICBiZWhhdmlvcjoge1xuICAgIHN0YXRzOiBhbnk7XG4gICAgaGlnaFJpc2tVc2VyczogbnVtYmVyO1xuICAgIHJlY2VudEFub21hbGllczogQXJyYXk8e1xuICAgICAgdXNlcklkOiBzdHJpbmc7XG4gICAgICB0eXBlOiBzdHJpbmc7XG4gICAgICBzZXZlcml0eTogc3RyaW5nO1xuICAgICAgdGltZXN0YW1wOiBEYXRlO1xuICAgIH0+O1xuICB9O1xuICBsb2dzOiB7XG4gICAgc3RhdHM6IGFueTtcbiAgICByZWNlbnRFcnJvcnM6IEFycmF5PHtcbiAgICAgIHRpbWVzdGFtcDogRGF0ZTtcbiAgICAgIGxldmVsOiBzdHJpbmc7XG4gICAgICBzZXJ2aWNlOiBzdHJpbmc7XG4gICAgICBtZXNzYWdlOiBzdHJpbmc7XG4gICAgfT47XG4gICAgcmVjZW50Q3JpdGljYWw6IEFycmF5PHtcbiAgICAgIHRpbWVzdGFtcDogRGF0ZTtcbiAgICAgIG1lc3NhZ2U6IHN0cmluZztcbiAgICAgIHNlcnZpY2U6IHN0cmluZztcbiAgICB9PjtcbiAgfTtcbiAgbW9uaXRvcmluZzoge1xuICAgIHBlcmZvcm1hbmNlOiBhbnk7XG4gICAgYWxlcnRzOiBBcnJheTx7XG4gICAgICBuYW1lOiBzdHJpbmc7XG4gICAgICBzZXZlcml0eTogc3RyaW5nO1xuICAgICAgbWVzc2FnZTogc3RyaW5nO1xuICAgICAgdGltZXN0YW1wOiBEYXRlO1xuICAgIH0+O1xuICB9O1xuICBiYWNrdXA6IHtcbiAgICBzdGF0czogYW55O1xuICAgIHJlY2VudEpvYnM6IEFycmF5PHtcbiAgICAgIGlkOiBzdHJpbmc7XG4gICAgICB0eXBlOiBzdHJpbmc7XG4gICAgICBzdGF0dXM6IHN0cmluZztcbiAgICAgIHNpemU6IG51bWJlcjtcbiAgICAgIHRpbWVzdGFtcDogRGF0ZTtcbiAgICB9PjtcbiAgfTtcbn1cblxuQGluamVjdGFibGUoKVxuZXhwb3J0IGNsYXNzIFNlY3VyaXR5RGFzaGJvYXJkU2VydmljZSB7XG4gIHByaXZhdGUgcmVhZG9ubHkgcmVkaXM6IFJlZGlzQ2xpZW50VHlwZTtcbiAgcHJpdmF0ZSByZWFkb25seSB3YWZTZXJ2aWNlOiBXQUZTZXJ2aWNlO1xuICBwcml2YXRlIHJlYWRvbmx5IG1hbHdhcmVTY2FubmVyOiBNYWx3YXJlU2Nhbm5lclNlcnZpY2U7XG4gIHByaXZhdGUgcmVhZG9ubHkgdHdvRmFjdG9yU2VydmljZTogVHdvRmFjdG9yU2VydmljZTtcbiAgcHJpdmF0ZSByZWFkb25seSB0aHJlYXRJbnRlbFNlcnZpY2U6IFRocmVhdEludGVsbGlnZW5jZVNlcnZpY2U7XG4gIHByaXZhdGUgcmVhZG9ubHkgYmVoYXZpb3JTZXJ2aWNlOiBVc2VyQmVoYXZpb3JTZXJ2aWNlO1xuICBwcml2YXRlIHJlYWRvbmx5IGxvZ2dpbmdTZXJ2aWNlOiBDZW50cmFsaXplZExvZ2dpbmdTZXJ2aWNlO1xuICBwcml2YXRlIHJlYWRvbmx5IG1vbml0b3JpbmdTZXJ2aWNlOiBNb25pdG9yaW5nU2VydmljZTtcbiAgcHJpdmF0ZSByZWFkb25seSBiYWNrdXBTZXJ2aWNlOiBCYWNrdXBSZXN0b3JlU2VydmljZTtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLnJlZGlzID0gZ2V0UmVkaXNDbGllbnQoKTtcblxuICAgIC8vIEluaXRpYWxpemUgc2VydmljZXMgdmlhIGNvbnRhaW5lciB0byBlbnN1cmUgc2luZ2xldG9uIHVzYWdlXG4gICAgdGhpcy53YWZTZXJ2aWNlID0gY29udGFpbmVyLmdldDxXQUZTZXJ2aWNlPihUWVBFUy5XQUZTZXJ2aWNlKTtcbiAgICB0aGlzLm1hbHdhcmVTY2FubmVyID0gY29udGFpbmVyLmdldDxNYWx3YXJlU2Nhbm5lclNlcnZpY2U+KFRZUEVTLk1hbHdhcmVTY2FubmVyU2VydmljZSk7XG4gICAgdGhpcy50d29GYWN0b3JTZXJ2aWNlID0gY29udGFpbmVyLmdldDxUd29GYWN0b3JTZXJ2aWNlPihUWVBFUy5Ud29GYWN0b3JTZXJ2aWNlKTtcbiAgICB0aGlzLnRocmVhdEludGVsU2VydmljZSA9IGNvbnRhaW5lci5nZXQ8VGhyZWF0SW50ZWxsaWdlbmNlU2VydmljZT4oXG4gICAgICBUWVBFUy5UaHJlYXRJbnRlbGxpZ2VuY2VTZXJ2aWNlLFxuICAgICk7XG4gICAgdGhpcy5iZWhhdmlvclNlcnZpY2UgPSBjb250YWluZXIuZ2V0PFVzZXJCZWhhdmlvclNlcnZpY2U+KFVzZXJCZWhhdmlvclNlcnZpY2UpO1xuICAgIHRoaXMubG9nZ2luZ1NlcnZpY2UgPSBjb250YWluZXIuZ2V0PENlbnRyYWxpemVkTG9nZ2luZ1NlcnZpY2U+KENFTlRSQUxfTE9HR0lOR19TRVJWSUNFX05BTUUpO1xuICAgIHRoaXMubW9uaXRvcmluZ1NlcnZpY2UgPSBjb250YWluZXIuZ2V0PE1vbml0b3JpbmdTZXJ2aWNlPihUWVBFUy5Nb25pdG9yaW5nU2VydmljZSk7XG4gICAgdGhpcy5iYWNrdXBTZXJ2aWNlID0gY29udGFpbmVyLmdldDxCYWNrdXBSZXN0b3JlU2VydmljZT4oVFlQRVMuQmFja3VwUmVzdG9yZVNlcnZpY2UpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBjb21wbGV0ZSBzZWN1cml0eSBkYXNoYm9hcmQgZGF0YVxuICAgKi9cbiAgcHVibGljIGFzeW5jIGdldERhc2hib2FyZERhdGEoKTogUHJvbWlzZTxTZWN1cml0eURhc2hib2FyZERhdGE+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgW292ZXJ2aWV3LCB3YWYsIG1hbHdhcmUsIHR3b0ZhY3RvciwgdGhyZWF0SW50ZWwsIGJlaGF2aW9yLCBsb2dzLCBtb25pdG9yaW5nXSA9XG4gICAgICAgIGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICAgICAgICB0aGlzLmdldE92ZXJ2aWV3RGF0YSgpLFxuICAgICAgICAgIHRoaXMuZ2V0V0FGRGF0YSgpLFxuICAgICAgICAgIHRoaXMuZ2V0TWFsd2FyZURhdGEoKSxcbiAgICAgICAgICB0aGlzLmdldFR3b0ZhY3RvckRhdGEoKSxcbiAgICAgICAgICB0aGlzLmdldFRocmVhdEludGVsRGF0YSgpLFxuICAgICAgICAgIHRoaXMuZ2V0QmVoYXZpb3JEYXRhKCksXG4gICAgICAgICAgdGhpcy5nZXRMb2dEYXRhKCksXG4gICAgICAgICAgdGhpcy5nZXRNb25pdG9yaW5nRGF0YSgpLFxuICAgICAgICBdKTtcblxuICAgICAgY29uc3QgYmFja3VwRGF0YSA9IGF3YWl0IHRoaXMuYmFja3VwU2VydmljZS5nZXRTdGF0cygpO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBvdmVydmlldyxcbiAgICAgICAgd2FmLFxuICAgICAgICBtYWx3YXJlLFxuICAgICAgICB0d29GYWN0b3IsXG4gICAgICAgIHRocmVhdEludGVsLFxuICAgICAgICBiZWhhdmlvcixcbiAgICAgICAgbG9ncyxcbiAgICAgICAgbW9uaXRvcmluZyxcbiAgICAgICAgYmFja3VwOiB7XG4gICAgICAgICAgc3RhdHM6IGJhY2t1cERhdGEsXG4gICAgICAgICAgcmVjZW50Sm9iczogYmFja3VwRGF0YS5yZWNlbnRCYWNrdXBzLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdGYWlsZWQgdG8gZ2V0IGRhc2hib2FyZCBkYXRhOicsIGVycm9yKTtcbiAgICAgIHJldHVybiB0aGlzLmdldERlZmF1bHREYXNoYm9hcmREYXRhKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBvdmVydmlldyBkYXRhIGludGVncmF0ZWQgd2l0aCBIZWFsdGhTZXJ2aWNlXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGdldE92ZXJ2aWV3RGF0YSgpOiBQcm9taXNlPHtcbiAgICBzeXN0ZW1IZWFsdGg6ICdoZWFsdGh5JyB8ICd3YXJuaW5nJyB8ICdjcml0aWNhbCc7XG4gICAgdG90YWxBbGVydHM6IG51bWJlcjtcbiAgICBjcml0aWNhbEFsZXJ0czogbnVtYmVyO1xuICAgIGFjdGl2ZVRocmVhdHM6IG51bWJlcjtcbiAgICBsYXN0U2NhbjogRGF0ZTtcbiAgfT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBoZWFsdGhTZXJ2aWNlID0gY29udGFpbmVyLmdldDxIZWFsdGhTZXJ2aWNlPihIZWFsdGhTZXJ2aWNlKTtcbiAgICAgIGNvbnN0IGhlYWx0aCA9IGF3YWl0IGhlYWx0aFNlcnZpY2UuZ2V0RGV0YWlsZWRIZWFsdGgoKTtcblxuICAgICAgY29uc3QgYmVoYXZpb3JTdGF0cyA9IGF3YWl0IHRoaXMuYmVoYXZpb3JTZXJ2aWNlLmdldFN0YXRzKCk7XG4gICAgICBjb25zdCB0aHJlYXRBbGVydHMgPSBhd2FpdCB0aGlzLnRocmVhdEludGVsU2VydmljZS5nZXRSZWNlbnRBbGVydHMoNTApO1xuICAgICAgY29uc3QgY3JpdGljYWxUaHJlYXRzID0gdGhyZWF0QWxlcnRzLmZpbHRlcihhbGVydCA9PiBhbGVydC5zZXZlcml0eSA9PT0gJ2NyaXRpY2FsJykubGVuZ3RoO1xuXG4gICAgICBsZXQgc3lzdGVtSGVhbHRoOiAnaGVhbHRoeScgfCAnd2FybmluZycgfCAnY3JpdGljYWwnID0gJ2hlYWx0aHknO1xuICAgICAgaWYgKGhlYWx0aC5zdGF0dXMgPT09ICdkZWdyYWRlZCcgfHwgYmVoYXZpb3JTdGF0cy5oaWdoUmlza1VzZXJzID4gNSB8fCBjcml0aWNhbFRocmVhdHMgPiAzKSB7XG4gICAgICAgIHN5c3RlbUhlYWx0aCA9ICdjcml0aWNhbCc7XG4gICAgICB9IGVsc2UgaWYgKGJlaGF2aW9yU3RhdHMuaGlnaFJpc2tVc2VycyA+IDAgfHwgY3JpdGljYWxUaHJlYXRzID4gMCkge1xuICAgICAgICBzeXN0ZW1IZWFsdGggPSAnd2FybmluZyc7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN5c3RlbUhlYWx0aCxcbiAgICAgICAgdG90YWxBbGVydHM6IGJlaGF2aW9yU3RhdHMudG90YWxBbm9tYWxpZXMgKyB0aHJlYXRBbGVydHMubGVuZ3RoLFxuICAgICAgICBjcml0aWNhbEFsZXJ0czogY3JpdGljYWxUaHJlYXRzLFxuICAgICAgICBhY3RpdmVUaHJlYXRzOiB0aHJlYXRBbGVydHMubGVuZ3RoLFxuICAgICAgICBsYXN0U2NhbjogbmV3IERhdGUoKSxcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRmFpbGVkIHRvIGdldCBvdmVydmlldyBkYXRhOicsIGVycm9yKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN5c3RlbUhlYWx0aDogJ2hlYWx0aHknLFxuICAgICAgICB0b3RhbEFsZXJ0czogMCxcbiAgICAgICAgY3JpdGljYWxBbGVydHM6IDAsXG4gICAgICAgIGFjdGl2ZVRocmVhdHM6IDAsXG4gICAgICAgIGxhc3RTY2FuOiBuZXcgRGF0ZSgpLFxuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IFdBRiBkYXRhXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGdldFdBRkRhdGEoKTogUHJvbWlzZTx7XG4gICAgc3RhdHM6IGFueTtcbiAgICByZWNlbnRCbG9ja3M6IG51bWJlcjtcbiAgICB0b3BBdHRhY2tzOiBBcnJheTx7XG4gICAgICBydWxlOiBzdHJpbmc7XG4gICAgICBjb3VudDogbnVtYmVyO1xuICAgICAgc2V2ZXJpdHk6IHN0cmluZztcbiAgICB9PjtcbiAgICBibG9ja2VkSVBzOiBzdHJpbmdbXTtcbiAgfT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBzdGF0cyA9IHRoaXMud2FmU2VydmljZS5nZXRNZXRyaWNzKCk7XG4gICAgICBjb25zdCByZWNlbnRBbGVydHMgPSBhd2FpdCB0aGlzLnRocmVhdEludGVsU2VydmljZS5nZXRSZWNlbnRBbGVydHMoNTApO1xuICAgICAgY29uc3QgcmVjZW50QmxvY2tzID0gcmVjZW50QWxlcnRzLmZpbHRlcihhbGVydCA9PiBhbGVydC5hY3Rpb24gPT09ICdibG9jaycpLmxlbmd0aDtcblxuICAgICAgY29uc3QgdG9wQXR0YWNrcyA9IE9iamVjdC5lbnRyaWVzKHN0YXRzLnRvcEF0dGFja3MpXG4gICAgICAgIC5tYXAoKFtfLCBhdHRhY2tdOiBbc3RyaW5nLCBhbnldKSA9PiAoe1xuICAgICAgICAgIHJ1bGU6IGF0dGFjay5ydWxlLFxuICAgICAgICAgIGNvdW50OiBhdHRhY2suY291bnQsXG4gICAgICAgICAgc2V2ZXJpdHk6IHRoaXMuZ2V0UnVsZVNldmVyaXR5KGF0dGFjay5ydWxlKSxcbiAgICAgICAgfSkpXG4gICAgICAgIC5zb3J0KChhLCBiKSA9PiBiLmNvdW50IC0gYS5jb3VudClcbiAgICAgICAgLnNsaWNlKDAsIDEwKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3RhdHMsXG4gICAgICAgIHJlY2VudEJsb2NrcyxcbiAgICAgICAgdG9wQXR0YWNrcyxcbiAgICAgICAgYmxvY2tlZElQczogW10sIC8vIFdvdWxkIGdldCBmcm9tIHJlY2VudCBXQUYgYmxvY2tzXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0ZhaWxlZCB0byBnZXQgV0FGIGRhdGE6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3RhdHM6IHsgdG90YWxSZXF1ZXN0czogMCwgYmxvY2tlZFJlcXVlc3RzOiAwLCB3YXJuaW5nczogMCwgcnVsZXNUcmlnZ2VyZWQ6IHt9IH0sXG4gICAgICAgIHJlY2VudEJsb2NrczogMCxcbiAgICAgICAgdG9wQXR0YWNrczogW10sXG4gICAgICAgIGJsb2NrZWRJUHM6IFtdLFxuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IG1hbHdhcmUgZGF0YVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBnZXRNYWx3YXJlRGF0YSgpOiBQcm9taXNlPHtcbiAgICBzdGF0czogYW55O1xuICAgIHF1YXJhbnRpbmVkRmlsZXM6IG51bWJlcjtcbiAgICByZWNlbnREZXRlY3Rpb25zOiBBcnJheTx7XG4gICAgICBmaWxlOiBzdHJpbmc7XG4gICAgICB0aHJlYXQ6IHN0cmluZztcbiAgICAgIHRpbWVzdGFtcDogRGF0ZTtcbiAgICB9PjtcbiAgfT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBzdGF0cyA9IHRoaXMubWFsd2FyZVNjYW5uZXIuZ2V0U2NhblN0YXRzKCk7XG4gICAgICBjb25zdCBxdWFyYW50aW5lZEZpbGVzID0gYXdhaXQgdGhpcy5tYWx3YXJlU2Nhbm5lci5nZXRRdWFyYW50aW5lZEZpbGVzKCk7XG5cbiAgICAgIGNvbnN0IHJlY2VudERldGVjdGlvbnMgPSBxdWFyYW50aW5lZEZpbGVzXG4gICAgICAgIC5zb3J0KChhLCBiKSA9PiBiLnF1YXJhbnRpbmVkQXQuZ2V0VGltZSgpIC0gYS5xdWFyYW50aW5lZEF0LmdldFRpbWUoKSlcbiAgICAgICAgLnNsaWNlKDAsIDEwKVxuICAgICAgICAubWFwKGZpbGUgPT4gKHtcbiAgICAgICAgICBmaWxlOiBmaWxlLm9yaWdpbmFsUGF0aCxcbiAgICAgICAgICB0aHJlYXQ6IGZpbGUudGhyZWF0LFxuICAgICAgICAgIHRpbWVzdGFtcDogZmlsZS5xdWFyYW50aW5lZEF0LFxuICAgICAgICB9KSk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN0YXRzLFxuICAgICAgICBxdWFyYW50aW5lZEZpbGVzOiBxdWFyYW50aW5lZEZpbGVzLmxlbmd0aCxcbiAgICAgICAgcmVjZW50RGV0ZWN0aW9ucyxcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRmFpbGVkIHRvIGdldCBtYWx3YXJlIGRhdGE6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3RhdHM6IHsgdG90YWxTY2FuczogMCwgaW5mZWN0ZWRGaWxlczogMCwgcXVhcmFudGluZWRGaWxlczogMCwgYXZlcmFnZVNjYW5UaW1lOiAwIH0sXG4gICAgICAgIHF1YXJhbnRpbmVkRmlsZXM6IDAsXG4gICAgICAgIHJlY2VudERldGVjdGlvbnM6IFtdLFxuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IDJGQSBkYXRhXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGdldFR3b0ZhY3RvckRhdGEoKTogUHJvbWlzZTx7XG4gICAgc3RhdHM6IGFueTtcbiAgICBlbmFibGVkVXNlcnM6IG51bWJlcjtcbiAgICByZWNlbnRWZXJpZmljYXRpb25zOiBudW1iZXI7XG4gIH0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc3RhdHMgPSBhd2FpdCB0aGlzLnR3b0ZhY3RvclNlcnZpY2UuZ2V0U3RhdHMoKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3RhdHMsXG4gICAgICAgIGVuYWJsZWRVc2Vyczogc3RhdHMuZW5hYmxlZFVzZXJzLFxuICAgICAgICByZWNlbnRWZXJpZmljYXRpb25zOiBzdGF0cy5yZWNlbnRWZXJpZmljYXRpb25zLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdGYWlsZWQgdG8gZ2V0IDJGQSBkYXRhOicsIGVycm9yKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN0YXRzOiB7IHRvdGFsVXNlcnM6IDAsIGVuYWJsZWRVc2VyczogMCwgbWV0aG9kRGlzdHJpYnV0aW9uOiB7fSwgcmVjZW50VmVyaWZpY2F0aW9uczogMCB9LFxuICAgICAgICBlbmFibGVkVXNlcnM6IDAsXG4gICAgICAgIHJlY2VudFZlcmlmaWNhdGlvbnM6IDAsXG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGhyZWF0IGludGVsbGlnZW5jZSBkYXRhXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGdldFRocmVhdEludGVsRGF0YSgpOiBQcm9taXNlPHtcbiAgICBzdGF0czogYW55O1xuICAgIHJlY2VudEFsZXJ0czogQXJyYXk8e1xuICAgICAgdHlwZTogc3RyaW5nO1xuICAgICAgc2V2ZXJpdHk6IHN0cmluZztcbiAgICAgIGluZGljYXRvcjogc3RyaW5nO1xuICAgICAgdGltZXN0YW1wOiBEYXRlO1xuICAgIH0+O1xuICB9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHN0YXRzID0gYXdhaXQgdGhpcy50aHJlYXRJbnRlbFNlcnZpY2UuZ2V0U3RhdHMoKTtcbiAgICAgIGNvbnN0IHJlY2VudEFsZXJ0cyA9IGF3YWl0IHRoaXMudGhyZWF0SW50ZWxTZXJ2aWNlLmdldFJlY2VudEFsZXJ0cyg1MCk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN0YXRzLFxuICAgICAgICByZWNlbnRBbGVydHM6IHJlY2VudEFsZXJ0cy5tYXAoYWxlcnQgPT4gKHtcbiAgICAgICAgICB0eXBlOiBhbGVydC50eXBlLFxuICAgICAgICAgIHNldmVyaXR5OiBhbGVydC5zZXZlcml0eSxcbiAgICAgICAgICBpbmRpY2F0b3I6IGFsZXJ0LmluZGljYXRvcixcbiAgICAgICAgICB0aW1lc3RhbXA6IGFsZXJ0LnRpbWVzdGFtcCxcbiAgICAgICAgfSkpLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdGYWlsZWQgdG8gZ2V0IHRocmVhdCBpbnRlbCBkYXRhOicsIGVycm9yKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN0YXRzOiB7XG4gICAgICAgICAgdG90YWxGZWVkczogMCxcbiAgICAgICAgICBhY3RpdmVGZWVkczogMCxcbiAgICAgICAgICB0b3RhbEFsZXJ0czogMCxcbiAgICAgICAgICBhbGVydHNCeVNldmVyaXR5OiB7fSxcbiAgICAgICAgICBhbGVydHNCeVR5cGU6IHt9LFxuICAgICAgICAgIHJlY2VudEFsZXJ0czogMCxcbiAgICAgICAgfSxcbiAgICAgICAgcmVjZW50QWxlcnRzOiBbXSxcbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBiZWhhdmlvciBhbmFseXNpcyBkYXRhXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGdldEJlaGF2aW9yRGF0YSgpOiBQcm9taXNlPHtcbiAgICBzdGF0czogYW55O1xuICAgIGhpZ2hSaXNrVXNlcnM6IG51bWJlcjtcbiAgICByZWNlbnRBbm9tYWxpZXM6IEFycmF5PHtcbiAgICAgIHVzZXJJZDogc3RyaW5nO1xuICAgICAgdHlwZTogc3RyaW5nO1xuICAgICAgc2V2ZXJpdHk6IHN0cmluZztcbiAgICAgIHRpbWVzdGFtcDogRGF0ZTtcbiAgICB9PjtcbiAgfT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBzdGF0cyA9IGF3YWl0IHRoaXMuYmVoYXZpb3JTZXJ2aWNlLmdldFN0YXRzKCk7XG4gICAgICBjb25zdCByZWNlbnRBbm9tYWxpZXMgPSBhd2FpdCB0aGlzLmJlaGF2aW9yU2VydmljZS5nZXRSZWNlbnRBbm9tYWxpZXMoNTApO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdGF0cyxcbiAgICAgICAgaGlnaFJpc2tVc2Vyczogc3RhdHMuaGlnaFJpc2tVc2VycyxcbiAgICAgICAgcmVjZW50QW5vbWFsaWVzOiByZWNlbnRBbm9tYWxpZXMubWFwKGFub21hbHkgPT4gKHtcbiAgICAgICAgICB1c2VySWQ6IGFub21hbHkudXNlcklkLFxuICAgICAgICAgIHR5cGU6IGFub21hbHkudHlwZSxcbiAgICAgICAgICBzZXZlcml0eTogYW5vbWFseS5zZXZlcml0eSxcbiAgICAgICAgICB0aW1lc3RhbXA6IGFub21hbHkuZGV0ZWN0ZWRBdCxcbiAgICAgICAgfSkpLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdGYWlsZWQgdG8gZ2V0IGJlaGF2aW9yIGRhdGE6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3RhdHM6IHtcbiAgICAgICAgICB0b3RhbFByb2ZpbGVzOiAwLFxuICAgICAgICAgIGVuYWJsZWRVc2VyczogMCxcbiAgICAgICAgICBhbm9tYWxpZXNCeVR5cGU6IHt9LFxuICAgICAgICAgIGFub21hbGllc0J5U2V2ZXJpdHk6IHt9LFxuICAgICAgICAgIGF2ZXJhZ2VSaXNrU2NvcmU6IDAsXG4gICAgICAgICAgaGlnaFJpc2tVc2VyczogMCxcbiAgICAgICAgfSxcbiAgICAgICAgaGlnaFJpc2tVc2VyczogMCxcbiAgICAgICAgcmVjZW50QW5vbWFsaWVzOiBbXSxcbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBsb2cgZGF0YVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBnZXRMb2dEYXRhKCk6IFByb21pc2U8e1xuICAgIHN0YXRzOiBhbnk7XG4gICAgcmVjZW50RXJyb3JzOiBBcnJheTx7XG4gICAgICB0aW1lc3RhbXA6IERhdGU7XG4gICAgICBsZXZlbDogc3RyaW5nO1xuICAgICAgc2VydmljZTogc3RyaW5nO1xuICAgICAgbWVzc2FnZTogc3RyaW5nO1xuICAgIH0+O1xuICAgIHJlY2VudENyaXRpY2FsOiBBcnJheTx7XG4gICAgICB0aW1lc3RhbXA6IERhdGU7XG4gICAgICBtZXNzYWdlOiBzdHJpbmc7XG4gICAgICBzZXJ2aWNlOiBzdHJpbmc7XG4gICAgfT47XG4gIH0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc3RhdHMgPSBhd2FpdCB0aGlzLmxvZ2dpbmdTZXJ2aWNlLmdldFN0YXRzKCdob3VyJyk7XG4gICAgICBjb25zdCByZWNlbnRFcnJvcnMgPSBhd2FpdCB0aGlzLmxvZ2dpbmdTZXJ2aWNlLmdldFJlY2VudEVycm9ycygyMCk7XG4gICAgICBjb25zdCByZWNlbnRDcml0aWNhbCA9IHJlY2VudEVycm9ycy5maWx0ZXIobG9nID0+IGxvZy5sZXZlbCA9PT0gJ2NyaXRpY2FsJykuc2xpY2UoMCwgMTApO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdGF0cyxcbiAgICAgICAgcmVjZW50RXJyb3JzOiByZWNlbnRFcnJvcnMubWFwKGxvZyA9PiAoe1xuICAgICAgICAgIHRpbWVzdGFtcDogbG9nLnRpbWVzdGFtcCxcbiAgICAgICAgICBsZXZlbDogbG9nLmxldmVsLFxuICAgICAgICAgIHNlcnZpY2U6IGxvZy5zZXJ2aWNlLFxuICAgICAgICAgIG1lc3NhZ2U6IGxvZy5tZXNzYWdlLFxuICAgICAgICB9KSksXG4gICAgICAgIHJlY2VudENyaXRpY2FsOiByZWNlbnRDcml0aWNhbC5tYXAobG9nID0+ICh7XG4gICAgICAgICAgdGltZXN0YW1wOiBsb2cudGltZXN0YW1wLFxuICAgICAgICAgIG1lc3NhZ2U6IGxvZy5tZXNzYWdlLFxuICAgICAgICAgIHNlcnZpY2U6IGxvZy5zZXJ2aWNlLFxuICAgICAgICB9KSksXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0ZhaWxlZCB0byBnZXQgbG9nIGRhdGE6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3RhdHM6IHtcbiAgICAgICAgICB0b3RhbExvZ3M6IDAsXG4gICAgICAgICAgbG9nc0J5TGV2ZWw6IHt9LFxuICAgICAgICAgIGxvZ3NCeVNlcnZpY2U6IHt9LFxuICAgICAgICAgIGVycm9yUmF0ZTogMCxcbiAgICAgICAgICBhdmVyYWdlUmVzcG9uc2VUaW1lOiAwLFxuICAgICAgICB9LFxuICAgICAgICByZWNlbnRFcnJvcnM6IFtdLFxuICAgICAgICByZWNlbnRDcml0aWNhbDogW10sXG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgbW9uaXRvcmluZyBkYXRhXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGdldE1vbml0b3JpbmdEYXRhKCk6IFByb21pc2U8e1xuICAgIHBlcmZvcm1hbmNlOiBhbnk7XG4gICAgYWxlcnRzOiBBcnJheTx7XG4gICAgICBuYW1lOiBzdHJpbmc7XG4gICAgICBzZXZlcml0eTogc3RyaW5nO1xuICAgICAgbWVzc2FnZTogc3RyaW5nO1xuICAgICAgdGltZXN0YW1wOiBEYXRlO1xuICAgIH0+O1xuICB9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHBlcmZvcm1hbmNlID0gYXdhaXQgdGhpcy5tb25pdG9yaW5nU2VydmljZS5nZXRQZXJmb3JtYW5jZU1ldHJpY3MoJ2hvdXInKTtcbiAgICAgIGNvbnN0IGFsZXJ0cyA9IGF3YWl0IHRoaXMubW9uaXRvcmluZ1NlcnZpY2UuZ2V0UmVjZW50QWxlcnRzKDIwKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcGVyZm9ybWFuY2UsXG4gICAgICAgIGFsZXJ0czogYWxlcnRzLm1hcChhbGVydCA9PiAoe1xuICAgICAgICAgIG5hbWU6IGFsZXJ0Lm5hbWUsXG4gICAgICAgICAgc2V2ZXJpdHk6IGFsZXJ0LnNldmVyaXR5LFxuICAgICAgICAgIG1lc3NhZ2U6IGFsZXJ0Lm1lc3NhZ2UsXG4gICAgICAgICAgdGltZXN0YW1wOiBhbGVydC50aW1lc3RhbXAsXG4gICAgICAgIH0pKSxcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRmFpbGVkIHRvIGdldCBtb25pdG9yaW5nIGRhdGE6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcGVyZm9ybWFuY2U6IHRoaXMuZ2V0RGVmYXVsdFBlcmZvcm1hbmNlTWV0cmljcygpLFxuICAgICAgICBhbGVydHM6IFtdLFxuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IHJ1bGUgc2V2ZXJpdHlcbiAgICovXG4gIHByaXZhdGUgZ2V0UnVsZVNldmVyaXR5KHJ1bGVOYW1lOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IHNldmVyaXR5TWFwOiB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9ID0ge1xuICAgICAgU1FMX0lOSkVDVElPTjogJ2NyaXRpY2FsJyxcbiAgICAgIFhTU19BVFRBQ0s6ICdjcml0aWNhbCcsXG4gICAgICBDT01NQU5EX0lOSkVDVElPTjogJ2NyaXRpY2FsJyxcbiAgICAgIFBBVEhfVFJBVkVSU0FMOiAnaGlnaCcsXG4gICAgICBTU1JGX0FUVEFDSzogJ2hpZ2gnLFxuICAgICAgRklMRV9JTkNMVVNJT046ICdoaWdoJyxcbiAgICAgIEJVRkZFUl9PVkVSRkxPVzogJ21lZGl1bScsXG4gICAgICBIRUFERVJfSU5KRUNUSU9OOiAnbWVkaXVtJyxcbiAgICAgIFBBUkFNRVRFUl9QT0xMVVRJT046ICdsb3cnLFxuICAgIH07XG5cbiAgICByZXR1cm4gc2V2ZXJpdHlNYXBbcnVsZU5hbWVdIHx8ICdtZWRpdW0nO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBkZWZhdWx0IHBlcmZvcm1hbmNlIG1ldHJpY3NcbiAgICovXG4gIHByaXZhdGUgZ2V0RGVmYXVsdFBlcmZvcm1hbmNlTWV0cmljcygpOiBhbnkge1xuICAgIHJldHVybiB7XG4gICAgICByZXNwb25zZVRpbWU6IHsgYXZnOiAwLCBtaW46IDAsIG1heDogMCwgcDUwOiAwLCBwOTU6IDAsIHA5OTogMCB9LFxuICAgICAgdGhyb3VnaHB1dDogeyByZXF1ZXN0c1BlclNlY29uZDogMCwgcmVxdWVzdHNQZXJNaW51dGU6IDAsIHJlcXVlc3RzUGVySG91cjogMCB9LFxuICAgICAgZXJyb3JSYXRlOiB7IHRvdGFsOiAwLCBwZXJjZW50YWdlOiAwLCBieVN0YXR1czoge30gfSxcbiAgICAgIHJlc291cmNlVXNhZ2U6IHsgY3B1OiAwLCBtZW1vcnk6IDAsIGRpc2s6IDAsIG5ldHdvcms6IHsgaW5ib3VuZDogMCwgb3V0Ym91bmQ6IDAgfSB9LFxuICAgICAgZGF0YWJhc2U6IHsgY29ubmVjdGlvbnM6IDAsIHF1ZXJ5VGltZTogeyBhdmc6IDAsIHNsb3c6IDAgfSwgY2FjaGVIaXRSYXRlOiAwIH0sXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgZGVmYXVsdCBkYXNoYm9hcmQgZGF0YVxuICAgKi9cbiAgcHJpdmF0ZSBnZXREZWZhdWx0RGFzaGJvYXJkRGF0YSgpOiBTZWN1cml0eURhc2hib2FyZERhdGEge1xuICAgIHJldHVybiB7XG4gICAgICBvdmVydmlldzoge1xuICAgICAgICBzeXN0ZW1IZWFsdGg6ICdoZWFsdGh5JyxcbiAgICAgICAgdG90YWxBbGVydHM6IDAsXG4gICAgICAgIGNyaXRpY2FsQWxlcnRzOiAwLFxuICAgICAgICBhY3RpdmVUaHJlYXRzOiAwLFxuICAgICAgICBsYXN0U2NhbjogbmV3IERhdGUoKSxcbiAgICAgIH0sXG4gICAgICB3YWY6IHtcbiAgICAgICAgc3RhdHM6IHsgdG90YWxSZXF1ZXN0czogMCwgYmxvY2tlZFJlcXVlc3RzOiAwLCB3YXJuaW5nczogMCwgcnVsZXNUcmlnZ2VyZWQ6IHt9IH0sXG4gICAgICAgIHJlY2VudEJsb2NrczogMCxcbiAgICAgICAgdG9wQXR0YWNrczogW10sXG4gICAgICAgIGJsb2NrZWRJUHM6IFtdLFxuICAgICAgfSxcbiAgICAgIG1hbHdhcmU6IHtcbiAgICAgICAgc3RhdHM6IHsgdG90YWxTY2FuczogMCwgaW5mZWN0ZWRGaWxlczogMCwgcXVhcmFudGluZWRGaWxlczogMCwgYXZlcmFnZVNjYW5UaW1lOiAwIH0sXG4gICAgICAgIHF1YXJhbnRpbmVkRmlsZXM6IDAsXG4gICAgICAgIHJlY2VudERldGVjdGlvbnM6IFtdLFxuICAgICAgfSxcbiAgICAgIHR3b0ZhY3Rvcjoge1xuICAgICAgICBzdGF0czogeyB0b3RhbFVzZXJzOiAwLCBlbmFibGVkVXNlcnM6IDAsIG1ldGhvZERpc3RyaWJ1dGlvbjoge30sIHJlY2VudFZlcmlmaWNhdGlvbnM6IDAgfSxcbiAgICAgICAgZW5hYmxlZFVzZXJzOiAwLFxuICAgICAgICByZWNlbnRWZXJpZmljYXRpb25zOiAwLFxuICAgICAgfSxcbiAgICAgIHRocmVhdEludGVsOiB7XG4gICAgICAgIHN0YXRzOiB7XG4gICAgICAgICAgdG90YWxGZWVkczogMCxcbiAgICAgICAgICBhY3RpdmVGZWVkczogMCxcbiAgICAgICAgICB0b3RhbEFsZXJ0czogMCxcbiAgICAgICAgICBhbGVydHNCeVNldmVyaXR5OiB7fSxcbiAgICAgICAgICBhbGVydHNCeVR5cGU6IHt9LFxuICAgICAgICAgIHJlY2VudEFsZXJ0czogMCxcbiAgICAgICAgfSxcbiAgICAgICAgcmVjZW50QWxlcnRzOiBbXSxcbiAgICAgIH0sXG4gICAgICBiZWhhdmlvcjoge1xuICAgICAgICBzdGF0czoge1xuICAgICAgICAgIHRvdGFsUHJvZmlsZXM6IDAsXG4gICAgICAgICAgZW5hYmxlZFVzZXJzOiAwLFxuICAgICAgICAgIGFub21hbGllc0J5VHlwZToge30sXG4gICAgICAgICAgYW5vbWFsaWVzQnlTZXZlcml0eToge30sXG4gICAgICAgICAgYXZlcmFnZVJpc2tTY29yZTogMCxcbiAgICAgICAgICBoaWdoUmlza1VzZXJzOiAwLFxuICAgICAgICB9LFxuICAgICAgICBoaWdoUmlza1VzZXJzOiAwLFxuICAgICAgICByZWNlbnRBbm9tYWxpZXM6IFtdLFxuICAgICAgfSxcbiAgICAgIGxvZ3M6IHtcbiAgICAgICAgc3RhdHM6IHtcbiAgICAgICAgICB0b3RhbExvZ3M6IDAsXG4gICAgICAgICAgbG9nc0J5TGV2ZWw6IHt9LFxuICAgICAgICAgIGxvZ3NCeVNlcnZpY2U6IHt9LFxuICAgICAgICAgIGVycm9yUmF0ZTogMCxcbiAgICAgICAgICBhdmVyYWdlUmVzcG9uc2VUaW1lOiAwLFxuICAgICAgICB9LFxuICAgICAgICByZWNlbnRFcnJvcnM6IFtdLFxuICAgICAgICByZWNlbnRDcml0aWNhbDogW10sXG4gICAgICB9LFxuICAgICAgbW9uaXRvcmluZzoge1xuICAgICAgICBwZXJmb3JtYW5jZTogdGhpcy5nZXREZWZhdWx0UGVyZm9ybWFuY2VNZXRyaWNzKCksXG4gICAgICAgIGFsZXJ0czogW10sXG4gICAgICB9LFxuICAgICAgYmFja3VwOiB7XG4gICAgICAgIHN0YXRzOiB7XG4gICAgICAgICAgdG90YWxCYWNrdXBzOiAwLFxuICAgICAgICAgIHN1Y2Nlc3NmdWxCYWNrdXBzOiAwLFxuICAgICAgICAgIGZhaWxlZEJhY2t1cHM6IDAsXG4gICAgICAgICAgdG90YWxTaXplOiAwLFxuICAgICAgICAgIGF2ZXJhZ2VTaXplOiAwLFxuICAgICAgICAgIGJhY2t1cHNCeVR5cGU6IHt9LFxuICAgICAgICAgIHJlY2VudEJhY2t1cHM6IFtdLFxuICAgICAgICB9LFxuICAgICAgICByZWNlbnRKb2JzOiBbXSxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgcmVhbC10aW1lIHNlY3VyaXR5IG1ldHJpY3NcbiAgICovXG4gIHB1YmxpYyBhc3luYyBnZXRSZWFsVGltZU1ldHJpY3MoKTogUHJvbWlzZTx7XG4gICAgdGltZXN0YW1wOiBEYXRlO1xuICAgIHRocmVhdHNCbG9ja2VkOiBudW1iZXI7XG4gICAgc2NhbnNDb21wbGV0ZWQ6IG51bWJlcjtcbiAgICBhdXRoZW50aWNhdGlvbkF0dGVtcHRzOiBudW1iZXI7XG4gICAgYWN0aXZlU2Vzc2lvbnM6IG51bWJlcjtcbiAgICBzeXN0ZW1Mb2FkOiB7XG4gICAgICBjcHU6IG51bWJlcjtcbiAgICAgIG1lbW9yeTogbnVtYmVyO1xuICAgICAgZGlzazogbnVtYmVyO1xuICAgIH07XG4gIH0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcGVyZm9ybWFuY2UgPSBhd2FpdCB0aGlzLm1vbml0b3JpbmdTZXJ2aWNlLmdldFBlcmZvcm1hbmNlTWV0cmljcygnbWludXRlJyk7XG4gICAgICBjb25zdCB3YWZTdGF0cyA9IHRoaXMud2FmU2VydmljZS5nZXRNZXRyaWNzKCk7XG4gICAgICBjb25zdCBtYWx3YXJlU3RhdHMgPSB0aGlzLm1hbHdhcmVTY2FubmVyLmdldFNjYW5TdGF0cygpO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICAgIHRocmVhdHNCbG9ja2VkOiB3YWZTdGF0cy5ibG9ja2VkUmVxdWVzdHMsXG4gICAgICAgIHNjYW5zQ29tcGxldGVkOiBtYWx3YXJlU3RhdHMudG90YWxTY2FucyxcbiAgICAgICAgYXV0aGVudGljYXRpb25BdHRlbXB0czogMCwgLy8gV291bGQgdHJhY2sgZnJvbSBhdXRoIHNlcnZpY2VcbiAgICAgICAgYWN0aXZlU2Vzc2lvbnM6IDAsIC8vIFdvdWxkIHRyYWNrIGZyb20gc2Vzc2lvbiBzZXJ2aWNlXG4gICAgICAgIHN5c3RlbUxvYWQ6IHBlcmZvcm1hbmNlLnJlc291cmNlVXNhZ2UsXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0ZhaWxlZCB0byBnZXQgcmVhbC10aW1lIG1ldHJpY3M6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgICB0aHJlYXRzQmxvY2tlZDogMCxcbiAgICAgICAgc2NhbnNDb21wbGV0ZWQ6IDAsXG4gICAgICAgIGF1dGhlbnRpY2F0aW9uQXR0ZW1wdHM6IDAsXG4gICAgICAgIGFjdGl2ZVNlc3Npb25zOiAwLFxuICAgICAgICBzeXN0ZW1Mb2FkOiB7IGNwdTogMCwgbWVtb3J5OiAwLCBkaXNrOiAwIH0sXG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgc2VjdXJpdHkgaW5jaWRlbnRzXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgZ2V0U2VjdXJpdHlJbmNpZGVudHMobGltaXQ6IG51bWJlciA9IDUwKTogUHJvbWlzZTxcbiAgICBBcnJheTx7XG4gICAgICBpZDogc3RyaW5nO1xuICAgICAgdHlwZTogc3RyaW5nO1xuICAgICAgc2V2ZXJpdHk6IHN0cmluZztcbiAgICAgIHRpdGxlOiBzdHJpbmc7XG4gICAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICAgICAgdGltZXN0YW1wOiBEYXRlO1xuICAgICAgc3RhdHVzOiAnb3BlbicgfCAnaW52ZXN0aWdhdGluZycgfCAncmVzb2x2ZWQnIHwgJ2Nsb3NlZCc7XG4gICAgICBhc3NpZ25lZFRvPzogc3RyaW5nO1xuICAgICAgdGFnczogc3RyaW5nW107XG4gICAgfT5cbiAgPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFRoaXMgd291bGQgaW50ZWdyYXRlIHdpdGggYW4gaW5jaWRlbnQgbWFuYWdlbWVudCBzeXN0ZW1cbiAgICAgIC8vIEZvciBub3csIHJldHVybiByZWNlbnQgYWxlcnRzIGFzIGluY2lkZW50c1xuICAgICAgY29uc3QgdGhyZWF0cyA9IGF3YWl0IHRoaXMudGhyZWF0SW50ZWxTZXJ2aWNlLmdldFJlY2VudEFsZXJ0cyhsaW1pdCk7XG4gICAgICBjb25zdCB3YWZCbG9ja3MgPSB0aGlzLndhZlNlcnZpY2UuZ2V0TWV0cmljcygpO1xuICAgICAgY29uc3QgbWFsd2FyZURldGVjdGlvbnMgPSBhd2FpdCB0aGlzLm1hbHdhcmVTY2FubmVyLmdldFF1YXJhbnRpbmVkRmlsZXMoKTtcblxuICAgICAgY29uc3QgaW5jaWRlbnRzID0gW1xuICAgICAgICAuLi50aHJlYXRzLm1hcCh0aHJlYXQgPT4gKHtcbiAgICAgICAgICBpZDogdGhyZWF0LmlkLFxuICAgICAgICAgIHR5cGU6ICd0aHJlYXRfZGV0ZWN0ZWQnLFxuICAgICAgICAgIHNldmVyaXR5OiB0aHJlYXQuc2V2ZXJpdHksXG4gICAgICAgICAgdGl0bGU6IGBUaHJlYXQgRGV0ZWN0ZWQ6ICR7dGhyZWF0LnR5cGV9YCxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogdGhyZWF0LmRlc2NyaXB0aW9uLFxuICAgICAgICAgIHRpbWVzdGFtcDogdGhyZWF0LnRpbWVzdGFtcCxcbiAgICAgICAgICBzdGF0dXM6ICdvcGVuJyBhcyBjb25zdCxcbiAgICAgICAgICB0YWdzOiBbdGhyZWF0LnR5cGUsIHRocmVhdC5zZXZlcml0eV0sXG4gICAgICAgIH0pKSxcbiAgICAgICAgLi4uQXJyYXkuZnJvbSh7IGxlbmd0aDogTWF0aC5taW4oMTAsIHdhZkJsb2Nrcy5ibG9ja2VkUmVxdWVzdHMpIH0sIChfLCBpbmRleCkgPT4gKHtcbiAgICAgICAgICBpZDogYHdhZl9ibG9ja18ke2luZGV4fWAsXG4gICAgICAgICAgdHlwZTogJ3dhZl9ibG9jaycsXG4gICAgICAgICAgc2V2ZXJpdHk6ICdtZWRpdW0nIGFzIGNvbnN0LFxuICAgICAgICAgIHRpdGxlOiAnV0FGIEJsb2NrJyxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogYFJlcXVlc3QgYmxvY2tlZCBieSBXQUY6ICR7d2FmQmxvY2tzLnRvcEF0dGFja3NbaW5kZXhdPy5ydWxlIHx8ICdVbmtub3duJ31gLFxuICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgICAgICBzdGF0dXM6ICdyZXNvbHZlZCcgYXMgY29uc3QsXG4gICAgICAgICAgdGFnczogWyd3YWYnLCAnc2VjdXJpdHknXSxcbiAgICAgICAgfSkpLFxuICAgICAgICAuLi5tYWx3YXJlRGV0ZWN0aW9ucy5zbGljZSgwLCAxMCkubWFwKChmaWxlLCBpbmRleCkgPT4gKHtcbiAgICAgICAgICBpZDogYG1hbHdhcmVfJHtpbmRleH1gLFxuICAgICAgICAgIHR5cGU6ICdtYWx3YXJlX2RldGVjdGVkJyxcbiAgICAgICAgICBzZXZlcml0eTogJ2hpZ2gnIGFzIGNvbnN0LFxuICAgICAgICAgIHRpdGxlOiAnTWFsd2FyZSBEZXRlY3RlZCcsXG4gICAgICAgICAgZGVzY3JpcHRpb246IGBNYWx3YXJlIGZvdW5kIGluOiAke2ZpbGUub3JpZ2luYWxQYXRofWAsXG4gICAgICAgICAgdGltZXN0YW1wOiBmaWxlLnF1YXJhbnRpbmVkQXQsXG4gICAgICAgICAgc3RhdHVzOiAnb3BlbicgYXMgY29uc3QsXG4gICAgICAgICAgdGFnczogWydtYWx3YXJlJywgJ3NlY3VyaXR5J10sXG4gICAgICAgIH0pKSxcbiAgICAgIF1cbiAgICAgICAgLnNvcnQoKGEsIGIpID0+IGIudGltZXN0YW1wLmdldFRpbWUoKSAtIGEudGltZXN0YW1wLmdldFRpbWUoKSlcbiAgICAgICAgLnNsaWNlKDAsIGxpbWl0KTtcblxuICAgICAgcmV0dXJuIGluY2lkZW50cztcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdGYWlsZWQgdG8gZ2V0IHNlY3VyaXR5IGluY2lkZW50czonLCBlcnJvcik7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBzZWN1cml0eSBzY29yZVxuICAgKi9cbiAgcHVibGljIGFzeW5jIGdldFNlY3VyaXR5U2NvcmUoKTogUHJvbWlzZTx7XG4gICAgb3ZlcmFsbDogbnVtYmVyO1xuICAgIGNhdGVnb3JpZXM6IHtcbiAgICAgIHdhZjogbnVtYmVyO1xuICAgICAgbWFsd2FyZTogbnVtYmVyO1xuICAgICAgYXV0aGVudGljYXRpb246IG51bWJlcjtcbiAgICAgIG1vbml0b3Jpbmc6IG51bWJlcjtcbiAgICAgIGJhY2t1cDogbnVtYmVyO1xuICAgIH07XG4gICAgcmVjb21tZW5kYXRpb25zOiBzdHJpbmdbXTtcbiAgfT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBvdmVydmlldyA9IGF3YWl0IHRoaXMuZ2V0T3ZlcnZpZXdEYXRhKCk7XG4gICAgICBjb25zdCB3YWZNZXRyaWNzID0gdGhpcy53YWZTZXJ2aWNlLmdldE1ldHJpY3MoKTsgLy8gUmVuYW1lZCBmcm9tIHdhZlN0YXRzXG4gICAgICBjb25zdCBtYWx3YXJlU3RhdHMgPSB0aGlzLm1hbHdhcmVTY2FubmVyLmdldFNjYW5TdGF0cygpO1xuICAgICAgY29uc3QgdHdvRmFjdG9yU3RhdHMgPSBhd2FpdCB0aGlzLnR3b0ZhY3RvclNlcnZpY2UuZ2V0U3RhdHMoKTtcbiAgICAgIGNvbnN0IG1vbml0b3JpbmdPdmVydmlldyA9IHRoaXMubW9uaXRvcmluZ1NlcnZpY2UuZ2V0TWV0cmljc092ZXJ2aWV3KCk7XG4gICAgICBjb25zdCBiYWNrdXBTdGF0cyA9IGF3YWl0IHRoaXMuYmFja3VwU2VydmljZS5nZXRTdGF0cygpO1xuXG4gICAgICAvLyBDYWxjdWxhdGUgc2NvcmVzIGZvciBlYWNoIGNhdGVnb3J5XG4gICAgICBjb25zdCB3YWZTY29yZSA9IHRoaXMuY2FsY3VsYXRlQ2F0ZWdvcnlTY29yZSh3YWZNZXRyaWNzKTsgLy8gQ29ycmVjdGVkIHZhcmlhYmxlIG5hbWVcbiAgICAgIGNvbnN0IG1hbHdhcmVTY29yZSA9IHRoaXMuY2FsY3VsYXRlQ2F0ZWdvcnlTY29yZShtYWx3YXJlU3RhdHMpO1xuICAgICAgY29uc3QgYXV0aFNjb3JlID0gdGhpcy5jYWxjdWxhdGVDYXRlZ29yeVNjb3JlKHR3b0ZhY3RvclN0YXRzKTtcbiAgICAgIGNvbnN0IG1vbml0b3JpbmdTY29yZSA9IHRoaXMuY2FsY3VsYXRlQ2F0ZWdvcnlTY29yZShtb25pdG9yaW5nT3ZlcnZpZXcpO1xuICAgICAgY29uc3QgYmFja3VwU2NvcmUgPSB0aGlzLmNhbGN1bGF0ZUNhdGVnb3J5U2NvcmUoYmFja3VwU3RhdHMpO1xuXG4gICAgICBjb25zdCBvdmVyYWxsID0gTWF0aC5yb3VuZChcbiAgICAgICAgKHdhZlNjb3JlICsgbWFsd2FyZVNjb3JlICsgYXV0aFNjb3JlICsgbW9uaXRvcmluZ1Njb3JlICsgYmFja3VwU2NvcmUpIC8gNSxcbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHJlY29tbWVuZGF0aW9ucyA9IHRoaXMuZ2VuZXJhdGVSZWNvbW1lbmRhdGlvbnMoe1xuICAgICAgICB3YWY6IHdhZlNjb3JlLFxuICAgICAgICBtYWx3YXJlOiBtYWx3YXJlU2NvcmUsXG4gICAgICAgIGF1dGg6IGF1dGhTY29yZSxcbiAgICAgICAgbW9uaXRvcmluZzogbW9uaXRvcmluZ1Njb3JlLFxuICAgICAgICBiYWNrdXA6IGJhY2t1cFNjb3JlLFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIG92ZXJhbGwsXG4gICAgICAgIGNhdGVnb3JpZXM6IHtcbiAgICAgICAgICB3YWY6IHdhZlNjb3JlLFxuICAgICAgICAgIG1hbHdhcmU6IG1hbHdhcmVTY29yZSxcbiAgICAgICAgICBhdXRoZW50aWNhdGlvbjogYXV0aFNjb3JlLFxuICAgICAgICAgIG1vbml0b3Jpbmc6IG1vbml0b3JpbmdTY29yZSxcbiAgICAgICAgICBiYWNrdXA6IGJhY2t1cFNjb3JlLFxuICAgICAgICB9LFxuICAgICAgICByZWNvbW1lbmRhdGlvbnMsXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0ZhaWxlZCB0byBnZXQgc2VjdXJpdHkgc2NvcmU6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgb3ZlcmFsbDogMCxcbiAgICAgICAgY2F0ZWdvcmllczoge1xuICAgICAgICAgIHdhZjogMCxcbiAgICAgICAgICBtYWx3YXJlOiAwLFxuICAgICAgICAgIGF1dGhlbnRpY2F0aW9uOiAwLFxuICAgICAgICAgIG1vbml0b3Jpbmc6IDAsXG4gICAgICAgICAgYmFja3VwOiAwLFxuICAgICAgICB9LFxuICAgICAgICByZWNvbW1lbmRhdGlvbnM6IFtdLFxuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ2FsY3VsYXRlIGNhdGVnb3J5IHNjb3JlXG4gICAqL1xuICBwcml2YXRlIGNhbGN1bGF0ZUNhdGVnb3J5U2NvcmUoc3RhdHM6IGFueSk6IG51bWJlciB7XG4gICAgLy8gU2ltcGxlIHNjb3JpbmcgYWxnb3JpdGhtIC0gd291bGQgYmUgbW9yZSBzb3BoaXN0aWNhdGVkIGluIHByb2R1Y3Rpb25cbiAgICBsZXQgc2NvcmUgPSA1MDsgLy8gQmFzZSBzY29yZVxuXG4gICAgaWYgKHN0YXRzLnRvdGFsUmVxdWVzdHMgPiAwKSB7XG4gICAgICBjb25zdCBibG9ja1JhdGUgPSBzdGF0cy5ibG9ja2VkUmVxdWVzdHMgLyBzdGF0cy50b3RhbFJlcXVlc3RzO1xuICAgICAgaWYgKGJsb2NrUmF0ZSA+IDAuMDUpIHNjb3JlIC09IDIwO1xuICAgICAgaWYgKGJsb2NrUmF0ZSA+IDAuMSkgc2NvcmUgLT0gMzA7XG4gICAgfVxuXG4gICAgaWYgKHN0YXRzLmVuYWJsZWRVc2VycyA+IDApIHtcbiAgICAgIHNjb3JlICs9IDIwO1xuICAgIH1cblxuICAgIGlmIChzdGF0cy50b3RhbFNjYW5zID4gMCkge1xuICAgICAgY29uc3QgaW5mZWN0aW9uUmF0ZSA9IHN0YXRzLmluZmVjdGVkRmlsZXMgLyBzdGF0cy50b3RhbFNjYW5zO1xuICAgICAgaWYgKGluZmVjdGlvblJhdGUgPT09IDApIHNjb3JlICs9IDIwO1xuICAgICAgaWYgKGluZmVjdGlvblJhdGUgPCAwLjAxKSBzY29yZSArPSAxMDtcbiAgICB9XG5cbiAgICByZXR1cm4gTWF0aC5tYXgoMCwgTWF0aC5taW4oMTAwLCBzY29yZSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIHJlY29tbWVuZGF0aW9uc1xuICAgKi9cbiAgcHJpdmF0ZSBnZW5lcmF0ZVJlY29tbWVuZGF0aW9ucyhzY29yZXM6IHtcbiAgICB3YWY6IG51bWJlcjtcbiAgICBtYWx3YXJlOiBudW1iZXI7XG4gICAgYXV0aDogbnVtYmVyO1xuICAgIG1vbml0b3Jpbmc6IG51bWJlcjtcbiAgICBiYWNrdXA6IG51bWJlcjtcbiAgfSk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCByZWNvbW1lbmRhdGlvbnM6IHN0cmluZ1tdID0gW107XG5cbiAgICBpZiAoc2NvcmVzLndhZiA8IDcwKSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnQ29uc2lkZXIgZW5hYmxpbmcgbW9yZSBXQUYgcnVsZXMgb3IgYWRqdXN0aW5nIHNlbnNpdGl2aXR5Jyk7XG4gICAgfVxuICAgIGlmIChzY29yZXMubWFsd2FyZSA8IDcwKSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnVXBkYXRlIG1hbHdhcmUgc2lnbmF0dXJlcyBhbmQgc2NhbiBtb3JlIGZyZXF1ZW50bHknKTtcbiAgICB9XG4gICAgaWYgKHNjb3Jlcy5hdXRoIDwgNzApIHtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdFbmNvdXJhZ2UgdXNlcnMgdG8gZW5hYmxlIDJGQSBmb3IgYmV0dGVyIHNlY3VyaXR5Jyk7XG4gICAgfVxuICAgIGlmIChzY29yZXMubW9uaXRvcmluZyA8IDcwKSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnU2V0IHVwIG1vcmUgY29tcHJlaGVuc2l2ZSBtb25pdG9yaW5nIGFuZCBhbGVydGluZycpO1xuICAgIH1cbiAgICBpZiAoc2NvcmVzLmJhY2t1cCA8IDcwKSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnRW5zdXJlIHJlZ3VsYXIgYmFja3VwcyBhcmUgc2NoZWR1bGVkIGFuZCB0ZXN0ZWQnKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVjb21tZW5kYXRpb25zO1xuICB9XG5cbiAgLyoqXG4gICAqIEV4cG9ydCBkYXNoYm9hcmQgZGF0YVxuICAgKi9cbiAgcHVibGljIGFzeW5jIGV4cG9ydERhc2hib2FyZERhdGEoZm9ybWF0OiAnanNvbicgfCAnY3N2JyA9ICdqc29uJyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLmdldERhc2hib2FyZERhdGEoKTtcblxuICAgICAgaWYgKGZvcm1hdCA9PT0gJ2pzb24nKSB7XG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShkYXRhLCBudWxsLCAyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIENvbnZlcnQgdG8gQ1NWXG4gICAgICAgIGNvbnN0IGNzdkRhdGEgPSB0aGlzLmNvbnZlcnRUb0NTVihkYXRhKTtcbiAgICAgICAgcmV0dXJuIGNzdkRhdGE7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRmFpbGVkIHRvIGV4cG9ydCBkYXNoYm9hcmQgZGF0YTonLCBlcnJvcik7XG4gICAgICByZXR1cm4gJyc7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENvbnZlcnQgdG8gQ1NWIGZvcm1hdFxuICAgKi9cbiAgcHJpdmF0ZSBjb252ZXJ0VG9DU1YoZGF0YTogU2VjdXJpdHlEYXNoYm9hcmREYXRhKTogc3RyaW5nIHtcbiAgICBjb25zdCBoZWFkZXJzID0gWydDYXRlZ29yeScsICdNZXRyaWMnLCAnVmFsdWUnLCAnVGltZXN0YW1wJywgJ1N0YXR1cyddO1xuXG4gICAgY29uc3Qgcm93cyA9IFtcbiAgICAgIGhlYWRlcnMsXG4gICAgICBbJ092ZXJ2aWV3JywgJ1N5c3RlbSBIZWFsdGgnLCBkYXRhLm92ZXJ2aWV3LnN5c3RlbUhlYWx0aCwgbmV3IERhdGUoKS50b0lTT1N0cmluZygpLCAnJ10sXG4gICAgICBbJ092ZXJ2aWV3JywgJ1RvdGFsIEFsZXJ0cycsIGRhdGEub3ZlcnZpZXcudG90YWxBbGVydHMsIG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSwgJyddLFxuICAgICAgWydPdmVydmlldycsICdDcml0aWNhbCBBbGVydHMnLCBkYXRhLm92ZXJ2aWV3LmNyaXRpY2FsQWxlcnRzLCBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksICcnXSxcbiAgICAgIFsnT3ZlcnZpZXcnLCAnQWN0aXZlIFRocmVhdHMnLCBkYXRhLm92ZXJ2aWV3LmFjdGl2ZVRocmVhdHMsIG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSwgJyddLFxuICAgICAgWydXQUYnLCAnQmxvY2tlZCBSZXF1ZXN0cycsIGRhdGEud2FmLnN0YXRzLmJsb2NrZWRSZXF1ZXN0cywgbmV3IERhdGUoKS50b0lTT1N0cmluZygpLCAnJ10sXG4gICAgICBbJ1dBRicsICdUb3RhbCBSZXF1ZXN0cycsIGRhdGEud2FmLnN0YXRzLnRvdGFsUmVxdWVzdHMsIG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSwgJyddLFxuICAgICAgWydNYWx3YXJlJywgJ1F1YXJhbnRpbmVkIEZpbGVzJywgZGF0YS5tYWx3YXJlLnF1YXJhbnRpbmVkRmlsZXMsIG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSwgJyddLFxuICAgICAgWydNYWx3YXJlJywgJ1RvdGFsIFNjYW5zJywgZGF0YS5tYWx3YXJlLnN0YXRzLnRvdGFsU2NhbnMsIG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSwgJyddLFxuICAgICAgWycyRkEnLCAnRW5hYmxlZCBVc2VycycsIGRhdGEudHdvRmFjdG9yLmVuYWJsZWRVc2VycywgbmV3IERhdGUoKS50b0lTT1N0cmluZygpLCAnJ10sXG4gICAgICBbXG4gICAgICAgICdUaHJlYXQgSW50ZWwnLFxuICAgICAgICAnVG90YWwgQWxlcnRzJyxcbiAgICAgICAgZGF0YS50aHJlYXRJbnRlbC5zdGF0cy50b3RhbEFsZXJ0cyxcbiAgICAgICAgbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAnJyxcbiAgICAgIF0sXG4gICAgICBbJ0JlaGF2aW9yJywgJ0hpZ2ggUmlzayBVc2VycycsIGRhdGEuYmVoYXZpb3IuaGlnaFJpc2tVc2VycywgbmV3IERhdGUoKS50b0lTT1N0cmluZygpLCAnJ10sXG4gICAgICBbJ0xvZ3MnLCAnVG90YWwgTG9ncycsIGRhdGEubG9ncy5zdGF0cy50b3RhbExvZ3MsIG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSwgJyddLFxuICAgICAgWydMb2dzJywgJ0Vycm9yIFJhdGUnLCBgJHtkYXRhLmxvZ3Muc3RhdHMuZXJyb3JSYXRlfSVgLCBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksICcnXSxcbiAgICAgIFsnTW9uaXRvcmluZycsICdBY3RpdmUgQWxlcnRzJywgZGF0YS5tb25pdG9yaW5nLmFsZXJ0cy5sZW5ndGgsIG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSwgJyddLFxuICAgICAgWydCYWNrdXAnLCAnVG90YWwgQmFja3VwcycsIGRhdGEuYmFja3VwLnN0YXRzLnRvdGFsQmFja3VwcywgbmV3IERhdGUoKS50b0lTT1N0cmluZygpLCAnJ10sXG4gICAgICBbXG4gICAgICAgICdCYWNrdXAnLFxuICAgICAgICAnU3VjY2VzcyBSYXRlJyxcbiAgICAgICAgYCR7KChkYXRhLmJhY2t1cC5zdGF0cy5zdWNjZXNzZnVsQmFja3VwcyAvIGRhdGEuYmFja3VwLnN0YXRzLnRvdGFsQmFja3VwcykgKiAxMDApLnRvRml4ZWQoXG4gICAgICAgICAgMSxcbiAgICAgICAgKX0lYCxcbiAgICAgICAgbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAnJyxcbiAgICAgIF0sXG4gICAgXTtcblxuICAgIHJldHVybiByb3dzLm1hcChyb3cgPT4gcm93LmpvaW4oJywnKSkuam9pbignXFxuJyk7XG4gIH1cbn1cbiJdLCJ2ZXJzaW9uIjozfQ==