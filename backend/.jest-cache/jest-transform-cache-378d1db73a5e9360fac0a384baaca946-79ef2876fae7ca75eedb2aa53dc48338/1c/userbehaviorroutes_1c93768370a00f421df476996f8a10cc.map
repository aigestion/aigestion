{"file":"C:\\Users\\Alejandro\\AIGestion\\backend\\src\\routes\\user-behavior.routes.ts","mappings":"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","names":[],"sources":["C:\\Users\\Alejandro\\AIGestion\\backend\\src\\routes\\user-behavior.routes.ts"],"sourcesContent":["import { Router } from 'express';\nimport { userBehaviorMiddleware } from '../middleware/user-behavior.middleware';\nimport { logger } from '../utils/logger';\n\nconst router = Router();\n\n/**\n * User Behavior Analysis Routes\n */\n\n// Get behavior statistics\nrouter.get('/stats', (req: any, res: any) => userBehaviorMiddleware.getStats(req, res));\n\n// Get user behavior profile\nrouter.get('/profile/:userId', (req: any, res: any) =>\n  userBehaviorMiddleware.getUserProfile(req as any, res),\n);\n\n// Get user anomalies\nrouter.get('/anomalies/:userId', (req: any, res: any) =>\n  userBehaviorMiddleware.getUserAnomalies(req as any, res),\n);\n\n// Get recent anomalies\nrouter.get('/anomalies', (req: any, res: any) =>\n  userBehaviorMiddleware.getRecentAnomalies(req, res),\n);\n\n// Resolve anomaly\nrouter.post('/anomalies/:anomalyId/resolve', (req: any, res: any) =>\n  userBehaviorMiddleware.resolveAnomaly(req, res),\n);\n\n// Track custom behavior event\nrouter.post('/track', async (req: any, res: any) => {\n  try {\n    const { userId, eventType, metadata } = req.body;\n\n    if (!userId || !eventType) {\n      return res.status(400).json({\n        success: false,\n        error: 'userId and eventType are required',\n      });\n    }\n\n    // Create mock request for behavior tracking\n    const mockReq = {\n      user: { id: userId, email: 'unknown@example.com' },\n      ip: req.ip || 'unknown',\n      get: (header: string) => req.get(header),\n      path: req.path,\n      method: req.method,\n      query: req.query,\n      body: metadata || {},\n    } as any;\n\n    // Create mock response\n    const mockRes = {\n      setHeader: () => {},\n    } as any;\n\n    // Apply behavior tracking\n    await new Promise<void>(resolve => {\n      userBehaviorMiddleware.trackBehavior(eventType as any)(mockReq as any, mockRes as any, () =>\n        resolve(),\n      );\n    });\n\n    res.json({\n      success: true,\n      message: 'Behavior event tracked successfully',\n    });\n  } catch (error) {\n    logger.error('Error tracking behavior event:', error);\n    res.status(500).json({\n      success: false,\n      error: 'Failed to track behavior event',\n    });\n  }\n});\n\n// Get behavior health\nrouter.get('/health', (req: any, res: any) => {\n  try {\n    const health = {\n      status: 'healthy',\n      service: 'user-behavior-analysis',\n      timestamp: new Date().toISOString(),\n    };\n\n    res.json({\n      success: true,\n      data: health,\n    });\n  } catch (error) {\n    logger.error('Error getting behavior health:', error);\n    res.status(500).json({\n      success: false,\n      error: 'Failed to get behavior health',\n    });\n  }\n});\n\nexport default router;\n"],"version":3}