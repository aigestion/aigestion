{"file":"C:\\Users\\Alejandro\\AIGestion\\backend\\src\\__tests__\\services\\email.service.test.ts","mappings":";;;;;AAEA,2CAAqC;AAQrC,mFAAmF;AACnF,cAAI,CAAC,IAAI,CAAC,YAAY,EAAE,GAAG,EAAE;IAC3B,OAAO;QACL,eAAe,EAAE,cAAI,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC;YAC9B,QAAQ,EAAE,YAAY;YACtB,MAAM,EAAE,UAAU;SACnB,CAAC,CAAC;KACJ,CAAC;AACJ,CAAC,CAAC,CAAC;AAlBH,4BAA0B;AAG1B,4DAAoC;AACpC,oEAAiE;AAGjE,MAAM,YAAY,GAAG,cAAI,CAAC,EAAE,EAAE,CAAC;AAC/B,MAAM,UAAU,GAAG,cAAI,CAAC,EAAE,EAAE,CAAC;AAY7B,QAAQ,CAAC,cAAc,EAAE,GAAG,EAAE;IAC5B,IAAI,OAAqB,CAAC;IAE1B,UAAU,CAAC,GAAG,EAAE;QACd,cAAI,CAAC,aAAa,EAAE,CAAC;QACrB,OAAO,GAAG,4BAAS,CAAC,GAAG,CAAe,wBAAK,CAAC,YAAY,CAAC,CAAC;IAC5D,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,6CAA6C,EAAE,GAAG,EAAE;QACrD,MAAM,CAAC,oBAAU,CAAC,eAAe,CAAC,CAAC,gBAAgB,EAAE,CAAC;IACxD,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,kBAAkB,EAAE,GAAG,EAAE;QAChC,EAAE,CAAC,+BAA+B,EAAE,KAAK,IAAI,EAAE;YAC7C,UAAU,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC;YACnC,MAAM,MAAM,GAAG,MAAM,OAAO,CAAC,gBAAgB,EAAE,CAAC;YAChD,MAAM,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC5B,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,gCAAgC,EAAE,KAAK,IAAI,EAAE;YAC9C,UAAU,CAAC,iBAAiB,CAAC,IAAI,KAAK,CAAC,mBAAmB,CAAC,CAAC,CAAC;YAC7D,MAAM,MAAM,GAAG,MAAM,OAAO,CAAC,gBAAgB,EAAE,CAAC;YAChD,MAAM,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAC7B,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,WAAW,EAAE,GAAG,EAAE;QACzB,EAAE,CAAC,gCAAgC,EAAE,KAAK,IAAI,EAAE;YAC9C,YAAY,CAAC,iBAAiB,CAAC,EAAE,SAAS,EAAE,SAAS,EAAE,CAAC,CAAC;YACzD,MAAM,OAAO,CAAC,SAAS,CAAC;gBACtB,EAAE,EAAE,kBAAkB;gBACtB,OAAO,EAAE,cAAc;gBACvB,IAAI,EAAE,WAAW;aAClB,CAAC,CAAC;YACH,MAAM,CAAC,YAAY,CAAC,CAAC,oBAAoB,CACvC,MAAM,CAAC,gBAAgB,CAAC;gBACtB,EAAE,EAAE,kBAAkB;gBACtB,OAAO,EAAE,cAAc;gBACvB,IAAI,EAAE,WAAW;aAClB,CAAC,CACH,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,gCAAgC,EAAE,KAAK,IAAI,EAAE;YAC9C,YAAY,CAAC,iBAAiB,CAAC,IAAI,KAAK,CAAC,aAAa,CAAC,CAAC,CAAC;YACzD,MAAM,MAAM,GAAG,MAAM,OAAO,CAAC,SAAS,CAAC,EAAE,EAAE,EAAE,MAAM,EAAE,OAAO,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC,CAAC;YACtF,MAAM,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAC7B,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","names":[],"sources":["C:\\Users\\Alejandro\\AIGestion\\backend\\src\\__tests__\\services\\email.service.test.ts"],"sourcesContent":["import 'reflect-metadata';\n\nimport { jest } from '@jest/globals';\nimport nodemailer from 'nodemailer';\nimport { container, TYPES } from '../../config/inversify.config';\nimport { EmailService } from '../../services/email.service';\n\nconst mockSendMail = jest.fn();\nconst mockVerify = jest.fn();\n\n// Move mock implementation to allow accessing variables (or use factory correctly)\njest.mock('nodemailer', () => {\n  return {\n    createTransport: jest.fn(() => ({\n      sendMail: mockSendMail,\n      verify: mockVerify,\n    })),\n  };\n});\n\ndescribe('EmailService', () => {\n  let service: EmailService;\n\n  beforeEach(() => {\n    jest.clearAllMocks();\n    service = container.get<EmailService>(TYPES.EmailService);\n  });\n\n  it('should create transporter on initialization', () => {\n    expect(nodemailer.createTransport).toHaveBeenCalled();\n  });\n\n  describe('verifyConnection', () => {\n    it('should return true on success', async () => {\n      mockVerify.mockResolvedValue(true);\n      const result = await service.verifyConnection();\n      expect(result).toBe(true);\n    });\n\n    it('should return false on failure', async () => {\n      mockVerify.mockRejectedValue(new Error('Connection failed'));\n      const result = await service.verifyConnection();\n      expect(result).toBe(false);\n    });\n  });\n\n  describe('sendEmail', () => {\n    it('should send email successfully', async () => {\n      mockSendMail.mockResolvedValue({ messageId: 'test-id' });\n      await service.sendEmail({\n        to: 'test@example.com',\n        subject: 'Test Subject',\n        html: 'Test Body',\n      });\n      expect(mockSendMail).toHaveBeenCalledWith(\n        expect.objectContaining({\n          to: 'test@example.com',\n          subject: 'Test Subject',\n          html: 'Test Body',\n        }),\n      );\n    });\n\n    it('should return false on failure', async () => {\n      mockSendMail.mockRejectedValue(new Error('Send failed'));\n      const result = await service.sendEmail({ to: 'test', subject: 'test', html: 'test' });\n      expect(result).toBe(false);\n    });\n  });\n});\n"],"version":3}