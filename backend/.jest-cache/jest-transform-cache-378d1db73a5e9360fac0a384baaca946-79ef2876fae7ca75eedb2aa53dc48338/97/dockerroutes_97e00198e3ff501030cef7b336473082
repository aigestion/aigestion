01cb3194c82181657a05de9827a28918
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
// src/routes/docker.routes.ts
const express_1 = require("express");
const inversify_config_1 = require("../config/inversify.config");
const types_1 = require("../types");
const router = (0, express_1.Router)();
const dockerService = inversify_config_1.container.get(types_1.TYPES.DockerService);
/**
 * @openapi
 * /docker/containers:
 *   get:
 *     summary: List all Docker containers
 *     tags: [Docker]
 *     responses:
 *       200:
 *         description: List of containers
 *         content:
 *           application/json:
 *             schema:
 *               type: object
 *               properties:
 *                 data:
 *                   type: array
 *                   items:
 *                     type: object
 *       500:
 *         description: Docker error
 */
// GET /docker/containers - list all containers
router.get('/containers', async (_req, res) => {
    try {
        const containers = await dockerService.getContainers();
        res.json({ data: containers });
    }
    catch (err) {
        const message = err instanceof Error ? err.message : 'Docker error';
        res.status(500).json({ error: message });
    }
});
/**
 * @openapi
 * /docker/containers/{id}/stats:
 *   get:
 *     summary: Get stats for a specific container
 *     tags: [Docker]
 *     parameters:
 *       - in: path
 *         name: id
 *         required: true
 *         schema:
 *           type: string
 *         description: Container ID
 *     responses:
 *       200:
 *         description: Container stats
 *       500:
 *         description: Docker error
 */
// GET /docker/containers/:id/stats - get stats for a container
router.get('/containers/:id/stats', async (req, res) => {
    const { id } = req.params;
    try {
        const stats = await dockerService.getContainerStats(id);
        res.json({ data: stats });
    }
    catch (err) {
        const message = err instanceof Error ? err.message : 'Docker error';
        res.status(500).json({ error: message });
    }
});
/**
 * @openapi
 * /docker/containers/{id}/start:
 *   post:
 *     summary: Start a specific container
 *     tags: [Docker]
 *     parameters:
 *       - in: path
 *         name: id
 *         required: true
 *         schema:
 *           type: string
 *         description: Container ID
 *     responses:
 *       200:
 *         description: Container started
 *       500:
 *         description: Docker error
 */
// POST /docker/containers/:id/start - start a container
router.post('/containers/:id/start', async (req, res) => {
    const { id } = req.params;
    try {
        await dockerService.startContainer(id);
        res.json({ message: `Container ${id} started` });
    }
    catch (err) {
        const message = err instanceof Error ? err.message : 'Docker error';
        res.status(500).json({ error: message });
    }
});
/**
 * @openapi
 * /docker/containers/{id}/stop:
 *   post:
 *     summary: Stop a specific container
 *     tags: [Docker]
 *     parameters:
 *       - in: path
 *         name: id
 *         required: true
 *         schema:
 *           type: string
 *         description: Container ID
 *     responses:
 *       200:
 *         description: Container stopped
 *       500:
 *         description: Docker error
 */
// POST /docker/containers/:id/stop - stop a container
router.post('/containers/:id/stop', async (req, res) => {
    const { id } = req.params;
    try {
        await dockerService.stopContainer(id);
        res.json({ message: `Container ${id} stopped` });
    }
    catch (err) {
        const message = err instanceof Error ? err.message : 'Docker error';
        res.status(500).json({ error: message });
    }
});
exports.default = router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxBbGVqYW5kcm9cXEFJR2VzdGlvblxcYmFja2VuZFxcc3JjXFxyb3V0ZXNcXGRvY2tlci5yb3V0ZXMudHMiLCJtYXBwaW5ncyI6Ijs7QUFBQSw4QkFBOEI7QUFDOUIscUNBQWlDO0FBQ2pDLGlFQUF1RDtBQUN2RCxvQ0FBaUM7QUFHakMsTUFBTSxNQUFNLEdBQUcsSUFBQSxnQkFBTSxHQUFFLENBQUM7QUFDeEIsTUFBTSxhQUFhLEdBQUcsNEJBQVMsQ0FBQyxHQUFHLENBQWdCLGFBQUssQ0FBQyxhQUFhLENBQUMsQ0FBQztBQUV4RTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7R0FvQkc7QUFDSCwrQ0FBK0M7QUFDL0MsTUFBTSxDQUFDLEdBQUcsQ0FBQyxhQUFhLEVBQUUsS0FBSyxFQUFFLElBQVMsRUFBRSxHQUFRLEVBQUUsRUFBRTtJQUN0RCxJQUFJLENBQUM7UUFDSCxNQUFNLFVBQVUsR0FBRyxNQUFNLGFBQWEsQ0FBQyxhQUFhLEVBQUUsQ0FBQztRQUN2RCxHQUFHLENBQUMsSUFBSSxDQUFDLEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRSxDQUFDLENBQUM7SUFDakMsQ0FBQztJQUFDLE9BQU8sR0FBRyxFQUFFLENBQUM7UUFDYixNQUFNLE9BQU8sR0FBRyxHQUFHLFlBQVksS0FBSyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxjQUFjLENBQUM7UUFDcEUsR0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxLQUFLLEVBQUUsT0FBTyxFQUFFLENBQUMsQ0FBQztJQUMzQyxDQUFDO0FBQ0gsQ0FBQyxDQUFDLENBQUM7QUFFSDs7Ozs7Ozs7Ozs7Ozs7Ozs7O0dBa0JHO0FBQ0gsK0RBQStEO0FBQy9ELE1BQU0sQ0FBQyxHQUFHLENBQUMsdUJBQXVCLEVBQUUsS0FBSyxFQUFFLEdBQVEsRUFBRSxHQUFRLEVBQUUsRUFBRTtJQUMvRCxNQUFNLEVBQUUsRUFBRSxFQUFFLEdBQUcsR0FBRyxDQUFDLE1BQXdCLENBQUM7SUFDNUMsSUFBSSxDQUFDO1FBQ0gsTUFBTSxLQUFLLEdBQUcsTUFBTSxhQUFhLENBQUMsaUJBQWlCLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDeEQsR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDO0lBQzVCLENBQUM7SUFBQyxPQUFPLEdBQUcsRUFBRSxDQUFDO1FBQ2IsTUFBTSxPQUFPLEdBQUcsR0FBRyxZQUFZLEtBQUssQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsY0FBYyxDQUFDO1FBQ3BFLEdBQUcsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRSxDQUFDLENBQUM7SUFDM0MsQ0FBQztBQUNILENBQUMsQ0FBQyxDQUFDO0FBRUg7Ozs7Ozs7Ozs7Ozs7Ozs7OztHQWtCRztBQUNILHdEQUF3RDtBQUN4RCxNQUFNLENBQUMsSUFBSSxDQUFDLHVCQUF1QixFQUFFLEtBQUssRUFBRSxHQUFRLEVBQUUsR0FBUSxFQUFFLEVBQUU7SUFDaEUsTUFBTSxFQUFFLEVBQUUsRUFBRSxHQUFHLEdBQUcsQ0FBQyxNQUF3QixDQUFDO0lBQzVDLElBQUksQ0FBQztRQUNILE1BQU0sYUFBYSxDQUFDLGNBQWMsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUN2QyxHQUFHLENBQUMsSUFBSSxDQUFDLEVBQUUsT0FBTyxFQUFFLGFBQWEsRUFBRSxVQUFVLEVBQUUsQ0FBQyxDQUFDO0lBQ25ELENBQUM7SUFBQyxPQUFPLEdBQUcsRUFBRSxDQUFDO1FBQ2IsTUFBTSxPQUFPLEdBQUcsR0FBRyxZQUFZLEtBQUssQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsY0FBYyxDQUFDO1FBQ3BFLEdBQUcsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRSxDQUFDLENBQUM7SUFDM0MsQ0FBQztBQUNILENBQUMsQ0FBQyxDQUFDO0FBRUg7Ozs7Ozs7Ozs7Ozs7Ozs7OztHQWtCRztBQUNILHNEQUFzRDtBQUN0RCxNQUFNLENBQUMsSUFBSSxDQUFDLHNCQUFzQixFQUFFLEtBQUssRUFBRSxHQUFRLEVBQUUsR0FBUSxFQUFFLEVBQUU7SUFDL0QsTUFBTSxFQUFFLEVBQUUsRUFBRSxHQUFHLEdBQUcsQ0FBQyxNQUF3QixDQUFDO0lBQzVDLElBQUksQ0FBQztRQUNILE1BQU0sYUFBYSxDQUFDLGFBQWEsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUN0QyxHQUFHLENBQUMsSUFBSSxDQUFDLEVBQUUsT0FBTyxFQUFFLGFBQWEsRUFBRSxVQUFVLEVBQUUsQ0FBQyxDQUFDO0lBQ25ELENBQUM7SUFBQyxPQUFPLEdBQUcsRUFBRSxDQUFDO1FBQ2IsTUFBTSxPQUFPLEdBQUcsR0FBRyxZQUFZLEtBQUssQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsY0FBYyxDQUFDO1FBQ3BFLEdBQUcsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRSxDQUFDLENBQUM7SUFDM0MsQ0FBQztBQUNILENBQUMsQ0FBQyxDQUFDO0FBRUgsa0JBQWUsTUFBTSxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcQWxlamFuZHJvXFxBSUdlc3Rpb25cXGJhY2tlbmRcXHNyY1xccm91dGVzXFxkb2NrZXIucm91dGVzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9yb3V0ZXMvZG9ja2VyLnJvdXRlcy50c1xuaW1wb3J0IHsgUm91dGVyIH0gZnJvbSAnZXhwcmVzcyc7XG5pbXBvcnQgeyBjb250YWluZXIgfSBmcm9tICcuLi9jb25maWcvaW52ZXJzaWZ5LmNvbmZpZyc7XG5pbXBvcnQgeyBUWVBFUyB9IGZyb20gJy4uL3R5cGVzJztcbmltcG9ydCB7IERvY2tlclNlcnZpY2UgfSBmcm9tICcuLi9pbmZyYXN0cnVjdHVyZS9kb2NrZXIvRG9ja2VyU2VydmljZSc7XG5cbmNvbnN0IHJvdXRlciA9IFJvdXRlcigpO1xuY29uc3QgZG9ja2VyU2VydmljZSA9IGNvbnRhaW5lci5nZXQ8RG9ja2VyU2VydmljZT4oVFlQRVMuRG9ja2VyU2VydmljZSk7XG5cbi8qKlxuICogQG9wZW5hcGlcbiAqIC9kb2NrZXIvY29udGFpbmVyczpcbiAqICAgZ2V0OlxuICogICAgIHN1bW1hcnk6IExpc3QgYWxsIERvY2tlciBjb250YWluZXJzXG4gKiAgICAgdGFnczogW0RvY2tlcl1cbiAqICAgICByZXNwb25zZXM6XG4gKiAgICAgICAyMDA6XG4gKiAgICAgICAgIGRlc2NyaXB0aW9uOiBMaXN0IG9mIGNvbnRhaW5lcnNcbiAqICAgICAgICAgY29udGVudDpcbiAqICAgICAgICAgICBhcHBsaWNhdGlvbi9qc29uOlxuICogICAgICAgICAgICAgc2NoZW1hOlxuICogICAgICAgICAgICAgICB0eXBlOiBvYmplY3RcbiAqICAgICAgICAgICAgICAgcHJvcGVydGllczpcbiAqICAgICAgICAgICAgICAgICBkYXRhOlxuICogICAgICAgICAgICAgICAgICAgdHlwZTogYXJyYXlcbiAqICAgICAgICAgICAgICAgICAgIGl0ZW1zOlxuICogICAgICAgICAgICAgICAgICAgICB0eXBlOiBvYmplY3RcbiAqICAgICAgIDUwMDpcbiAqICAgICAgICAgZGVzY3JpcHRpb246IERvY2tlciBlcnJvclxuICovXG4vLyBHRVQgL2RvY2tlci9jb250YWluZXJzIC0gbGlzdCBhbGwgY29udGFpbmVyc1xucm91dGVyLmdldCgnL2NvbnRhaW5lcnMnLCBhc3luYyAoX3JlcTogYW55LCByZXM6IGFueSkgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IGNvbnRhaW5lcnMgPSBhd2FpdCBkb2NrZXJTZXJ2aWNlLmdldENvbnRhaW5lcnMoKTtcbiAgICByZXMuanNvbih7IGRhdGE6IGNvbnRhaW5lcnMgfSk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBlcnIgaW5zdGFuY2VvZiBFcnJvciA/IGVyci5tZXNzYWdlIDogJ0RvY2tlciBlcnJvcic7XG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogbWVzc2FnZSB9KTtcbiAgfVxufSk7XG5cbi8qKlxuICogQG9wZW5hcGlcbiAqIC9kb2NrZXIvY29udGFpbmVycy97aWR9L3N0YXRzOlxuICogICBnZXQ6XG4gKiAgICAgc3VtbWFyeTogR2V0IHN0YXRzIGZvciBhIHNwZWNpZmljIGNvbnRhaW5lclxuICogICAgIHRhZ3M6IFtEb2NrZXJdXG4gKiAgICAgcGFyYW1ldGVyczpcbiAqICAgICAgIC0gaW46IHBhdGhcbiAqICAgICAgICAgbmFtZTogaWRcbiAqICAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAqICAgICAgICAgc2NoZW1hOlxuICogICAgICAgICAgIHR5cGU6IHN0cmluZ1xuICogICAgICAgICBkZXNjcmlwdGlvbjogQ29udGFpbmVyIElEXG4gKiAgICAgcmVzcG9uc2VzOlxuICogICAgICAgMjAwOlxuICogICAgICAgICBkZXNjcmlwdGlvbjogQ29udGFpbmVyIHN0YXRzXG4gKiAgICAgICA1MDA6XG4gKiAgICAgICAgIGRlc2NyaXB0aW9uOiBEb2NrZXIgZXJyb3JcbiAqL1xuLy8gR0VUIC9kb2NrZXIvY29udGFpbmVycy86aWQvc3RhdHMgLSBnZXQgc3RhdHMgZm9yIGEgY29udGFpbmVyXG5yb3V0ZXIuZ2V0KCcvY29udGFpbmVycy86aWQvc3RhdHMnLCBhc3luYyAocmVxOiBhbnksIHJlczogYW55KSA9PiB7XG4gIGNvbnN0IHsgaWQgfSA9IHJlcS5wYXJhbXMgYXMgeyBpZDogc3RyaW5nIH07XG4gIHRyeSB7XG4gICAgY29uc3Qgc3RhdHMgPSBhd2FpdCBkb2NrZXJTZXJ2aWNlLmdldENvbnRhaW5lclN0YXRzKGlkKTtcbiAgICByZXMuanNvbih7IGRhdGE6IHN0YXRzIH0pO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICBjb25zdCBtZXNzYWdlID0gZXJyIGluc3RhbmNlb2YgRXJyb3IgPyBlcnIubWVzc2FnZSA6ICdEb2NrZXIgZXJyb3InO1xuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6IG1lc3NhZ2UgfSk7XG4gIH1cbn0pO1xuXG4vKipcbiAqIEBvcGVuYXBpXG4gKiAvZG9ja2VyL2NvbnRhaW5lcnMve2lkfS9zdGFydDpcbiAqICAgcG9zdDpcbiAqICAgICBzdW1tYXJ5OiBTdGFydCBhIHNwZWNpZmljIGNvbnRhaW5lclxuICogICAgIHRhZ3M6IFtEb2NrZXJdXG4gKiAgICAgcGFyYW1ldGVyczpcbiAqICAgICAgIC0gaW46IHBhdGhcbiAqICAgICAgICAgbmFtZTogaWRcbiAqICAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAqICAgICAgICAgc2NoZW1hOlxuICogICAgICAgICAgIHR5cGU6IHN0cmluZ1xuICogICAgICAgICBkZXNjcmlwdGlvbjogQ29udGFpbmVyIElEXG4gKiAgICAgcmVzcG9uc2VzOlxuICogICAgICAgMjAwOlxuICogICAgICAgICBkZXNjcmlwdGlvbjogQ29udGFpbmVyIHN0YXJ0ZWRcbiAqICAgICAgIDUwMDpcbiAqICAgICAgICAgZGVzY3JpcHRpb246IERvY2tlciBlcnJvclxuICovXG4vLyBQT1NUIC9kb2NrZXIvY29udGFpbmVycy86aWQvc3RhcnQgLSBzdGFydCBhIGNvbnRhaW5lclxucm91dGVyLnBvc3QoJy9jb250YWluZXJzLzppZC9zdGFydCcsIGFzeW5jIChyZXE6IGFueSwgcmVzOiBhbnkpID0+IHtcbiAgY29uc3QgeyBpZCB9ID0gcmVxLnBhcmFtcyBhcyB7IGlkOiBzdHJpbmcgfTtcbiAgdHJ5IHtcbiAgICBhd2FpdCBkb2NrZXJTZXJ2aWNlLnN0YXJ0Q29udGFpbmVyKGlkKTtcbiAgICByZXMuanNvbih7IG1lc3NhZ2U6IGBDb250YWluZXIgJHtpZH0gc3RhcnRlZGAgfSk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBlcnIgaW5zdGFuY2VvZiBFcnJvciA/IGVyci5tZXNzYWdlIDogJ0RvY2tlciBlcnJvcic7XG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogbWVzc2FnZSB9KTtcbiAgfVxufSk7XG5cbi8qKlxuICogQG9wZW5hcGlcbiAqIC9kb2NrZXIvY29udGFpbmVycy97aWR9L3N0b3A6XG4gKiAgIHBvc3Q6XG4gKiAgICAgc3VtbWFyeTogU3RvcCBhIHNwZWNpZmljIGNvbnRhaW5lclxuICogICAgIHRhZ3M6IFtEb2NrZXJdXG4gKiAgICAgcGFyYW1ldGVyczpcbiAqICAgICAgIC0gaW46IHBhdGhcbiAqICAgICAgICAgbmFtZTogaWRcbiAqICAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAqICAgICAgICAgc2NoZW1hOlxuICogICAgICAgICAgIHR5cGU6IHN0cmluZ1xuICogICAgICAgICBkZXNjcmlwdGlvbjogQ29udGFpbmVyIElEXG4gKiAgICAgcmVzcG9uc2VzOlxuICogICAgICAgMjAwOlxuICogICAgICAgICBkZXNjcmlwdGlvbjogQ29udGFpbmVyIHN0b3BwZWRcbiAqICAgICAgIDUwMDpcbiAqICAgICAgICAgZGVzY3JpcHRpb246IERvY2tlciBlcnJvclxuICovXG4vLyBQT1NUIC9kb2NrZXIvY29udGFpbmVycy86aWQvc3RvcCAtIHN0b3AgYSBjb250YWluZXJcbnJvdXRlci5wb3N0KCcvY29udGFpbmVycy86aWQvc3RvcCcsIGFzeW5jIChyZXE6IGFueSwgcmVzOiBhbnkpID0+IHtcbiAgY29uc3QgeyBpZCB9ID0gcmVxLnBhcmFtcyBhcyB7IGlkOiBzdHJpbmcgfTtcbiAgdHJ5IHtcbiAgICBhd2FpdCBkb2NrZXJTZXJ2aWNlLnN0b3BDb250YWluZXIoaWQpO1xuICAgIHJlcy5qc29uKHsgbWVzc2FnZTogYENvbnRhaW5lciAke2lkfSBzdG9wcGVkYCB9KTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgY29uc3QgbWVzc2FnZSA9IGVyciBpbnN0YW5jZW9mIEVycm9yID8gZXJyLm1lc3NhZ2UgOiAnRG9ja2VyIGVycm9yJztcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiBtZXNzYWdlIH0pO1xuICB9XG59KTtcblxuZXhwb3J0IGRlZmF1bHQgcm91dGVyO1xuIl0sInZlcnNpb24iOjN9