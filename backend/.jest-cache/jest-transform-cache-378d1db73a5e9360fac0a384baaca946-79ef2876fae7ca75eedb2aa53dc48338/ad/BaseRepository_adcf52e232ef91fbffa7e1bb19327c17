35c70d16826d86d17babc1e958d3eb4c
"use strict";
// src/infrastructure/repository/BaseRepository.ts
Object.defineProperty(exports, "__esModule", { value: true });
exports.BaseRepository = void 0;
class BaseRepository {
    items = new Map();
    // Supports both create(item) and create(id, item)
    async create(idOrItem, maybeItem) {
        let item;
        if (typeof idOrItem === 'string' && maybeItem) {
            // Ensure the item has the correct id
            maybeItem.id = idOrItem;
            item = maybeItem;
        }
        else {
            item = idOrItem;
        }
        this.items.set(item.id, item);
        return item;
    }
    async findAll() {
        return Array.from(this.items.values());
    }
    async findById(id) {
        return this.items.get(id) ?? null;
    }
    async update(id, data) {
        const existing = this.items.get(id);
        if (!existing) {
            return null;
        }
        const updated = { ...existing, ...data };
        this.items.set(id, updated);
        return updated;
    }
    async delete(id) {
        return this.items.delete(id);
    }
}
exports.BaseRepository = BaseRepository;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxBbGVqYW5kcm9cXEFJR2VzdGlvblxcYmFja2VuZFxcc3JjXFxpbmZyYXN0cnVjdHVyZVxccmVwb3NpdG9yeVxcQmFzZVJlcG9zaXRvcnkudHMiLCJtYXBwaW5ncyI6IjtBQUFBLGtEQUFrRDs7O0FBTWxELE1BQWEsY0FBYztJQUNqQixLQUFLLEdBQUcsSUFBSSxHQUFHLEVBQWEsQ0FBQztJQUVyQyxrREFBa0Q7SUFDbEQsS0FBSyxDQUFDLE1BQU0sQ0FBQyxRQUFvQixFQUFFLFNBQWE7UUFDOUMsSUFBSSxJQUFPLENBQUM7UUFDWixJQUFJLE9BQU8sUUFBUSxLQUFLLFFBQVEsSUFBSSxTQUFTLEVBQUUsQ0FBQztZQUM5QyxxQ0FBcUM7WUFDcEMsU0FBaUIsQ0FBQyxFQUFFLEdBQUcsUUFBUSxDQUFDO1lBQ2pDLElBQUksR0FBRyxTQUFTLENBQUM7UUFDbkIsQ0FBQzthQUFNLENBQUM7WUFDTixJQUFJLEdBQUcsUUFBYSxDQUFDO1FBQ3ZCLENBQUM7UUFDRCxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsRUFBRSxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQzlCLE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQztJQUVELEtBQUssQ0FBQyxPQUFPO1FBQ1gsT0FBTyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQztJQUN6QyxDQUFDO0lBRUQsS0FBSyxDQUFDLFFBQVEsQ0FBQyxFQUFVO1FBQ3ZCLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLElBQUksSUFBSSxDQUFDO0lBQ3BDLENBQUM7SUFFRCxLQUFLLENBQUMsTUFBTSxDQUFDLEVBQVUsRUFBRSxJQUFnQjtRQUN2QyxNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUNwQyxJQUFJLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDZCxPQUFPLElBQUksQ0FBQztRQUNkLENBQUM7UUFDRCxNQUFNLE9BQU8sR0FBRyxFQUFFLEdBQUcsUUFBUSxFQUFFLEdBQUcsSUFBSSxFQUFPLENBQUM7UUFDOUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsRUFBRSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQzVCLE9BQU8sT0FBTyxDQUFDO0lBQ2pCLENBQUM7SUFFRCxLQUFLLENBQUMsTUFBTSxDQUFDLEVBQVU7UUFDckIsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUMvQixDQUFDO0NBQ0Y7QUF0Q0Qsd0NBc0NDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcQWxlamFuZHJvXFxBSUdlc3Rpb25cXGJhY2tlbmRcXHNyY1xcaW5mcmFzdHJ1Y3R1cmVcXHJlcG9zaXRvcnlcXEJhc2VSZXBvc2l0b3J5LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9pbmZyYXN0cnVjdHVyZS9yZXBvc2l0b3J5L0Jhc2VSZXBvc2l0b3J5LnRzXG5cbmV4cG9ydCBpbnRlcmZhY2UgSUVudGl0eSB7XG4gIGlkOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjbGFzcyBCYXNlUmVwb3NpdG9yeTxUIGV4dGVuZHMgSUVudGl0eT4ge1xuICBwcml2YXRlIGl0ZW1zID0gbmV3IE1hcDxzdHJpbmcsIFQ+KCk7XG5cbiAgLy8gU3VwcG9ydHMgYm90aCBjcmVhdGUoaXRlbSkgYW5kIGNyZWF0ZShpZCwgaXRlbSlcbiAgYXN5bmMgY3JlYXRlKGlkT3JJdGVtOiBzdHJpbmcgfCBULCBtYXliZUl0ZW0/OiBUKTogUHJvbWlzZTxUPiB7XG4gICAgbGV0IGl0ZW06IFQ7XG4gICAgaWYgKHR5cGVvZiBpZE9ySXRlbSA9PT0gJ3N0cmluZycgJiYgbWF5YmVJdGVtKSB7XG4gICAgICAvLyBFbnN1cmUgdGhlIGl0ZW0gaGFzIHRoZSBjb3JyZWN0IGlkXG4gICAgICAobWF5YmVJdGVtIGFzIGFueSkuaWQgPSBpZE9ySXRlbTtcbiAgICAgIGl0ZW0gPSBtYXliZUl0ZW07XG4gICAgfSBlbHNlIHtcbiAgICAgIGl0ZW0gPSBpZE9ySXRlbSBhcyBUO1xuICAgIH1cbiAgICB0aGlzLml0ZW1zLnNldChpdGVtLmlkLCBpdGVtKTtcbiAgICByZXR1cm4gaXRlbTtcbiAgfVxuXG4gIGFzeW5jIGZpbmRBbGwoKTogUHJvbWlzZTxUW10+IHtcbiAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLml0ZW1zLnZhbHVlcygpKTtcbiAgfVxuXG4gIGFzeW5jIGZpbmRCeUlkKGlkOiBzdHJpbmcpOiBQcm9taXNlPFQgfCBudWxsPiB7XG4gICAgcmV0dXJuIHRoaXMuaXRlbXMuZ2V0KGlkKSA/PyBudWxsO1xuICB9XG5cbiAgYXN5bmMgdXBkYXRlKGlkOiBzdHJpbmcsIGRhdGE6IFBhcnRpYWw8VD4pOiBQcm9taXNlPFQgfCBudWxsPiB7XG4gICAgY29uc3QgZXhpc3RpbmcgPSB0aGlzLml0ZW1zLmdldChpZCk7XG4gICAgaWYgKCFleGlzdGluZykge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGNvbnN0IHVwZGF0ZWQgPSB7IC4uLmV4aXN0aW5nLCAuLi5kYXRhIH0gYXMgVDtcbiAgICB0aGlzLml0ZW1zLnNldChpZCwgdXBkYXRlZCk7XG4gICAgcmV0dXJuIHVwZGF0ZWQ7XG4gIH1cblxuICBhc3luYyBkZWxldGUoaWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIHJldHVybiB0aGlzLml0ZW1zLmRlbGV0ZShpZCk7XG4gIH1cbn1cbiJdLCJ2ZXJzaW9uIjozfQ==