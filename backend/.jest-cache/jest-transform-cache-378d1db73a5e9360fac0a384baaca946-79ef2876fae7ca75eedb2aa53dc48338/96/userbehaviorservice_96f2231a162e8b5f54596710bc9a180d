cd58d3d7212f08085b065e65610f27a3
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.UserBehaviorService = void 0;
const inversify_1 = require("inversify");
const redis_1 = require("../cache/redis");
const logger_1 = require("../utils/logger");
let UserBehaviorService = class UserBehaviorService {
    redis;
    profileCache = new Map();
    cacheTimeout = 30 * 60; // 30 minutes
    baselinePeriod = 30 * 24 * 60 * 60 * 1000; // 30 days
    anomalies = [];
    maxAnomalies = 10000;
    constructor() {
        this.redis = (0, redis_1.getRedisClient)();
    }
    /**
     * Track user behavior event
     */
    async trackEvent(event) {
        try {
            // Store event in Redis
            const eventKey = `behavior:event:${event.userId}:${Date.now()}`;
            await this.redis.setEx(eventKey, 7 * 24 * 60 * 60, JSON.stringify(event)); // 7 days
            // Update user profile
            await this.updateUserProfile(event);
            // Check for anomalies
            await this.detectAnomalies(event);
            logger_1.logger.debug('User behavior event tracked', {
                userId: event.userId,
                eventType: event.eventType,
                timestamp: event.timestamp,
            });
        }
        catch (error) {
            logger_1.logger.error('Error tracking user behavior event:', error);
        }
    }
    /**
     * Update user behavior profile
     */
    async updateUserProfile(event) {
        try {
            let profile = await this.getUserProfile(event.userId);
            if (!profile) {
                profile = this.createInitialProfile(event.userId);
            }
            // Update current session
            this.updateCurrentSession(profile, event);
            // Update baseline with new data
            this.updateBaseline(profile, event);
            // Calculate risk score
            profile.riskScore = this.calculateRiskScore(profile);
            profile.lastUpdated = new Date();
            // Cache profile
            this.profileCache.set(event.userId, profile);
            await this.redis.setEx(`behavior:profile:${event.userId}`, this.cacheTimeout, JSON.stringify(profile));
            logger_1.logger.debug('User behavior profile updated', {
                userId: event.userId,
                riskScore: profile.riskScore,
            });
        }
        catch (error) {
            logger_1.logger.error('Error updating user profile:', error);
        }
    }
    /**
     * Specifically track malware detection events
     */
    async trackThreat(userId, filename, threats, ipAddress) {
        const event = {
            userId,
            eventType: 'malware_detected',
            timestamp: new Date(),
            ipAddress,
            userAgent: 'system-scanner',
            sessionId: 'security-alert',
            metadata: {
                filename,
                threats,
                priority: 'critical',
            },
        };
        await this.trackEvent(event);
    }
    /**
     * Get user behavior profile
     */
    async getUserProfile(userId) {
        try {
            // Check cache first
            if (this.profileCache.has(userId)) {
                return this.profileCache.get(userId);
            }
            // Get from Redis
            const cached = await this.redis.get(`behavior:profile:${userId}`);
            if (cached) {
                const profile = JSON.parse(cached);
                this.profileCache.set(userId, profile);
                return profile;
            }
            return null;
        }
        catch (error) {
            logger_1.logger.error('Error getting user profile:', { userId, error });
            return null;
        }
    }
    /**
     * Create initial user profile
     */
    createInitialProfile(userId) {
        return {
            userId,
            baseline: {
                typicalIPs: [],
                typicalUserAgents: [],
                typicalHours: [],
                typicalDays: [],
                apiCallFrequency: 0,
                errorRate: 0,
                sessionDuration: 0,
                dataAccessPatterns: [],
            },
            currentSession: {
                startTime: new Date(),
                ipAddress: '',
                userAgent: '',
                apiCalls: 0,
                errors: 0,
                dataAccess: [],
                unusualEvents: [],
            },
            riskScore: 0,
            lastUpdated: new Date(),
        };
    }
    /**
     * Update current session data
     */
    updateCurrentSession(profile, event) {
        const session = profile.currentSession;
        // Update session basics
        if (event.eventType === 'login') {
            session.startTime = event.timestamp;
            session.ipAddress = event.ipAddress;
            session.userAgent = event.userAgent;
            session.apiCalls = 0;
            session.errors = 0;
            session.dataAccess = [];
            session.unusualEvents = [];
        }
        // Update session counters
        switch (event.eventType) {
            case 'api_call':
                session.apiCalls++;
                break;
            case 'error':
            case 'permission_denied':
                session.errors++;
                break;
            case 'data_access':
                if (event.metadata.resource) {
                    session.dataAccess.push(event.metadata.resource);
                }
                break;
        }
        // Add unusual events
        if (event.metadata.unusual) {
            session.unusualEvents.push(event.eventType);
        }
    }
    /**
     * Update baseline with new data
     */
    updateBaseline(profile, event) {
        const baseline = profile.baseline;
        // Update typical IPs
        if (!baseline.typicalIPs.includes(event.ipAddress)) {
            baseline.typicalIPs.push(event.ipAddress);
            // Keep only last 20 IPs
            if (baseline.typicalIPs.length > 20) {
                baseline.typicalIPs = baseline.typicalIPs.slice(-20);
            }
        }
        // Update typical user agents
        if (!baseline.typicalUserAgents.includes(event.userAgent)) {
            baseline.typicalUserAgents.push(event.userAgent);
            // Keep only last 10 user agents
            if (baseline.typicalUserAgents.length > 10) {
                baseline.typicalUserAgents = baseline.typicalUserAgents.slice(-10);
            }
        }
        // Update typical hours
        const hour = event.timestamp.getHours();
        if (!baseline.typicalHours.includes(hour)) {
            baseline.typicalHours.push(hour);
            baseline.typicalHours.sort((a, b) => a - b);
        }
        // Update typical days
        const day = event.timestamp.getDay();
        if (!baseline.typicalDays.includes(day)) {
            baseline.typicalDays.push(day);
            baseline.typicalDays.sort((a, b) => a - b);
        }
        // Update data access patterns
        if (event.eventType === 'data_access' && event.metadata.resource) {
            if (!baseline.dataAccessPatterns.includes(event.metadata.resource)) {
                baseline.dataAccessPatterns.push(event.metadata.resource);
                // Keep only last 50 patterns
                if (baseline.dataAccessPatterns.length > 50) {
                    baseline.dataAccessPatterns = baseline.dataAccessPatterns.slice(-50);
                }
            }
        }
    }
    /**
     * Detect anomalies in user behavior
     */
    async detectAnomalies(event) {
        try {
            const profile = await this.getUserProfile(event.userId);
            if (!profile || profile.baseline.typicalIPs.length < 3) {
                // Not enough baseline data
                return;
            }
            const anomalies = [];
            // Check for new IP
            if (!profile.baseline.typicalIPs.includes(event.ipAddress)) {
                anomalies.push({
                    id: this.generateAnomalyId(),
                    userId: event.userId,
                    type: 'new_ip',
                    severity: 'medium',
                    description: `Login from new IP address: ${event.ipAddress}`,
                    detectedAt: new Date(),
                    metadata: {
                        newIP: event.ipAddress,
                        typicalIPs: profile.baseline.typicalIPs.slice(0, 5),
                    },
                    resolved: false,
                });
            }
            // Check for new user agent
            if (!profile.baseline.typicalUserAgents.includes(event.userAgent)) {
                anomalies.push({
                    id: this.generateAnomalyId(),
                    userId: event.userId,
                    type: 'new_user_agent',
                    severity: 'low',
                    description: 'Login from new user agent',
                    detectedAt: new Date(),
                    metadata: {
                        newUserAgent: event.userAgent,
                        typicalUserAgents: profile.baseline.typicalUserAgents.slice(0, 3),
                    },
                    resolved: false,
                });
            }
            // Check for unusual time
            const hour = event.timestamp.getHours();
            if (!profile.baseline.typicalHours.includes(hour) && event.eventType === 'login') {
                anomalies.push({
                    id: this.generateAnomalyId(),
                    userId: event.userId,
                    type: 'unusual_time',
                    severity: 'low',
                    description: `Login at unusual hour: ${hour}:00`,
                    detectedAt: new Date(),
                    metadata: {
                        hour,
                        typicalHours: profile.baseline.typicalHours,
                    },
                    resolved: false,
                });
            }
            // Check for high error rate
            if (profile.currentSession.errors > 5 && profile.currentSession.apiCalls > 0) {
                const errorRate = profile.currentSession.errors / profile.currentSession.apiCalls;
                if (errorRate > 0.2) {
                    // More than 20% errors
                    anomalies.push({
                        id: this.generateAnomalyId(),
                        userId: event.userId,
                        type: 'high_error_rate',
                        severity: 'high',
                        description: `High error rate: ${Math.round(errorRate * 100)}%`,
                        detectedAt: new Date(),
                        metadata: {
                            errorRate,
                            errors: profile.currentSession.errors,
                            apiCalls: profile.currentSession.apiCalls,
                        },
                        resolved: false,
                    });
                }
            }
            // Check for excessive API calls
            if (profile.currentSession.apiCalls > 1000) {
                anomalies.push({
                    id: this.generateAnomalyId(),
                    userId: event.userId,
                    type: 'excessive_api_calls',
                    severity: 'medium',
                    description: `Excessive API calls: ${profile.currentSession.apiCalls}`,
                    detectedAt: new Date(),
                    metadata: {
                        apiCalls: profile.currentSession.apiCalls,
                        sessionDuration: Date.now() - profile.currentSession.startTime.getTime(),
                    },
                    resolved: false,
                });
            }
            // Check for unusual data access
            if (event.eventType === 'data_access' && event.metadata.resource) {
                if (!profile.baseline.dataAccessPatterns.includes(event.metadata.resource)) {
                    anomalies.push({
                        id: this.generateAnomalyId(),
                        userId: event.userId,
                        type: 'unusual_data_access',
                        severity: 'medium',
                        description: `Access to unusual resource: ${event.metadata.resource}`,
                        detectedAt: new Date(),
                        metadata: {
                            resource: event.metadata.resource,
                            typicalPatterns: profile.baseline.dataAccessPatterns.slice(0, 5),
                        },
                        resolved: false,
                    });
                }
            }
            // Store anomalies
            for (const anomaly of anomalies) {
                await this.storeAnomaly(anomaly);
            }
        }
        catch (error) {
            logger_1.logger.error('Error detecting anomalies:', error);
        }
    }
    /**
     * Store anomaly
     */
    async storeAnomaly(anomaly) {
        try {
            // Add to memory
            this.anomalies.push(anomaly);
            // Keep only recent anomalies
            if (this.anomalies.length > this.maxAnomalies) {
                this.anomalies.splice(0, this.anomalies.length - this.maxAnomalies);
            }
            // Store in Redis
            await this.redis.setEx(`behavior:anomaly:${anomaly.id}`, 7 * 24 * 60 * 60, // 7 days
            JSON.stringify(anomaly));
            // Add to user anomalies list
            await this.redis.lPush(`behavior:anomalies:${anomaly.userId}`, JSON.stringify(anomaly));
            await this.redis.lTrim(`behavior:anomalies:${anomaly.userId}`, 0, 99); // Keep last 100
            // Log anomaly
            logger_1.logger.warn('User behavior anomaly detected', {
                userId: anomaly.userId,
                type: anomaly.type,
                severity: anomaly.severity,
                description: anomaly.description,
            });
        }
        catch (error) {
            logger_1.logger.error('Error storing anomaly:', error);
        }
    }
    /**
     * Calculate risk score
     */
    calculateRiskScore(profile) {
        let score = 0;
        // Base score
        score += 10;
        // Current session factors
        const session = profile.currentSession;
        // Error rate impact
        if (session.apiCalls > 0) {
            const errorRate = session.errors / session.apiCalls;
            score += errorRate * 30;
        }
        // Unusual events impact
        score += session.unusualEvents.length * 5;
        // API call frequency impact
        if (session.apiCalls > 500) {
            score += Math.min(session.apiCalls / 100, 20);
        }
        // Recent anomalies impact
        // Malware detections add 50 points immediately
        if (session.unusualEvents.includes('malware_detected')) {
            score += 50;
        }
        return Math.min(Math.round(score), 100);
    }
    /**
     * Get user anomalies
     */
    async getUserAnomalies(userId, limit = 50) {
        try {
            const anomalyData = await this.redis.lRange(`behavior:anomalies:${userId}`, 0, limit - 1);
            return anomalyData.map(data => JSON.parse(data));
        }
        catch (error) {
            logger_1.logger.error('Error getting user anomalies:', { userId, error });
            return [];
        }
    }
    /**
     * Get recent anomalies
     */
    async getRecentAnomalies(limit = 100) {
        try {
            return this.anomalies
                .sort((a, b) => b.detectedAt.getTime() - a.detectedAt.getTime())
                .slice(0, limit);
        }
        catch (error) {
            logger_1.logger.error('Error getting recent anomalies:', error);
            return [];
        }
    }
    /**
     * Resolve anomaly
     */
    async resolveAnomaly(anomalyId) {
        try {
            // Update in memory
            const anomaly = this.anomalies.find(a => a.id === anomalyId);
            if (anomaly) {
                anomaly.resolved = true;
            }
            // Update in Redis
            const cached = await this.redis.get(`behavior:anomaly:${anomalyId}`);
            if (cached) {
                const updatedAnomaly = JSON.parse(cached);
                updatedAnomaly.resolved = true;
                await this.redis.setEx(`behavior:anomaly:${anomalyId}`, 7 * 24 * 60 * 60, JSON.stringify(updatedAnomaly));
            }
            logger_1.logger.info('Anomaly resolved', { anomalyId });
            return true;
        }
        catch (error) {
            logger_1.logger.error('Error resolving anomaly:', { anomalyId, error });
            return false;
        }
    }
    /**
     * Get behavior statistics
     */
    async getStats() {
        try {
            const totalProfiles = this.profileCache.size;
            const totalAnomalies = this.anomalies.length;
            const anomaliesByType = {};
            const anomaliesBySeverity = {};
            this.anomalies.forEach(anomaly => {
                anomaliesByType[anomaly.type] = (anomaliesByType[anomaly.type] || 0) + 1;
                anomaliesBySeverity[anomaly.severity] = (anomaliesBySeverity[anomaly.severity] || 0) + 1;
            });
            const riskScores = Array.from(this.profileCache.values()).map(p => p.riskScore);
            const averageRiskScore = riskScores.length > 0
                ? riskScores.reduce((sum, score) => sum + score, 0) / riskScores.length
                : 0;
            const highRiskUsers = riskScores.filter(score => score > 70).length;
            return {
                totalProfiles,
                totalAnomalies,
                anomaliesByType,
                anomaliesBySeverity,
                averageRiskScore: Math.round(averageRiskScore),
                highRiskUsers,
            };
        }
        catch (error) {
            logger_1.logger.error('Error getting behavior stats:', error);
            return {
                totalProfiles: 0,
                totalAnomalies: 0,
                anomaliesByType: {},
                anomaliesBySeverity: {},
                averageRiskScore: 0,
                highRiskUsers: 0,
            };
        }
    }
    /**
     * Generate anomaly ID
     */
    generateAnomalyId() {
        return `anomaly_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
    }
    /**
     * Cleanup old data
     */
    async cleanup() {
        try {
            // Clean old profiles from cache
            const now = Date.now();
            for (const [userId, profile] of this.profileCache.entries()) {
                if (now - profile.lastUpdated.getTime() > this.cacheTimeout * 1000) {
                    this.profileCache.delete(userId);
                }
            }
            // Clean old anomalies from memory
            const cutoff = new Date(now - 7 * 24 * 60 * 60 * 1000); // 7 days ago
            this.anomalies.filter(anomaly => anomaly.detectedAt > cutoff);
            logger_1.logger.info('User behavior cleanup completed');
        }
        catch (error) {
            logger_1.logger.error('Error during cleanup:', error);
        }
    }
};
exports.UserBehaviorService = UserBehaviorService;
exports.UserBehaviorService = UserBehaviorService = __decorate([
    (0, inversify_1.injectable)(),
    __metadata("design:paramtypes", [])
], UserBehaviorService);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxBbGVqYW5kcm9cXEFJR2VzdGlvblxcYmFja2VuZFxcc3JjXFxzZXJ2aWNlc1xcdXNlci1iZWhhdmlvci5zZXJ2aWNlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUFBLHlDQUF1QztBQUV2QywwQ0FBZ0Q7QUFDaEQsNENBQXlDO0FBcUVsQyxJQUFNLG1CQUFtQixHQUF6QixNQUFNLG1CQUFtQjtJQUNiLEtBQUssQ0FBa0I7SUFDdkIsWUFBWSxHQUFHLElBQUksR0FBRyxFQUErQixDQUFDO0lBQ3RELFlBQVksR0FBRyxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUMsYUFBYTtJQUNyQyxjQUFjLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLElBQUksQ0FBQyxDQUFDLFVBQVU7SUFDckQsU0FBUyxHQUFzQixFQUFFLENBQUM7SUFDbEMsWUFBWSxHQUFHLEtBQUssQ0FBQztJQUV0QztRQUNFLElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBQSxzQkFBYyxHQUFFLENBQUM7SUFDaEMsQ0FBQztJQUVEOztPQUVHO0lBQ0ksS0FBSyxDQUFDLFVBQVUsQ0FBQyxLQUF3QjtRQUM5QyxJQUFJLENBQUM7WUFDSCx1QkFBdUI7WUFDdkIsTUFBTSxRQUFRLEdBQUcsa0JBQWtCLEtBQUssQ0FBQyxNQUFNLElBQUksSUFBSSxDQUFDLEdBQUcsRUFBRSxFQUFFLENBQUM7WUFDaEUsTUFBTSxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxRQUFRLEVBQUUsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVM7WUFFcEYsc0JBQXNCO1lBQ3RCLE1BQU0sSUFBSSxDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxDQUFDO1lBRXBDLHNCQUFzQjtZQUN0QixNQUFNLElBQUksQ0FBQyxlQUFlLENBQUMsS0FBSyxDQUFDLENBQUM7WUFFbEMsZUFB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QztZQUVELGtDQUFrQztZQUNsQyxNQUFNLE1BQU0sR0FBRyxJQUFJLElBQUksQ0FBQyxHQUFHLEdBQUcsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUMsYUFBYTtZQUNyRSxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLE9BQU8sQ0FBQyxVQUFVLEdBQUcsTUFBTSxDQUFDLENBQUM7WUFFOUQsZUFBTSxDQUFDLElBQUksQ0FBQyxpQ0FBaUMsQ0FBQyxDQUFDO1FBQ2pELENBQUM7UUFBQyxPQUFPLEtBQUssRUFBRSxDQUFDO1lBQ2YsZUFBTSxDQUFDLEtBQUssQ0FBQyx1QkFBdUIsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUMvQyxDQUFDO0lBQ0gsQ0FBQztDQUNGLENBQUE7QUExa0JZLGtEQUFtQjs4QkFBbkIsbUJBQW1CO0lBRC9CLElBQUEsc0JBQVUsR0FBRTs7R0FDQSxtQkFBbUIsQ0Ewa0IvQiIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXEFsZWphbmRyb1xcQUlHZXN0aW9uXFxiYWNrZW5kXFxzcmNcXHNlcnZpY2VzXFx1c2VyLWJlaGF2aW9yLnNlcnZpY2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaW5qZWN0YWJsZSB9IGZyb20gJ2ludmVyc2lmeSc7XG5pbXBvcnQgdHlwZSB7IFJlZGlzQ2xpZW50VHlwZSB9IGZyb20gJ3JlZGlzJztcbmltcG9ydCB7IGdldFJlZGlzQ2xpZW50IH0gZnJvbSAnLi4vY2FjaGUvcmVkaXMnO1xuaW1wb3J0IHsgbG9nZ2VyIH0gZnJvbSAnLi4vdXRpbHMvbG9nZ2VyJztcblxuaW50ZXJmYWNlIFVzZXJCZWhhdmlvckV2ZW50IHtcbiAgdXNlcklkOiBzdHJpbmc7XG4gIGV2ZW50VHlwZTpcbiAgICB8ICdsb2dpbidcbiAgICB8ICdsb2dvdXQnXG4gICAgfCAnZmlsZV91cGxvYWQnXG4gICAgfCAnYXBpX2NhbGwnXG4gICAgfCAncGFnZV92aWV3J1xuICAgIHwgJ2Vycm9yJ1xuICAgIHwgJ3Blcm1pc3Npb25fZGVuaWVkJ1xuICAgIHwgJ2RhdGFfYWNjZXNzJ1xuICAgIHwgJ21hbHdhcmVfZGV0ZWN0ZWQnO1xuICB0aW1lc3RhbXA6IERhdGU7XG4gIGlwQWRkcmVzczogc3RyaW5nO1xuICB1c2VyQWdlbnQ6IHN0cmluZztcbiAgc2Vzc2lvbklkOiBzdHJpbmc7XG4gIG1ldGFkYXRhOiB7XG4gICAgW2tleTogc3RyaW5nXTogYW55O1xuICB9O1xufVxuXG5pbnRlcmZhY2UgVXNlckJlaGF2aW9yUHJvZmlsZSB7XG4gIHVzZXJJZDogc3RyaW5nO1xuICBiYXNlbGluZToge1xuICAgIHR5cGljYWxJUHM6IHN0cmluZ1tdO1xuICAgIHR5cGljYWxVc2VyQWdlbnRzOiBzdHJpbmdbXTtcbiAgICB0eXBpY2FsSG91cnM6IG51bWJlcltdO1xuICAgIHR5cGljYWxEYXlzOiBudW1iZXJbXTtcbiAgICBhcGlDYWxsRnJlcXVlbmN5OiBudW1iZXI7XG4gICAgZXJyb3JSYXRlOiBudW1iZXI7XG4gICAgc2Vzc2lvbkR1cmF0aW9uOiBudW1iZXI7XG4gICAgZGF0YUFjY2Vzc1BhdHRlcm5zOiBzdHJpbmdbXTtcbiAgfTtcbiAgY3VycmVudFNlc3Npb246IHtcbiAgICBzdGFydFRpbWU6IERhdGU7XG4gICAgaXBBZGRyZXNzOiBzdHJpbmc7XG4gICAgdXNlckFnZW50OiBzdHJpbmc7XG4gICAgYXBpQ2FsbHM6IG51bWJlcjtcbiAgICBlcnJvcnM6IG51bWJlcjtcbiAgICBkYXRhQWNjZXNzOiBzdHJpbmdbXTtcbiAgICB1bnVzdWFsRXZlbnRzOiBzdHJpbmdbXTtcbiAgfTtcbiAgcmlza1Njb3JlOiBudW1iZXI7XG4gIGxhc3RVcGRhdGVkOiBEYXRlO1xufVxuXG5pbnRlcmZhY2UgQmVoYXZpb3JBbm9tYWx5IHtcbiAgaWQ6IHN0cmluZztcbiAgdXNlcklkOiBzdHJpbmc7XG4gIHR5cGU6XG4gICAgfCAnbmV3X2lwJ1xuICAgIHwgJ25ld191c2VyX2FnZW50J1xuICAgIHwgJ3VudXN1YWxfdGltZSdcbiAgICB8ICdoaWdoX2Vycm9yX3JhdGUnXG4gICAgfCAnZXhjZXNzaXZlX2FwaV9jYWxscydcbiAgICB8ICd1bnVzdWFsX2RhdGFfYWNjZXNzJ1xuICAgIHwgJ3Nlc3Npb25fYW5vbWFseSc7XG4gIHNldmVyaXR5OiAnbG93JyB8ICdtZWRpdW0nIHwgJ2hpZ2gnIHwgJ2NyaXRpY2FsJztcbiAgZGVzY3JpcHRpb246IHN0cmluZztcbiAgZGV0ZWN0ZWRBdDogRGF0ZTtcbiAgbWV0YWRhdGE6IHtcbiAgICBba2V5OiBzdHJpbmddOiBhbnk7XG4gIH07XG4gIHJlc29sdmVkOiBib29sZWFuO1xufVxuXG5AaW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgVXNlckJlaGF2aW9yU2VydmljZSB7XG4gIHByaXZhdGUgcmVhZG9ubHkgcmVkaXM6IFJlZGlzQ2xpZW50VHlwZTtcbiAgcHJpdmF0ZSByZWFkb25seSBwcm9maWxlQ2FjaGUgPSBuZXcgTWFwPHN0cmluZywgVXNlckJlaGF2aW9yUHJvZmlsZT4oKTtcbiAgcHJpdmF0ZSByZWFkb25seSBjYWNoZVRpbWVvdXQgPSAzMCAqIDYwOyAvLyAzMCBtaW51dGVzXG4gIHByaXZhdGUgcmVhZG9ubHkgYmFzZWxpbmVQZXJpb2QgPSAzMCAqIDI0ICogNjAgKiA2MCAqIDEwMDA7IC8vIDMwIGRheXNcbiAgcHJpdmF0ZSByZWFkb25seSBhbm9tYWxpZXM6IEJlaGF2aW9yQW5vbWFseVtdID0gW107XG4gIHByaXZhdGUgcmVhZG9ubHkgbWF4QW5vbWFsaWVzID0gMTAwMDA7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5yZWRpcyA9IGdldFJlZGlzQ2xpZW50KCk7XG4gIH1cblxuICAvKipcbiAgICogVHJhY2sgdXNlciBiZWhhdmlvciBldmVudFxuICAgKi9cbiAgcHVibGljIGFzeW5jIHRyYWNrRXZlbnQoZXZlbnQ6IFVzZXJCZWhhdmlvckV2ZW50KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFN0b3JlIGV2ZW50IGluIFJlZGlzXG4gICAgICBjb25zdCBldmVudEtleSA9IGBiZWhhdmlvcjpldmVudDoke2V2ZW50LnVzZXJJZH06JHtEYXRlLm5vdygpfWA7XG4gICAgICBhd2FpdCB0aGlzLnJlZGlzLnNldEV4KGV2ZW50S2V5LCA3ICogMjQgKiA2MCAqIDYwLCBKU09OLnN0cmluZ2lmeShldmVudCkpOyAvLyA3IGRheXNcblxuICAgICAgLy8gVXBkYXRlIHVzZXIgcHJvZmlsZVxuICAgICAgYXdhaXQgdGhpcy51cGRhdGVVc2VyUHJvZmlsZShldmVudCk7XG5cbiAgICAgIC8vIENoZWNrIGZvciBhbm9tYWxpZXNcbiAgICAgIGF3YWl0IHRoaXMuZGV0ZWN0QW5vbWFsaWVzKGV2ZW50KTtcblxuICAgICAgbG9nZ2VyLmRlYnVnKCdVc2VyIGJlaGF2aW9yIGV2ZW50IHRyYWNrZWQnLCB7XG4gICAgICAgIHVzZXJJZDogZXZlbnQudXNlcklkLFxuICAgICAgICBldmVudFR5cGU6IGV2ZW50LmV2ZW50VHlwZSxcbiAgICAgICAgdGltZXN0YW1wOiBldmVudC50aW1lc3RhbXAsXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciB0cmFja2luZyB1c2VyIGJlaGF2aW9yIGV2ZW50OicsIGVycm9yKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlIHVzZXIgYmVoYXZpb3IgcHJvZmlsZVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyB1cGRhdGVVc2VyUHJvZmlsZShldmVudDogVXNlckJlaGF2aW9yRXZlbnQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgbGV0IHByb2ZpbGUgPSBhd2FpdCB0aGlzLmdldFVzZXJQcm9maWxlKGV2ZW50LnVzZXJJZCk7XG5cbiAgICAgIGlmICghcHJvZmlsZSkge1xuICAgICAgICBwcm9maWxlID0gdGhpcy5jcmVhdGVJbml0aWFsUHJvZmlsZShldmVudC51c2VySWQpO1xuICAgICAgfVxuXG4gICAgICAvLyBVcGRhdGUgY3VycmVudCBzZXNzaW9uXG4gICAgICB0aGlzLnVwZGF0ZUN1cnJlbnRTZXNzaW9uKHByb2ZpbGUsIGV2ZW50KTtcblxuICAgICAgLy8gVXBkYXRlIGJhc2VsaW5lIHdpdGggbmV3IGRhdGFcbiAgICAgIHRoaXMudXBkYXRlQmFzZWxpbmUocHJvZmlsZSwgZXZlbnQpO1xuXG4gICAgICAvLyBDYWxjdWxhdGUgcmlzayBzY29yZVxuICAgICAgcHJvZmlsZS5yaXNrU2NvcmUgPSB0aGlzLmNhbGN1bGF0ZVJpc2tTY29yZShwcm9maWxlKTtcbiAgICAgIHByb2ZpbGUubGFzdFVwZGF0ZWQgPSBuZXcgRGF0ZSgpO1xuXG4gICAgICAvLyBDYWNoZSBwcm9maWxlXG4gICAgICB0aGlzLnByb2ZpbGVDYWNoZS5zZXQoZXZlbnQudXNlcklkLCBwcm9maWxlKTtcbiAgICAgIGF3YWl0IHRoaXMucmVkaXMuc2V0RXgoXG4gICAgICAgIGBiZWhhdmlvcjpwcm9maWxlOiR7ZXZlbnQudXNlcklkfWAsXG4gICAgICAgIHRoaXMuY2FjaGVUaW1lb3V0LFxuICAgICAgICBKU09OLnN0cmluZ2lmeShwcm9maWxlKSxcbiAgICAgICk7XG5cbiAgICAgIGxvZ2dlci5kZWJ1ZygnVXNlciBiZWhhdmlvciBwcm9maWxlIHVwZGF0ZWQnLCB7XG4gICAgICAgIHVzZXJJZDogZXZlbnQudXNlcklkLFxuICAgICAgICByaXNrU2NvcmU6IHByb2ZpbGUucmlza1Njb3JlLFxuICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3IgdXBkYXRpbmcgdXNlciBwcm9maWxlOicsIGVycm9yKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU3BlY2lmaWNhbGx5IHRyYWNrIG1hbHdhcmUgZGV0ZWN0aW9uIGV2ZW50c1xuICAgKi9cbiAgcHVibGljIGFzeW5jIHRyYWNrVGhyZWF0KFxuICAgIHVzZXJJZDogc3RyaW5nLFxuICAgIGZpbGVuYW1lOiBzdHJpbmcsXG4gICAgdGhyZWF0czogc3RyaW5nW10sXG4gICAgaXBBZGRyZXNzOiBzdHJpbmcsXG4gICk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGV2ZW50OiBVc2VyQmVoYXZpb3JFdmVudCA9IHtcbiAgICAgIHVzZXJJZCxcbiAgICAgIGV2ZW50VHlwZTogJ21hbHdhcmVfZGV0ZWN0ZWQnLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgaXBBZGRyZXNzLFxuICAgICAgdXNlckFnZW50OiAnc3lzdGVtLXNjYW5uZXInLFxuICAgICAgc2Vzc2lvbklkOiAnc2VjdXJpdHktYWxlcnQnLFxuICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgZmlsZW5hbWUsXG4gICAgICAgIHRocmVhdHMsXG4gICAgICAgIHByaW9yaXR5OiAnY3JpdGljYWwnLFxuICAgICAgfSxcbiAgICB9O1xuICAgIGF3YWl0IHRoaXMudHJhY2tFdmVudChldmVudCk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHVzZXIgYmVoYXZpb3IgcHJvZmlsZVxuICAgKi9cbiAgcHVibGljIGFzeW5jIGdldFVzZXJQcm9maWxlKHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTxVc2VyQmVoYXZpb3JQcm9maWxlIHwgbnVsbD4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBDaGVjayBjYWNoZSBmaXJzdFxuICAgICAgaWYgKHRoaXMucHJvZmlsZUNhY2hlLmhhcyh1c2VySWQpKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByb2ZpbGVDYWNoZS5nZXQodXNlcklkKSE7XG4gICAgICB9XG5cbiAgICAgIC8vIEdldCBmcm9tIFJlZGlzXG4gICAgICBjb25zdCBjYWNoZWQgPSBhd2FpdCB0aGlzLnJlZGlzLmdldChgYmVoYXZpb3I6cHJvZmlsZToke3VzZXJJZH1gKTtcbiAgICAgIGlmIChjYWNoZWQpIHtcbiAgICAgICAgY29uc3QgcHJvZmlsZSA9IEpTT04ucGFyc2UoY2FjaGVkKTtcbiAgICAgICAgdGhpcy5wcm9maWxlQ2FjaGUuc2V0KHVzZXJJZCwgcHJvZmlsZSk7XG4gICAgICAgIHJldHVybiBwcm9maWxlO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciBnZXR0aW5nIHVzZXIgcHJvZmlsZTonLCB7IHVzZXJJZCwgZXJyb3IgfSk7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlIGluaXRpYWwgdXNlciBwcm9maWxlXG4gICAqL1xuICBwcml2YXRlIGNyZWF0ZUluaXRpYWxQcm9maWxlKHVzZXJJZDogc3RyaW5nKTogVXNlckJlaGF2aW9yUHJvZmlsZSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHVzZXJJZCxcbiAgICAgIGJhc2VsaW5lOiB7XG4gICAgICAgIHR5cGljYWxJUHM6IFtdLFxuICAgICAgICB0eXBpY2FsVXNlckFnZW50czogW10sXG4gICAgICAgIHR5cGljYWxIb3VyczogW10sXG4gICAgICAgIHR5cGljYWxEYXlzOiBbXSxcbiAgICAgICAgYXBpQ2FsbEZyZXF1ZW5jeTogMCxcbiAgICAgICAgZXJyb3JSYXRlOiAwLFxuICAgICAgICBzZXNzaW9uRHVyYXRpb246IDAsXG4gICAgICAgIGRhdGFBY2Nlc3NQYXR0ZXJuczogW10sXG4gICAgICB9LFxuICAgICAgY3VycmVudFNlc3Npb246IHtcbiAgICAgICAgc3RhcnRUaW1lOiBuZXcgRGF0ZSgpLFxuICAgICAgICBpcEFkZHJlc3M6ICcnLFxuICAgICAgICB1c2VyQWdlbnQ6ICcnLFxuICAgICAgICBhcGlDYWxsczogMCxcbiAgICAgICAgZXJyb3JzOiAwLFxuICAgICAgICBkYXRhQWNjZXNzOiBbXSxcbiAgICAgICAgdW51c3VhbEV2ZW50czogW10sXG4gICAgICB9LFxuICAgICAgcmlza1Njb3JlOiAwLFxuICAgICAgbGFzdFVwZGF0ZWQ6IG5ldyBEYXRlKCksXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGUgY3VycmVudCBzZXNzaW9uIGRhdGFcbiAgICovXG4gIHByaXZhdGUgdXBkYXRlQ3VycmVudFNlc3Npb24ocHJvZmlsZTogVXNlckJlaGF2aW9yUHJvZmlsZSwgZXZlbnQ6IFVzZXJCZWhhdmlvckV2ZW50KTogdm9pZCB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IHByb2ZpbGUuY3VycmVudFNlc3Npb247XG5cbiAgICAvLyBVcGRhdGUgc2Vzc2lvbiBiYXNpY3NcbiAgICBpZiAoZXZlbnQuZXZlbnRUeXBlID09PSAnbG9naW4nKSB7XG4gICAgICBzZXNzaW9uLnN0YXJ0VGltZSA9IGV2ZW50LnRpbWVzdGFtcDtcbiAgICAgIHNlc3Npb24uaXBBZGRyZXNzID0gZXZlbnQuaXBBZGRyZXNzO1xuICAgICAgc2Vzc2lvbi51c2VyQWdlbnQgPSBldmVudC51c2VyQWdlbnQ7XG4gICAgICBzZXNzaW9uLmFwaUNhbGxzID0gMDtcbiAgICAgIHNlc3Npb24uZXJyb3JzID0gMDtcbiAgICAgIHNlc3Npb24uZGF0YUFjY2VzcyA9IFtdO1xuICAgICAgc2Vzc2lvbi51bnVzdWFsRXZlbnRzID0gW107XG4gICAgfVxuXG4gICAgLy8gVXBkYXRlIHNlc3Npb24gY291bnRlcnNcbiAgICBzd2l0Y2ggKGV2ZW50LmV2ZW50VHlwZSkge1xuICAgICAgY2FzZSAnYXBpX2NhbGwnOlxuICAgICAgICBzZXNzaW9uLmFwaUNhbGxzKys7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnZXJyb3InOlxuICAgICAgY2FzZSAncGVybWlzc2lvbl9kZW5pZWQnOlxuICAgICAgICBzZXNzaW9uLmVycm9ycysrO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2RhdGFfYWNjZXNzJzpcbiAgICAgICAgaWYgKGV2ZW50Lm1ldGFkYXRhLnJlc291cmNlKSB7XG4gICAgICAgICAgc2Vzc2lvbi5kYXRhQWNjZXNzLnB1c2goZXZlbnQubWV0YWRhdGEucmVzb3VyY2UpO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIC8vIEFkZCB1bnVzdWFsIGV2ZW50c1xuICAgIGlmIChldmVudC5tZXRhZGF0YS51bnVzdWFsKSB7XG4gICAgICBzZXNzaW9uLnVudXN1YWxFdmVudHMucHVzaChldmVudC5ldmVudFR5cGUpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGUgYmFzZWxpbmUgd2l0aCBuZXcgZGF0YVxuICAgKi9cbiAgcHJpdmF0ZSB1cGRhdGVCYXNlbGluZShwcm9maWxlOiBVc2VyQmVoYXZpb3JQcm9maWxlLCBldmVudDogVXNlckJlaGF2aW9yRXZlbnQpOiB2b2lkIHtcbiAgICBjb25zdCBiYXNlbGluZSA9IHByb2ZpbGUuYmFzZWxpbmU7XG5cbiAgICAvLyBVcGRhdGUgdHlwaWNhbCBJUHNcbiAgICBpZiAoIWJhc2VsaW5lLnR5cGljYWxJUHMuaW5jbHVkZXMoZXZlbnQuaXBBZGRyZXNzKSkge1xuICAgICAgYmFzZWxpbmUudHlwaWNhbElQcy5wdXNoKGV2ZW50LmlwQWRkcmVzcyk7XG4gICAgICAvLyBLZWVwIG9ubHkgbGFzdCAyMCBJUHNcbiAgICAgIGlmIChiYXNlbGluZS50eXBpY2FsSVBzLmxlbmd0aCA+IDIwKSB7XG4gICAgICAgIGJhc2VsaW5lLnR5cGljYWxJUHMgPSBiYXNlbGluZS50eXBpY2FsSVBzLnNsaWNlKC0yMCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gVXBkYXRlIHR5cGljYWwgdXNlciBhZ2VudHNcbiAgICBpZiAoIWJhc2VsaW5lLnR5cGljYWxVc2VyQWdlbnRzLmluY2x1ZGVzKGV2ZW50LnVzZXJBZ2VudCkpIHtcbiAgICAgIGJhc2VsaW5lLnR5cGljYWxVc2VyQWdlbnRzLnB1c2goZXZlbnQudXNlckFnZW50KTtcbiAgICAgIC8vIEtlZXAgb25seSBsYXN0IDEwIHVzZXIgYWdlbnRzXG4gICAgICBpZiAoYmFzZWxpbmUudHlwaWNhbFVzZXJBZ2VudHMubGVuZ3RoID4gMTApIHtcbiAgICAgICAgYmFzZWxpbmUudHlwaWNhbFVzZXJBZ2VudHMgPSBiYXNlbGluZS50eXBpY2FsVXNlckFnZW50cy5zbGljZSgtMTApO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFVwZGF0ZSB0eXBpY2FsIGhvdXJzXG4gICAgY29uc3QgaG91ciA9IGV2ZW50LnRpbWVzdGFtcC5nZXRIb3VycygpO1xuICAgIGlmICghYmFzZWxpbmUudHlwaWNhbEhvdXJzLmluY2x1ZGVzKGhvdXIpKSB7XG4gICAgICBiYXNlbGluZS50eXBpY2FsSG91cnMucHVzaChob3VyKTtcbiAgICAgIGJhc2VsaW5lLnR5cGljYWxIb3Vycy5zb3J0KChhLCBiKSA9PiBhIC0gYik7XG4gICAgfVxuXG4gICAgLy8gVXBkYXRlIHR5cGljYWwgZGF5c1xuICAgIGNvbnN0IGRheSA9IGV2ZW50LnRpbWVzdGFtcC5nZXREYXkoKTtcbiAgICBpZiAoIWJhc2VsaW5lLnR5cGljYWxEYXlzLmluY2x1ZGVzKGRheSkpIHtcbiAgICAgIGJhc2VsaW5lLnR5cGljYWxEYXlzLnB1c2goZGF5KTtcbiAgICAgIGJhc2VsaW5lLnR5cGljYWxEYXlzLnNvcnQoKGEsIGIpID0+IGEgLSBiKTtcbiAgICB9XG5cbiAgICAvLyBVcGRhdGUgZGF0YSBhY2Nlc3MgcGF0dGVybnNcbiAgICBpZiAoZXZlbnQuZXZlbnRUeXBlID09PSAnZGF0YV9hY2Nlc3MnICYmIGV2ZW50Lm1ldGFkYXRhLnJlc291cmNlKSB7XG4gICAgICBpZiAoIWJhc2VsaW5lLmRhdGFBY2Nlc3NQYXR0ZXJucy5pbmNsdWRlcyhldmVudC5tZXRhZGF0YS5yZXNvdXJjZSkpIHtcbiAgICAgICAgYmFzZWxpbmUuZGF0YUFjY2Vzc1BhdHRlcm5zLnB1c2goZXZlbnQubWV0YWRhdGEucmVzb3VyY2UpO1xuICAgICAgICAvLyBLZWVwIG9ubHkgbGFzdCA1MCBwYXR0ZXJuc1xuICAgICAgICBpZiAoYmFzZWxpbmUuZGF0YUFjY2Vzc1BhdHRlcm5zLmxlbmd0aCA+IDUwKSB7XG4gICAgICAgICAgYmFzZWxpbmUuZGF0YUFjY2Vzc1BhdHRlcm5zID0gYmFzZWxpbmUuZGF0YUFjY2Vzc1BhdHRlcm5zLnNsaWNlKC01MCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRGV0ZWN0IGFub21hbGllcyBpbiB1c2VyIGJlaGF2aW9yXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGRldGVjdEFub21hbGllcyhldmVudDogVXNlckJlaGF2aW9yRXZlbnQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcHJvZmlsZSA9IGF3YWl0IHRoaXMuZ2V0VXNlclByb2ZpbGUoZXZlbnQudXNlcklkKTtcbiAgICAgIGlmICghcHJvZmlsZSB8fCBwcm9maWxlLmJhc2VsaW5lLnR5cGljYWxJUHMubGVuZ3RoIDwgMykge1xuICAgICAgICAvLyBOb3QgZW5vdWdoIGJhc2VsaW5lIGRhdGFcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBhbm9tYWxpZXM6IEJlaGF2aW9yQW5vbWFseVtdID0gW107XG5cbiAgICAgIC8vIENoZWNrIGZvciBuZXcgSVBcbiAgICAgIGlmICghcHJvZmlsZS5iYXNlbGluZS50eXBpY2FsSVBzLmluY2x1ZGVzKGV2ZW50LmlwQWRkcmVzcykpIHtcbiAgICAgICAgYW5vbWFsaWVzLnB1c2goe1xuICAgICAgICAgIGlkOiB0aGlzLmdlbmVyYXRlQW5vbWFseUlkKCksXG4gICAgICAgICAgdXNlcklkOiBldmVudC51c2VySWQsXG4gICAgICAgICAgdHlwZTogJ25ld19pcCcsXG4gICAgICAgICAgc2V2ZXJpdHk6ICdtZWRpdW0nLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBgTG9naW4gZnJvbSBuZXcgSVAgYWRkcmVzczogJHtldmVudC5pcEFkZHJlc3N9YCxcbiAgICAgICAgICBkZXRlY3RlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICBuZXdJUDogZXZlbnQuaXBBZGRyZXNzLFxuICAgICAgICAgICAgdHlwaWNhbElQczogcHJvZmlsZS5iYXNlbGluZS50eXBpY2FsSVBzLnNsaWNlKDAsIDUpLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgcmVzb2x2ZWQ6IGZhbHNlLFxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgZm9yIG5ldyB1c2VyIGFnZW50XG4gICAgICBpZiAoIXByb2ZpbGUuYmFzZWxpbmUudHlwaWNhbFVzZXJBZ2VudHMuaW5jbHVkZXMoZXZlbnQudXNlckFnZW50KSkge1xuICAgICAgICBhbm9tYWxpZXMucHVzaCh7XG4gICAgICAgICAgaWQ6IHRoaXMuZ2VuZXJhdGVBbm9tYWx5SWQoKSxcbiAgICAgICAgICB1c2VySWQ6IGV2ZW50LnVzZXJJZCxcbiAgICAgICAgICB0eXBlOiAnbmV3X3VzZXJfYWdlbnQnLFxuICAgICAgICAgIHNldmVyaXR5OiAnbG93JyxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogJ0xvZ2luIGZyb20gbmV3IHVzZXIgYWdlbnQnLFxuICAgICAgICAgIGRldGVjdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgIG5ld1VzZXJBZ2VudDogZXZlbnQudXNlckFnZW50LFxuICAgICAgICAgICAgdHlwaWNhbFVzZXJBZ2VudHM6IHByb2ZpbGUuYmFzZWxpbmUudHlwaWNhbFVzZXJBZ2VudHMuc2xpY2UoMCwgMyksXG4gICAgICAgICAgfSxcbiAgICAgICAgICByZXNvbHZlZDogZmFsc2UsXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBDaGVjayBmb3IgdW51c3VhbCB0aW1lXG4gICAgICBjb25zdCBob3VyID0gZXZlbnQudGltZXN0YW1wLmdldEhvdXJzKCk7XG4gICAgICBpZiAoIXByb2ZpbGUuYmFzZWxpbmUudHlwaWNhbEhvdXJzLmluY2x1ZGVzKGhvdXIpICYmIGV2ZW50LmV2ZW50VHlwZSA9PT0gJ2xvZ2luJykge1xuICAgICAgICBhbm9tYWxpZXMucHVzaCh7XG4gICAgICAgICAgaWQ6IHRoaXMuZ2VuZXJhdGVBbm9tYWx5SWQoKSxcbiAgICAgICAgICB1c2VySWQ6IGV2ZW50LnVzZXJJZCxcbiAgICAgICAgICB0eXBlOiAndW51c3VhbF90aW1lJyxcbiAgICAgICAgICBzZXZlcml0eTogJ2xvdycsXG4gICAgICAgICAgZGVzY3JpcHRpb246IGBMb2dpbiBhdCB1bnVzdWFsIGhvdXI6ICR7aG91cn06MDBgLFxuICAgICAgICAgIGRldGVjdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgIGhvdXIsXG4gICAgICAgICAgICB0eXBpY2FsSG91cnM6IHByb2ZpbGUuYmFzZWxpbmUudHlwaWNhbEhvdXJzLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgcmVzb2x2ZWQ6IGZhbHNlLFxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgZm9yIGhpZ2ggZXJyb3IgcmF0ZVxuICAgICAgaWYgKHByb2ZpbGUuY3VycmVudFNlc3Npb24uZXJyb3JzID4gNSAmJiBwcm9maWxlLmN1cnJlbnRTZXNzaW9uLmFwaUNhbGxzID4gMCkge1xuICAgICAgICBjb25zdCBlcnJvclJhdGUgPSBwcm9maWxlLmN1cnJlbnRTZXNzaW9uLmVycm9ycyAvIHByb2ZpbGUuY3VycmVudFNlc3Npb24uYXBpQ2FsbHM7XG4gICAgICAgIGlmIChlcnJvclJhdGUgPiAwLjIpIHtcbiAgICAgICAgICAvLyBNb3JlIHRoYW4gMjAlIGVycm9yc1xuICAgICAgICAgIGFub21hbGllcy5wdXNoKHtcbiAgICAgICAgICAgIGlkOiB0aGlzLmdlbmVyYXRlQW5vbWFseUlkKCksXG4gICAgICAgICAgICB1c2VySWQ6IGV2ZW50LnVzZXJJZCxcbiAgICAgICAgICAgIHR5cGU6ICdoaWdoX2Vycm9yX3JhdGUnLFxuICAgICAgICAgICAgc2V2ZXJpdHk6ICdoaWdoJyxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBgSGlnaCBlcnJvciByYXRlOiAke01hdGgucm91bmQoZXJyb3JSYXRlICogMTAwKX0lYCxcbiAgICAgICAgICAgIGRldGVjdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgICBlcnJvclJhdGUsXG4gICAgICAgICAgICAgIGVycm9yczogcHJvZmlsZS5jdXJyZW50U2Vzc2lvbi5lcnJvcnMsXG4gICAgICAgICAgICAgIGFwaUNhbGxzOiBwcm9maWxlLmN1cnJlbnRTZXNzaW9uLmFwaUNhbGxzLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJlc29sdmVkOiBmYWxzZSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBDaGVjayBmb3IgZXhjZXNzaXZlIEFQSSBjYWxsc1xuICAgICAgaWYgKHByb2ZpbGUuY3VycmVudFNlc3Npb24uYXBpQ2FsbHMgPiAxMDAwKSB7XG4gICAgICAgIGFub21hbGllcy5wdXNoKHtcbiAgICAgICAgICBpZDogdGhpcy5nZW5lcmF0ZUFub21hbHlJZCgpLFxuICAgICAgICAgIHVzZXJJZDogZXZlbnQudXNlcklkLFxuICAgICAgICAgIHR5cGU6ICdleGNlc3NpdmVfYXBpX2NhbGxzJyxcbiAgICAgICAgICBzZXZlcml0eTogJ21lZGl1bScsXG4gICAgICAgICAgZGVzY3JpcHRpb246IGBFeGNlc3NpdmUgQVBJIGNhbGxzOiAke3Byb2ZpbGUuY3VycmVudFNlc3Npb24uYXBpQ2FsbHN9YCxcbiAgICAgICAgICBkZXRlY3RlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICBhcGlDYWxsczogcHJvZmlsZS5jdXJyZW50U2Vzc2lvbi5hcGlDYWxscyxcbiAgICAgICAgICAgIHNlc3Npb25EdXJhdGlvbjogRGF0ZS5ub3coKSAtIHByb2ZpbGUuY3VycmVudFNlc3Npb24uc3RhcnRUaW1lLmdldFRpbWUoKSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHJlc29sdmVkOiBmYWxzZSxcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIC8vIENoZWNrIGZvciB1bnVzdWFsIGRhdGEgYWNjZXNzXG4gICAgICBpZiAoZXZlbnQuZXZlbnRUeXBlID09PSAnZGF0YV9hY2Nlc3MnICYmIGV2ZW50Lm1ldGFkYXRhLnJlc291cmNlKSB7XG4gICAgICAgIGlmICghcHJvZmlsZS5iYXNlbGluZS5kYXRhQWNjZXNzUGF0dGVybnMuaW5jbHVkZXMoZXZlbnQubWV0YWRhdGEucmVzb3VyY2UpKSB7XG4gICAgICAgICAgYW5vbWFsaWVzLnB1c2goe1xuICAgICAgICAgICAgaWQ6IHRoaXMuZ2VuZXJhdGVBbm9tYWx5SWQoKSxcbiAgICAgICAgICAgIHVzZXJJZDogZXZlbnQudXNlcklkLFxuICAgICAgICAgICAgdHlwZTogJ3VudXN1YWxfZGF0YV9hY2Nlc3MnLFxuICAgICAgICAgICAgc2V2ZXJpdHk6ICdtZWRpdW0nLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IGBBY2Nlc3MgdG8gdW51c3VhbCByZXNvdXJjZTogJHtldmVudC5tZXRhZGF0YS5yZXNvdXJjZX1gLFxuICAgICAgICAgICAgZGV0ZWN0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICAgIHJlc291cmNlOiBldmVudC5tZXRhZGF0YS5yZXNvdXJjZSxcbiAgICAgICAgICAgICAgdHlwaWNhbFBhdHRlcm5zOiBwcm9maWxlLmJhc2VsaW5lLmRhdGFBY2Nlc3NQYXR0ZXJucy5zbGljZSgwLCA1KSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXNvbHZlZDogZmFsc2UsXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gU3RvcmUgYW5vbWFsaWVzXG4gICAgICBmb3IgKGNvbnN0IGFub21hbHkgb2YgYW5vbWFsaWVzKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuc3RvcmVBbm9tYWx5KGFub21hbHkpO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGRldGVjdGluZyBhbm9tYWxpZXM6JywgZXJyb3IpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBTdG9yZSBhbm9tYWx5XG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHN0b3JlQW5vbWFseShhbm9tYWx5OiBCZWhhdmlvckFub21hbHkpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgLy8gQWRkIHRvIG1lbW9yeVxuICAgICAgdGhpcy5hbm9tYWxpZXMucHVzaChhbm9tYWx5KTtcblxuICAgICAgLy8gS2VlcCBvbmx5IHJlY2VudCBhbm9tYWxpZXNcbiAgICAgIGlmICh0aGlzLmFub21hbGllcy5sZW5ndGggPiB0aGlzLm1heEFub21hbGllcykge1xuICAgICAgICB0aGlzLmFub21hbGllcy5zcGxpY2UoMCwgdGhpcy5hbm9tYWxpZXMubGVuZ3RoIC0gdGhpcy5tYXhBbm9tYWxpZXMpO1xuICAgICAgfVxuXG4gICAgICAvLyBTdG9yZSBpbiBSZWRpc1xuICAgICAgYXdhaXQgdGhpcy5yZWRpcy5zZXRFeChcbiAgICAgICAgYGJlaGF2aW9yOmFub21hbHk6JHthbm9tYWx5LmlkfWAsXG4gICAgICAgIDcgKiAyNCAqIDYwICogNjAsIC8vIDcgZGF5c1xuICAgICAgICBKU09OLnN0cmluZ2lmeShhbm9tYWx5KSxcbiAgICAgICk7XG5cbiAgICAgIC8vIEFkZCB0byB1c2VyIGFub21hbGllcyBsaXN0XG4gICAgICBhd2FpdCB0aGlzLnJlZGlzLmxQdXNoKGBiZWhhdmlvcjphbm9tYWxpZXM6JHthbm9tYWx5LnVzZXJJZH1gLCBKU09OLnN0cmluZ2lmeShhbm9tYWx5KSk7XG4gICAgICBhd2FpdCB0aGlzLnJlZGlzLmxUcmltKGBiZWhhdmlvcjphbm9tYWxpZXM6JHthbm9tYWx5LnVzZXJJZH1gLCAwLCA5OSk7IC8vIEtlZXAgbGFzdCAxMDBcblxuICAgICAgLy8gTG9nIGFub21hbHlcbiAgICAgIGxvZ2dlci53YXJuKCdVc2VyIGJlaGF2aW9yIGFub21hbHkgZGV0ZWN0ZWQnLCB7XG4gICAgICAgIHVzZXJJZDogYW5vbWFseS51c2VySWQsXG4gICAgICAgIHR5cGU6IGFub21hbHkudHlwZSxcbiAgICAgICAgc2V2ZXJpdHk6IGFub21hbHkuc2V2ZXJpdHksXG4gICAgICAgIGRlc2NyaXB0aW9uOiBhbm9tYWx5LmRlc2NyaXB0aW9uLFxuICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3Igc3RvcmluZyBhbm9tYWx5OicsIGVycm9yKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ2FsY3VsYXRlIHJpc2sgc2NvcmVcbiAgICovXG4gIHByaXZhdGUgY2FsY3VsYXRlUmlza1Njb3JlKHByb2ZpbGU6IFVzZXJCZWhhdmlvclByb2ZpbGUpOiBudW1iZXIge1xuICAgIGxldCBzY29yZSA9IDA7XG5cbiAgICAvLyBCYXNlIHNjb3JlXG4gICAgc2NvcmUgKz0gMTA7XG5cbiAgICAvLyBDdXJyZW50IHNlc3Npb24gZmFjdG9yc1xuICAgIGNvbnN0IHNlc3Npb24gPSBwcm9maWxlLmN1cnJlbnRTZXNzaW9uO1xuXG4gICAgLy8gRXJyb3IgcmF0ZSBpbXBhY3RcbiAgICBpZiAoc2Vzc2lvbi5hcGlDYWxscyA+IDApIHtcbiAgICAgIGNvbnN0IGVycm9yUmF0ZSA9IHNlc3Npb24uZXJyb3JzIC8gc2Vzc2lvbi5hcGlDYWxscztcbiAgICAgIHNjb3JlICs9IGVycm9yUmF0ZSAqIDMwO1xuICAgIH1cblxuICAgIC8vIFVudXN1YWwgZXZlbnRzIGltcGFjdFxuICAgIHNjb3JlICs9IHNlc3Npb24udW51c3VhbEV2ZW50cy5sZW5ndGggKiA1O1xuXG4gICAgLy8gQVBJIGNhbGwgZnJlcXVlbmN5IGltcGFjdFxuICAgIGlmIChzZXNzaW9uLmFwaUNhbGxzID4gNTAwKSB7XG4gICAgICBzY29yZSArPSBNYXRoLm1pbihzZXNzaW9uLmFwaUNhbGxzIC8gMTAwLCAyMCk7XG4gICAgfVxuXG4gICAgLy8gUmVjZW50IGFub21hbGllcyBpbXBhY3RcbiAgICAvLyBNYWx3YXJlIGRldGVjdGlvbnMgYWRkIDUwIHBvaW50cyBpbW1lZGlhdGVseVxuICAgIGlmIChzZXNzaW9uLnVudXN1YWxFdmVudHMuaW5jbHVkZXMoJ21hbHdhcmVfZGV0ZWN0ZWQnKSkge1xuICAgICAgc2NvcmUgKz0gNTA7XG4gICAgfVxuXG4gICAgcmV0dXJuIE1hdGgubWluKE1hdGgucm91bmQoc2NvcmUpLCAxMDApO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCB1c2VyIGFub21hbGllc1xuICAgKi9cbiAgcHVibGljIGFzeW5jIGdldFVzZXJBbm9tYWxpZXModXNlcklkOiBzdHJpbmcsIGxpbWl0OiBudW1iZXIgPSA1MCk6IFByb21pc2U8QmVoYXZpb3JBbm9tYWx5W10+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgYW5vbWFseURhdGEgPSBhd2FpdCB0aGlzLnJlZGlzLmxSYW5nZShgYmVoYXZpb3I6YW5vbWFsaWVzOiR7dXNlcklkfWAsIDAsIGxpbWl0IC0gMSk7XG4gICAgICByZXR1cm4gYW5vbWFseURhdGEubWFwKGRhdGEgPT4gSlNPTi5wYXJzZShkYXRhKSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3IgZ2V0dGluZyB1c2VyIGFub21hbGllczonLCB7IHVzZXJJZCwgZXJyb3IgfSk7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCByZWNlbnQgYW5vbWFsaWVzXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgZ2V0UmVjZW50QW5vbWFsaWVzKGxpbWl0OiBudW1iZXIgPSAxMDApOiBQcm9taXNlPEJlaGF2aW9yQW5vbWFseVtdPiB7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiB0aGlzLmFub21hbGllc1xuICAgICAgICAuc29ydCgoYSwgYikgPT4gYi5kZXRlY3RlZEF0LmdldFRpbWUoKSAtIGEuZGV0ZWN0ZWRBdC5nZXRUaW1lKCkpXG4gICAgICAgIC5zbGljZSgwLCBsaW1pdCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3IgZ2V0dGluZyByZWNlbnQgYW5vbWFsaWVzOicsIGVycm9yKTtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVzb2x2ZSBhbm9tYWx5XG4gICAqL1xuICBwdWJsaWMgYXN5bmMgcmVzb2x2ZUFub21hbHkoYW5vbWFseUlkOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICB0cnkge1xuICAgICAgLy8gVXBkYXRlIGluIG1lbW9yeVxuICAgICAgY29uc3QgYW5vbWFseSA9IHRoaXMuYW5vbWFsaWVzLmZpbmQoYSA9PiBhLmlkID09PSBhbm9tYWx5SWQpO1xuICAgICAgaWYgKGFub21hbHkpIHtcbiAgICAgICAgYW5vbWFseS5yZXNvbHZlZCA9IHRydWU7XG4gICAgICB9XG5cbiAgICAgIC8vIFVwZGF0ZSBpbiBSZWRpc1xuICAgICAgY29uc3QgY2FjaGVkID0gYXdhaXQgdGhpcy5yZWRpcy5nZXQoYGJlaGF2aW9yOmFub21hbHk6JHthbm9tYWx5SWR9YCk7XG4gICAgICBpZiAoY2FjaGVkKSB7XG4gICAgICAgIGNvbnN0IHVwZGF0ZWRBbm9tYWx5ID0gSlNPTi5wYXJzZShjYWNoZWQpO1xuICAgICAgICB1cGRhdGVkQW5vbWFseS5yZXNvbHZlZCA9IHRydWU7XG4gICAgICAgIGF3YWl0IHRoaXMucmVkaXMuc2V0RXgoXG4gICAgICAgICAgYGJlaGF2aW9yOmFub21hbHk6JHthbm9tYWx5SWR9YCxcbiAgICAgICAgICA3ICogMjQgKiA2MCAqIDYwLFxuICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHVwZGF0ZWRBbm9tYWx5KSxcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgbG9nZ2VyLmluZm8oJ0Fub21hbHkgcmVzb2x2ZWQnLCB7IGFub21hbHlJZCB9KTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIHJlc29sdmluZyBhbm9tYWx5OicsIHsgYW5vbWFseUlkLCBlcnJvciB9KTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IGJlaGF2aW9yIHN0YXRpc3RpY3NcbiAgICovXG4gIHB1YmxpYyBhc3luYyBnZXRTdGF0cygpOiBQcm9taXNlPHtcbiAgICB0b3RhbFByb2ZpbGVzOiBudW1iZXI7XG4gICAgdG90YWxBbm9tYWxpZXM6IG51bWJlcjtcbiAgICBhbm9tYWxpZXNCeVR5cGU6IHsgW2tleTogc3RyaW5nXTogbnVtYmVyIH07XG4gICAgYW5vbWFsaWVzQnlTZXZlcml0eTogeyBba2V5OiBzdHJpbmddOiBudW1iZXIgfTtcbiAgICBhdmVyYWdlUmlza1Njb3JlOiBudW1iZXI7XG4gICAgaGlnaFJpc2tVc2VyczogbnVtYmVyO1xuICB9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHRvdGFsUHJvZmlsZXMgPSB0aGlzLnByb2ZpbGVDYWNoZS5zaXplO1xuICAgICAgY29uc3QgdG90YWxBbm9tYWxpZXMgPSB0aGlzLmFub21hbGllcy5sZW5ndGg7XG5cbiAgICAgIGNvbnN0IGFub21hbGllc0J5VHlwZTogeyBba2V5OiBzdHJpbmddOiBudW1iZXIgfSA9IHt9O1xuICAgICAgY29uc3QgYW5vbWFsaWVzQnlTZXZlcml0eTogeyBba2V5OiBzdHJpbmddOiBudW1iZXIgfSA9IHt9O1xuXG4gICAgICB0aGlzLmFub21hbGllcy5mb3JFYWNoKGFub21hbHkgPT4ge1xuICAgICAgICBhbm9tYWxpZXNCeVR5cGVbYW5vbWFseS50eXBlXSA9IChhbm9tYWxpZXNCeVR5cGVbYW5vbWFseS50eXBlXSB8fCAwKSArIDE7XG4gICAgICAgIGFub21hbGllc0J5U2V2ZXJpdHlbYW5vbWFseS5zZXZlcml0eV0gPSAoYW5vbWFsaWVzQnlTZXZlcml0eVthbm9tYWx5LnNldmVyaXR5XSB8fCAwKSArIDE7XG4gICAgICB9KTtcblxuICAgICAgY29uc3Qgcmlza1Njb3JlcyA9IEFycmF5LmZyb20odGhpcy5wcm9maWxlQ2FjaGUudmFsdWVzKCkpLm1hcChwID0+IHAucmlza1Njb3JlKTtcbiAgICAgIGNvbnN0IGF2ZXJhZ2VSaXNrU2NvcmUgPVxuICAgICAgICByaXNrU2NvcmVzLmxlbmd0aCA+IDBcbiAgICAgICAgICA/IHJpc2tTY29yZXMucmVkdWNlKChzdW0sIHNjb3JlKSA9PiBzdW0gKyBzY29yZSwgMCkgLyByaXNrU2NvcmVzLmxlbmd0aFxuICAgICAgICAgIDogMDtcblxuICAgICAgY29uc3QgaGlnaFJpc2tVc2VycyA9IHJpc2tTY29yZXMuZmlsdGVyKHNjb3JlID0+IHNjb3JlID4gNzApLmxlbmd0aDtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdG90YWxQcm9maWxlcyxcbiAgICAgICAgdG90YWxBbm9tYWxpZXMsXG4gICAgICAgIGFub21hbGllc0J5VHlwZSxcbiAgICAgICAgYW5vbWFsaWVzQnlTZXZlcml0eSxcbiAgICAgICAgYXZlcmFnZVJpc2tTY29yZTogTWF0aC5yb3VuZChhdmVyYWdlUmlza1Njb3JlKSxcbiAgICAgICAgaGlnaFJpc2tVc2VycyxcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3IgZ2V0dGluZyBiZWhhdmlvciBzdGF0czonLCBlcnJvcik7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0b3RhbFByb2ZpbGVzOiAwLFxuICAgICAgICB0b3RhbEFub21hbGllczogMCxcbiAgICAgICAgYW5vbWFsaWVzQnlUeXBlOiB7fSxcbiAgICAgICAgYW5vbWFsaWVzQnlTZXZlcml0eToge30sXG4gICAgICAgIGF2ZXJhZ2VSaXNrU2NvcmU6IDAsXG4gICAgICAgIGhpZ2hSaXNrVXNlcnM6IDAsXG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSBhbm9tYWx5IElEXG4gICAqL1xuICBwcml2YXRlIGdlbmVyYXRlQW5vbWFseUlkKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGBhbm9tYWx5XyR7RGF0ZS5ub3coKX1fJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgOSl9YDtcbiAgfVxuXG4gIC8qKlxuICAgKiBDbGVhbnVwIG9sZCBkYXRhXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgY2xlYW51cCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgLy8gQ2xlYW4gb2xkIHByb2ZpbGVzIGZyb20gY2FjaGVcbiAgICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gICAgICBmb3IgKGNvbnN0IFt1c2VySWQsIHByb2ZpbGVdIG9mIHRoaXMucHJvZmlsZUNhY2hlLmVudHJpZXMoKSkge1xuICAgICAgICBpZiAobm93IC0gcHJvZmlsZS5sYXN0VXBkYXRlZC5nZXRUaW1lKCkgPiB0aGlzLmNhY2hlVGltZW91dCAqIDEwMDApIHtcbiAgICAgICAgICB0aGlzLnByb2ZpbGVDYWNoZS5kZWxldGUodXNlcklkKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBDbGVhbiBvbGQgYW5vbWFsaWVzIGZyb20gbWVtb3J5XG4gICAgICBjb25zdCBjdXRvZmYgPSBuZXcgRGF0ZShub3cgLSA3ICogMjQgKiA2MCAqIDYwICogMTAwMCk7IC8vIDcgZGF5cyBhZ29cbiAgICAgIHRoaXMuYW5vbWFsaWVzLmZpbHRlcihhbm9tYWx5ID0+IGFub21hbHkuZGV0ZWN0ZWRBdCA+IGN1dG9mZik7XG5cbiAgICAgIGxvZ2dlci5pbmZvKCdVc2VyIGJlaGF2aW9yIGNsZWFudXAgY29tcGxldGVkJyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3IgZHVyaW5nIGNsZWFudXA6JywgZXJyb3IpO1xuICAgIH1cbiAgfVxufVxuIl0sInZlcnNpb24iOjN9