0d74d5eeecbe61da5478c087db50264b
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.catchAsync = exports.ValidationError = exports.ConflictError = exports.NotFoundError = exports.ForbiddenError = exports.UnauthorizedError = exports.BadRequestError = exports.AppError = exports.HttpStatusCode = void 0;
/**
 * Enums for standard HTTP status codes
 */
var HttpStatusCode;
(function (HttpStatusCode) {
    HttpStatusCode[HttpStatusCode["OK"] = 200] = "OK";
    HttpStatusCode[HttpStatusCode["CREATED"] = 201] = "CREATED";
    HttpStatusCode[HttpStatusCode["ACCEPTED"] = 202] = "ACCEPTED";
    HttpStatusCode[HttpStatusCode["NO_CONTENT"] = 204] = "NO_CONTENT";
    HttpStatusCode[HttpStatusCode["BAD_REQUEST"] = 400] = "BAD_REQUEST";
    HttpStatusCode[HttpStatusCode["UNAUTHORIZED"] = 401] = "UNAUTHORIZED";
    HttpStatusCode[HttpStatusCode["PAYMENT_REQUIRED"] = 402] = "PAYMENT_REQUIRED";
    HttpStatusCode[HttpStatusCode["FORBIDDEN"] = 403] = "FORBIDDEN";
    HttpStatusCode[HttpStatusCode["NOT_FOUND"] = 404] = "NOT_FOUND";
    HttpStatusCode[HttpStatusCode["METHOD_NOT_ALLOWED"] = 405] = "METHOD_NOT_ALLOWED";
    HttpStatusCode[HttpStatusCode["CONFLICT"] = 409] = "CONFLICT";
    HttpStatusCode[HttpStatusCode["UNPROCESSABLE_ENTITY"] = 422] = "UNPROCESSABLE_ENTITY";
    HttpStatusCode[HttpStatusCode["TOO_MANY_REQUESTS"] = 429] = "TOO_MANY_REQUESTS";
    HttpStatusCode[HttpStatusCode["INTERNAL_SERVER_ERROR"] = 500] = "INTERNAL_SERVER_ERROR";
    HttpStatusCode[HttpStatusCode["NOT_IMPLEMENTED"] = 501] = "NOT_IMPLEMENTED";
    HttpStatusCode[HttpStatusCode["BAD_GATEWAY"] = 502] = "BAD_GATEWAY";
    HttpStatusCode[HttpStatusCode["SERVICE_UNAVAILABLE"] = 503] = "SERVICE_UNAVAILABLE";
})(HttpStatusCode || (exports.HttpStatusCode = HttpStatusCode = {}));
/**
 * Standard Application Error class
 */
class AppError extends Error {
    statusCode;
    code;
    isOperational;
    details;
    constructor(message, statusCode = HttpStatusCode.INTERNAL_SERVER_ERROR, code, details, isOperational = true) {
        super(message);
        this.statusCode = statusCode;
        this.code = code || (statusCode === 404 ? 'NOT_FOUND' : 'INTERNAL_ERROR');
        this.isOperational = isOperational;
        this.details = details;
        Object.setPrototypeOf(this, new.target.prototype);
        Error.captureStackTrace(this, this.constructor);
    }
}
exports.AppError = AppError;
class BadRequestError extends AppError {
    constructor(message = 'Bad Request', details) {
        super(message, HttpStatusCode.BAD_REQUEST, 'BAD_REQUEST', details);
    }
}
exports.BadRequestError = BadRequestError;
class UnauthorizedError extends AppError {
    constructor(message = 'Unauthorized', details) {
        super(message, HttpStatusCode.UNAUTHORIZED, 'UNAUTHORIZED', details);
    }
}
exports.UnauthorizedError = UnauthorizedError;
class ForbiddenError extends AppError {
    constructor(message = 'Forbidden', details) {
        super(message, HttpStatusCode.FORBIDDEN, 'FORBIDDEN', details);
    }
}
exports.ForbiddenError = ForbiddenError;
class NotFoundError extends AppError {
    constructor(message = 'Resource not found', details) {
        super(message, HttpStatusCode.NOT_FOUND, 'NOT_FOUND', details);
    }
}
exports.NotFoundError = NotFoundError;
class ConflictError extends AppError {
    constructor(message = 'Conflict', details) {
        super(message, HttpStatusCode.CONFLICT, 'CONFLICT', details);
    }
}
exports.ConflictError = ConflictError;
class ValidationError extends AppError {
    constructor(message = 'Validation Error', details) {
        super(message, HttpStatusCode.BAD_REQUEST, 'VALIDATION_ERROR', details);
    }
}
exports.ValidationError = ValidationError;
/**
 * Global async error wrapper to eliminate try-catch boilerplate in controllers
 */
const catchAsync = (fn) => {
    return (req, res, next) => {
        fn(req, res, next).catch(next);
    };
};
exports.catchAsync = catchAsync;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxBbGVqYW5kcm9cXEFJR2VzdGlvblxcYmFja2VuZFxcc3JjXFx1dGlsc1xcZXJyb3JzLnRzIiwibWFwcGluZ3MiOiI7OztBQUFBOztHQUVHO0FBQ0gsSUFBWSxjQWtCWDtBQWxCRCxXQUFZLGNBQWM7SUFDeEIsaURBQVEsQ0FBQTtJQUNSLDJEQUFhLENBQUE7SUFDYiw2REFBYyxDQUFBO0lBQ2QsaUVBQWdCLENBQUE7SUFDaEIsbUVBQWlCLENBQUE7SUFDakIscUVBQWtCLENBQUE7SUFDbEIsNkVBQXNCLENBQUE7SUFDdEIsK0RBQWUsQ0FBQTtJQUNmLCtEQUFlLENBQUE7SUFDZixpRkFBd0IsQ0FBQTtJQUN4Qiw2REFBYyxDQUFBO0lBQ2QscUZBQTBCLENBQUE7SUFDMUIsK0VBQXVCLENBQUE7SUFDdkIsdUZBQTJCLENBQUE7SUFDM0IsMkVBQXFCLENBQUE7SUFDckIsbUVBQWlCLENBQUE7SUFDakIsbUZBQXlCLENBQUE7QUFDM0IsQ0FBQyxFQWxCVyxjQUFjLDhCQUFkLGNBQWMsUUFrQnpCO0FBRUQ7O0dBRUc7QUFDSCxNQUFhLFFBQVMsU0FBUSxLQUFLO0lBQ2pCLFVBQVUsQ0FBUztJQUNuQixJQUFJLENBQVM7SUFDYixhQUFhLENBQVU7SUFDdkIsT0FBTyxDQUFPO0lBRTlCLFlBQ0UsT0FBZSxFQUNmLGFBQXFCLGNBQWMsQ0FBQyxxQkFBcUIsRUFDekQsSUFBYSxFQUNiLE9BQWEsRUFDYixhQUFhLEdBQUcsSUFBSTtRQUVwQixLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDZixJQUFJLENBQUMsVUFBVSxHQUFHLFVBQVUsQ0FBQztRQUM3QixJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksSUFBSSxDQUFDLFVBQVUsS0FBSyxHQUFHLENBQUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztRQUMxRSxJQUFJLENBQUMsYUFBYSxHQUFHLGFBQWEsQ0FBQztRQUNuQyxJQUFJLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQztRQUV2QixNQUFNLENBQUMsY0FBYyxDQUFDLElBQUksRUFBRSxHQUFHLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQ2xELEtBQUssQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDO0lBQ2xELENBQUM7Q0FDRjtBQXRCRCw0QkFzQkM7QUFFRCxNQUFhLGVBQWdCLFNBQVEsUUFBUTtJQUMzQyxZQUFZLE9BQU8sR0FBRyxhQUFhLEVBQUUsT0FBYTtRQUNoRCxLQUFLLENBQUMsT0FBTyxFQUFFLGNBQWMsQ0FBQyxXQUFXLEVBQUUsYUFBYSxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQ3JFLENBQUM7Q0FDRjtBQUpELDBDQUlDO0FBRUQsTUFBYSxpQkFBa0IsU0FBUSxRQUFRO0lBQzdDLFlBQVksT0FBTyxHQUFHLGNBQWMsRUFBRSxPQUFhO1FBQ2pELEtBQUssQ0FBQyxPQUFPLEVBQUUsY0FBYyxDQUFDLFlBQVksRUFBRSxjQUFjLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDdkUsQ0FBQztDQUNGO0FBSkQsOENBSUM7QUFFRCxNQUFhLGNBQWUsU0FBUSxRQUFRO0lBQzFDLFlBQVksT0FBTyxHQUFHLFdBQVcsRUFBRSxPQUFhO1FBQzlDLEtBQUssQ0FBQyxPQUFPLEVBQUUsY0FBYyxDQUFDLFNBQVMsRUFBRSxXQUFXLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDakUsQ0FBQztDQUNGO0FBSkQsd0NBSUM7QUFFRCxNQUFhLGFBQWMsU0FBUSxRQUFRO0lBQ3pDLFlBQVksT0FBTyxHQUFHLG9CQUFvQixFQUFFLE9BQWE7UUFDdkQsS0FBSyxDQUFDLE9BQU8sRUFBRSxjQUFjLENBQUMsU0FBUyxFQUFFLFdBQVcsRUFBRSxPQUFPLENBQUMsQ0FBQztJQUNqRSxDQUFDO0NBQ0Y7QUFKRCxzQ0FJQztBQUVELE1BQWEsYUFBYyxTQUFRLFFBQVE7SUFDekMsWUFBWSxPQUFPLEdBQUcsVUFBVSxFQUFFLE9BQWE7UUFDN0MsS0FBSyxDQUFDLE9BQU8sRUFBRSxjQUFjLENBQUMsUUFBUSxFQUFFLFVBQVUsRUFBRSxPQUFPLENBQUMsQ0FBQztJQUMvRCxDQUFDO0NBQ0Y7QUFKRCxzQ0FJQztBQUVELE1BQWEsZUFBZ0IsU0FBUSxRQUFRO0lBQzNDLFlBQVksT0FBTyxHQUFHLGtCQUFrQixFQUFFLE9BQWE7UUFDckQsS0FBSyxDQUFDLE9BQU8sRUFBRSxjQUFjLENBQUMsV0FBVyxFQUFFLGtCQUFrQixFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQzFFLENBQUM7Q0FDRjtBQUpELDBDQUlDO0FBRUQ7O0dBRUc7QUFDSSxNQUFNLFVBQVUsR0FBRyxDQUFDLEVBQVksRUFBRSxFQUFFO0lBQ3pDLE9BQU8sQ0FBQyxHQUFRLEVBQUUsR0FBUSxFQUFFLElBQVMsRUFBRSxFQUFFO1FBQ3ZDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLElBQUksQ0FBQyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUNqQyxDQUFDLENBQUM7QUFDSixDQUFDLENBQUM7QUFKVyxRQUFBLFVBQVUsY0FJckIiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxBbGVqYW5kcm9cXEFJR2VzdGlvblxcYmFja2VuZFxcc3JjXFx1dGlsc1xcZXJyb3JzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogRW51bXMgZm9yIHN0YW5kYXJkIEhUVFAgc3RhdHVzIGNvZGVzXG4gKi9cbmV4cG9ydCBlbnVtIEh0dHBTdGF0dXNDb2RlIHtcbiAgT0sgPSAyMDAsXG4gIENSRUFURUQgPSAyMDEsXG4gIEFDQ0VQVEVEID0gMjAyLFxuICBOT19DT05URU5UID0gMjA0LFxuICBCQURfUkVRVUVTVCA9IDQwMCxcbiAgVU5BVVRIT1JJWkVEID0gNDAxLFxuICBQQVlNRU5UX1JFUVVJUkVEID0gNDAyLFxuICBGT1JCSURERU4gPSA0MDMsXG4gIE5PVF9GT1VORCA9IDQwNCxcbiAgTUVUSE9EX05PVF9BTExPV0VEID0gNDA1LFxuICBDT05GTElDVCA9IDQwOSxcbiAgVU5QUk9DRVNTQUJMRV9FTlRJVFkgPSA0MjIsXG4gIFRPT19NQU5ZX1JFUVVFU1RTID0gNDI5LFxuICBJTlRFUk5BTF9TRVJWRVJfRVJST1IgPSA1MDAsXG4gIE5PVF9JTVBMRU1FTlRFRCA9IDUwMSxcbiAgQkFEX0dBVEVXQVkgPSA1MDIsXG4gIFNFUlZJQ0VfVU5BVkFJTEFCTEUgPSA1MDMsXG59XG5cbi8qKlxuICogU3RhbmRhcmQgQXBwbGljYXRpb24gRXJyb3IgY2xhc3NcbiAqL1xuZXhwb3J0IGNsYXNzIEFwcEVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICBwdWJsaWMgcmVhZG9ubHkgc3RhdHVzQ29kZTogbnVtYmVyO1xuICBwdWJsaWMgcmVhZG9ubHkgY29kZTogc3RyaW5nO1xuICBwdWJsaWMgcmVhZG9ubHkgaXNPcGVyYXRpb25hbDogYm9vbGVhbjtcbiAgcHVibGljIHJlYWRvbmx5IGRldGFpbHM/OiBhbnk7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgbWVzc2FnZTogc3RyaW5nLFxuICAgIHN0YXR1c0NvZGU6IG51bWJlciA9IEh0dHBTdGF0dXNDb2RlLklOVEVSTkFMX1NFUlZFUl9FUlJPUixcbiAgICBjb2RlPzogc3RyaW5nLFxuICAgIGRldGFpbHM/OiBhbnksXG4gICAgaXNPcGVyYXRpb25hbCA9IHRydWUsXG4gICkge1xuICAgIHN1cGVyKG1lc3NhZ2UpO1xuICAgIHRoaXMuc3RhdHVzQ29kZSA9IHN0YXR1c0NvZGU7XG4gICAgdGhpcy5jb2RlID0gY29kZSB8fCAoc3RhdHVzQ29kZSA9PT0gNDA0ID8gJ05PVF9GT1VORCcgOiAnSU5URVJOQUxfRVJST1InKTtcbiAgICB0aGlzLmlzT3BlcmF0aW9uYWwgPSBpc09wZXJhdGlvbmFsO1xuICAgIHRoaXMuZGV0YWlscyA9IGRldGFpbHM7XG5cbiAgICBPYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcywgbmV3LnRhcmdldC5wcm90b3R5cGUpO1xuICAgIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKHRoaXMsIHRoaXMuY29uc3RydWN0b3IpO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBCYWRSZXF1ZXN0RXJyb3IgZXh0ZW5kcyBBcHBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2UgPSAnQmFkIFJlcXVlc3QnLCBkZXRhaWxzPzogYW55KSB7XG4gICAgc3VwZXIobWVzc2FnZSwgSHR0cFN0YXR1c0NvZGUuQkFEX1JFUVVFU1QsICdCQURfUkVRVUVTVCcsIGRldGFpbHMpO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBVbmF1dGhvcml6ZWRFcnJvciBleHRlbmRzIEFwcEVycm9yIHtcbiAgY29uc3RydWN0b3IobWVzc2FnZSA9ICdVbmF1dGhvcml6ZWQnLCBkZXRhaWxzPzogYW55KSB7XG4gICAgc3VwZXIobWVzc2FnZSwgSHR0cFN0YXR1c0NvZGUuVU5BVVRIT1JJWkVELCAnVU5BVVRIT1JJWkVEJywgZGV0YWlscyk7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIEZvcmJpZGRlbkVycm9yIGV4dGVuZHMgQXBwRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihtZXNzYWdlID0gJ0ZvcmJpZGRlbicsIGRldGFpbHM/OiBhbnkpIHtcbiAgICBzdXBlcihtZXNzYWdlLCBIdHRwU3RhdHVzQ29kZS5GT1JCSURERU4sICdGT1JCSURERU4nLCBkZXRhaWxzKTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgTm90Rm91bmRFcnJvciBleHRlbmRzIEFwcEVycm9yIHtcbiAgY29uc3RydWN0b3IobWVzc2FnZSA9ICdSZXNvdXJjZSBub3QgZm91bmQnLCBkZXRhaWxzPzogYW55KSB7XG4gICAgc3VwZXIobWVzc2FnZSwgSHR0cFN0YXR1c0NvZGUuTk9UX0ZPVU5ELCAnTk9UX0ZPVU5EJywgZGV0YWlscyk7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIENvbmZsaWN0RXJyb3IgZXh0ZW5kcyBBcHBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2UgPSAnQ29uZmxpY3QnLCBkZXRhaWxzPzogYW55KSB7XG4gICAgc3VwZXIobWVzc2FnZSwgSHR0cFN0YXR1c0NvZGUuQ09ORkxJQ1QsICdDT05GTElDVCcsIGRldGFpbHMpO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBWYWxpZGF0aW9uRXJyb3IgZXh0ZW5kcyBBcHBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2UgPSAnVmFsaWRhdGlvbiBFcnJvcicsIGRldGFpbHM/OiBhbnkpIHtcbiAgICBzdXBlcihtZXNzYWdlLCBIdHRwU3RhdHVzQ29kZS5CQURfUkVRVUVTVCwgJ1ZBTElEQVRJT05fRVJST1InLCBkZXRhaWxzKTtcbiAgfVxufVxuXG4vKipcbiAqIEdsb2JhbCBhc3luYyBlcnJvciB3cmFwcGVyIHRvIGVsaW1pbmF0ZSB0cnktY2F0Y2ggYm9pbGVycGxhdGUgaW4gY29udHJvbGxlcnNcbiAqL1xuZXhwb3J0IGNvbnN0IGNhdGNoQXN5bmMgPSAoZm46IEZ1bmN0aW9uKSA9PiB7XG4gIHJldHVybiAocmVxOiBhbnksIHJlczogYW55LCBuZXh0OiBhbnkpID0+IHtcbiAgICBmbihyZXEsIHJlcywgbmV4dCkuY2F0Y2gobmV4dCk7XG4gIH07XG59O1xuIl0sInZlcnNpb24iOjN9