3a559babb2fbff506966ba5dbed7340c
/**
 * API Integration Tests
 *
 * These tests require a fully running server with real MongoDB and Redis connections.
 * They are skipped in unit test mode (NODE_ENV=test) and should only be run
 * as part of a dedicated integration test pipeline with `npm run test:integration`.
 *
 * To run: RUN_INTEGRATION_TESTS=true npx jest --runInBand api.integration.test.ts
 */
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
const SKIP_INTEGRATION = process.env.NODE_ENV === 'test' && !process.env.RUN_INTEGRATION_TESTS;
(SKIP_INTEGRATION ? describe.skip : describe)('API Integration Tests', () => {
    let server;
    let dbService;
    let redisService;
    beforeAll(async () => {
        // Dynamic imports to avoid compilation errors when skipped
        const { app } = await Promise.resolve().then(() => __importStar(require('../../app')));
        dbService = {};
        redisService = {};
        server = app.listen(0);
    });
    afterAll(async () => {
        if (server)
            server.close();
    });
    describe('Authentication Endpoints', () => {
        test('POST /api/v1/auth/login - Valid credentials', async () => {
            const request = require('supertest');
            const response = await request(server)
                .post('/api/v1/auth/login')
                .send({ email: 'test@example.com', password: 'AIGestion2026!' });
            expect(response.status).toBe(200);
        });
    });
    describe('Health Check', () => {
        test('GET /health should return status', async () => {
            const request = require('supertest');
            const response = await request(server).get('/health');
            expect(response.status).toBeDefined();
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxBbGVqYW5kcm9cXEFJR2VzdGlvblxcYmFja2VuZFxcc3JjXFxfX3Rlc3RzX19cXGludGVncmF0aW9uXFxhcGkuaW50ZWdyYXRpb24udGVzdC50cyIsIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7R0FRRzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUVILE1BQU0sZ0JBQWdCLEdBQUcsT0FBTyxDQUFDLEdBQUcsQ0FBQyxRQUFRLEtBQUssTUFBTSxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxxQkFBcUIsQ0FBQztBQUUvRixDQUFDLGdCQUFnQixDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyx1QkFBdUIsRUFBRSxHQUFHLEVBQUU7SUFDMUUsSUFBSSxNQUFXLENBQUM7SUFDaEIsSUFBSSxTQUFjLENBQUM7SUFDbkIsSUFBSSxZQUFpQixDQUFDO0lBRXRCLFNBQVMsQ0FBQyxLQUFLLElBQUksRUFBRTtRQUNuQiwyREFBMkQ7UUFDM0QsTUFBTSxFQUFFLEdBQUcsRUFBRSxHQUFHLHdEQUFhLFdBQVcsR0FBQyxDQUFDO1FBQzFDLFNBQVMsR0FBRyxFQUFFLENBQUM7UUFDZixZQUFZLEdBQUcsRUFBRSxDQUFDO1FBQ2xCLE1BQU0sR0FBRyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3pCLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLEtBQUssSUFBSSxFQUFFO1FBQ2xCLElBQUksTUFBTTtZQUFFLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQztJQUM3QixDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQywwQkFBMEIsRUFBRSxHQUFHLEVBQUU7UUFDeEMsSUFBSSxDQUFDLDZDQUE2QyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzdELE1BQU0sT0FBTyxHQUFHLE9BQU8sQ0FBQyxXQUFXLENBQUMsQ0FBQztZQUNyQyxNQUFNLFFBQVEsR0FBRyxNQUFNLE9BQU8sQ0FBQyxNQUFNLENBQUM7aUJBQ25DLElBQUksQ0FBQyxvQkFBb0IsQ0FBQztpQkFDMUIsSUFBSSxDQUFDLEVBQUUsS0FBSyxFQUFFLGtCQUFrQixFQUFFLFFBQVEsRUFBRSxnQkFBZ0IsRUFBRSxDQUFDLENBQUM7WUFFbkUsTUFBTSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDcEMsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxjQUFjLEVBQUUsR0FBRyxFQUFFO1FBQzVCLElBQUksQ0FBQyxrQ0FBa0MsRUFBRSxLQUFLLElBQUksRUFBRTtZQUNsRCxNQUFNLE9BQU8sR0FBRyxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUM7WUFDckMsTUFBTSxRQUFRLEdBQUcsTUFBTSxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQ3RELE1BQU0sQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDeEMsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcQWxlamFuZHJvXFxBSUdlc3Rpb25cXGJhY2tlbmRcXHNyY1xcX190ZXN0c19fXFxpbnRlZ3JhdGlvblxcYXBpLmludGVncmF0aW9uLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBBUEkgSW50ZWdyYXRpb24gVGVzdHNcbiAqXG4gKiBUaGVzZSB0ZXN0cyByZXF1aXJlIGEgZnVsbHkgcnVubmluZyBzZXJ2ZXIgd2l0aCByZWFsIE1vbmdvREIgYW5kIFJlZGlzIGNvbm5lY3Rpb25zLlxuICogVGhleSBhcmUgc2tpcHBlZCBpbiB1bml0IHRlc3QgbW9kZSAoTk9ERV9FTlY9dGVzdCkgYW5kIHNob3VsZCBvbmx5IGJlIHJ1blxuICogYXMgcGFydCBvZiBhIGRlZGljYXRlZCBpbnRlZ3JhdGlvbiB0ZXN0IHBpcGVsaW5lIHdpdGggYG5wbSBydW4gdGVzdDppbnRlZ3JhdGlvbmAuXG4gKlxuICogVG8gcnVuOiBSVU5fSU5URUdSQVRJT05fVEVTVFM9dHJ1ZSBucHggamVzdCAtLXJ1bkluQmFuZCBhcGkuaW50ZWdyYXRpb24udGVzdC50c1xuICovXG5cbmNvbnN0IFNLSVBfSU5URUdSQVRJT04gPSBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Rlc3QnICYmICFwcm9jZXNzLmVudi5SVU5fSU5URUdSQVRJT05fVEVTVFM7XG5cbihTS0lQX0lOVEVHUkFUSU9OID8gZGVzY3JpYmUuc2tpcCA6IGRlc2NyaWJlKSgnQVBJIEludGVncmF0aW9uIFRlc3RzJywgKCkgPT4ge1xuICBsZXQgc2VydmVyOiBhbnk7XG4gIGxldCBkYlNlcnZpY2U6IGFueTtcbiAgbGV0IHJlZGlzU2VydmljZTogYW55O1xuXG4gIGJlZm9yZUFsbChhc3luYyAoKSA9PiB7XG4gICAgLy8gRHluYW1pYyBpbXBvcnRzIHRvIGF2b2lkIGNvbXBpbGF0aW9uIGVycm9ycyB3aGVuIHNraXBwZWRcbiAgICBjb25zdCB7IGFwcCB9ID0gYXdhaXQgaW1wb3J0KCcuLi8uLi9hcHAnKTtcbiAgICBkYlNlcnZpY2UgPSB7fTtcbiAgICByZWRpc1NlcnZpY2UgPSB7fTtcbiAgICBzZXJ2ZXIgPSBhcHAubGlzdGVuKDApO1xuICB9KTtcblxuICBhZnRlckFsbChhc3luYyAoKSA9PiB7XG4gICAgaWYgKHNlcnZlcikgc2VydmVyLmNsb3NlKCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdBdXRoZW50aWNhdGlvbiBFbmRwb2ludHMnLCAoKSA9PiB7XG4gICAgdGVzdCgnUE9TVCAvYXBpL3YxL2F1dGgvbG9naW4gLSBWYWxpZCBjcmVkZW50aWFscycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlcXVlc3QgPSByZXF1aXJlKCdzdXBlcnRlc3QnKTtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChzZXJ2ZXIpXG4gICAgICAgIC5wb3N0KCcvYXBpL3YxL2F1dGgvbG9naW4nKVxuICAgICAgICAuc2VuZCh7IGVtYWlsOiAndGVzdEBleGFtcGxlLmNvbScsIHBhc3N3b3JkOiAnQUlHZXN0aW9uMjAyNiEnIH0pO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDIwMCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdIZWFsdGggQ2hlY2snLCAoKSA9PiB7XG4gICAgdGVzdCgnR0VUIC9oZWFsdGggc2hvdWxkIHJldHVybiBzdGF0dXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXF1ZXN0ID0gcmVxdWlyZSgnc3VwZXJ0ZXN0Jyk7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3Qoc2VydmVyKS5nZXQoJy9oZWFsdGgnKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwidmVyc2lvbiI6M30=