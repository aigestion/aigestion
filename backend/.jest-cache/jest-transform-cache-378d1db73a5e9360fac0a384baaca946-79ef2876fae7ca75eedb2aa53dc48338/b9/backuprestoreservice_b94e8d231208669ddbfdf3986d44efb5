06256562222e2fbb6d1676a41dc7ad2a
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.BackupRestoreService = void 0;
const child_process_1 = require("child_process");
const crypto_1 = __importDefault(require("crypto"));
const promises_1 = __importDefault(require("fs/promises"));
const inversify_1 = require("inversify");
const path_1 = __importDefault(require("path"));
const util_1 = require("util");
const logger_1 = require("../utils/logger");
const execAsync = (0, util_1.promisify)(child_process_1.exec);
let BackupRestoreService = class BackupRestoreService {
    backupDir = 'backups';
    encryptionKey;
    backupConfigs = [];
    backupJobs = [];
    restoreJobs = [];
    maxJobs = 1000;
    constructor() {
        this.encryptionKey =
            process.env.BACKUP_ENCRYPTION_KEY || crypto_1.default.randomBytes(32).toString('hex');
        this.initializeBackupDirectory();
        this.initializeDefaultConfigs();
        this.startScheduledBackups();
    }
    async initializeBackupDirectory() {
        try {
            await promises_1.default.mkdir(this.backupDir, { recursive: true });
            await promises_1.default.mkdir(path_1.default.join(this.backupDir, 'database'), { recursive: true });
            await promises_1.default.mkdir(path_1.default.join(this.backupDir, 'files'), { recursive: true });
            await promises_1.default.mkdir(path_1.default.join(this.backupDir, 'logs'), { recursive: true });
            await promises_1.default.mkdir(path_1.default.join(this.backupDir, 'config'), { recursive: true });
            logger_1.logger.info('Backup directory initialized');
        }
        catch (error) {
            logger_1.logger.error('Failed to initialize backup directory:', error);
        }
    }
    initializeDefaultConfigs() {
        this.backupConfigs.push({
            name: 'daily-database',
            type: 'database',
            schedule: '0 2 * * *', // 2 AM daily
            enabled: true,
            retention: 30,
            compression: true,
            encryption: true,
            destinations: [
                {
                    type: 'local',
                    path: path_1.default.join(this.backupDir, 'database'),
                },
            ],
        }, {
            name: 'weekly-full',
            type: 'full',
            schedule: '0 3 * * 0', // 3 AM on Sundays
            enabled: true,
            retention: 90,
            compression: true,
            encryption: true,
            destinations: [
                {
                    type: 'local',
                    path: this.backupDir,
                },
            ],
        }, {
            name: 'hourly-logs',
            type: 'logs',
            schedule: '0 * * * *', // Every hour
            enabled: true,
            retention: 7,
            compression: true,
            encryption: false,
            destinations: [
                {
                    type: 'local',
                    path: path_1.default.join(this.backupDir, 'logs'),
                },
            ],
        }, {
            name: 'daily-files',
            type: 'files',
            schedule: '0 1 * * *', // 1 AM daily
            enabled: true,
            retention: 30,
            compression: true,
            encryption: true,
            destinations: [
                {
                    type: 'local',
                    path: path_1.default.join(this.backupDir, 'files'),
                },
            ],
        });
        logger_1.logger.info('Default backup configurations initialized', {
            totalConfigs: this.backupConfigs.length,
        });
    }
    /**
     * Create backup job
     */
    async createBackup(configName, customOptions) {
        try {
            const config = this.backupConfigs.find(c => c.name === configName);
            if (!config) {
                throw new Error(`Backup configuration '${configName}' not found`);
            }
            const mergedConfig = { ...config, ...customOptions };
            const job = {
                id: this.generateJobId(),
                config: mergedConfig,
                status: 'pending',
                startTime: new Date(),
                size: 0,
                files: [],
                checksum: '',
                metadata: {
                    createdBy: 'system',
                    environment: process.env.NODE_ENV || 'development',
                },
            };
            this.backupJobs.push(job);
            await this.executeBackup(job);
            return job;
        }
        catch (error) {
            logger_1.logger.error('Failed to create backup job:', error);
            throw error;
        }
    }
    /**
     * Execute backup
     */
    async executeBackup(job) {
        try {
            job.status = 'running';
            logger_1.logger.info('Starting backup job', { jobId: job.id, config: job.config.name });
            const startTime = Date.now();
            let totalSize = 0;
            const files = [];
            switch (job.config.type) {
                case 'database':
                    await this.backupDatabase(job, files, totalSize);
                    break;
                case 'files':
                    await this.backupFiles(job, files, totalSize);
                    break;
                case 'logs':
                    await this.backupLogs(job, files, totalSize);
                    break;
                case 'config':
                    await this.backupConfig(job, files, totalSize);
                    break;
                case 'full':
                    await this.backupFull(job, files, totalSize);
                    break;
            }
            // Process backup (compress and encrypt)
            const processedFiles = await this.processBackup(job, files);
            // Store backup
            await this.storeBackup(job, processedFiles);
            // Update job status
            job.status = 'completed';
            job.endTime = new Date();
            job.size = totalSize;
            job.files = processedFiles;
            job.checksum = await this.calculateChecksum(processedFiles);
            const duration = Date.now() - startTime;
            logger_1.logger.info('Backup completed successfully', {
                jobId: job.id,
                config: job.config.name,
                duration,
                size: job.size,
                files: job.files.length,
            });
            // Cleanup old backups
            await this.cleanupOldBackups(job.config);
        }
        catch (error) {
            job.status = 'failed';
            job.endTime = new Date();
            job.error = error instanceof Error ? error.message : 'Unknown error';
            logger_1.logger.error('Backup failed', {
                jobId: job.id,
                config: job.config.name,
                error: job.error,
            });
        }
    }
    /**
     * Backup database
     */
    async backupDatabase(job, files, totalSize) {
        try {
            const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
            const backupFile = path_1.default.join(this.backupDir, 'database', `database-${timestamp}.sql`);
            // MongoDB backup
            if (process.env.MONGODB_URI) {
                const command = `mongodump --uri="${process.env.MONGODB_URI}" --out="${backupFile}"`;
                await execAsync(command);
                files.push(backupFile);
                const stats = await promises_1.default.stat(backupFile);
                totalSize += stats.size;
            }
            // PostgreSQL backup
            if (process.env.DATABASE_URL) {
                const pgBackupFile = path_1.default.join(this.backupDir, 'database', `postgres-${timestamp}.sql`);
                const command = `pg_dump "${process.env.DATABASE_URL}" > "${pgBackupFile}"`;
                await execAsync(command);
                files.push(pgBackupFile);
                const stats = await promises_1.default.stat(pgBackupFile);
                totalSize += stats.size;
            }
            logger_1.logger.info('Database backup completed', { files: files.length, size: totalSize });
        }
        catch (error) {
            logger_1.logger.error('Database backup failed:', error);
            throw error;
        }
    }
    /**
     * Backup files
     */
    async backupFiles(job, files, totalSize) {
        try {
            const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
            const backupFile = path_1.default.join(this.backupDir, 'files', `files-${timestamp}.tar.gz`);
            // Create tar archive of important directories
            const directories = ['uploads', 'quarantine', 'data'];
            let tarCommand = `tar -czf "${backupFile}"`;
            for (const dir of directories) {
                try {
                    await promises_1.default.access(dir);
                    tarCommand += ` ${dir}`;
                }
                catch {
                    // Directory doesn't exist, skip
                }
            }
            await execAsync(tarCommand);
            files.push(backupFile);
            const stats = await promises_1.default.stat(backupFile);
            totalSize += stats.size;
            logger_1.logger.info('Files backup completed', { files: files.length, size: totalSize });
        }
        catch (error) {
            logger_1.logger.error('Files backup failed:', error);
            throw error;
        }
    }
    /**
     * Backup logs
     */
    async backupLogs(job, files, totalSize) {
        try {
            const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
            const backupFile = path_1.default.join(this.backupDir, 'logs', `logs-${timestamp}.tar.gz`);
            // Create tar archive of logs
            const logDirs = ['logs', 'monitoring'];
            let tarCommand = `tar -czf "${backupFile}"`;
            for (const dir of logDirs) {
                try {
                    await promises_1.default.access(dir);
                    tarCommand += ` ${dir}`;
                }
                catch {
                    // Directory doesn't exist, skip
                }
            }
            await execAsync(tarCommand);
            files.push(backupFile);
            const stats = await promises_1.default.stat(backupFile);
            totalSize += stats.size;
            logger_1.logger.info('Logs backup completed', { files: files.length, size: totalSize });
        }
        catch (error) {
            logger_1.logger.error('Logs backup failed:', error);
            throw error;
        }
    }
    /**
     * Backup configuration
     */
    async backupConfig(job, files, totalSize) {
        try {
            const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
            const backupFile = path_1.default.join(this.backupDir, 'config', `config-${timestamp}.tar.gz`);
            // Create tar archive of configuration files
            const configFiles = ['.env', 'package.json', 'tsconfig.json', 'docker-compose.yml'];
            let tarCommand = `tar -czf "${backupFile}"`;
            for (const file of configFiles) {
                try {
                    await promises_1.default.access(file);
                    tarCommand += ` ${file}`;
                }
                catch {
                    // File doesn't exist, skip
                }
            }
            await execAsync(tarCommand);
            files.push(backupFile);
            const stats = await promises_1.default.stat(backupFile);
            totalSize += stats.size;
            logger_1.logger.info('Configuration backup completed', { files: files.length, size: totalSize });
        }
        catch (error) {
            logger_1.logger.error('Configuration backup failed:', error);
            throw error;
        }
    }
    /**
     * Full backup
     */
    async backupFull(job, files, totalSize) {
        try {
            // Run all backup types
            await this.backupDatabase(job, files, totalSize);
            await this.backupFiles(job, files, totalSize);
            await this.backupLogs(job, files, totalSize);
            await this.backupConfig(job, files, totalSize);
            logger_1.logger.info('Full backup completed', { files: files.length, size: totalSize });
        }
        catch (error) {
            logger_1.logger.error('Full backup failed:', error);
            throw error;
        }
    }
    /**
     * Process backup (compress and encrypt)
     */
    async processBackup(job, files) {
        const processedFiles = [];
        for (const file of files) {
            let processedFile = file;
            // Compression
            if (job.config.compression && !file.endsWith('.gz')) {
                processedFile = await this.compressFile(file);
                await promises_1.default.unlink(file); // Remove original
            }
            // Encryption
            if (job.config.encryption) {
                processedFile = await this.encryptFile(processedFile);
                await promises_1.default.unlink(processedFile.replace('.enc', '')); // Remove unencrypted
            }
            processedFiles.push(processedFile);
        }
        return processedFiles;
    }
    /**
     * Compress file
     */
    async compressFile(filePath) {
        const compressedPath = `${filePath}.gz`;
        await execAsync(`gzip "${filePath}"`);
        return compressedPath;
    }
    /**
     * Encrypt file
     */
    async encryptFile(filePath) {
        const encryptedPath = `${filePath}.enc`;
        const data = await promises_1.default.readFile(filePath);
        // Simple XOR encryption (in production, use proper encryption)
        const encrypted = Buffer.from(data.map(byte => byte ^ this.encryptionKey.charCodeAt(0)));
        await promises_1.default.writeFile(encryptedPath, encrypted);
        return encryptedPath;
    }
    /**
     * Store backup
     */
    async storeBackup(job, files) {
        try {
            for (const destination of job.config.destinations) {
                switch (destination.type) {
                    case 'local':
                        await this.storeBackupLocal(job, files, destination.path);
                        break;
                    case 's3':
                        await this.storeBackupS3(job, files, destination);
                        break;
                    case 'gcs':
                        await this.storeBackupGCS(job, files, destination);
                        break;
                    case 'azure':
                        await this.storeBackupAzure(job, files, destination);
                        break;
                }
            }
        }
        catch (error) {
            logger_1.logger.error('Failed to store backup:', error);
            throw error;
        }
    }
    /**
     * Store backup locally
     */
    async storeBackupLocal(job, files, destinationPath) {
        try {
            await promises_1.default.mkdir(destinationPath, { recursive: true });
            for (const file of files) {
                const fileName = path_1.default.basename(file);
                const destPath = path_1.default.join(destinationPath, `${job.id}_${fileName}`);
                await promises_1.default.copyFile(file, destPath);
            }
            // Store backup metadata
            const metadataPath = path_1.default.join(destinationPath, `${job.id}_metadata.json`);
            await promises_1.default.writeFile(metadataPath, JSON.stringify({
                job,
                files,
                storedAt: new Date(),
            }, null, 2));
            logger_1.logger.info('Backup stored locally', { destination: destinationPath, files: files.length });
        }
        catch (error) {
            logger_1.logger.error('Failed to store backup locally:', error);
            throw error;
        }
    }
    /**
     * Store backup to S3 (placeholder)
     */
    async storeBackupS3(job, files, destination) {
        // Implementation would use AWS SDK
        logger_1.logger.info('S3 backup storage not implemented', { destination });
    }
    /**
     * Store backup to GCS (placeholder)
     */
    async storeBackupGCS(job, files, destination) {
        // Implementation would use Google Cloud SDK
        logger_1.logger.info('GCS backup storage not implemented', { destination });
    }
    /**
     * Store backup to Azure (placeholder)
     */
    async storeBackupAzure(job, files, destination) {
        // Implementation would use Azure SDK
        logger_1.logger.info('Azure backup storage not implemented', { destination });
    }
    /**
     * Calculate checksum
     */
    async calculateChecksum(files) {
        const hash = crypto_1.default.createHash('sha256');
        for (const file of files) {
            try {
                const data = await promises_1.default.readFile(file);
                hash.update(data);
            }
            catch (error) {
                logger_1.logger.error('Failed to read file for checksum:', { file, error });
            }
        }
        return hash.digest('hex');
    }
    /**
     * Cleanup old backups
     */
    async cleanupOldBackups(config) {
        try {
            const cutoffDate = new Date(Date.now() - config.retention * 24 * 60 * 60 * 1000);
            for (const destination of config.destinations) {
                if (destination.type === 'local') {
                    const files = await promises_1.default.readdir(destination.path);
                    for (const file of files) {
                        if (file.endsWith('_metadata.json')) {
                            const metadataPath = path_1.default.join(destination.path, file);
                            try {
                                const metadata = JSON.parse(await promises_1.default.readFile(metadataPath, 'utf-8'));
                                if (new Date(metadata.storedAt) < cutoffDate) {
                                    // Remove backup files
                                    for (const backupFile of metadata.files) {
                                        const filePath = path_1.default.join(destination.path, backupFile);
                                        try {
                                            await promises_1.default.unlink(filePath);
                                        }
                                        catch (error) {
                                            logger_1.logger.error('Failed to delete backup file:', { filePath, error });
                                        }
                                    }
                                    // Remove metadata file
                                    await promises_1.default.unlink(metadataPath);
                                    logger_1.logger.info('Cleaned up old backup', { backupId: metadata.job.id });
                                }
                            }
                            catch (error) {
                                logger_1.logger.error('Failed to read backup metadata:', { metadataPath, error });
                            }
                        }
                    }
                }
            }
        }
        catch (error) {
            logger_1.logger.error('Failed to cleanup old backups:', error);
        }
    }
    /**
     * Restore from backup
     */
    async restoreFromBackup(backupId) {
        try {
            const backupJob = this.backupJobs.find(job => job.id === backupId);
            if (!backupJob) {
                throw new Error(`Backup '${backupId}' not found`);
            }
            const restoreJob = {
                id: this.generateJobId(),
                backupId,
                status: 'pending',
                startTime: new Date(),
                files: [],
                metadata: {
                    restoredBy: 'system',
                    environment: process.env.NODE_ENV || 'development',
                },
            };
            this.restoreJobs.push(restoreJob);
            await this.executeRestore(restoreJob, backupJob);
            return restoreJob;
        }
        catch (error) {
            logger_1.logger.error('Failed to create restore job:', error);
            throw error;
        }
    }
    /**
     * Execute restore
     */
    async executeRestore(restoreJob, backupJob) {
        try {
            restoreJob.status = 'running';
            logger_1.logger.info('Starting restore job', { restoreJobId: restoreJob.id, backupId: backupJob.id });
            // Find backup files
            const backupFiles = await this.findBackupFiles(backupJob);
            if (backupFiles.length === 0) {
                throw new Error('No backup files found');
            }
            // Decrypt and decompress files
            const processedFiles = await this.processRestoreFiles(backupFiles, backupJob);
            // Restore data
            await this.restoreData(processedFiles, backupJob);
            // Update job status
            restoreJob.status = 'completed';
            restoreJob.endTime = new Date();
            restoreJob.files = processedFiles;
            logger_1.logger.info('Restore completed successfully', {
                restoreJobId: restoreJob.id,
                backupId: backupJob.id,
                files: restoreJob.files.length,
            });
        }
        catch (error) {
            restoreJob.status = 'failed';
            restoreJob.endTime = new Date();
            restoreJob.error = error instanceof Error ? error.message : 'Unknown error';
            logger_1.logger.error('Restore failed', {
                restoreJobId: restoreJob.id,
                backupId: backupJob.id,
                error: restoreJob.error,
            });
        }
    }
    /**
     * Find backup files
     */
    async findBackupFiles(backupJob) {
        const files = [];
        for (const destination of backupJob.config.destinations) {
            if (destination.type === 'local') {
                const dirFiles = await promises_1.default.readdir(destination.path);
                for (const file of dirFiles) {
                    if (file.startsWith(backupJob.id)) {
                        files.push(path_1.default.join(destination.path, file));
                    }
                }
            }
            // Add other destination types as needed
        }
        return files;
    }
    /**
     * Process restore files (decrypt and decompress)
     */
    async processRestoreFiles(files, backupJob) {
        const processedFiles = [];
        for (const file of files) {
            let processedFile = file;
            // Decrypt
            if (backupJob.config.encryption && file.endsWith('.enc')) {
                processedFile = await this.decryptFile(file);
                await promises_1.default.unlink(file); // Remove encrypted
            }
            // Decompress
            if (backupJob.config.compression && processedFile.endsWith('.gz')) {
                processedFile = await this.decompressFile(processedFile);
                await promises_1.default.unlink(processedFile); // Remove compressed
            }
            processedFiles.push(processedFile);
        }
        return processedFiles;
    }
    /**
     * Decrypt file
     */
    async decryptFile(filePath) {
        const decryptedPath = filePath.replace('.enc', '');
        const encrypted = await promises_1.default.readFile(filePath);
        // Simple XOR decryption (in production, use proper decryption)
        const decrypted = Buffer.from(encrypted.map(byte => byte ^ this.encryptionKey.charCodeAt(0)));
        await promises_1.default.writeFile(decryptedPath, decrypted);
        return decryptedPath;
    }
    /**
     * Decompress file
     */
    async decompressFile(filePath) {
        const decompressedPath = filePath.replace('.gz', '');
        await execAsync(`gunzip "${filePath}"`);
        return decompressedPath;
    }
    /**
     * Restore data
     */
    async restoreData(files, backupJob) {
        try {
            switch (backupJob.config.type) {
                case 'database':
                    await this.restoreDatabase(files);
                    break;
                case 'files':
                    await this.restoreFiles(files);
                    break;
                case 'logs':
                    await this.restoreLogs(files);
                    break;
                case 'config':
                    await this.restoreConfig(files);
                    break;
                case 'full':
                    await this.restoreFull(files);
                    break;
            }
            logger_1.logger.info('Data restored successfully', {
                files: files.length,
                type: backupJob.config.type,
            });
        }
        catch (error) {
            logger_1.logger.error('Data restore failed:', error);
            throw error;
        }
    }
    /**
     * Restore database
     */
    async restoreDatabase(files) {
        for (const file of files) {
            if (file.includes('database-') && file.endsWith('.sql')) {
                if (file.includes('mongodb')) {
                    const command = `mongorestore --uri="${process.env.MONGODB_URI}" --drop "${file}"`;
                    await execAsync(command);
                }
                else if (file.includes('postgres')) {
                    const command = `psql "${process.env.DATABASE_URL}" < "${file}"`;
                    await execAsync(command);
                }
                break;
            }
        }
    }
    /**
     * Restore files
     */
    async restoreFiles(files) {
        for (const file of files) {
            if (file.includes('files-') && file.endsWith('.tar.gz')) {
                const command = `tar -xzf "${file}" -C .`;
                await execAsync(command);
            }
        }
    }
    /**
     * Restore logs
     */
    async restoreLogs(files) {
        for (const file of files) {
            if (file.includes('logs-') && file.endsWith('.tar.gz')) {
                const command = `tar -xzf "${file}" -C .`;
                await execAsync(command);
            }
        }
    }
    /**
     * Restore configuration
     */
    async restoreConfig(files) {
        for (const file of files) {
            if (file.includes('config-') && file.endsWith('.tar.gz')) {
                const command = `tar -xzf "${file}" -C .`;
                await execAsync(command);
            }
        }
    }
    /**
     * Full restore
     */
    async restoreFull(files) {
        await this.restoreDatabase(files);
        await this.restoreFiles(files);
        await this.restoreLogs(files);
        await this.restoreConfig(files);
    }
    /**
     * Get backup jobs
     */
    getBackupJobs() {
        return this.backupJobs.sort((a, b) => b.startTime.getTime() - a.startTime.getTime());
    }
    /**
     * Get restore jobs
     */
    getRestoreJobs() {
        return this.restoreJobs.sort((a, b) => b.startTime.getTime() - a.startTime.getTime());
    }
    /**
     * Get backup configurations
     */
    getBackupConfigs() {
        return this.backupConfigs;
    }
    /**
     * Add backup configuration
     */
    addBackupConfig(config) {
        this.backupConfigs.push(config);
        logger_1.logger.info('Backup configuration added', { name: config.name });
    }
    /**
     * Start scheduled backups
     */
    startScheduledBackups() {
        // This would integrate with a cron scheduler
        // For now, just log that it would start
        logger_1.logger.info('Scheduled backups configured', {
            configs: this.backupConfigs.filter(c => c.enabled).length,
        });
    }
    /**
     * Generate job ID
     */
    generateJobId() {
        return `job_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
    }
    /**
     * Get backup statistics
     */
    async getStats() {
        try {
            const totalBackups = this.backupJobs.length;
            const successfulBackups = this.backupJobs.filter(job => job.status === 'completed').length;
            const failedBackups = this.backupJobs.filter(job => job.status === 'failed').length;
            const totalSize = this.backupJobs.reduce((sum, job) => sum + job.size, 0);
            const averageSize = totalBackups > 0 ? totalSize / totalBackups : 0;
            const backupsByType = {};
            this.backupJobs.forEach(job => {
                backupsByType[job.config.type] = (backupsByType[job.config.type] || 0) + 1;
            });
            const recentBackups = this.backupJobs
                .sort((a, b) => b.startTime.getTime() - a.startTime.getTime())
                .slice(0, 10)
                .map(job => ({
                id: job.id,
                type: job.config.type,
                status: job.status,
                size: job.size,
                timestamp: job.startTime,
            }));
            return {
                totalBackups,
                successfulBackups,
                failedBackups,
                totalSize,
                averageSize,
                backupsByType,
                recentBackups,
            };
        }
        catch (error) {
            logger_1.logger.error('Failed to get backup stats:', error);
            return {
                totalBackups: 0,
                successfulBackups: 0,
                failedBackups: 0,
                totalSize: 0,
                averageSize: 0,
                backupsByType: {},
                recentBackups: [],
            };
        }
    }
};
exports.BackupRestoreService = BackupRestoreService;
exports.BackupRestoreService = BackupRestoreService = __decorate([
    (0, inversify_1.injectable)(),
    __metadata("design:paramtypes", [])
], BackupRestoreService);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxBbGVqYW5kcm9cXEFJR2VzdGlvblxcYmFja2VuZFxcc3JjXFxzZXJ2aWNlc1xcYmFja3VwLXJlc3RvcmUuc2VydmljZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBQSxpREFBcUM7QUFDckMsb0RBQTRCO0FBQzVCLDJEQUE2QjtBQUM3Qix5Q0FBdUM7QUFDdkMsZ0RBQXdCO0FBQ3hCLCtCQUFpQztBQUNqQyw0Q0FBeUM7QUFFekMsTUFBTSxTQUFTLEdBQUcsSUFBQSxnQkFBUyxFQUFDLG9CQUFJLENBQUMsQ0FBQztBQXNEM0IsSUFBTSxvQkFBb0IsR0FBMUIsTUFBTSxvQkFBb0I7SUFDZCxTQUFTLEdBQUcsU0FBUyxDQUFDO0lBQ3RCLGFBQWEsQ0FBUztJQUN0QixhQUFhLEdBQW1CLEVBQUUsQ0FBQztJQUNuQyxVQUFVLEdBQWdCLEVBQUUsQ0FBQztJQUM3QixXQUFXLEdBQWlCLEVBQUUsQ0FBQztJQUMvQixPQUFPLEdBQUcsSUFBSSxDQUFDO0lBRWhDO1FBQ0UsSUFBSSxDQUFDLGFBQWE7WUFDaEIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxxQkFBcUIsSUFBSSxnQkFBTSxDQUFDLFdBQVcsQ0FBQyxFQUFFLENBQUMsQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDOUUsSUFBSSxDQUFDLHlCQUF5QixFQUFFLENBQUM7UUFDakMsSUFBSSxDQUFDLHdCQUF3QixFQUFFLENBQUM7UUFDaEMsSUFBSSxDQUFDLHFCQUFxQixFQUFFLENBQUM7SUFDL0IsQ0FBQztJQUVPLEtBQUssQ0FBQyx5QkFBeUI7UUFDckMsSUFBSSxDQUFDO1lBQ0gsTUFBTSxrQkFBRSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7WUFDcEQsTUFBTSxrQkFBRSxDQUFDLEtBQUssQ0FBQyxjQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsVUFBVSxDQUFDLEVBQUUsRUFBRSxT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SixDQUFDO0lBQ0gsQ0FBQztDQUNGLENBQUE7QUFsNkJZLG9EQUFvQjsrQkFBcEIsb0JBQW9CO0lBRGhDLElBQUEsc0JBQVUsR0FBRTs7R0FDQSxvQkFBb0IsQ0FrNkJoQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXEFsZWphbmRyb1xcQUlHZXN0aW9uXFxiYWNrZW5kXFxzcmNcXHNlcnZpY2VzXFxiYWNrdXAtcmVzdG9yZS5zZXJ2aWNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGV4ZWMgfSBmcm9tICdjaGlsZF9wcm9jZXNzJztcbmltcG9ydCBjcnlwdG8gZnJvbSAnY3J5cHRvJztcbmltcG9ydCBmcyBmcm9tICdmcy9wcm9taXNlcyc7XG5pbXBvcnQgeyBpbmplY3RhYmxlIH0gZnJvbSAnaW52ZXJzaWZ5JztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IHsgcHJvbWlzaWZ5IH0gZnJvbSAndXRpbCc7XG5pbXBvcnQgeyBsb2dnZXIgfSBmcm9tICcuLi91dGlscy9sb2dnZXInO1xuXG5jb25zdCBleGVjQXN5bmMgPSBwcm9taXNpZnkoZXhlYyk7XG5cbmludGVyZmFjZSBCYWNrdXBDb25maWcge1xuICBuYW1lOiBzdHJpbmc7XG4gIHR5cGU6ICdkYXRhYmFzZScgfCAnZmlsZXMnIHwgJ2xvZ3MnIHwgJ2NvbmZpZycgfCAnZnVsbCc7XG4gIHNjaGVkdWxlOiBzdHJpbmc7IC8vIENyb24gZXhwcmVzc2lvblxuICBlbmFibGVkOiBib29sZWFuO1xuICByZXRlbnRpb246IG51bWJlcjsgLy8gRGF5c1xuICBjb21wcmVzc2lvbjogYm9vbGVhbjtcbiAgZW5jcnlwdGlvbjogYm9vbGVhbjtcbiAgZGVzdGluYXRpb25zOiBCYWNrdXBEZXN0aW5hdGlvbltdO1xufVxuXG5pbnRlcmZhY2UgQmFja3VwRGVzdGluYXRpb24ge1xuICB0eXBlOiAnbG9jYWwnIHwgJ3MzJyB8ICdnY3MnIHwgJ2F6dXJlJztcbiAgcGF0aDogc3RyaW5nO1xuICBjcmVkZW50aWFscz86IHtcbiAgICBhY2Nlc3NLZXlJZD86IHN0cmluZztcbiAgICBzZWNyZXRBY2Nlc3NLZXk/OiBzdHJpbmc7XG4gICAgYnVja2V0Pzogc3RyaW5nO1xuICAgIHJlZ2lvbj86IHN0cmluZztcbiAgICBjb25uZWN0aW9uU3RyaW5nPzogc3RyaW5nO1xuICB9O1xufVxuXG5pbnRlcmZhY2UgQmFja3VwSm9iIHtcbiAgaWQ6IHN0cmluZztcbiAgY29uZmlnOiBCYWNrdXBDb25maWc7XG4gIHN0YXR1czogJ3BlbmRpbmcnIHwgJ3J1bm5pbmcnIHwgJ2NvbXBsZXRlZCcgfCAnZmFpbGVkJztcbiAgc3RhcnRUaW1lOiBEYXRlO1xuICBlbmRUaW1lPzogRGF0ZTtcbiAgc2l6ZTogbnVtYmVyO1xuICBmaWxlczogc3RyaW5nW107XG4gIGNoZWNrc3VtOiBzdHJpbmc7XG4gIGVycm9yPzogc3RyaW5nO1xuICBtZXRhZGF0YToge1xuICAgIFtrZXk6IHN0cmluZ106IGFueTtcbiAgfTtcbn1cblxuaW50ZXJmYWNlIFJlc3RvcmVKb2Ige1xuICBpZDogc3RyaW5nO1xuICBiYWNrdXBJZDogc3RyaW5nO1xuICBzdGF0dXM6ICdwZW5kaW5nJyB8ICdydW5uaW5nJyB8ICdjb21wbGV0ZWQnIHwgJ2ZhaWxlZCc7XG4gIHN0YXJ0VGltZTogRGF0ZTtcbiAgZW5kVGltZT86IERhdGU7XG4gIGZpbGVzOiBzdHJpbmdbXTtcbiAgZXJyb3I/OiBzdHJpbmc7XG4gIG1ldGFkYXRhOiB7XG4gICAgW2tleTogc3RyaW5nXTogYW55O1xuICB9O1xufVxuXG5AaW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgQmFja3VwUmVzdG9yZVNlcnZpY2Uge1xuICBwcml2YXRlIHJlYWRvbmx5IGJhY2t1cERpciA9ICdiYWNrdXBzJztcbiAgcHJpdmF0ZSByZWFkb25seSBlbmNyeXB0aW9uS2V5OiBzdHJpbmc7XG4gIHByaXZhdGUgcmVhZG9ubHkgYmFja3VwQ29uZmlnczogQmFja3VwQ29uZmlnW10gPSBbXTtcbiAgcHJpdmF0ZSByZWFkb25seSBiYWNrdXBKb2JzOiBCYWNrdXBKb2JbXSA9IFtdO1xuICBwcml2YXRlIHJlYWRvbmx5IHJlc3RvcmVKb2JzOiBSZXN0b3JlSm9iW10gPSBbXTtcbiAgcHJpdmF0ZSByZWFkb25seSBtYXhKb2JzID0gMTAwMDtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmVuY3J5cHRpb25LZXkgPVxuICAgICAgcHJvY2Vzcy5lbnYuQkFDS1VQX0VOQ1JZUFRJT05fS0VZIHx8IGNyeXB0by5yYW5kb21CeXRlcygzMikudG9TdHJpbmcoJ2hleCcpO1xuICAgIHRoaXMuaW5pdGlhbGl6ZUJhY2t1cERpcmVjdG9yeSgpO1xuICAgIHRoaXMuaW5pdGlhbGl6ZURlZmF1bHRDb25maWdzKCk7XG4gICAgdGhpcy5zdGFydFNjaGVkdWxlZEJhY2t1cHMoKTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgaW5pdGlhbGl6ZUJhY2t1cERpcmVjdG9yeSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgZnMubWtkaXIodGhpcy5iYWNrdXBEaXIsIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xuICAgICAgYXdhaXQgZnMubWtkaXIocGF0aC5qb2luKHRoaXMuYmFja3VwRGlyLCAnZGF0YWJhc2UnKSwgeyByZWN1cnNpdmU6IHRydWUgfSk7XG4gICAgICBhd2FpdCBmcy5ta2RpcihwYXRoLmpvaW4odGhpcy5iYWNrdXBEaXIsICdmaWxlcycpLCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KTtcbiAgICAgIGF3YWl0IGZzLm1rZGlyKHBhdGguam9pbih0aGlzLmJhY2t1cERpciwgJ2xvZ3MnKSwgeyByZWN1cnNpdmU6IHRydWUgfSk7XG4gICAgICBhd2FpdCBmcy5ta2RpcihwYXRoLmpvaW4odGhpcy5iYWNrdXBEaXIsICdjb25maWcnKSwgeyByZWN1cnNpdmU6IHRydWUgfSk7XG5cbiAgICAgIGxvZ2dlci5pbmZvKCdCYWNrdXAgZGlyZWN0b3J5IGluaXRpYWxpemVkJyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRmFpbGVkIHRvIGluaXRpYWxpemUgYmFja3VwIGRpcmVjdG9yeTonLCBlcnJvcik7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBpbml0aWFsaXplRGVmYXVsdENvbmZpZ3MoKTogdm9pZCB7XG4gICAgdGhpcy5iYWNrdXBDb25maWdzLnB1c2goXG4gICAgICB7XG4gICAgICAgIG5hbWU6ICdkYWlseS1kYXRhYmFzZScsXG4gICAgICAgIHR5cGU6ICdkYXRhYmFzZScsXG4gICAgICAgIHNjaGVkdWxlOiAnMCAyICogKiAqJywgLy8gMiBBTSBkYWlseVxuICAgICAgICBlbmFibGVkOiB0cnVlLFxuICAgICAgICByZXRlbnRpb246IDMwLFxuICAgICAgICBjb21wcmVzc2lvbjogdHJ1ZSxcbiAgICAgICAgZW5jcnlwdGlvbjogdHJ1ZSxcbiAgICAgICAgZGVzdGluYXRpb25zOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgdHlwZTogJ2xvY2FsJyxcbiAgICAgICAgICAgIHBhdGg6IHBhdGguam9pbih0aGlzLmJhY2t1cERpciwgJ2RhdGFiYXNlJyksXG4gICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIG5hbWU6ICd3ZWVrbHktZnVsbCcsXG4gICAgICAgIHR5cGU6ICdmdWxsJyxcbiAgICAgICAgc2NoZWR1bGU6ICcwIDMgKiAqIDAnLCAvLyAzIEFNIG9uIFN1bmRheXNcbiAgICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgICAgcmV0ZW50aW9uOiA5MCxcbiAgICAgICAgY29tcHJlc3Npb246IHRydWUsXG4gICAgICAgIGVuY3J5cHRpb246IHRydWUsXG4gICAgICAgIGRlc3RpbmF0aW9uczogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIHR5cGU6ICdsb2NhbCcsXG4gICAgICAgICAgICBwYXRoOiB0aGlzLmJhY2t1cERpcixcbiAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgbmFtZTogJ2hvdXJseS1sb2dzJyxcbiAgICAgICAgdHlwZTogJ2xvZ3MnLFxuICAgICAgICBzY2hlZHVsZTogJzAgKiAqICogKicsIC8vIEV2ZXJ5IGhvdXJcbiAgICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgICAgcmV0ZW50aW9uOiA3LFxuICAgICAgICBjb21wcmVzc2lvbjogdHJ1ZSxcbiAgICAgICAgZW5jcnlwdGlvbjogZmFsc2UsXG4gICAgICAgIGRlc3RpbmF0aW9uczogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIHR5cGU6ICdsb2NhbCcsXG4gICAgICAgICAgICBwYXRoOiBwYXRoLmpvaW4odGhpcy5iYWNrdXBEaXIsICdsb2dzJyksXG4gICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIG5hbWU6ICdkYWlseS1maWxlcycsXG4gICAgICAgIHR5cGU6ICdmaWxlcycsXG4gICAgICAgIHNjaGVkdWxlOiAnMCAxICogKiAqJywgLy8gMSBBTSBkYWlseVxuICAgICAgICBlbmFibGVkOiB0cnVlLFxuICAgICAgICByZXRlbnRpb246IDMwLFxuICAgICAgICBjb21wcmVzc2lvbjogdHJ1ZSxcbiAgICAgICAgZW5jcnlwdGlvbjogdHJ1ZSxcbiAgICAgICAgZGVzdGluYXRpb25zOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgdHlwZTogJ2xvY2FsJyxcbiAgICAgICAgICAgIHBhdGg6IHBhdGguam9pbih0aGlzLmJhY2t1cERpciwgJ2ZpbGVzJyksXG4gICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgIH0sXG4gICAgKTtcblxuICAgIGxvZ2dlci5pbmZvKCdEZWZhdWx0IGJhY2t1cCBjb25maWd1cmF0aW9ucyBpbml0aWFsaXplZCcsIHtcbiAgICAgIHRvdGFsQ29uZmlnczogdGhpcy5iYWNrdXBDb25maWdzLmxlbmd0aCxcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGUgYmFja3VwIGpvYlxuICAgKi9cbiAgcHVibGljIGFzeW5jIGNyZWF0ZUJhY2t1cChcbiAgICBjb25maWdOYW1lOiBzdHJpbmcsXG4gICAgY3VzdG9tT3B0aW9ucz86IFBhcnRpYWw8QmFja3VwQ29uZmlnPixcbiAgKTogUHJvbWlzZTxCYWNrdXBKb2I+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgY29uZmlnID0gdGhpcy5iYWNrdXBDb25maWdzLmZpbmQoYyA9PiBjLm5hbWUgPT09IGNvbmZpZ05hbWUpO1xuICAgICAgaWYgKCFjb25maWcpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBCYWNrdXAgY29uZmlndXJhdGlvbiAnJHtjb25maWdOYW1lfScgbm90IGZvdW5kYCk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IG1lcmdlZENvbmZpZyA9IHsgLi4uY29uZmlnLCAuLi5jdXN0b21PcHRpb25zIH07XG4gICAgICBjb25zdCBqb2I6IEJhY2t1cEpvYiA9IHtcbiAgICAgICAgaWQ6IHRoaXMuZ2VuZXJhdGVKb2JJZCgpLFxuICAgICAgICBjb25maWc6IG1lcmdlZENvbmZpZyxcbiAgICAgICAgc3RhdHVzOiAncGVuZGluZycsXG4gICAgICAgIHN0YXJ0VGltZTogbmV3IERhdGUoKSxcbiAgICAgICAgc2l6ZTogMCxcbiAgICAgICAgZmlsZXM6IFtdLFxuICAgICAgICBjaGVja3N1bTogJycsXG4gICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgY3JlYXRlZEJ5OiAnc3lzdGVtJyxcbiAgICAgICAgICBlbnZpcm9ubWVudDogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgfHwgJ2RldmVsb3BtZW50JyxcbiAgICAgICAgfSxcbiAgICAgIH07XG5cbiAgICAgIHRoaXMuYmFja3VwSm9icy5wdXNoKGpvYik7XG4gICAgICBhd2FpdCB0aGlzLmV4ZWN1dGVCYWNrdXAoam9iKTtcblxuICAgICAgcmV0dXJuIGpvYjtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdGYWlsZWQgdG8gY3JlYXRlIGJhY2t1cCBqb2I6JywgZXJyb3IpO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEV4ZWN1dGUgYmFja3VwXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGV4ZWN1dGVCYWNrdXAoam9iOiBCYWNrdXBKb2IpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgam9iLnN0YXR1cyA9ICdydW5uaW5nJztcbiAgICAgIGxvZ2dlci5pbmZvKCdTdGFydGluZyBiYWNrdXAgam9iJywgeyBqb2JJZDogam9iLmlkLCBjb25maWc6IGpvYi5jb25maWcubmFtZSB9KTtcblxuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgIGxldCB0b3RhbFNpemUgPSAwO1xuICAgICAgY29uc3QgZmlsZXM6IHN0cmluZ1tdID0gW107XG5cbiAgICAgIHN3aXRjaCAoam9iLmNvbmZpZy50eXBlKSB7XG4gICAgICAgIGNhc2UgJ2RhdGFiYXNlJzpcbiAgICAgICAgICBhd2FpdCB0aGlzLmJhY2t1cERhdGFiYXNlKGpvYiwgZmlsZXMsIHRvdGFsU2l6ZSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ2ZpbGVzJzpcbiAgICAgICAgICBhd2FpdCB0aGlzLmJhY2t1cEZpbGVzKGpvYiwgZmlsZXMsIHRvdGFsU2l6ZSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ2xvZ3MnOlxuICAgICAgICAgIGF3YWl0IHRoaXMuYmFja3VwTG9ncyhqb2IsIGZpbGVzLCB0b3RhbFNpemUpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdjb25maWcnOlxuICAgICAgICAgIGF3YWl0IHRoaXMuYmFja3VwQ29uZmlnKGpvYiwgZmlsZXMsIHRvdGFsU2l6ZSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ2Z1bGwnOlxuICAgICAgICAgIGF3YWl0IHRoaXMuYmFja3VwRnVsbChqb2IsIGZpbGVzLCB0b3RhbFNpemUpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgfVxuXG4gICAgICAvLyBQcm9jZXNzIGJhY2t1cCAoY29tcHJlc3MgYW5kIGVuY3J5cHQpXG4gICAgICBjb25zdCBwcm9jZXNzZWRGaWxlcyA9IGF3YWl0IHRoaXMucHJvY2Vzc0JhY2t1cChqb2IsIGZpbGVzKTtcblxuICAgICAgLy8gU3RvcmUgYmFja3VwXG4gICAgICBhd2FpdCB0aGlzLnN0b3JlQmFja3VwKGpvYiwgcHJvY2Vzc2VkRmlsZXMpO1xuXG4gICAgICAvLyBVcGRhdGUgam9iIHN0YXR1c1xuICAgICAgam9iLnN0YXR1cyA9ICdjb21wbGV0ZWQnO1xuICAgICAgam9iLmVuZFRpbWUgPSBuZXcgRGF0ZSgpO1xuICAgICAgam9iLnNpemUgPSB0b3RhbFNpemU7XG4gICAgICBqb2IuZmlsZXMgPSBwcm9jZXNzZWRGaWxlcztcbiAgICAgIGpvYi5jaGVja3N1bSA9IGF3YWl0IHRoaXMuY2FsY3VsYXRlQ2hlY2tzdW0ocHJvY2Vzc2VkRmlsZXMpO1xuXG4gICAgICBjb25zdCBkdXJhdGlvbiA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7XG4gICAgICBsb2dnZXIuaW5mbygnQmFja3VwIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHknLCB7XG4gICAgICAgIGpvYklkOiBqb2IuaWQsXG4gICAgICAgIGNvbmZpZzogam9iLmNvbmZpZy5uYW1lLFxuICAgICAgICBkdXJhdGlvbixcbiAgICAgICAgc2l6ZTogam9iLnNpemUsXG4gICAgICAgIGZpbGVzOiBqb2IuZmlsZXMubGVuZ3RoLFxuICAgICAgfSk7XG5cbiAgICAgIC8vIENsZWFudXAgb2xkIGJhY2t1cHNcbiAgICAgIGF3YWl0IHRoaXMuY2xlYW51cE9sZEJhY2t1cHMoam9iLmNvbmZpZyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGpvYi5zdGF0dXMgPSAnZmFpbGVkJztcbiAgICAgIGpvYi5lbmRUaW1lID0gbmV3IERhdGUoKTtcbiAgICAgIGpvYi5lcnJvciA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InO1xuXG4gICAgICBsb2dnZXIuZXJyb3IoJ0JhY2t1cCBmYWlsZWQnLCB7XG4gICAgICAgIGpvYklkOiBqb2IuaWQsXG4gICAgICAgIGNvbmZpZzogam9iLmNvbmZpZy5uYW1lLFxuICAgICAgICBlcnJvcjogam9iLmVycm9yLFxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEJhY2t1cCBkYXRhYmFzZVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBiYWNrdXBEYXRhYmFzZShqb2I6IEJhY2t1cEpvYiwgZmlsZXM6IHN0cmluZ1tdLCB0b3RhbFNpemU6IG51bWJlcik6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB0aW1lc3RhbXAgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkucmVwbGFjZSgvWzouXS9nLCAnLScpO1xuICAgICAgY29uc3QgYmFja3VwRmlsZSA9IHBhdGguam9pbih0aGlzLmJhY2t1cERpciwgJ2RhdGFiYXNlJywgYGRhdGFiYXNlLSR7dGltZXN0YW1wfS5zcWxgKTtcblxuICAgICAgLy8gTW9uZ29EQiBiYWNrdXBcbiAgICAgIGlmIChwcm9jZXNzLmVudi5NT05HT0RCX1VSSSkge1xuICAgICAgICBjb25zdCBjb21tYW5kID0gYG1vbmdvZHVtcCAtLXVyaT1cIiR7cHJvY2Vzcy5lbnYuTU9OR09EQl9VUkl9XCIgLS1vdXQ9XCIke2JhY2t1cEZpbGV9XCJgO1xuICAgICAgICBhd2FpdCBleGVjQXN5bmMoY29tbWFuZCk7XG4gICAgICAgIGZpbGVzLnB1c2goYmFja3VwRmlsZSk7XG5cbiAgICAgICAgY29uc3Qgc3RhdHMgPSBhd2FpdCBmcy5zdGF0KGJhY2t1cEZpbGUpO1xuICAgICAgICB0b3RhbFNpemUgKz0gc3RhdHMuc2l6ZTtcbiAgICAgIH1cblxuICAgICAgLy8gUG9zdGdyZVNRTCBiYWNrdXBcbiAgICAgIGlmIChwcm9jZXNzLmVudi5EQVRBQkFTRV9VUkwpIHtcbiAgICAgICAgY29uc3QgcGdCYWNrdXBGaWxlID0gcGF0aC5qb2luKHRoaXMuYmFja3VwRGlyLCAnZGF0YWJhc2UnLCBgcG9zdGdyZXMtJHt0aW1lc3RhbXB9LnNxbGApO1xuICAgICAgICBjb25zdCBjb21tYW5kID0gYHBnX2R1bXAgXCIke3Byb2Nlc3MuZW52LkRBVEFCQVNFX1VSTH1cIiA+IFwiJHtwZ0JhY2t1cEZpbGV9XCJgO1xuICAgICAgICBhd2FpdCBleGVjQXN5bmMoY29tbWFuZCk7XG4gICAgICAgIGZpbGVzLnB1c2gocGdCYWNrdXBGaWxlKTtcblxuICAgICAgICBjb25zdCBzdGF0cyA9IGF3YWl0IGZzLnN0YXQocGdCYWNrdXBGaWxlKTtcbiAgICAgICAgdG90YWxTaXplICs9IHN0YXRzLnNpemU7XG4gICAgICB9XG5cbiAgICAgIGxvZ2dlci5pbmZvKCdEYXRhYmFzZSBiYWNrdXAgY29tcGxldGVkJywgeyBmaWxlczogZmlsZXMubGVuZ3RoLCBzaXplOiB0b3RhbFNpemUgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRGF0YWJhc2UgYmFja3VwIGZhaWxlZDonLCBlcnJvcik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQmFja3VwIGZpbGVzXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGJhY2t1cEZpbGVzKGpvYjogQmFja3VwSm9iLCBmaWxlczogc3RyaW5nW10sIHRvdGFsU2l6ZTogbnVtYmVyKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5yZXBsYWNlKC9bOi5dL2csICctJyk7XG4gICAgICBjb25zdCBiYWNrdXBGaWxlID0gcGF0aC5qb2luKHRoaXMuYmFja3VwRGlyLCAnZmlsZXMnLCBgZmlsZXMtJHt0aW1lc3RhbXB9LnRhci5nemApO1xuXG4gICAgICAvLyBDcmVhdGUgdGFyIGFyY2hpdmUgb2YgaW1wb3J0YW50IGRpcmVjdG9yaWVzXG4gICAgICBjb25zdCBkaXJlY3RvcmllcyA9IFsndXBsb2FkcycsICdxdWFyYW50aW5lJywgJ2RhdGEnXTtcblxuICAgICAgbGV0IHRhckNvbW1hbmQgPSBgdGFyIC1jemYgXCIke2JhY2t1cEZpbGV9XCJgO1xuICAgICAgZm9yIChjb25zdCBkaXIgb2YgZGlyZWN0b3JpZXMpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBhd2FpdCBmcy5hY2Nlc3MoZGlyKTtcbiAgICAgICAgICB0YXJDb21tYW5kICs9IGAgJHtkaXJ9YDtcbiAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgLy8gRGlyZWN0b3J5IGRvZXNuJ3QgZXhpc3QsIHNraXBcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBhd2FpdCBleGVjQXN5bmModGFyQ29tbWFuZCk7XG4gICAgICBmaWxlcy5wdXNoKGJhY2t1cEZpbGUpO1xuXG4gICAgICBjb25zdCBzdGF0cyA9IGF3YWl0IGZzLnN0YXQoYmFja3VwRmlsZSk7XG4gICAgICB0b3RhbFNpemUgKz0gc3RhdHMuc2l6ZTtcblxuICAgICAgbG9nZ2VyLmluZm8oJ0ZpbGVzIGJhY2t1cCBjb21wbGV0ZWQnLCB7IGZpbGVzOiBmaWxlcy5sZW5ndGgsIHNpemU6IHRvdGFsU2l6ZSB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdGaWxlcyBiYWNrdXAgZmFpbGVkOicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBCYWNrdXAgbG9nc1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBiYWNrdXBMb2dzKGpvYjogQmFja3VwSm9iLCBmaWxlczogc3RyaW5nW10sIHRvdGFsU2l6ZTogbnVtYmVyKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5yZXBsYWNlKC9bOi5dL2csICctJyk7XG4gICAgICBjb25zdCBiYWNrdXBGaWxlID0gcGF0aC5qb2luKHRoaXMuYmFja3VwRGlyLCAnbG9ncycsIGBsb2dzLSR7dGltZXN0YW1wfS50YXIuZ3pgKTtcblxuICAgICAgLy8gQ3JlYXRlIHRhciBhcmNoaXZlIG9mIGxvZ3NcbiAgICAgIGNvbnN0IGxvZ0RpcnMgPSBbJ2xvZ3MnLCAnbW9uaXRvcmluZyddO1xuXG4gICAgICBsZXQgdGFyQ29tbWFuZCA9IGB0YXIgLWN6ZiBcIiR7YmFja3VwRmlsZX1cImA7XG4gICAgICBmb3IgKGNvbnN0IGRpciBvZiBsb2dEaXJzKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgYXdhaXQgZnMuYWNjZXNzKGRpcik7XG4gICAgICAgICAgdGFyQ29tbWFuZCArPSBgICR7ZGlyfWA7XG4gICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgIC8vIERpcmVjdG9yeSBkb2Vzbid0IGV4aXN0LCBza2lwXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgYXdhaXQgZXhlY0FzeW5jKHRhckNvbW1hbmQpO1xuICAgICAgZmlsZXMucHVzaChiYWNrdXBGaWxlKTtcblxuICAgICAgY29uc3Qgc3RhdHMgPSBhd2FpdCBmcy5zdGF0KGJhY2t1cEZpbGUpO1xuICAgICAgdG90YWxTaXplICs9IHN0YXRzLnNpemU7XG5cbiAgICAgIGxvZ2dlci5pbmZvKCdMb2dzIGJhY2t1cCBjb21wbGV0ZWQnLCB7IGZpbGVzOiBmaWxlcy5sZW5ndGgsIHNpemU6IHRvdGFsU2l6ZSB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdMb2dzIGJhY2t1cCBmYWlsZWQ6JywgZXJyb3IpO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEJhY2t1cCBjb25maWd1cmF0aW9uXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGJhY2t1cENvbmZpZyhqb2I6IEJhY2t1cEpvYiwgZmlsZXM6IHN0cmluZ1tdLCB0b3RhbFNpemU6IG51bWJlcik6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB0aW1lc3RhbXAgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkucmVwbGFjZSgvWzouXS9nLCAnLScpO1xuICAgICAgY29uc3QgYmFja3VwRmlsZSA9IHBhdGguam9pbih0aGlzLmJhY2t1cERpciwgJ2NvbmZpZycsIGBjb25maWctJHt0aW1lc3RhbXB9LnRhci5nemApO1xuXG4gICAgICAvLyBDcmVhdGUgdGFyIGFyY2hpdmUgb2YgY29uZmlndXJhdGlvbiBmaWxlc1xuICAgICAgY29uc3QgY29uZmlnRmlsZXMgPSBbJy5lbnYnLCAncGFja2FnZS5qc29uJywgJ3RzY29uZmlnLmpzb24nLCAnZG9ja2VyLWNvbXBvc2UueW1sJ107XG5cbiAgICAgIGxldCB0YXJDb21tYW5kID0gYHRhciAtY3pmIFwiJHtiYWNrdXBGaWxlfVwiYDtcbiAgICAgIGZvciAoY29uc3QgZmlsZSBvZiBjb25maWdGaWxlcykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGF3YWl0IGZzLmFjY2VzcyhmaWxlKTtcbiAgICAgICAgICB0YXJDb21tYW5kICs9IGAgJHtmaWxlfWA7XG4gICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgIC8vIEZpbGUgZG9lc24ndCBleGlzdCwgc2tpcFxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGF3YWl0IGV4ZWNBc3luYyh0YXJDb21tYW5kKTtcbiAgICAgIGZpbGVzLnB1c2goYmFja3VwRmlsZSk7XG5cbiAgICAgIGNvbnN0IHN0YXRzID0gYXdhaXQgZnMuc3RhdChiYWNrdXBGaWxlKTtcbiAgICAgIHRvdGFsU2l6ZSArPSBzdGF0cy5zaXplO1xuXG4gICAgICBsb2dnZXIuaW5mbygnQ29uZmlndXJhdGlvbiBiYWNrdXAgY29tcGxldGVkJywgeyBmaWxlczogZmlsZXMubGVuZ3RoLCBzaXplOiB0b3RhbFNpemUgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignQ29uZmlndXJhdGlvbiBiYWNrdXAgZmFpbGVkOicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBGdWxsIGJhY2t1cFxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBiYWNrdXBGdWxsKGpvYjogQmFja3VwSm9iLCBmaWxlczogc3RyaW5nW10sIHRvdGFsU2l6ZTogbnVtYmVyKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFJ1biBhbGwgYmFja3VwIHR5cGVzXG4gICAgICBhd2FpdCB0aGlzLmJhY2t1cERhdGFiYXNlKGpvYiwgZmlsZXMsIHRvdGFsU2l6ZSk7XG4gICAgICBhd2FpdCB0aGlzLmJhY2t1cEZpbGVzKGpvYiwgZmlsZXMsIHRvdGFsU2l6ZSk7XG4gICAgICBhd2FpdCB0aGlzLmJhY2t1cExvZ3Moam9iLCBmaWxlcywgdG90YWxTaXplKTtcbiAgICAgIGF3YWl0IHRoaXMuYmFja3VwQ29uZmlnKGpvYiwgZmlsZXMsIHRvdGFsU2l6ZSk7XG5cbiAgICAgIGxvZ2dlci5pbmZvKCdGdWxsIGJhY2t1cCBjb21wbGV0ZWQnLCB7IGZpbGVzOiBmaWxlcy5sZW5ndGgsIHNpemU6IHRvdGFsU2l6ZSB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdGdWxsIGJhY2t1cCBmYWlsZWQ6JywgZXJyb3IpO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFByb2Nlc3MgYmFja3VwIChjb21wcmVzcyBhbmQgZW5jcnlwdClcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgcHJvY2Vzc0JhY2t1cChqb2I6IEJhY2t1cEpvYiwgZmlsZXM6IHN0cmluZ1tdKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xuICAgIGNvbnN0IHByb2Nlc3NlZEZpbGVzOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgZm9yIChjb25zdCBmaWxlIG9mIGZpbGVzKSB7XG4gICAgICBsZXQgcHJvY2Vzc2VkRmlsZSA9IGZpbGU7XG5cbiAgICAgIC8vIENvbXByZXNzaW9uXG4gICAgICBpZiAoam9iLmNvbmZpZy5jb21wcmVzc2lvbiAmJiAhZmlsZS5lbmRzV2l0aCgnLmd6JykpIHtcbiAgICAgICAgcHJvY2Vzc2VkRmlsZSA9IGF3YWl0IHRoaXMuY29tcHJlc3NGaWxlKGZpbGUpO1xuICAgICAgICBhd2FpdCBmcy51bmxpbmsoZmlsZSk7IC8vIFJlbW92ZSBvcmlnaW5hbFxuICAgICAgfVxuXG4gICAgICAvLyBFbmNyeXB0aW9uXG4gICAgICBpZiAoam9iLmNvbmZpZy5lbmNyeXB0aW9uKSB7XG4gICAgICAgIHByb2Nlc3NlZEZpbGUgPSBhd2FpdCB0aGlzLmVuY3J5cHRGaWxlKHByb2Nlc3NlZEZpbGUpO1xuICAgICAgICBhd2FpdCBmcy51bmxpbmsocHJvY2Vzc2VkRmlsZS5yZXBsYWNlKCcuZW5jJywgJycpKTsgLy8gUmVtb3ZlIHVuZW5jcnlwdGVkXG4gICAgICB9XG5cbiAgICAgIHByb2Nlc3NlZEZpbGVzLnB1c2gocHJvY2Vzc2VkRmlsZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHByb2Nlc3NlZEZpbGVzO1xuICB9XG5cbiAgLyoqXG4gICAqIENvbXByZXNzIGZpbGVcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgY29tcHJlc3NGaWxlKGZpbGVQYXRoOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGNvbnN0IGNvbXByZXNzZWRQYXRoID0gYCR7ZmlsZVBhdGh9Lmd6YDtcbiAgICBhd2FpdCBleGVjQXN5bmMoYGd6aXAgXCIke2ZpbGVQYXRofVwiYCk7XG4gICAgcmV0dXJuIGNvbXByZXNzZWRQYXRoO1xuICB9XG5cbiAgLyoqXG4gICAqIEVuY3J5cHQgZmlsZVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBlbmNyeXB0RmlsZShmaWxlUGF0aDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICBjb25zdCBlbmNyeXB0ZWRQYXRoID0gYCR7ZmlsZVBhdGh9LmVuY2A7XG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IGZzLnJlYWRGaWxlKGZpbGVQYXRoKTtcblxuICAgIC8vIFNpbXBsZSBYT1IgZW5jcnlwdGlvbiAoaW4gcHJvZHVjdGlvbiwgdXNlIHByb3BlciBlbmNyeXB0aW9uKVxuICAgIGNvbnN0IGVuY3J5cHRlZCA9IEJ1ZmZlci5mcm9tKGRhdGEubWFwKGJ5dGUgPT4gYnl0ZSBeIHRoaXMuZW5jcnlwdGlvbktleS5jaGFyQ29kZUF0KDApKSk7XG4gICAgYXdhaXQgZnMud3JpdGVGaWxlKGVuY3J5cHRlZFBhdGgsIGVuY3J5cHRlZCk7XG5cbiAgICByZXR1cm4gZW5jcnlwdGVkUGF0aDtcbiAgfVxuXG4gIC8qKlxuICAgKiBTdG9yZSBiYWNrdXBcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgc3RvcmVCYWNrdXAoam9iOiBCYWNrdXBKb2IsIGZpbGVzOiBzdHJpbmdbXSk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBmb3IgKGNvbnN0IGRlc3RpbmF0aW9uIG9mIGpvYi5jb25maWcuZGVzdGluYXRpb25zKSB7XG4gICAgICAgIHN3aXRjaCAoZGVzdGluYXRpb24udHlwZSkge1xuICAgICAgICAgIGNhc2UgJ2xvY2FsJzpcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuc3RvcmVCYWNrdXBMb2NhbChqb2IsIGZpbGVzLCBkZXN0aW5hdGlvbi5wYXRoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgJ3MzJzpcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuc3RvcmVCYWNrdXBTMyhqb2IsIGZpbGVzLCBkZXN0aW5hdGlvbik7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlICdnY3MnOlxuICAgICAgICAgICAgYXdhaXQgdGhpcy5zdG9yZUJhY2t1cEdDUyhqb2IsIGZpbGVzLCBkZXN0aW5hdGlvbik7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlICdhenVyZSc6XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnN0b3JlQmFja3VwQXp1cmUoam9iLCBmaWxlcywgZGVzdGluYXRpb24pO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdGYWlsZWQgdG8gc3RvcmUgYmFja3VwOicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBTdG9yZSBiYWNrdXAgbG9jYWxseVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBzdG9yZUJhY2t1cExvY2FsKFxuICAgIGpvYjogQmFja3VwSm9iLFxuICAgIGZpbGVzOiBzdHJpbmdbXSxcbiAgICBkZXN0aW5hdGlvblBhdGg6IHN0cmluZyxcbiAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IGZzLm1rZGlyKGRlc3RpbmF0aW9uUGF0aCwgeyByZWN1cnNpdmU6IHRydWUgfSk7XG5cbiAgICAgIGZvciAoY29uc3QgZmlsZSBvZiBmaWxlcykge1xuICAgICAgICBjb25zdCBmaWxlTmFtZSA9IHBhdGguYmFzZW5hbWUoZmlsZSk7XG4gICAgICAgIGNvbnN0IGRlc3RQYXRoID0gcGF0aC5qb2luKGRlc3RpbmF0aW9uUGF0aCwgYCR7am9iLmlkfV8ke2ZpbGVOYW1lfWApO1xuICAgICAgICBhd2FpdCBmcy5jb3B5RmlsZShmaWxlLCBkZXN0UGF0aCk7XG4gICAgICB9XG5cbiAgICAgIC8vIFN0b3JlIGJhY2t1cCBtZXRhZGF0YVxuICAgICAgY29uc3QgbWV0YWRhdGFQYXRoID0gcGF0aC5qb2luKGRlc3RpbmF0aW9uUGF0aCwgYCR7am9iLmlkfV9tZXRhZGF0YS5qc29uYCk7XG4gICAgICBhd2FpdCBmcy53cml0ZUZpbGUoXG4gICAgICAgIG1ldGFkYXRhUGF0aCxcbiAgICAgICAgSlNPTi5zdHJpbmdpZnkoXG4gICAgICAgICAge1xuICAgICAgICAgICAgam9iLFxuICAgICAgICAgICAgZmlsZXMsXG4gICAgICAgICAgICBzdG9yZWRBdDogbmV3IERhdGUoKSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIG51bGwsXG4gICAgICAgICAgMixcbiAgICAgICAgKSxcbiAgICAgICk7XG5cbiAgICAgIGxvZ2dlci5pbmZvKCdCYWNrdXAgc3RvcmVkIGxvY2FsbHknLCB7IGRlc3RpbmF0aW9uOiBkZXN0aW5hdGlvblBhdGgsIGZpbGVzOiBmaWxlcy5sZW5ndGggfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRmFpbGVkIHRvIHN0b3JlIGJhY2t1cCBsb2NhbGx5OicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBTdG9yZSBiYWNrdXAgdG8gUzMgKHBsYWNlaG9sZGVyKVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBzdG9yZUJhY2t1cFMzKFxuICAgIGpvYjogQmFja3VwSm9iLFxuICAgIGZpbGVzOiBzdHJpbmdbXSxcbiAgICBkZXN0aW5hdGlvbjogQmFja3VwRGVzdGluYXRpb24sXG4gICk6IFByb21pc2U8dm9pZD4ge1xuICAgIC8vIEltcGxlbWVudGF0aW9uIHdvdWxkIHVzZSBBV1MgU0RLXG4gICAgbG9nZ2VyLmluZm8oJ1MzIGJhY2t1cCBzdG9yYWdlIG5vdCBpbXBsZW1lbnRlZCcsIHsgZGVzdGluYXRpb24gfSk7XG4gIH1cblxuICAvKipcbiAgICogU3RvcmUgYmFja3VwIHRvIEdDUyAocGxhY2Vob2xkZXIpXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHN0b3JlQmFja3VwR0NTKFxuICAgIGpvYjogQmFja3VwSm9iLFxuICAgIGZpbGVzOiBzdHJpbmdbXSxcbiAgICBkZXN0aW5hdGlvbjogQmFja3VwRGVzdGluYXRpb24sXG4gICk6IFByb21pc2U8dm9pZD4ge1xuICAgIC8vIEltcGxlbWVudGF0aW9uIHdvdWxkIHVzZSBHb29nbGUgQ2xvdWQgU0RLXG4gICAgbG9nZ2VyLmluZm8oJ0dDUyBiYWNrdXAgc3RvcmFnZSBub3QgaW1wbGVtZW50ZWQnLCB7IGRlc3RpbmF0aW9uIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFN0b3JlIGJhY2t1cCB0byBBenVyZSAocGxhY2Vob2xkZXIpXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHN0b3JlQmFja3VwQXp1cmUoXG4gICAgam9iOiBCYWNrdXBKb2IsXG4gICAgZmlsZXM6IHN0cmluZ1tdLFxuICAgIGRlc3RpbmF0aW9uOiBCYWNrdXBEZXN0aW5hdGlvbixcbiAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgLy8gSW1wbGVtZW50YXRpb24gd291bGQgdXNlIEF6dXJlIFNES1xuICAgIGxvZ2dlci5pbmZvKCdBenVyZSBiYWNrdXAgc3RvcmFnZSBub3QgaW1wbGVtZW50ZWQnLCB7IGRlc3RpbmF0aW9uIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGN1bGF0ZSBjaGVja3N1bVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBjYWxjdWxhdGVDaGVja3N1bShmaWxlczogc3RyaW5nW10pOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGNvbnN0IGhhc2ggPSBjcnlwdG8uY3JlYXRlSGFzaCgnc2hhMjU2Jyk7XG5cbiAgICBmb3IgKGNvbnN0IGZpbGUgb2YgZmlsZXMpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBmcy5yZWFkRmlsZShmaWxlKTtcbiAgICAgICAgaGFzaC51cGRhdGUoZGF0YSk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBsb2dnZXIuZXJyb3IoJ0ZhaWxlZCB0byByZWFkIGZpbGUgZm9yIGNoZWNrc3VtOicsIHsgZmlsZSwgZXJyb3IgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGhhc2guZGlnZXN0KCdoZXgnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDbGVhbnVwIG9sZCBiYWNrdXBzXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGNsZWFudXBPbGRCYWNrdXBzKGNvbmZpZzogQmFja3VwQ29uZmlnKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGN1dG9mZkRhdGUgPSBuZXcgRGF0ZShEYXRlLm5vdygpIC0gY29uZmlnLnJldGVudGlvbiAqIDI0ICogNjAgKiA2MCAqIDEwMDApO1xuXG4gICAgICBmb3IgKGNvbnN0IGRlc3RpbmF0aW9uIG9mIGNvbmZpZy5kZXN0aW5hdGlvbnMpIHtcbiAgICAgICAgaWYgKGRlc3RpbmF0aW9uLnR5cGUgPT09ICdsb2NhbCcpIHtcbiAgICAgICAgICBjb25zdCBmaWxlcyA9IGF3YWl0IGZzLnJlYWRkaXIoZGVzdGluYXRpb24ucGF0aCk7XG5cbiAgICAgICAgICBmb3IgKGNvbnN0IGZpbGUgb2YgZmlsZXMpIHtcbiAgICAgICAgICAgIGlmIChmaWxlLmVuZHNXaXRoKCdfbWV0YWRhdGEuanNvbicpKSB7XG4gICAgICAgICAgICAgIGNvbnN0IG1ldGFkYXRhUGF0aCA9IHBhdGguam9pbihkZXN0aW5hdGlvbi5wYXRoLCBmaWxlKTtcbiAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBtZXRhZGF0YSA9IEpTT04ucGFyc2UoYXdhaXQgZnMucmVhZEZpbGUobWV0YWRhdGFQYXRoLCAndXRmLTgnKSk7XG5cbiAgICAgICAgICAgICAgICBpZiAobmV3IERhdGUobWV0YWRhdGEuc3RvcmVkQXQpIDwgY3V0b2ZmRGF0ZSkge1xuICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIGJhY2t1cCBmaWxlc1xuICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBiYWNrdXBGaWxlIG9mIG1ldGFkYXRhLmZpbGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVQYXRoID0gcGF0aC5qb2luKGRlc3RpbmF0aW9uLnBhdGgsIGJhY2t1cEZpbGUpO1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGZzLnVubGluayhmaWxlUGF0aCk7XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKCdGYWlsZWQgdG8gZGVsZXRlIGJhY2t1cCBmaWxlOicsIHsgZmlsZVBhdGgsIGVycm9yIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBtZXRhZGF0YSBmaWxlXG4gICAgICAgICAgICAgICAgICBhd2FpdCBmcy51bmxpbmsobWV0YWRhdGFQYXRoKTtcblxuICAgICAgICAgICAgICAgICAgbG9nZ2VyLmluZm8oJ0NsZWFuZWQgdXAgb2xkIGJhY2t1cCcsIHsgYmFja3VwSWQ6IG1ldGFkYXRhLmpvYi5pZCB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKCdGYWlsZWQgdG8gcmVhZCBiYWNrdXAgbWV0YWRhdGE6JywgeyBtZXRhZGF0YVBhdGgsIGVycm9yIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRmFpbGVkIHRvIGNsZWFudXAgb2xkIGJhY2t1cHM6JywgZXJyb3IpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZXN0b3JlIGZyb20gYmFja3VwXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgcmVzdG9yZUZyb21CYWNrdXAoYmFja3VwSWQ6IHN0cmluZyk6IFByb21pc2U8UmVzdG9yZUpvYj4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBiYWNrdXBKb2IgPSB0aGlzLmJhY2t1cEpvYnMuZmluZChqb2IgPT4gam9iLmlkID09PSBiYWNrdXBJZCk7XG4gICAgICBpZiAoIWJhY2t1cEpvYikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEJhY2t1cCAnJHtiYWNrdXBJZH0nIG5vdCBmb3VuZGApO1xuICAgICAgfVxuXG4gICAgICBjb25zdCByZXN0b3JlSm9iOiBSZXN0b3JlSm9iID0ge1xuICAgICAgICBpZDogdGhpcy5nZW5lcmF0ZUpvYklkKCksXG4gICAgICAgIGJhY2t1cElkLFxuICAgICAgICBzdGF0dXM6ICdwZW5kaW5nJyxcbiAgICAgICAgc3RhcnRUaW1lOiBuZXcgRGF0ZSgpLFxuICAgICAgICBmaWxlczogW10sXG4gICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgcmVzdG9yZWRCeTogJ3N5c3RlbScsXG4gICAgICAgICAgZW52aXJvbm1lbnQ6IHByb2Nlc3MuZW52Lk5PREVfRU5WIHx8ICdkZXZlbG9wbWVudCcsXG4gICAgICAgIH0sXG4gICAgICB9O1xuXG4gICAgICB0aGlzLnJlc3RvcmVKb2JzLnB1c2gocmVzdG9yZUpvYik7XG4gICAgICBhd2FpdCB0aGlzLmV4ZWN1dGVSZXN0b3JlKHJlc3RvcmVKb2IsIGJhY2t1cEpvYik7XG5cbiAgICAgIHJldHVybiByZXN0b3JlSm9iO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0ZhaWxlZCB0byBjcmVhdGUgcmVzdG9yZSBqb2I6JywgZXJyb3IpO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEV4ZWN1dGUgcmVzdG9yZVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBleGVjdXRlUmVzdG9yZShyZXN0b3JlSm9iOiBSZXN0b3JlSm9iLCBiYWNrdXBKb2I6IEJhY2t1cEpvYik6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICByZXN0b3JlSm9iLnN0YXR1cyA9ICdydW5uaW5nJztcbiAgICAgIGxvZ2dlci5pbmZvKCdTdGFydGluZyByZXN0b3JlIGpvYicsIHsgcmVzdG9yZUpvYklkOiByZXN0b3JlSm9iLmlkLCBiYWNrdXBJZDogYmFja3VwSm9iLmlkIH0pO1xuXG4gICAgICAvLyBGaW5kIGJhY2t1cCBmaWxlc1xuICAgICAgY29uc3QgYmFja3VwRmlsZXMgPSBhd2FpdCB0aGlzLmZpbmRCYWNrdXBGaWxlcyhiYWNrdXBKb2IpO1xuXG4gICAgICBpZiAoYmFja3VwRmlsZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gYmFja3VwIGZpbGVzIGZvdW5kJyk7XG4gICAgICB9XG5cbiAgICAgIC8vIERlY3J5cHQgYW5kIGRlY29tcHJlc3MgZmlsZXNcbiAgICAgIGNvbnN0IHByb2Nlc3NlZEZpbGVzID0gYXdhaXQgdGhpcy5wcm9jZXNzUmVzdG9yZUZpbGVzKGJhY2t1cEZpbGVzLCBiYWNrdXBKb2IpO1xuXG4gICAgICAvLyBSZXN0b3JlIGRhdGFcbiAgICAgIGF3YWl0IHRoaXMucmVzdG9yZURhdGEocHJvY2Vzc2VkRmlsZXMsIGJhY2t1cEpvYik7XG5cbiAgICAgIC8vIFVwZGF0ZSBqb2Igc3RhdHVzXG4gICAgICByZXN0b3JlSm9iLnN0YXR1cyA9ICdjb21wbGV0ZWQnO1xuICAgICAgcmVzdG9yZUpvYi5lbmRUaW1lID0gbmV3IERhdGUoKTtcbiAgICAgIHJlc3RvcmVKb2IuZmlsZXMgPSBwcm9jZXNzZWRGaWxlcztcblxuICAgICAgbG9nZ2VyLmluZm8oJ1Jlc3RvcmUgY29tcGxldGVkIHN1Y2Nlc3NmdWxseScsIHtcbiAgICAgICAgcmVzdG9yZUpvYklkOiByZXN0b3JlSm9iLmlkLFxuICAgICAgICBiYWNrdXBJZDogYmFja3VwSm9iLmlkLFxuICAgICAgICBmaWxlczogcmVzdG9yZUpvYi5maWxlcy5sZW5ndGgsXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgcmVzdG9yZUpvYi5zdGF0dXMgPSAnZmFpbGVkJztcbiAgICAgIHJlc3RvcmVKb2IuZW5kVGltZSA9IG5ldyBEYXRlKCk7XG4gICAgICByZXN0b3JlSm9iLmVycm9yID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcic7XG5cbiAgICAgIGxvZ2dlci5lcnJvcignUmVzdG9yZSBmYWlsZWQnLCB7XG4gICAgICAgIHJlc3RvcmVKb2JJZDogcmVzdG9yZUpvYi5pZCxcbiAgICAgICAgYmFja3VwSWQ6IGJhY2t1cEpvYi5pZCxcbiAgICAgICAgZXJyb3I6IHJlc3RvcmVKb2IuZXJyb3IsXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRmluZCBiYWNrdXAgZmlsZXNcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgZmluZEJhY2t1cEZpbGVzKGJhY2t1cEpvYjogQmFja3VwSm9iKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xuICAgIGNvbnN0IGZpbGVzOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgZm9yIChjb25zdCBkZXN0aW5hdGlvbiBvZiBiYWNrdXBKb2IuY29uZmlnLmRlc3RpbmF0aW9ucykge1xuICAgICAgaWYgKGRlc3RpbmF0aW9uLnR5cGUgPT09ICdsb2NhbCcpIHtcbiAgICAgICAgY29uc3QgZGlyRmlsZXMgPSBhd2FpdCBmcy5yZWFkZGlyKGRlc3RpbmF0aW9uLnBhdGgpO1xuXG4gICAgICAgIGZvciAoY29uc3QgZmlsZSBvZiBkaXJGaWxlcykge1xuICAgICAgICAgIGlmIChmaWxlLnN0YXJ0c1dpdGgoYmFja3VwSm9iLmlkKSkge1xuICAgICAgICAgICAgZmlsZXMucHVzaChwYXRoLmpvaW4oZGVzdGluYXRpb24ucGF0aCwgZmlsZSkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgLy8gQWRkIG90aGVyIGRlc3RpbmF0aW9uIHR5cGVzIGFzIG5lZWRlZFxuICAgIH1cblxuICAgIHJldHVybiBmaWxlcztcbiAgfVxuXG4gIC8qKlxuICAgKiBQcm9jZXNzIHJlc3RvcmUgZmlsZXMgKGRlY3J5cHQgYW5kIGRlY29tcHJlc3MpXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHByb2Nlc3NSZXN0b3JlRmlsZXMoZmlsZXM6IHN0cmluZ1tdLCBiYWNrdXBKb2I6IEJhY2t1cEpvYik6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgICBjb25zdCBwcm9jZXNzZWRGaWxlczogc3RyaW5nW10gPSBbXTtcblxuICAgIGZvciAoY29uc3QgZmlsZSBvZiBmaWxlcykge1xuICAgICAgbGV0IHByb2Nlc3NlZEZpbGUgPSBmaWxlO1xuXG4gICAgICAvLyBEZWNyeXB0XG4gICAgICBpZiAoYmFja3VwSm9iLmNvbmZpZy5lbmNyeXB0aW9uICYmIGZpbGUuZW5kc1dpdGgoJy5lbmMnKSkge1xuICAgICAgICBwcm9jZXNzZWRGaWxlID0gYXdhaXQgdGhpcy5kZWNyeXB0RmlsZShmaWxlKTtcbiAgICAgICAgYXdhaXQgZnMudW5saW5rKGZpbGUpOyAvLyBSZW1vdmUgZW5jcnlwdGVkXG4gICAgICB9XG5cbiAgICAgIC8vIERlY29tcHJlc3NcbiAgICAgIGlmIChiYWNrdXBKb2IuY29uZmlnLmNvbXByZXNzaW9uICYmIHByb2Nlc3NlZEZpbGUuZW5kc1dpdGgoJy5neicpKSB7XG4gICAgICAgIHByb2Nlc3NlZEZpbGUgPSBhd2FpdCB0aGlzLmRlY29tcHJlc3NGaWxlKHByb2Nlc3NlZEZpbGUpO1xuICAgICAgICBhd2FpdCBmcy51bmxpbmsocHJvY2Vzc2VkRmlsZSk7IC8vIFJlbW92ZSBjb21wcmVzc2VkXG4gICAgICB9XG5cbiAgICAgIHByb2Nlc3NlZEZpbGVzLnB1c2gocHJvY2Vzc2VkRmlsZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHByb2Nlc3NlZEZpbGVzO1xuICB9XG5cbiAgLyoqXG4gICAqIERlY3J5cHQgZmlsZVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBkZWNyeXB0RmlsZShmaWxlUGF0aDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICBjb25zdCBkZWNyeXB0ZWRQYXRoID0gZmlsZVBhdGgucmVwbGFjZSgnLmVuYycsICcnKTtcbiAgICBjb25zdCBlbmNyeXB0ZWQgPSBhd2FpdCBmcy5yZWFkRmlsZShmaWxlUGF0aCk7XG5cbiAgICAvLyBTaW1wbGUgWE9SIGRlY3J5cHRpb24gKGluIHByb2R1Y3Rpb24sIHVzZSBwcm9wZXIgZGVjcnlwdGlvbilcbiAgICBjb25zdCBkZWNyeXB0ZWQgPSBCdWZmZXIuZnJvbShlbmNyeXB0ZWQubWFwKGJ5dGUgPT4gYnl0ZSBeIHRoaXMuZW5jcnlwdGlvbktleS5jaGFyQ29kZUF0KDApKSk7XG4gICAgYXdhaXQgZnMud3JpdGVGaWxlKGRlY3J5cHRlZFBhdGgsIGRlY3J5cHRlZCk7XG5cbiAgICByZXR1cm4gZGVjcnlwdGVkUGF0aDtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZWNvbXByZXNzIGZpbGVcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgZGVjb21wcmVzc0ZpbGUoZmlsZVBhdGg6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgY29uc3QgZGVjb21wcmVzc2VkUGF0aCA9IGZpbGVQYXRoLnJlcGxhY2UoJy5neicsICcnKTtcbiAgICBhd2FpdCBleGVjQXN5bmMoYGd1bnppcCBcIiR7ZmlsZVBhdGh9XCJgKTtcbiAgICByZXR1cm4gZGVjb21wcmVzc2VkUGF0aDtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXN0b3JlIGRhdGFcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgcmVzdG9yZURhdGEoZmlsZXM6IHN0cmluZ1tdLCBiYWNrdXBKb2I6IEJhY2t1cEpvYik6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBzd2l0Y2ggKGJhY2t1cEpvYi5jb25maWcudHlwZSkge1xuICAgICAgICBjYXNlICdkYXRhYmFzZSc6XG4gICAgICAgICAgYXdhaXQgdGhpcy5yZXN0b3JlRGF0YWJhc2UoZmlsZXMpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdmaWxlcyc6XG4gICAgICAgICAgYXdhaXQgdGhpcy5yZXN0b3JlRmlsZXMoZmlsZXMpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdsb2dzJzpcbiAgICAgICAgICBhd2FpdCB0aGlzLnJlc3RvcmVMb2dzKGZpbGVzKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnY29uZmlnJzpcbiAgICAgICAgICBhd2FpdCB0aGlzLnJlc3RvcmVDb25maWcoZmlsZXMpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdmdWxsJzpcbiAgICAgICAgICBhd2FpdCB0aGlzLnJlc3RvcmVGdWxsKGZpbGVzKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cblxuICAgICAgbG9nZ2VyLmluZm8oJ0RhdGEgcmVzdG9yZWQgc3VjY2Vzc2Z1bGx5Jywge1xuICAgICAgICBmaWxlczogZmlsZXMubGVuZ3RoLFxuICAgICAgICB0eXBlOiBiYWNrdXBKb2IuY29uZmlnLnR5cGUsXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdEYXRhIHJlc3RvcmUgZmFpbGVkOicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZXN0b3JlIGRhdGFiYXNlXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHJlc3RvcmVEYXRhYmFzZShmaWxlczogc3RyaW5nW10pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBmb3IgKGNvbnN0IGZpbGUgb2YgZmlsZXMpIHtcbiAgICAgIGlmIChmaWxlLmluY2x1ZGVzKCdkYXRhYmFzZS0nKSAmJiBmaWxlLmVuZHNXaXRoKCcuc3FsJykpIHtcbiAgICAgICAgaWYgKGZpbGUuaW5jbHVkZXMoJ21vbmdvZGInKSkge1xuICAgICAgICAgIGNvbnN0IGNvbW1hbmQgPSBgbW9uZ29yZXN0b3JlIC0tdXJpPVwiJHtwcm9jZXNzLmVudi5NT05HT0RCX1VSSX1cIiAtLWRyb3AgXCIke2ZpbGV9XCJgO1xuICAgICAgICAgIGF3YWl0IGV4ZWNBc3luYyhjb21tYW5kKTtcbiAgICAgICAgfSBlbHNlIGlmIChmaWxlLmluY2x1ZGVzKCdwb3N0Z3JlcycpKSB7XG4gICAgICAgICAgY29uc3QgY29tbWFuZCA9IGBwc3FsIFwiJHtwcm9jZXNzLmVudi5EQVRBQkFTRV9VUkx9XCIgPCBcIiR7ZmlsZX1cImA7XG4gICAgICAgICAgYXdhaXQgZXhlY0FzeW5jKGNvbW1hbmQpO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZXN0b3JlIGZpbGVzXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHJlc3RvcmVGaWxlcyhmaWxlczogc3RyaW5nW10pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBmb3IgKGNvbnN0IGZpbGUgb2YgZmlsZXMpIHtcbiAgICAgIGlmIChmaWxlLmluY2x1ZGVzKCdmaWxlcy0nKSAmJiBmaWxlLmVuZHNXaXRoKCcudGFyLmd6JykpIHtcbiAgICAgICAgY29uc3QgY29tbWFuZCA9IGB0YXIgLXh6ZiBcIiR7ZmlsZX1cIiAtQyAuYDtcbiAgICAgICAgYXdhaXQgZXhlY0FzeW5jKGNvbW1hbmQpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZXN0b3JlIGxvZ3NcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgcmVzdG9yZUxvZ3MoZmlsZXM6IHN0cmluZ1tdKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgZm9yIChjb25zdCBmaWxlIG9mIGZpbGVzKSB7XG4gICAgICBpZiAoZmlsZS5pbmNsdWRlcygnbG9ncy0nKSAmJiBmaWxlLmVuZHNXaXRoKCcudGFyLmd6JykpIHtcbiAgICAgICAgY29uc3QgY29tbWFuZCA9IGB0YXIgLXh6ZiBcIiR7ZmlsZX1cIiAtQyAuYDtcbiAgICAgICAgYXdhaXQgZXhlY0FzeW5jKGNvbW1hbmQpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZXN0b3JlIGNvbmZpZ3VyYXRpb25cbiAgICovXG4gIHByaXZhdGUgYXN5bmMgcmVzdG9yZUNvbmZpZyhmaWxlczogc3RyaW5nW10pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBmb3IgKGNvbnN0IGZpbGUgb2YgZmlsZXMpIHtcbiAgICAgIGlmIChmaWxlLmluY2x1ZGVzKCdjb25maWctJykgJiYgZmlsZS5lbmRzV2l0aCgnLnRhci5neicpKSB7XG4gICAgICAgIGNvbnN0IGNvbW1hbmQgPSBgdGFyIC14emYgXCIke2ZpbGV9XCIgLUMgLmA7XG4gICAgICAgIGF3YWl0IGV4ZWNBc3luYyhjb21tYW5kKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRnVsbCByZXN0b3JlXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHJlc3RvcmVGdWxsKGZpbGVzOiBzdHJpbmdbXSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGF3YWl0IHRoaXMucmVzdG9yZURhdGFiYXNlKGZpbGVzKTtcbiAgICBhd2FpdCB0aGlzLnJlc3RvcmVGaWxlcyhmaWxlcyk7XG4gICAgYXdhaXQgdGhpcy5yZXN0b3JlTG9ncyhmaWxlcyk7XG4gICAgYXdhaXQgdGhpcy5yZXN0b3JlQ29uZmlnKGZpbGVzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYmFja3VwIGpvYnNcbiAgICovXG4gIHB1YmxpYyBnZXRCYWNrdXBKb2JzKCk6IEJhY2t1cEpvYltdIHtcbiAgICByZXR1cm4gdGhpcy5iYWNrdXBKb2JzLnNvcnQoKGEsIGIpID0+IGIuc3RhcnRUaW1lLmdldFRpbWUoKSAtIGEuc3RhcnRUaW1lLmdldFRpbWUoKSk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHJlc3RvcmUgam9ic1xuICAgKi9cbiAgcHVibGljIGdldFJlc3RvcmVKb2JzKCk6IFJlc3RvcmVKb2JbXSB7XG4gICAgcmV0dXJuIHRoaXMucmVzdG9yZUpvYnMuc29ydCgoYSwgYikgPT4gYi5zdGFydFRpbWUuZ2V0VGltZSgpIC0gYS5zdGFydFRpbWUuZ2V0VGltZSgpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYmFja3VwIGNvbmZpZ3VyYXRpb25zXG4gICAqL1xuICBwdWJsaWMgZ2V0QmFja3VwQ29uZmlncygpOiBCYWNrdXBDb25maWdbXSB7XG4gICAgcmV0dXJuIHRoaXMuYmFja3VwQ29uZmlncztcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGQgYmFja3VwIGNvbmZpZ3VyYXRpb25cbiAgICovXG4gIHB1YmxpYyBhZGRCYWNrdXBDb25maWcoY29uZmlnOiBCYWNrdXBDb25maWcpOiB2b2lkIHtcbiAgICB0aGlzLmJhY2t1cENvbmZpZ3MucHVzaChjb25maWcpO1xuICAgIGxvZ2dlci5pbmZvKCdCYWNrdXAgY29uZmlndXJhdGlvbiBhZGRlZCcsIHsgbmFtZTogY29uZmlnLm5hbWUgfSk7XG4gIH1cblxuICAvKipcbiAgICogU3RhcnQgc2NoZWR1bGVkIGJhY2t1cHNcbiAgICovXG4gIHByaXZhdGUgc3RhcnRTY2hlZHVsZWRCYWNrdXBzKCk6IHZvaWQge1xuICAgIC8vIFRoaXMgd291bGQgaW50ZWdyYXRlIHdpdGggYSBjcm9uIHNjaGVkdWxlclxuICAgIC8vIEZvciBub3csIGp1c3QgbG9nIHRoYXQgaXQgd291bGQgc3RhcnRcbiAgICBsb2dnZXIuaW5mbygnU2NoZWR1bGVkIGJhY2t1cHMgY29uZmlndXJlZCcsIHtcbiAgICAgIGNvbmZpZ3M6IHRoaXMuYmFja3VwQ29uZmlncy5maWx0ZXIoYyA9PiBjLmVuYWJsZWQpLmxlbmd0aCxcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSBqb2IgSURcbiAgICovXG4gIHByaXZhdGUgZ2VuZXJhdGVKb2JJZCgpOiBzdHJpbmcge1xuICAgIHJldHVybiBgam9iXyR7RGF0ZS5ub3coKX1fJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgOSl9YDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYmFja3VwIHN0YXRpc3RpY3NcbiAgICovXG4gIHB1YmxpYyBhc3luYyBnZXRTdGF0cygpOiBQcm9taXNlPHtcbiAgICB0b3RhbEJhY2t1cHM6IG51bWJlcjtcbiAgICBzdWNjZXNzZnVsQmFja3VwczogbnVtYmVyO1xuICAgIGZhaWxlZEJhY2t1cHM6IG51bWJlcjtcbiAgICB0b3RhbFNpemU6IG51bWJlcjtcbiAgICBhdmVyYWdlU2l6ZTogbnVtYmVyO1xuICAgIGJhY2t1cHNCeVR5cGU6IHsgW2tleTogc3RyaW5nXTogbnVtYmVyIH07XG4gICAgcmVjZW50QmFja3VwczogQXJyYXk8e1xuICAgICAgaWQ6IHN0cmluZztcbiAgICAgIHR5cGU6IHN0cmluZztcbiAgICAgIHN0YXR1czogc3RyaW5nO1xuICAgICAgc2l6ZTogbnVtYmVyO1xuICAgICAgdGltZXN0YW1wOiBEYXRlO1xuICAgIH0+O1xuICB9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHRvdGFsQmFja3VwcyA9IHRoaXMuYmFja3VwSm9icy5sZW5ndGg7XG4gICAgICBjb25zdCBzdWNjZXNzZnVsQmFja3VwcyA9IHRoaXMuYmFja3VwSm9icy5maWx0ZXIoam9iID0+IGpvYi5zdGF0dXMgPT09ICdjb21wbGV0ZWQnKS5sZW5ndGg7XG4gICAgICBjb25zdCBmYWlsZWRCYWNrdXBzID0gdGhpcy5iYWNrdXBKb2JzLmZpbHRlcihqb2IgPT4gam9iLnN0YXR1cyA9PT0gJ2ZhaWxlZCcpLmxlbmd0aDtcbiAgICAgIGNvbnN0IHRvdGFsU2l6ZSA9IHRoaXMuYmFja3VwSm9icy5yZWR1Y2UoKHN1bSwgam9iKSA9PiBzdW0gKyBqb2Iuc2l6ZSwgMCk7XG4gICAgICBjb25zdCBhdmVyYWdlU2l6ZSA9IHRvdGFsQmFja3VwcyA+IDAgPyB0b3RhbFNpemUgLyB0b3RhbEJhY2t1cHMgOiAwO1xuXG4gICAgICBjb25zdCBiYWNrdXBzQnlUeXBlOiB7IFtrZXk6IHN0cmluZ106IG51bWJlciB9ID0ge307XG4gICAgICB0aGlzLmJhY2t1cEpvYnMuZm9yRWFjaChqb2IgPT4ge1xuICAgICAgICBiYWNrdXBzQnlUeXBlW2pvYi5jb25maWcudHlwZV0gPSAoYmFja3Vwc0J5VHlwZVtqb2IuY29uZmlnLnR5cGVdIHx8IDApICsgMTtcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZWNlbnRCYWNrdXBzID0gdGhpcy5iYWNrdXBKb2JzXG4gICAgICAgIC5zb3J0KChhLCBiKSA9PiBiLnN0YXJ0VGltZS5nZXRUaW1lKCkgLSBhLnN0YXJ0VGltZS5nZXRUaW1lKCkpXG4gICAgICAgIC5zbGljZSgwLCAxMClcbiAgICAgICAgLm1hcChqb2IgPT4gKHtcbiAgICAgICAgICBpZDogam9iLmlkLFxuICAgICAgICAgIHR5cGU6IGpvYi5jb25maWcudHlwZSxcbiAgICAgICAgICBzdGF0dXM6IGpvYi5zdGF0dXMsXG4gICAgICAgICAgc2l6ZTogam9iLnNpemUsXG4gICAgICAgICAgdGltZXN0YW1wOiBqb2Iuc3RhcnRUaW1lLFxuICAgICAgICB9KSk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHRvdGFsQmFja3VwcyxcbiAgICAgICAgc3VjY2Vzc2Z1bEJhY2t1cHMsXG4gICAgICAgIGZhaWxlZEJhY2t1cHMsXG4gICAgICAgIHRvdGFsU2l6ZSxcbiAgICAgICAgYXZlcmFnZVNpemUsXG4gICAgICAgIGJhY2t1cHNCeVR5cGUsXG4gICAgICAgIHJlY2VudEJhY2t1cHMsXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0ZhaWxlZCB0byBnZXQgYmFja3VwIHN0YXRzOicsIGVycm9yKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHRvdGFsQmFja3VwczogMCxcbiAgICAgICAgc3VjY2Vzc2Z1bEJhY2t1cHM6IDAsXG4gICAgICAgIGZhaWxlZEJhY2t1cHM6IDAsXG4gICAgICAgIHRvdGFsU2l6ZTogMCxcbiAgICAgICAgYXZlcmFnZVNpemU6IDAsXG4gICAgICAgIGJhY2t1cHNCeVR5cGU6IHt9LFxuICAgICAgICByZWNlbnRCYWNrdXBzOiBbXSxcbiAgICAgIH07XG4gICAgfVxuICB9XG59XG4iXSwidmVyc2lvbiI6M30=