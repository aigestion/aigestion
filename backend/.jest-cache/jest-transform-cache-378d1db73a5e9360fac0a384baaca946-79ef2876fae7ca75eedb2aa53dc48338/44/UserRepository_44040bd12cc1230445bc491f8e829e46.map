{"file":"C:\\Users\\Alejandro\\AIGestion\\backend\\src\\infrastructure\\repository\\UserRepository.ts","mappings":";AAAA,kDAAkD;;;;;;;;;AAElD,4CAAgD;AAChD,qDAAkD;AAClD,yCAAuC;AAYhC,IAAM,cAAc,GAApB,MAAM,cAAe,SAAQ,+BAAqB;IACvD,KAAK,CAAC,WAAW,CAAC,KAAa;QAC7B,OAAO,MAAM,WAAI,CAAC,OAAO,CAAC,EAAE,KAAK,EAAE,CAAC,CAAC,IAAI,EAAE,CAAC;IAC9C,CAAC;IAEQ,KAAK,CAAC,MAAM,CACnB,QAAiC,EACjC,SAA0B;QAE1B,MAAM,IAAI,GAAG,OAAO,QAAQ,KAAK,QAAQ,CAAC,CAAC,CAAC,SAAS,IAAI,EAAE,CAAC,CAAC,CAAC,QAAQ,CAAC;QACvE,MAAM,IAAI,GAAG,IAAI,WAAI,CAAC,IAAW,CAAC,CAAC;QACnC,OAAO,MAAM,IAAI,CAAC,IAAI,EAAE,CAAC;IAC3B,CAAC;IAEQ,KAAK,CAAC,QAAQ,CAAC,EAAU;QAChC,OAAO,MAAM,WAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,IAAI,EAAE,CAAC;IACxC,CAAC;IAEQ,KAAK,CAAC,OAAO,CAAC,QAAgB,EAAE,EAAE,OAAe,CAAC;QACzD,OAAO,MAAM,WAAI,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,IAAI,EAAE,CAAC;IAC1D,CAAC;IAED,KAAK,CAAC,QAAQ;QACZ,OAAO,MAAM,WAAI,CAAC,cAAc,EAAE,CAAC,IAAI,EAAE,CAAC;IAC5C,CAAC;IAEQ,KAAK,CAAC,MAAM,CAAC,EAAU,EAAE,IAAoB;QACpD,OAAO,MAAM,WAAI,CAAC,iBAAiB,CAAC,EAAE,EAAE,IAAI,EAAE,EAAE,GAAG,EAAE,IAAI,EAAE,CAAC,CAAC,IAAI,EAAE,CAAC;IACtE,CAAC;IAEQ,KAAK,CAAC,MAAM,CAAC,EAAU;QAC9B,MAAM,MAAM,GAAG,MAAM,WAAI,CAAC,iBAAiB,CAAC,EAAE,CAAC,CAAC,IAAI,EAAE,CAAC;QACvD,OAAO,CAAC,CAAC,MAAM,CAAC;IAClB,CAAC;IAED,KAAK,CAAC,OAAO,CAAC,KAAU;QACtB,OAAO,MAAM,WAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,IAAI,EAAE,CAAC;IAC1C,CAAC;IAED,KAAK,CAAC,kBAAkB,CAAC,KAAa;QACpC,MAAM,WAAI,CAAC,SAAS,CAClB,EAAE,qBAAqB,EAAE,KAAK,EAAE,EAChC,EAAE,KAAK,EAAE,EAAE,aAAa,EAAE,EAAE,KAAK,EAAE,KAAK,EAAE,EAAE,EAAE,CAC/C,CAAC,IAAI,EAAE,CAAC;IACX,CAAC;CACF,CAAA;AA7CY,wCAAc;yBAAd,cAAc;IAD1B,IAAA,sBAAU,GAAE;GACA,cAAc,CA6C1B","names":[],"sources":["C:\\Users\\Alejandro\\AIGestion\\backend\\src\\infrastructure\\repository\\UserRepository.ts"],"sourcesContent":["// src/infrastructure/repository/UserRepository.ts\n\nimport { User, IUser } from '../../models/User';\nimport { BaseRepository } from './BaseRepository';\nimport { injectable } from 'inversify';\n\nexport interface IUserRepository extends BaseRepository<IUser> {\n  findByEmail(email: string): Promise<IUser | null>;\n  create(idOrItem: string | Partial<IUser>, maybeItem?: Partial<IUser>): Promise<IUser>;\n  findAll(limit?: number, skip?: number): Promise<IUser[]>;\n  countAll(): Promise<number>;\n  findOne(query: any): Promise<IUser | null>;\n  removeRefreshToken(token: string): Promise<void>;\n}\n\n@injectable()\nexport class UserRepository extends BaseRepository<IUser> implements IUserRepository {\n  async findByEmail(email: string): Promise<IUser | null> {\n    return await User.findOne({ email }).exec();\n  }\n\n  override async create(\n    idOrItem: string | Partial<IUser>,\n    maybeItem?: Partial<IUser>,\n  ): Promise<IUser> {\n    const data = typeof idOrItem === 'string' ? maybeItem ?? {} : idOrItem;\n    const user = new User(data as any);\n    return await user.save();\n  }\n\n  override async findById(id: string): Promise<IUser | null> {\n    return await User.findById(id).exec();\n  }\n\n  override async findAll(limit: number = 10, skip: number = 0): Promise<IUser[]> {\n    return await User.find().skip(skip).limit(limit).exec();\n  }\n\n  async countAll(): Promise<number> {\n    return await User.countDocuments().exec();\n  }\n\n  override async update(id: string, data: Partial<IUser>): Promise<IUser | null> {\n    return await User.findByIdAndUpdate(id, data, { new: true }).exec();\n  }\n\n  override async delete(id: string): Promise<boolean> {\n    const result = await User.findByIdAndDelete(id).exec();\n    return !!result;\n  }\n\n  async findOne(query: any): Promise<IUser | null> {\n    return await User.findOne(query).exec();\n  }\n\n  async removeRefreshToken(token: string): Promise<void> {\n    await User.updateOne(\n      { 'refreshTokens.token': token },\n      { $pull: { refreshTokens: { token: token } } },\n    ).exec();\n  }\n}\n"],"version":3}