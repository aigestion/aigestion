{"file":"C:\\Users\\Alejandro\\AIGestion\\backend\\src\\services\\infra-optimizer.service.ts","mappings":";;;;;;;;;;;;AAAA,yCAAuC;AACvC,qDAA2C;AAC3C,4CAAyC;AACzC,yDAA+D;AAGxD,IAAM,qBAAqB,GAA3B,MAAM,qBAAqB;IACxB,gBAAgB,CAAsB;IAE9C;QACE,IAAI,CAAC,gBAAgB,GAAG,IAAI,gCAAmB,EAAE,CAAC;IACpD,CAAC;IAED;;OAEG;IACH,KAAK,CAAC,uBAAuB;QAC3B,MAAM,SAAS,GAAG,gBAAG,CAAC,uBAAuB,CAAC;QAE9C,IAAI,CAAC;YACH,eAAM,CAAC,IAAI,CAAC,0DAA0D,SAAS,EAAE,CAAC,CAAC;YAEnF,yEAAyE;YACzE,+GAA+G;YAE/G,MAAM,eAAe,GAAG;gBACtB;oBACE,OAAO,EAAE,mBAAmB;oBAC5B,KAAK,EAAE,yBAAyB;oBAChC,MAAM,EAAE,4BAA4B;oBACpC,uBAAuB,EAAE,QAAQ;iBAClC;gBACD;oBACE,OAAO,EAAE,aAAa;oBACtB,KAAK,EAAE,sBAAsB;oBAC7B,MAAM,EAAE,yBAAyB;oBACjC,oBAAoB,EAAE,uBAAuB;iBAC9C;aACF,CAAC;YAEF,OAAO;gBACL,SAAS;gBACT,eAAe;gBACf,qBAAqB,EAAE,QAAQ;aAChC,CAAC;QACJ,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YACf,eAAM,CAAC,KAAK,CAAC,gDAAgD,EAAE,KAAK,CAAC,CAAC;YACtE,MAAM,KAAK,CAAC;QACd,CAAC;IACH,CAAC;IAED;;OAEG;IACH,KAAK,CAAC,QAAQ,CAAC,MAAc;QAC3B,eAAM,CAAC,IAAI,CAAC,uCAAuC,MAAM,EAAE,CAAC,CAAC;QAC7D,+BAA+B;QAC/B,OAAO;YACL,MAAM;YACN,MAAM,EAAE,WAAW;YACnB,aAAa,EAAE,CAAC,oBAAoB,EAAE,uBAAuB,CAAC;YAC9D,OAAO,EAAE,WAAW;SACrB,CAAC;IACJ,CAAC;CACF,CAAA;AA1DY,sDAAqB;gCAArB,qBAAqB;IADjC,IAAA,sBAAU,GAAE;;GACA,qBAAqB,CA0DjC","names":[],"sources":["C:\\Users\\Alejandro\\AIGestion\\backend\\src\\services\\infra-optimizer.service.ts"],"sourcesContent":["import { injectable } from 'inversify';\nimport { env } from '../config/env.schema';\nimport { logger } from '../utils/logger';\nimport { MetricServiceClient } from '@google-cloud/monitoring';\n\n@injectable()\nexport class InfraOptimizerService {\n  private monitoringClient: MetricServiceClient;\n\n  constructor() {\n    this.monitoringClient = new MetricServiceClient();\n  }\n\n  /**\n   * Analyzes GCP usage and suggests cost/performance optimizations.\n   */\n  async getInfraRecommendations(): Promise<any> {\n    const projectId = env.GOOGLE_CLOUD_PROJECT_ID;\n\n    try {\n      logger.info(`[InfraOptimizer] Analyzing infrastructure for project: ${projectId}`);\n\n      // In a real scenario, we'd query Cloud Monitoring metrics for CPU/Memory\n      // For this prototype, we'll return a simulated high-impact recommendation based on typical Cloud Run patterns.\n\n      const recommendations = [\n        {\n          service: 'dashboard-backend',\n          issue: 'Over-provisioned Memory',\n          action: 'Reduce from 1GiB to 512MiB',\n          estimatedMonthlySavings: '$12.50',\n        },\n        {\n          service: 'rag-service',\n          issue: 'Cold Starts detected',\n          action: 'Enable min-instances: 1',\n          estimatedImprovement: '30% Latency reduction',\n        },\n      ];\n\n      return {\n        projectId,\n        recommendations,\n        totalPotentialSavings: '$12.50',\n      };\n    } catch (error) {\n      logger.error('[InfraOptimizer] Optimization analysis failed:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Optimizes infrastructure resources based on target.\n   */\n  async optimize(target: string): Promise<any> {\n    logger.info(`[InfraOptimizer] optimizing target: ${target}`);\n    // Simulated optimization logic\n    return {\n      target,\n      status: 'optimized',\n      actions_taken: ['scaled_down_memory', 'enabled_min_instances'],\n      savings: '$15.00/mo',\n    };\n  }\n}\n"],"version":3}