{"file":"C:\\Users\\Alejandro\\AIGestion\\backend\\src\\routes\\security-dashboard.routes.ts","mappings":"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","names":[],"sources":["C:\\Users\\Alejandro\\AIGestion\\backend\\src\\routes\\security-dashboard.routes.ts"],"sourcesContent":["import { Router } from 'express';\nimport { SecurityDashboardService } from '../services/security-dashboard.service';\nimport { logger } from '../utils/logger';\n\nconst router = Router();\nconst dashboardService = new SecurityDashboardService();\n\n/**\n * Security Dashboard Routes\n */\n\n// Get complete dashboard data\nrouter.get('/dashboard', async (req: any, res: any) => {\n  try {\n    const data = await dashboardService.getDashboardData();\n\n    res.json({\n      success: true,\n      data,\n    });\n  } catch (error) {\n    logger.error('Error getting dashboard data:', error);\n    res.status(500).json({\n      success: false,\n      error: 'Failed to get dashboard data',\n    });\n  }\n});\n\n// Get real-time metrics\nrouter.get('/metrics/realtime', async (req: any, res: any) => {\n  try {\n    const metrics = await dashboardService.getRealTimeMetrics();\n\n    res.json({\n      success: true,\n      data: metrics,\n    });\n  } catch (error) {\n    logger.error('Error getting real-time metrics:', error);\n    res.status(500).json({\n      success: false,\n      error: 'Failed to get real-time metrics',\n    });\n  }\n});\n\n// Get security incidents\nrouter.get('/incidents', async (req: any, res: any) => {\n  try {\n    const limit = parseInt(req.query.limit as string) || 50;\n    const incidents = await dashboardService.getSecurityIncidents(limit);\n\n    res.json({\n      success: true,\n      data: incidents,\n    });\n  } catch (error) {\n    logger.error('Error getting security incidents:', error);\n    res.status(500).json({\n      success: false,\n      error: 'Failed to get security incidents',\n    });\n  }\n});\n\n// Get security score\nrouter.get('/score', async (req: any, res: any) => {\n  try {\n    const score = await dashboardService.getSecurityScore();\n\n    res.json({\n      success: true,\n      data: score,\n    });\n  } catch (error) {\n    logger.error('Error getting security score:', error);\n    res.status(500).json({\n      success: false,\n      error: 'Failed to get security score',\n    });\n  }\n});\n\n// Export dashboard data\nrouter.get('/export', async (req: any, res: any) => {\n  try {\n    const format = (req.query.format as string) || 'json';\n    const data = await dashboardService.exportDashboardData(format as 'json' | 'csv');\n\n    const filename = `security-dashboard-${new Date().toISOString().split('T')[0]}.${format}`;\n\n    res.setHeader('Content-Type', format === 'json' ? 'application/json' : 'text/csv');\n    res.setHeader('Content-Disposition', `attachment; filename=\"${filename}\"`);\n\n    res.send(data);\n  } catch (error) {\n    logger.error('Error exporting dashboard data:', error);\n    res.status(500).json({\n      success: false,\n      error: 'Failed to export dashboard data',\n    });\n  }\n});\n\n// Get WAF statistics\nrouter.get('/waf/stats', async (req: any, res: any) => {\n  try {\n    const data = await dashboardService.getDashboardData();\n\n    res.json({\n      success: true,\n      data: data.waf,\n    });\n  } catch (error) {\n    logger.error('Error getting WAF stats:', error);\n    res.status(500).json({\n      success: false,\n      error: 'Failed to get WAF stats',\n    });\n  }\n});\n\n// Get malware scanner statistics\nrouter.get('/malware/stats', async (req: any, res: any) => {\n  try {\n    const data = await dashboardService.getDashboardData();\n\n    res.json({\n      success: true,\n      data: data.malware,\n    });\n  } catch (error) {\n    logger.error('Error getting malware stats:', error);\n    res.status(500).json({\n      success: false,\n      error: 'Failed to get malware stats',\n    });\n  }\n});\n\n// Get 2FA statistics\nrouter.get('/2fa/stats', async (req: any, res: any) => {\n  try {\n    const data = await dashboardService.getDashboardData();\n\n    res.json({\n      success: true,\n      data: data.twoFactor,\n    });\n  } catch (error) {\n    logger.error('Error getting 2FA stats:', error);\n    res.status(500).json({\n      success: false,\n      error: 'Failed to get 2FA stats',\n    });\n  }\n});\n\n// Get threat intelligence statistics\nrouter.get('/threat-intel/stats', async (req: any, res: any) => {\n  try {\n    const data = await dashboardService.getDashboardData();\n\n    res.json({\n      success: true,\n      data: data.threatIntel,\n    });\n  } catch (error) {\n    logger.error('Error getting threat intel stats:', error);\n    res.status(500).json({\n      success: false,\n      error: 'Failed to get threat intel stats',\n    });\n  }\n});\n\n// Get behavior analysis statistics\nrouter.get('/behavior/stats', async (req: any, res: any) => {\n  try {\n    const data = await dashboardService.getDashboardData();\n\n    res.json({\n      success: true,\n      data: data.behavior,\n    });\n  } catch (error) {\n    logger.error('Error getting behavior stats:', error);\n    res.status(500).json({\n      success: false,\n      error: 'Failed to get behavior stats',\n    });\n  }\n});\n\n// Get log statistics\nrouter.get('/logs/stats', async (req: any, res: any) => {\n  try {\n    const data = await dashboardService.getDashboardData();\n\n    res.json({\n      success: true,\n      data: data.logs,\n    });\n  } catch (error) {\n    logger.error('Error getting log stats:', error);\n    res.status(500).json({\n      success: false,\n      error: 'Failed to get log stats',\n    });\n  }\n});\n\n// Get monitoring statistics\nrouter.get('/monitoring/stats', async (req: any, res: any) => {\n  try {\n    const data = await dashboardService.getDashboardData();\n\n    res.json({\n      success: true,\n      data: data.monitoring,\n    });\n  } catch (error) {\n    logger.error('Error getting monitoring stats:', error);\n    res.status(500).json({\n      success: false,\n      error: 'Failed to get monitoring stats',\n    });\n  }\n});\n\n// Get backup statistics\nrouter.get('/backup/stats', async (req: any, res: any) => {\n  try {\n    const data = await dashboardService.getDashboardData();\n\n    res.json({\n      success: true,\n      data: data.backup,\n    });\n  } catch (error) {\n    logger.error('Error getting backup stats:', error);\n    res.status(500).json({\n      success: false,\n      error: 'Failed to get backup stats',\n    });\n  }\n});\n\n// Get dashboard health\nrouter.get('/health', async (req: any, res: any) => {\n  try {\n    const data = await dashboardService.getDashboardData();\n\n    const health = {\n      status: data.overview.systemHealth === 'healthy' ? 200 : 503,\n      service: 'security-dashboard',\n      timestamp: new Date().toISOString(),\n      uptime: process.uptime(),\n      memory: process.memoryUsage(),\n      version: '1.0.0',\n    };\n\n    res.status(health.status).json({\n      success: true,\n      data: health,\n    });\n  } catch (error) {\n    logger.error('Error getting dashboard health:', error);\n    res.status(500).json({\n      success: false,\n      error: 'Failed to get dashboard health',\n    });\n  }\n});\n\nexport default router;\n"],"version":3}