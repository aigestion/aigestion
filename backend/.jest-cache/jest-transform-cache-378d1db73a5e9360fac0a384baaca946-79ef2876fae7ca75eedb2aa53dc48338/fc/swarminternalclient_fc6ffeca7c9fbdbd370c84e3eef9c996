74d116c1cde173bd476f7951de9b6a11
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.SwarmInternalClient = void 0;
const axios_1 = __importDefault(require("axios"));
const inversify_1 = require("inversify");
const env_schema_1 = require("../config/env.schema");
const logger_1 = require("../utils/logger");
/**
 * [GOD MODE] Swarm Internal Client
 * Handles authenticated communication with the Python Swarm IA Engine.
 */
let SwarmInternalClient = class SwarmInternalClient {
    client;
    constructor() {
        this.client = axios_1.default.create({
            baseURL: env_schema_1.env.IA_ENGINE_URL || 'http://localhost:8000',
            headers: {
                'Content-Type': 'application/json',
                'X-API-Key': env_schema_1.env.IA_ENGINE_API_KEY,
            },
            timeout: 30000, // Autonomous agents might take time
        });
        // Logging interceptor
        this.client.interceptors.request.use((config) => {
            if (config) {
                logger_1.logger.debug(`[SwarmInternalClient] Request to ${config.baseURL}${config.url}`);
            }
            return config;
        });
        this.client.interceptors.response.use(response => response, error => {
            logger_1.logger.error(`[SwarmInternalClient] Error: ${error.message}`, {
                url: error.config?.url,
                status: error.response?.status,
            });
            return Promise.reject(error);
        });
    }
    /**
     * Status check
     */
    async getStatus() {
        const response = await this.client.get('/health');
        return response.data;
    }
    /**
     * Calling Daniela's specialized routes
     */
    async getDanielaStatus() {
        const response = await this.client.get('/daniela/status');
        return response.data;
    }
    /**
     * Generic Post
     */
    async post(path, data) {
        const response = await this.client.post(path, data);
        return response.data;
    }
};
exports.SwarmInternalClient = SwarmInternalClient;
exports.SwarmInternalClient = SwarmInternalClient = __decorate([
    (0, inversify_1.injectable)(),
    __metadata("design:paramtypes", [])
], SwarmInternalClient);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxBbGVqYW5kcm9cXEFJR2VzdGlvblxcYmFja2VuZFxcc3JjXFxzZXJ2aWNlc1xcc3dhcm0taW50ZXJuYWwuY2xpZW50LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFBLGtEQUF5RTtBQUN6RSx5Q0FBdUM7QUFDdkMscURBQTJDO0FBQzNDLDRDQUF5QztBQUV6Qzs7O0dBR0c7QUFFSSxJQUFNLG1CQUFtQixHQUF6QixNQUFNLG1CQUFtQjtJQUN0QixNQUFNLENBQWdCO0lBRTlCO1FBQ0UsSUFBSSxDQUFDLE1BQU0sR0FBRyxlQUFLLENBQUMsTUFBTSxDQUFDO1lBQ3pCLE9BQU8sRUFBRSxnQkFBRyxDQUFDLGFBQWEsSUFBSSx1QkFBdUI7WUFDckQsT0FBTyxFQUFFO2dCQUNQLGNBQWMsRUFBRSxrQkFBa0I7Z0JBQ2xDLFdBQVcsRUFBRSxnQkFBRyxDQUFDLGlCQUFpQjthQUNuQztZQUNELE9BQU8sRUFBRSxLQUFLLEVBQUUsb0NBQW9DO1NBQ3JELENBQUMsQ0FBQztRQUVILHNCQUFzQjtRQUN0QixJQUFJLENBQUMsTUFBTSxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUMsTUFBa0MsRUFBRSxFQUFFO1lBQzFFLElBQUksTUFBTSxFQUFFLENBQUM7Z0JBQ1gsZUFBTSxDQUFDLEtBQUssQ0FBQyxvQ0FBb0MsTUFBTSxDQUFDLE9BQU8sR0FBRyxNQUFNLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQztZQUNsRixDQUFDO1lBQ0QsT0FBTyxNQUFNLENBQUM7UUFDaEIsQ0FBQyxDQUFDLENBQUM7UUFFSCxJQUFJLENBQUMsTUFBTSxDQUFDLFlBQVksQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUNuQyxRQUFRLENBQUMsRUFBRSxDQUFDLFFBQVEsRUFDcEIsS0FBSyxDQUFDLEVBQUU7WUFDTixlQUFNLENBQUMsS0FBSyxDQUFDLGdDQUFnQyxLQUFLLENBQUMsT0FBTyxFQUFFLEVBQUU7Z0JBQzVELEdBQUcsRUFBRSxLQUFLLENBQUMsTUFBTSxFQUFFLEdBQUc7Z0JBQ3RCLE1BQU0sRUFBRSxLQUFLLENBQUMsUUFBUSxFQUFFLE1BQU07YUFDL0IsQ0FBQyxDQUFDO1lBQ0gsT0FBTyxPQUFPLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQy9CLENBQUMsQ0FDRixDQUFDO0lBQ0osQ0FBQztJQUVEOztPQUVHO0lBQ0gsS0FBSyxDQUFDLFNBQVM7UUFDYixNQUFNLFFBQVEsR0FBRyxNQUFNLElBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQ2xELE9BQU8sUUFBUSxDQUFDLElBQUksQ0FBQztJQUN2QixDQUFDO0lBRUQ7O09BRUc7SUFDSCxLQUFLLENBQUMsZ0JBQWdCO1FBQ3BCLE1BQU0sUUFBUSxHQUFHLE1BQU0sSUFBSSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsaUJBQWlCLENBQUMsQ0FBQztRQUMxRCxPQUFPLFFBQVEsQ0FBQyxJQUFJLENBQUM7SUFDdkIsQ0FBQztJQUVEOztPQUVHO0lBQ0gsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFZLEVBQUUsSUFBUztRQUNoQyxNQUFNLFFBQVEsR0FBRyxNQUFNLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztRQUNwRCxPQUFPLFFBQVEsQ0FBQyxJQUFJLENBQUM7SUFDdkIsQ0FBQztDQUNGLENBQUE7QUF4RFksa0RBQW1COzhCQUFuQixtQkFBbUI7SUFEL0IsSUFBQSxzQkFBVSxHQUFFOztHQUNBLG1CQUFtQixDQXdEL0IiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxBbGVqYW5kcm9cXEFJR2VzdGlvblxcYmFja2VuZFxcc3JjXFxzZXJ2aWNlc1xcc3dhcm0taW50ZXJuYWwuY2xpZW50LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBheGlvcywgeyBBeGlvc0luc3RhbmNlLCBJbnRlcm5hbEF4aW9zUmVxdWVzdENvbmZpZyB9IGZyb20gJ2F4aW9zJztcbmltcG9ydCB7IGluamVjdGFibGUgfSBmcm9tICdpbnZlcnNpZnknO1xuaW1wb3J0IHsgZW52IH0gZnJvbSAnLi4vY29uZmlnL2Vudi5zY2hlbWEnO1xuaW1wb3J0IHsgbG9nZ2VyIH0gZnJvbSAnLi4vdXRpbHMvbG9nZ2VyJztcblxuLyoqXG4gKiBbR09EIE1PREVdIFN3YXJtIEludGVybmFsIENsaWVudFxuICogSGFuZGxlcyBhdXRoZW50aWNhdGVkIGNvbW11bmljYXRpb24gd2l0aCB0aGUgUHl0aG9uIFN3YXJtIElBIEVuZ2luZS5cbiAqL1xuQGluamVjdGFibGUoKVxuZXhwb3J0IGNsYXNzIFN3YXJtSW50ZXJuYWxDbGllbnQge1xuICBwcml2YXRlIGNsaWVudDogQXhpb3NJbnN0YW5jZTtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmNsaWVudCA9IGF4aW9zLmNyZWF0ZSh7XG4gICAgICBiYXNlVVJMOiBlbnYuSUFfRU5HSU5FX1VSTCB8fCAnaHR0cDovL2xvY2FsaG9zdDo4MDAwJyxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgJ1gtQVBJLUtleSc6IGVudi5JQV9FTkdJTkVfQVBJX0tFWSxcbiAgICAgIH0sXG4gICAgICB0aW1lb3V0OiAzMDAwMCwgLy8gQXV0b25vbW91cyBhZ2VudHMgbWlnaHQgdGFrZSB0aW1lXG4gICAgfSk7XG5cbiAgICAvLyBMb2dnaW5nIGludGVyY2VwdG9yXG4gICAgdGhpcy5jbGllbnQuaW50ZXJjZXB0b3JzLnJlcXVlc3QudXNlKChjb25maWc6IEludGVybmFsQXhpb3NSZXF1ZXN0Q29uZmlnKSA9PiB7XG4gICAgICBpZiAoY29uZmlnKSB7XG4gICAgICAgIGxvZ2dlci5kZWJ1ZyhgW1N3YXJtSW50ZXJuYWxDbGllbnRdIFJlcXVlc3QgdG8gJHtjb25maWcuYmFzZVVSTH0ke2NvbmZpZy51cmx9YCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gY29uZmlnO1xuICAgIH0pO1xuXG4gICAgdGhpcy5jbGllbnQuaW50ZXJjZXB0b3JzLnJlc3BvbnNlLnVzZShcbiAgICAgIHJlc3BvbnNlID0+IHJlc3BvbnNlLFxuICAgICAgZXJyb3IgPT4ge1xuICAgICAgICBsb2dnZXIuZXJyb3IoYFtTd2FybUludGVybmFsQ2xpZW50XSBFcnJvcjogJHtlcnJvci5tZXNzYWdlfWAsIHtcbiAgICAgICAgICB1cmw6IGVycm9yLmNvbmZpZz8udXJsLFxuICAgICAgICAgIHN0YXR1czogZXJyb3IucmVzcG9uc2U/LnN0YXR1cyxcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7XG4gICAgICB9LFxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogU3RhdHVzIGNoZWNrXG4gICAqL1xuICBhc3luYyBnZXRTdGF0dXMoKTogUHJvbWlzZTxhbnk+IHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuY2xpZW50LmdldCgnL2hlYWx0aCcpO1xuICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGxpbmcgRGFuaWVsYSdzIHNwZWNpYWxpemVkIHJvdXRlc1xuICAgKi9cbiAgYXN5bmMgZ2V0RGFuaWVsYVN0YXR1cygpOiBQcm9taXNlPGFueT4ge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5jbGllbnQuZ2V0KCcvZGFuaWVsYS9zdGF0dXMnKTtcbiAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmljIFBvc3RcbiAgICovXG4gIGFzeW5jIHBvc3QocGF0aDogc3RyaW5nLCBkYXRhOiBhbnkpOiBQcm9taXNlPGFueT4ge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5jbGllbnQucG9zdChwYXRoLCBkYXRhKTtcbiAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgfVxufVxuIl0sInZlcnNpb24iOjN9