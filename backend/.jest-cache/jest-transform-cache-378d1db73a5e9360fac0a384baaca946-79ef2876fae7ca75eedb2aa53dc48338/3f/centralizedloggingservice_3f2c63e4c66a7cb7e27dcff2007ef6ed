8dcb45a28e92cdc80da3d62f121440d9
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.CentralizedLoggingService = exports.CENTRAL_LOGGING_SERVICE_NAME = void 0;
const crypto_1 = __importDefault(require("crypto"));
const promises_1 = __importDefault(require("fs/promises"));
const inversify_1 = require("inversify");
const path_1 = __importDefault(require("path"));
const redis_1 = require("../cache/redis");
const logger_1 = require("../utils/logger");
exports.CENTRAL_LOGGING_SERVICE_NAME = 'CentralizedLoggingService';
let CentralizedLoggingService = class CentralizedLoggingService {
    redis;
    logBuffer = [];
    bufferSize = 1000;
    flushInterval = 5000; // 5 seconds
    logRetention = 30 * 24 * 60 * 60 * 1000; // 30 days
    logDirectory = 'logs';
    maxLogFiles = 100;
    constructor() {
        this.redis = (0, redis_1.getRedisClient)();
        this.initializeLogging();
        this.startLogFlush();
        this.startLogRotation();
    }
    async initializeLogging() {
        try {
            // Create log directory
            await promises_1.default.mkdir(this.logDirectory, { recursive: true });
            // Create daily log files
            const today = new Date().toISOString().split('T')[0];
            const logFile = path_1.default.join(this.logDirectory, `nexus-${today}.log`);
            // Check if log file exists
            try {
                await promises_1.default.access(logFile);
            }
            catch {
                // Create new log file with header
                const header = `# NEXUS V1 Centralized Log - ${today}\n`;
                await promises_1.default.writeFile(logFile, header);
            }
            logger_1.logger.info('Centralized logging service initialized');
        }
        catch (error) {
            logger_1.logger.error('Failed to initialize centralized logging:', error);
        }
    }
    /**
     * Log an entry
     */
    async log(entry) {
        try {
            const logEntry = {
                ...entry,
                id: this.generateLogId(),
                timestamp: new Date(),
            };
            // Add to buffer
            this.logBuffer.push(logEntry);
            // Buffer management
            if (this.logBuffer.length >= this.bufferSize) {
                await this.flushLogs();
            }
            // Critical logs are flushed immediately
            if (entry.level === 'critical') {
                await this.flushLogs();
                await this.sendAlert(logEntry);
            }
        }
        catch (error) {
            logger_1.logger.error('Failed to log entry:', error);
        }
    }
    /**
     * Query logs
     */
    async queryLogs(query) {
        try {
            const cacheKey = this.generateQueryCacheKey(query);
            const cached = await this.redis.get(cacheKey);
            if (cached) {
                const result = JSON.parse(cached);
                return result;
            }
            // Query from file system (simplified implementation)
            const logs = await this.queryLogsFromFile(query);
            const total = logs.length;
            const limit = query.limit || 100;
            const offset = query.offset || 0;
            const paginatedLogs = logs.slice(offset, offset + limit);
            const hasMore = offset + limit < total;
            const result = {
                logs: paginatedLogs,
                total,
                hasMore,
            };
            // Cache result
            await this.redis.setEx(cacheKey, 60, JSON.stringify(result));
            return result;
        }
        catch (error) {
            logger_1.logger.error('Failed to query logs:', error);
            return { logs: [], total: 0, hasMore: false };
        }
    }
    /**
     * Get log statistics
     */
    async getStats(timeRange = 'day') {
        try {
            const now = new Date();
            let startTime;
            switch (timeRange) {
                case 'hour':
                    startTime = new Date(now.getTime() - 60 * 60 * 1000);
                    break;
                case 'day':
                    startTime = new Date(now.getTime() - 24 * 60 * 60 * 1000);
                    break;
                case 'week':
                    startTime = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
                    break;
                case 'month':
                    startTime = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);
                    break;
            }
            const query = {
                startTime,
                endTime: now,
                limit: 10000,
            };
            const { logs } = await this.queryLogs(query);
            const stats = {
                totalLogs: logs.length,
                logsByLevel: {},
                logsByService: {},
                errorRate: 0,
                averageResponseTime: 0,
                topErrors: [],
                recentActivity: [],
            };
            // Calculate statistics
            logs.forEach(log => {
                // Count by level
                stats.logsByLevel[log.level] = (stats.logsByLevel[log.level] || 0) + 1;
                // Count by service
                stats.logsByService[log.service] = (stats.logsByService[log.service] || 0) + 1;
                // Calculate error rate
                if (log.level === 'error' || log.level === 'critical') {
                    stats.errorRate++;
                }
                // Calculate average response time
                if (log.duration) {
                    stats.averageResponseTime += log.duration;
                }
            });
            // Finalize calculations
            stats.errorRate = logs.length > 0 ? (stats.errorRate / logs.length) * 100 : 0;
            stats.averageResponseTime = logs.length > 0 ? stats.averageResponseTime / logs.length : 0;
            // Top errors
            const errorLogs = logs.filter(log => log.level === 'error' || log.level === 'critical');
            const errorCounts = new Map();
            errorLogs.forEach(log => {
                const key = `${log.service}:${log.message}`;
                const existing = errorCounts.get(key);
                if (existing) {
                    existing.count++;
                }
                else {
                    errorCounts.set(key, {
                        count: 1,
                        level: log.level,
                        service: log.service,
                        message: log.message,
                    });
                }
            });
            stats.topErrors = Array.from(errorCounts.values())
                .sort((a, b) => b.count - a.count)
                .slice(0, 10);
            // Recent activity
            stats.recentActivity = logs
                .sort((a, b) => b.timestamp.getTime() - a.timestamp.getTime())
                .slice(0, 20)
                .map(log => ({
                timestamp: log.timestamp,
                level: log.level,
                service: log.service,
                message: log.message,
            }));
            return stats;
        }
        catch (error) {
            logger_1.logger.error('Failed to get log stats:', error);
            return {
                totalLogs: 0,
                logsByLevel: {},
                logsByService: {},
                errorRate: 0,
                averageResponseTime: 0,
                topErrors: [],
                recentActivity: [],
            };
        }
    }
    /**
     * Search logs
     */
    async searchLogs(searchTerm, options = {}) {
        try {
            const query = {
                search: searchTerm,
                limit: 100,
                ...options,
            };
            const { logs } = await this.queryLogs(query);
            return logs;
        }
        catch (error) {
            logger_1.logger.error('Failed to search logs:', error);
            return [];
        }
    }
    /**
     * Export logs
     */
    async exportLogs(query, format = 'json') {
        try {
            const { logs } = await this.queryLogs({ ...query, limit: 10000 });
            if (format === 'csv') {
                const headers = [
                    'id',
                    'timestamp',
                    'level',
                    'service',
                    'userId',
                    'message',
                    'ipAddress',
                    'duration',
                ];
                const csvData = logs.map(log => [
                    log.id,
                    log.timestamp.toISOString(),
                    log.level,
                    log.service,
                    log.userId || '',
                    log.message.replace(/"/g, '""'), // Escape quotes
                    log.ipAddress || '',
                    log.duration || '',
                ]);
                return [headers, ...csvData].map(row => row.join(',')).join('\n');
            }
            return JSON.stringify(logs, null, 2);
        }
        catch (error) {
            logger_1.logger.error('Failed to export logs:', error);
            return '';
        }
    }
    /**
     * Flush buffer to persistent storage
     */
    async flushLogs() {
        try {
            if (this.logBuffer.length === 0) {
                return;
            }
            const logsToFlush = [...this.logBuffer];
            this.logBuffer.length = 0; // Clear buffer
            // Write to daily log file
            const today = new Date().toISOString().split('T')[0];
            const logFile = path_1.default.join(this.logDirectory, `nexus-${today}.log`);
            const logLines = logsToFlush.map(log => `${log.timestamp.toISOString()} [${log.level.toUpperCase()}] ${log.service}: ${log.message} ` +
                `${log.userId ? `[user:${log.userId}]` : ''} ${log.ipAddress ? `[ip:${log.ipAddress}]` : ''} ` +
                `${log.duration ? `[duration:${log.duration}ms]` : ''} ` +
                `${Object.keys(log.metadata).length > 0 ? `[metadata:${JSON.stringify(log.metadata)}]` : ''}`);
            await promises_1.default.appendFile(logFile, logLines.join('\n') + '\n');
            // Store in Redis for quick access
            for (const log of logsToFlush) {
                const redisKey = `log:${log.service}:${log.id}`;
                await this.redis.setEx(redisKey, 24 * 60 * 60, JSON.stringify(log));
                // Add to service index
                await this.redis.lPush(`logs:${log.service}:recent`, JSON.stringify(log));
                await this.redis.lTrim(`logs:${log.service}:recent`, 0, 999); // Keep last 1000
                // Add to level index if error or critical
                if (log.level === 'error' || log.level === 'critical') {
                    await this.redis.lPush('logs:errors:recent', JSON.stringify(log));
                    await this.redis.lTrim('logs:errors:recent', 0, 999);
                }
            }
            logger_1.logger.debug(`Flushed ${logsToFlush.length} logs to storage`);
        }
        catch (error) {
            logger_1.logger.error('Failed to flush logs:', error);
        }
    }
    /**
     * Query logs from file system
     */
    async queryLogsFromFile(query) {
        try {
            const today = new Date().toISOString().split('T')[0];
            const logFile = path_1.default.join(this.logDirectory, `nexus-${today}.log`);
            const content = await promises_1.default.readFile(logFile, 'utf-8');
            const lines = content.split('\n').filter(line => line.trim() && !line.startsWith('#'));
            const logs = [];
            for (const line of lines) {
                try {
                    const log = this.parseLogLine(line);
                    if (this.matchesQuery(log, query)) {
                        logs.push(log);
                    }
                }
                catch (error) {
                    // Skip malformed lines
                }
            }
            // Sort by timestamp (newest first)
            logs.sort((a, b) => b.timestamp.getTime() - a.timestamp.getTime());
            return logs;
        }
        catch (error) {
            logger_1.logger.error('Failed to query logs from file:', error);
            return [];
        }
    }
    /**
     * Parse log line
     */
    parseLogLine(line) {
        const timestampMatch = line.match(/^(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{3}Z)/);
        const levelMatch = line.match(/\[(DEBUG|INFO|WARN|ERROR|CRITICAL)\]/);
        const serviceMatch = line.match(/\] ([^:]+):/);
        const messageMatch = line.match(/: (.+?)(?: \[|$)/);
        const userIdMatch = line.match(/\[user:([^\]]+)\]/);
        const ipMatch = line.match(/\[ip:([^\]]+)\]/);
        const durationMatch = line.match(/\[duration:(\d+)ms\]/);
        const metadataMatch = line.match(/\[metadata:([^\]]+)\]/);
        return {
            id: crypto_1.default.randomBytes(16).toString('hex'),
            timestamp: timestampMatch ? new Date(timestampMatch[1]) : new Date(),
            level: (levelMatch?.[1] || 'info').toLowerCase(),
            service: serviceMatch?.[1] || 'unknown',
            message: messageMatch?.[1] || line,
            userId: userIdMatch?.[1],
            ipAddress: ipMatch?.[1],
            duration: durationMatch ? parseInt(durationMatch[1]) : undefined,
            metadata: metadataMatch ? JSON.parse(metadataMatch[1]) : {},
            tags: [],
            sessionId: undefined,
            requestId: undefined,
            userAgent: undefined,
            stack: undefined,
        };
    }
    /**
     * Check if log matches query
     */
    matchesQuery(log, query) {
        if (query.level && log.level !== query.level)
            return false;
        if (query.service && log.service !== query.service)
            return false;
        if (query.userId && log.userId !== query.userId)
            return false;
        if (query.startTime && log.timestamp < query.startTime)
            return false;
        if (query.endTime && log.timestamp > query.endTime)
            return false;
        if (query.search && !log.message.toLowerCase().includes(query.search.toLowerCase()))
            return false;
        if (query.tags && query.tags.length > 0 && !query.tags.some(tag => log.tags.includes(tag)))
            return false;
        return true;
    }
    /**
     * Generate query cache key
     */
    generateQueryCacheKey(query) {
        const key = `query:${JSON.stringify(query)}`;
        return crypto_1.default.createHash('md5').update(key).digest('hex');
    }
    /**
     * Generate log ID
     */
    generateLogId() {
        return `log_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
    }
    /**
     * Send alert for critical logs
     */
    async sendAlert(log) {
        try {
            // This would integrate with your alerting system (Sentry, PagerDuty, etc.)
            logger_1.logger.error('CRITICAL ALERT', {
                id: log.id,
                service: log.service,
                message: log.message,
                userId: log.userId,
                ipAddress: log.ipAddress,
                metadata: log.metadata,
            });
            // Store alert for monitoring
            await this.redis.setEx(`alert:${log.id}`, 24 * 60 * 60, // 24 hours
            JSON.stringify({
                ...log,
                alertLevel: 'critical',
                sentAt: new Date(),
            }));
        }
        catch (error) {
            logger_1.logger.error('Failed to send alert:', error);
        }
    }
    /**
     * Start log flush interval
     */
    startLogFlush() {
        setInterval(() => {
            this.flushLogs();
        }, this.flushInterval);
    }
    /**
     * Start log rotation
     */
    startLogRotation() {
        setInterval(async () => {
            await this.rotateLogs();
        }, 24 * 60 * 60 * 1000); // Daily
    }
    /**
     * Rotate old log files
     */
    async rotateLogs() {
        try {
            const files = await promises_1.default.readdir(this.logDirectory);
            const logFiles = files.filter(file => file.startsWith('nexus-') && file.endsWith('.log'));
            // Sort by date (oldest first)
            logFiles.sort((a, b) => {
                const dateA = a.split('-')[1].split('.')[0];
                const dateB = b.split('-')[1].split('.')[0];
                return dateA.localeCompare(dateB);
            });
            // Remove old files beyond retention period
            const cutoffDate = new Date(Date.now() - this.logRetention);
            for (const file of logFiles) {
                if (logFiles.length > this.maxLogFiles) {
                    const filePath = path_1.default.join(this.logDirectory, file);
                    await promises_1.default.unlink(filePath);
                    logger_1.logger.info(`Rotated old log file: ${file}`);
                    logFiles.shift(); // Remove from array
                }
                // Check file date
                const fileDate = file.split('-')[1].split('.')[0];
                const fileDateTime = new Date(fileDate);
                if (fileDateTime < cutoffDate) {
                    const filePath = path_1.default.join(this.logDirectory, file);
                    await promises_1.default.unlink(filePath);
                    logger_1.logger.info(`Rotated expired log file: ${file}`);
                }
            }
            logger_1.logger.info('Log rotation completed');
        }
        catch (error) {
            logger_1.logger.error('Failed to rotate logs:', error);
        }
    }
    /**
     * Get recent logs for a service
     */
    async getRecentLogs(service, limit = 100) {
        try {
            const logData = await this.redis.lRange(`logs:${service}:recent`, 0, limit - 1);
            return logData.map(data => JSON.parse(data));
        }
        catch (error) {
            logger_1.logger.error('Failed to get recent logs:', error);
            return [];
        }
    }
    /**
     * Get recent error logs
     */
    async getRecentErrors(limit = 100) {
        try {
            const errorData = await this.redis.lRange('logs:errors:recent', 0, limit - 1);
            return errorData.map(data => JSON.parse(data));
        }
        catch (error) {
            logger_1.logger.error('Failed to get recent errors:', error);
            return [];
        }
    }
};
exports.CentralizedLoggingService = CentralizedLoggingService;
exports.CentralizedLoggingService = CentralizedLoggingService = __decorate([
    (0, inversify_1.injectable)(),
    __metadata("design:paramtypes", [])
], CentralizedLoggingService);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxBbGVqYW5kcm9cXEFJR2VzdGlvblxcYmFja2VuZFxcc3JjXFxzZXJ2aWNlc1xcY2VudHJhbGl6ZWQtbG9nZ2luZy5zZXJ2aWNlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFBLG9EQUE0QjtBQUM1QiwyREFBNkI7QUFDN0IseUNBQXVDO0FBRXZDLGdEQUF3QjtBQUN4QiwwQ0FBZ0Q7QUFDaEQsNENBQXlDO0FBQzVCLFFBQUEsNEJBQTRCLEdBQUcsMkJBQTJCLENBQUM7QUF1RGpFLElBQU0seUJBQXlCLEdBQS9CLE1BQU0seUJBQXlCO0lBQ25CLEtBQUssQ0FBa0I7SUFDdkIsU0FBUyxHQUFlLEVBQUUsQ0FBQztJQUMzQixVQUFVLEdBQUcsSUFBSSxDQUFDO0lBQ2xCLGFBQWEsR0FBRyxJQUFJLENBQUMsQ0FBQyxZQUFZO0lBQ2xDLFlBQVksR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsSUFBSSxDQUFDLENBQUMsVUFBVTtJQUNuRCxZQUFZLEdBQUcsTUFBTSxDQUFDO0lBQ3RCLFdBQVcsR0FBRyxHQUFHLENBQUM7SUFFbkM7UUFDRSxJQUFJLENBQUMsS0FBSyxHQUFHLElBQUEsc0JBQWMsR0FBRSxDQUFDO1FBRTlCLElBQUksQ0FBQyxpQkFBaUIsRUFBRSxDQUFDO1FBQ3pCLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztRQUNyQixJQUFJLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztJQUMxQixDQUFDO0lBRU8sS0FBSyxDQUFDLGlCQUFpQjtRQUM3QixJQUFJLENBQUM7WUFDSCx1QkFBdUI7WUFDdkIsTUFBTSxrQkFBRSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsWUFBWSxFQUFFLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7WUFFdkQseUJBQXlCO1lBQ3pCLE1BQU0sS0FBSyxHQUFHLElBQUksSUFBSSxFQUFFLENBQUMsV0FBVyxFQUFFLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENB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TSxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxRQUFRLE9BQU8sU0FBUyxFQUFFLENBQUMsRUFBRSxLQUFLLEdBQUcsQ0FBQyxDQUFDLENBQUM7WUFDaEYsT0FBTyxPQUFPLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO1FBQy9DLENBQUM7UUFBQyxPQUFPLEtBQUssRUFBRSxDQUFDO1lBQ2YsZUFBTSxDQUFDLEtBQUssQ0FBQyw0QkFBNEIsRUFBRSxLQUFLLENBQUMsQ0FBQztZQUNsRCxPQUFPLEVBQUUsQ0FBQztRQUNaLENBQUM7SUFDSCxDQUFDO0lBRUQ7O09BRUc7SUFDSSxLQUFLLENBQUMsZUFBZSxDQUFDLFFBQWdCLEdBQUc7UUFDOUMsSUFBSSxDQUFDO1lBQ0gsTUFBTSxTQUFTLEdBQUcsTUFBTSxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxvQkFBb0IsRUFBRSxDQUFDLEVBQUUsS0FBSyxHQUFHLENBQUMsQ0FBQyxDQUFDO1lBQzlFLE9BQU8sU0FBUyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztRQUNqRCxDQUFDO1FBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQztZQUNmLGVBQU0sQ0FBQyxLQUFLLENBQUMsOEJBQThCLEVBQUUsS0FBSyxDQUFDLENBQUM7WUFDcEQsT0FBTyxFQUFFLENBQUM7UUFDWixDQUFDO0lBQ0gsQ0FBQztDQUNGLENBQUE7QUEvaUJZLDhEQUF5QjtvQ0FBekIseUJBQXlCO0lBRHJDLElBQUEsc0JBQVUsR0FBRTs7R0FDQSx5QkFBeUIsQ0EraUJyQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXEFsZWphbmRyb1xcQUlHZXN0aW9uXFxiYWNrZW5kXFxzcmNcXHNlcnZpY2VzXFxjZW50cmFsaXplZC1sb2dnaW5nLnNlcnZpY2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGNyeXB0byBmcm9tICdjcnlwdG8nO1xuaW1wb3J0IGZzIGZyb20gJ2ZzL3Byb21pc2VzJztcbmltcG9ydCB7IGluamVjdGFibGUgfSBmcm9tICdpbnZlcnNpZnknO1xuaW1wb3J0IHR5cGUgeyBSZWRpc0NsaWVudFR5cGUgfSBmcm9tICdyZWRpcyc7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCB7IGdldFJlZGlzQ2xpZW50IH0gZnJvbSAnLi4vY2FjaGUvcmVkaXMnO1xuaW1wb3J0IHsgbG9nZ2VyIH0gZnJvbSAnLi4vdXRpbHMvbG9nZ2VyJztcbmV4cG9ydCBjb25zdCBDRU5UUkFMX0xPR0dJTkdfU0VSVklDRV9OQU1FID0gJ0NlbnRyYWxpemVkTG9nZ2luZ1NlcnZpY2UnO1xuXG5pbnRlcmZhY2UgTG9nRW50cnkge1xuICBpZDogc3RyaW5nO1xuICB0aW1lc3RhbXA6IERhdGU7XG4gIGxldmVsOiAnZGVidWcnIHwgJ2luZm8nIHwgJ3dhcm4nIHwgJ2Vycm9yJyB8ICdjcml0aWNhbCc7XG4gIHNlcnZpY2U6IHN0cmluZztcbiAgdXNlcklkPzogc3RyaW5nO1xuICBzZXNzaW9uSWQ/OiBzdHJpbmc7XG4gIHJlcXVlc3RJZD86IHN0cmluZztcbiAgaXBBZGRyZXNzPzogc3RyaW5nO1xuICB1c2VyQWdlbnQ/OiBzdHJpbmc7XG4gIG1lc3NhZ2U6IHN0cmluZztcbiAgbWV0YWRhdGE6IHtcbiAgICBba2V5OiBzdHJpbmddOiBhbnk7XG4gIH07XG4gIHN0YWNrPzogc3RyaW5nO1xuICBkdXJhdGlvbj86IG51bWJlcjtcbiAgdGFnczogc3RyaW5nW107XG59XG5cbmludGVyZmFjZSBMb2dRdWVyeSB7XG4gIGxldmVsPzogc3RyaW5nO1xuICBzZXJ2aWNlPzogc3RyaW5nO1xuICB1c2VySWQ/OiBzdHJpbmc7XG4gIHNlc3Npb25JZD86IHN0cmluZztcbiAgc3RhcnRUaW1lPzogRGF0ZTtcbiAgZW5kVGltZT86IERhdGU7XG4gIHRhZ3M/OiBzdHJpbmdbXTtcbiAgbGltaXQ/OiBudW1iZXI7XG4gIG9mZnNldD86IG51bWJlcjtcbiAgc2VhcmNoPzogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgTG9nU3RhdHMge1xuICB0b3RhbExvZ3M6IG51bWJlcjtcbiAgbG9nc0J5TGV2ZWw6IHsgW2tleTogc3RyaW5nXTogbnVtYmVyIH07XG4gIGxvZ3NCeVNlcnZpY2U6IHsgW2tleTogc3RyaW5nXTogbnVtYmVyIH07XG4gIGVycm9yUmF0ZTogbnVtYmVyO1xuICBhdmVyYWdlUmVzcG9uc2VUaW1lOiBudW1iZXI7XG4gIHRvcEVycm9yczogQXJyYXk8e1xuICAgIG1lc3NhZ2U6IHN0cmluZztcbiAgICBjb3VudDogbnVtYmVyO1xuICAgIGxldmVsOiBzdHJpbmc7XG4gICAgc2VydmljZTogc3RyaW5nO1xuICB9PjtcbiAgcmVjZW50QWN0aXZpdHk6IEFycmF5PHtcbiAgICB0aW1lc3RhbXA6IERhdGU7XG4gICAgbGV2ZWw6IHN0cmluZztcbiAgICBzZXJ2aWNlOiBzdHJpbmc7XG4gICAgbWVzc2FnZTogc3RyaW5nO1xuICB9Pjtcbn1cblxuQGluamVjdGFibGUoKVxuZXhwb3J0IGNsYXNzIENlbnRyYWxpemVkTG9nZ2luZ1NlcnZpY2Uge1xuICBwcml2YXRlIHJlYWRvbmx5IHJlZGlzOiBSZWRpc0NsaWVudFR5cGU7XG4gIHByaXZhdGUgcmVhZG9ubHkgbG9nQnVmZmVyOiBMb2dFbnRyeVtdID0gW107XG4gIHByaXZhdGUgcmVhZG9ubHkgYnVmZmVyU2l6ZSA9IDEwMDA7XG4gIHByaXZhdGUgcmVhZG9ubHkgZmx1c2hJbnRlcnZhbCA9IDUwMDA7IC8vIDUgc2Vjb25kc1xuICBwcml2YXRlIHJlYWRvbmx5IGxvZ1JldGVudGlvbiA9IDMwICogMjQgKiA2MCAqIDYwICogMTAwMDsgLy8gMzAgZGF5c1xuICBwcml2YXRlIHJlYWRvbmx5IGxvZ0RpcmVjdG9yeSA9ICdsb2dzJztcbiAgcHJpdmF0ZSByZWFkb25seSBtYXhMb2dGaWxlcyA9IDEwMDtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLnJlZGlzID0gZ2V0UmVkaXNDbGllbnQoKTtcblxuICAgIHRoaXMuaW5pdGlhbGl6ZUxvZ2dpbmcoKTtcbiAgICB0aGlzLnN0YXJ0TG9nRmx1c2goKTtcbiAgICB0aGlzLnN0YXJ0TG9nUm90YXRpb24oKTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgaW5pdGlhbGl6ZUxvZ2dpbmcoKSB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIENyZWF0ZSBsb2cgZGlyZWN0b3J5XG4gICAgICBhd2FpdCBmcy5ta2Rpcih0aGlzLmxvZ0RpcmVjdG9yeSwgeyByZWN1cnNpdmU6IHRydWUgfSk7XG5cbiAgICAgIC8vIENyZWF0ZSBkYWlseSBsb2cgZmlsZXNcbiAgICAgIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XG4gICAgICBjb25zdCBsb2dGaWxlID0gcGF0aC5qb2luKHRoaXMubG9nRGlyZWN0b3J5LCBgbmV4dXMtJHt0b2RheX0ubG9nYCk7XG5cbiAgICAgIC8vIENoZWNrIGlmIGxvZyBmaWxlIGV4aXN0c1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgZnMuYWNjZXNzKGxvZ0ZpbGUpO1xuICAgICAgfSBjYXRjaCB7XG4gICAgICAgIC8vIENyZWF0ZSBuZXcgbG9nIGZpbGUgd2l0aCBoZWFkZXJcbiAgICAgICAgY29uc3QgaGVhZGVyID0gYCMgTkVYVVMgVjEgQ2VudHJhbGl6ZWQgTG9nIC0gJHt0b2RheX1cXG5gO1xuICAgICAgICBhd2FpdCBmcy53cml0ZUZpbGUobG9nRmlsZSwgaGVhZGVyKTtcbiAgICAgIH1cblxuICAgICAgbG9nZ2VyLmluZm8oJ0NlbnRyYWxpemVkIGxvZ2dpbmcgc2VydmljZSBpbml0aWFsaXplZCcpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0ZhaWxlZCB0byBpbml0aWFsaXplIGNlbnRyYWxpemVkIGxvZ2dpbmc6JywgZXJyb3IpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBMb2cgYW4gZW50cnlcbiAgICovXG4gIHB1YmxpYyBhc3luYyBsb2coZW50cnk6IE9taXQ8TG9nRW50cnksICdpZCcgfCAndGltZXN0YW1wJz4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgbG9nRW50cnk6IExvZ0VudHJ5ID0ge1xuICAgICAgICAuLi5lbnRyeSxcbiAgICAgICAgaWQ6IHRoaXMuZ2VuZXJhdGVMb2dJZCgpLFxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICB9O1xuXG4gICAgICAvLyBBZGQgdG8gYnVmZmVyXG4gICAgICB0aGlzLmxvZ0J1ZmZlci5wdXNoKGxvZ0VudHJ5KTtcblxuICAgICAgLy8gQnVmZmVyIG1hbmFnZW1lbnRcbiAgICAgIGlmICh0aGlzLmxvZ0J1ZmZlci5sZW5ndGggPj0gdGhpcy5idWZmZXJTaXplKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuZmx1c2hMb2dzKCk7XG4gICAgICB9XG5cbiAgICAgIC8vIENyaXRpY2FsIGxvZ3MgYXJlIGZsdXNoZWQgaW1tZWRpYXRlbHlcbiAgICAgIGlmIChlbnRyeS5sZXZlbCA9PT0gJ2NyaXRpY2FsJykge1xuICAgICAgICBhd2FpdCB0aGlzLmZsdXNoTG9ncygpO1xuICAgICAgICBhd2FpdCB0aGlzLnNlbmRBbGVydChsb2dFbnRyeSk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRmFpbGVkIHRvIGxvZyBlbnRyeTonLCBlcnJvcik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFF1ZXJ5IGxvZ3NcbiAgICovXG4gIHB1YmxpYyBhc3luYyBxdWVyeUxvZ3MocXVlcnk6IExvZ1F1ZXJ5KTogUHJvbWlzZTx7XG4gICAgbG9nczogTG9nRW50cnlbXTtcbiAgICB0b3RhbDogbnVtYmVyO1xuICAgIGhhc01vcmU6IGJvb2xlYW47XG4gIH0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgY2FjaGVLZXkgPSB0aGlzLmdlbmVyYXRlUXVlcnlDYWNoZUtleShxdWVyeSk7XG4gICAgICBjb25zdCBjYWNoZWQgPSBhd2FpdCB0aGlzLnJlZGlzLmdldChjYWNoZUtleSk7XG5cbiAgICAgIGlmIChjYWNoZWQpIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gSlNPTi5wYXJzZShjYWNoZWQpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgfVxuXG4gICAgICAvLyBRdWVyeSBmcm9tIGZpbGUgc3lzdGVtIChzaW1wbGlmaWVkIGltcGxlbWVudGF0aW9uKVxuICAgICAgY29uc3QgbG9ncyA9IGF3YWl0IHRoaXMucXVlcnlMb2dzRnJvbUZpbGUocXVlcnkpO1xuICAgICAgY29uc3QgdG90YWwgPSBsb2dzLmxlbmd0aDtcbiAgICAgIGNvbnN0IGxpbWl0ID0gcXVlcnkubGltaXQgfHwgMTAwO1xuICAgICAgY29uc3Qgb2Zmc2V0ID0gcXVlcnkub2Zmc2V0IHx8IDA7XG4gICAgICBjb25zdCBwYWdpbmF0ZWRMb2dzID0gbG9ncy5zbGljZShvZmZzZXQsIG9mZnNldCArIGxpbWl0KTtcbiAgICAgIGNvbnN0IGhhc01vcmUgPSBvZmZzZXQgKyBsaW1pdCA8IHRvdGFsO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSB7XG4gICAgICAgIGxvZ3M6IHBhZ2luYXRlZExvZ3MsXG4gICAgICAgIHRvdGFsLFxuICAgICAgICBoYXNNb3JlLFxuICAgICAgfTtcblxuICAgICAgLy8gQ2FjaGUgcmVzdWx0XG4gICAgICBhd2FpdCB0aGlzLnJlZGlzLnNldEV4KGNhY2hlS2V5LCA2MCwgSlNPTi5zdHJpbmdpZnkocmVzdWx0KSk7XG5cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRmFpbGVkIHRvIHF1ZXJ5IGxvZ3M6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIHsgbG9nczogW10sIHRvdGFsOiAwLCBoYXNNb3JlOiBmYWxzZSB9O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgbG9nIHN0YXRpc3RpY3NcbiAgICovXG4gIHB1YmxpYyBhc3luYyBnZXRTdGF0cyh0aW1lUmFuZ2U6ICdob3VyJyB8ICdkYXknIHwgJ3dlZWsnIHwgJ21vbnRoJyA9ICdkYXknKTogUHJvbWlzZTxMb2dTdGF0cz4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgICAgbGV0IHN0YXJ0VGltZTogRGF0ZTtcblxuICAgICAgc3dpdGNoICh0aW1lUmFuZ2UpIHtcbiAgICAgICAgY2FzZSAnaG91cic6XG4gICAgICAgICAgc3RhcnRUaW1lID0gbmV3IERhdGUobm93LmdldFRpbWUoKSAtIDYwICogNjAgKiAxMDAwKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnZGF5JzpcbiAgICAgICAgICBzdGFydFRpbWUgPSBuZXcgRGF0ZShub3cuZ2V0VGltZSgpIC0gMjQgKiA2MCAqIDYwICogMTAwMCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ3dlZWsnOlxuICAgICAgICAgIHN0YXJ0VGltZSA9IG5ldyBEYXRlKG5vdy5nZXRUaW1lKCkgLSA3ICogMjQgKiA2MCAqIDYwICogMTAwMCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ21vbnRoJzpcbiAgICAgICAgICBzdGFydFRpbWUgPSBuZXcgRGF0ZShub3cuZ2V0VGltZSgpIC0gMzAgKiAyNCAqIDYwICogNjAgKiAxMDAwKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cblxuICAgICAgY29uc3QgcXVlcnk6IExvZ1F1ZXJ5ID0ge1xuICAgICAgICBzdGFydFRpbWUsXG4gICAgICAgIGVuZFRpbWU6IG5vdyxcbiAgICAgICAgbGltaXQ6IDEwMDAwLFxuICAgICAgfTtcblxuICAgICAgY29uc3QgeyBsb2dzIH0gPSBhd2FpdCB0aGlzLnF1ZXJ5TG9ncyhxdWVyeSk7XG5cbiAgICAgIGNvbnN0IHN0YXRzOiBMb2dTdGF0cyA9IHtcbiAgICAgICAgdG90YWxMb2dzOiBsb2dzLmxlbmd0aCxcbiAgICAgICAgbG9nc0J5TGV2ZWw6IHt9LFxuICAgICAgICBsb2dzQnlTZXJ2aWNlOiB7fSxcbiAgICAgICAgZXJyb3JSYXRlOiAwLFxuICAgICAgICBhdmVyYWdlUmVzcG9uc2VUaW1lOiAwLFxuICAgICAgICB0b3BFcnJvcnM6IFtdLFxuICAgICAgICByZWNlbnRBY3Rpdml0eTogW10sXG4gICAgICB9O1xuXG4gICAgICAvLyBDYWxjdWxhdGUgc3RhdGlzdGljc1xuICAgICAgbG9ncy5mb3JFYWNoKGxvZyA9PiB7XG4gICAgICAgIC8vIENvdW50IGJ5IGxldmVsXG4gICAgICAgIHN0YXRzLmxvZ3NCeUxldmVsW2xvZy5sZXZlbF0gPSAoc3RhdHMubG9nc0J5TGV2ZWxbbG9nLmxldmVsXSB8fCAwKSArIDE7XG5cbiAgICAgICAgLy8gQ291bnQgYnkgc2VydmljZVxuICAgICAgICBzdGF0cy5sb2dzQnlTZXJ2aWNlW2xvZy5zZXJ2aWNlXSA9IChzdGF0cy5sb2dzQnlTZXJ2aWNlW2xvZy5zZXJ2aWNlXSB8fCAwKSArIDE7XG5cbiAgICAgICAgLy8gQ2FsY3VsYXRlIGVycm9yIHJhdGVcbiAgICAgICAgaWYgKGxvZy5sZXZlbCA9PT0gJ2Vycm9yJyB8fCBsb2cubGV2ZWwgPT09ICdjcml0aWNhbCcpIHtcbiAgICAgICAgICBzdGF0cy5lcnJvclJhdGUrKztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENhbGN1bGF0ZSBhdmVyYWdlIHJlc3BvbnNlIHRpbWVcbiAgICAgICAgaWYgKGxvZy5kdXJhdGlvbikge1xuICAgICAgICAgIHN0YXRzLmF2ZXJhZ2VSZXNwb25zZVRpbWUgKz0gbG9nLmR1cmF0aW9uO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgLy8gRmluYWxpemUgY2FsY3VsYXRpb25zXG4gICAgICBzdGF0cy5lcnJvclJhdGUgPSBsb2dzLmxlbmd0aCA+IDAgPyAoc3RhdHMuZXJyb3JSYXRlIC8gbG9ncy5sZW5ndGgpICogMTAwIDogMDtcbiAgICAgIHN0YXRzLmF2ZXJhZ2VSZXNwb25zZVRpbWUgPSBsb2dzLmxlbmd0aCA+IDAgPyBzdGF0cy5hdmVyYWdlUmVzcG9uc2VUaW1lIC8gbG9ncy5sZW5ndGggOiAwO1xuXG4gICAgICAvLyBUb3AgZXJyb3JzXG4gICAgICBjb25zdCBlcnJvckxvZ3MgPSBsb2dzLmZpbHRlcihsb2cgPT4gbG9nLmxldmVsID09PSAnZXJyb3InIHx8IGxvZy5sZXZlbCA9PT0gJ2NyaXRpY2FsJyk7XG4gICAgICBjb25zdCBlcnJvckNvdW50cyA9IG5ldyBNYXA8XG4gICAgICAgIHN0cmluZyxcbiAgICAgICAgeyBjb3VudDogbnVtYmVyOyBsZXZlbDogc3RyaW5nOyBzZXJ2aWNlOiBzdHJpbmc7IG1lc3NhZ2U6IHN0cmluZyB9XG4gICAgICA+KCk7XG5cbiAgICAgIGVycm9yTG9ncy5mb3JFYWNoKGxvZyA9PiB7XG4gICAgICAgIGNvbnN0IGtleSA9IGAke2xvZy5zZXJ2aWNlfToke2xvZy5tZXNzYWdlfWA7XG4gICAgICAgIGNvbnN0IGV4aXN0aW5nID0gZXJyb3JDb3VudHMuZ2V0KGtleSk7XG4gICAgICAgIGlmIChleGlzdGluZykge1xuICAgICAgICAgIGV4aXN0aW5nLmNvdW50Kys7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZXJyb3JDb3VudHMuc2V0KGtleSwge1xuICAgICAgICAgICAgY291bnQ6IDEsXG4gICAgICAgICAgICBsZXZlbDogbG9nLmxldmVsLFxuICAgICAgICAgICAgc2VydmljZTogbG9nLnNlcnZpY2UsXG4gICAgICAgICAgICBtZXNzYWdlOiBsb2cubWVzc2FnZSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIHN0YXRzLnRvcEVycm9ycyA9IEFycmF5LmZyb20oZXJyb3JDb3VudHMudmFsdWVzKCkpXG4gICAgICAgIC5zb3J0KChhLCBiKSA9PiBiLmNvdW50IC0gYS5jb3VudClcbiAgICAgICAgLnNsaWNlKDAsIDEwKTtcblxuICAgICAgLy8gUmVjZW50IGFjdGl2aXR5XG4gICAgICBzdGF0cy5yZWNlbnRBY3Rpdml0eSA9IGxvZ3NcbiAgICAgICAgLnNvcnQoKGEsIGIpID0+IGIudGltZXN0YW1wLmdldFRpbWUoKSAtIGEudGltZXN0YW1wLmdldFRpbWUoKSlcbiAgICAgICAgLnNsaWNlKDAsIDIwKVxuICAgICAgICAubWFwKGxvZyA9PiAoe1xuICAgICAgICAgIHRpbWVzdGFtcDogbG9nLnRpbWVzdGFtcCxcbiAgICAgICAgICBsZXZlbDogbG9nLmxldmVsLFxuICAgICAgICAgIHNlcnZpY2U6IGxvZy5zZXJ2aWNlLFxuICAgICAgICAgIG1lc3NhZ2U6IGxvZy5tZXNzYWdlLFxuICAgICAgICB9KSk7XG5cbiAgICAgIHJldHVybiBzdGF0cztcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdGYWlsZWQgdG8gZ2V0IGxvZyBzdGF0czonLCBlcnJvcik7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0b3RhbExvZ3M6IDAsXG4gICAgICAgIGxvZ3NCeUxldmVsOiB7fSxcbiAgICAgICAgbG9nc0J5U2VydmljZToge30sXG4gICAgICAgIGVycm9yUmF0ZTogMCxcbiAgICAgICAgYXZlcmFnZVJlc3BvbnNlVGltZTogMCxcbiAgICAgICAgdG9wRXJyb3JzOiBbXSxcbiAgICAgICAgcmVjZW50QWN0aXZpdHk6IFtdLFxuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU2VhcmNoIGxvZ3NcbiAgICovXG4gIHB1YmxpYyBhc3luYyBzZWFyY2hMb2dzKFxuICAgIHNlYXJjaFRlcm06IHN0cmluZyxcbiAgICBvcHRpb25zOiBQYXJ0aWFsPExvZ1F1ZXJ5PiA9IHt9LFxuICApOiBQcm9taXNlPExvZ0VudHJ5W10+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcXVlcnk6IExvZ1F1ZXJ5ID0ge1xuICAgICAgICBzZWFyY2g6IHNlYXJjaFRlcm0sXG4gICAgICAgIGxpbWl0OiAxMDAsXG4gICAgICAgIC4uLm9wdGlvbnMsXG4gICAgICB9O1xuXG4gICAgICBjb25zdCB7IGxvZ3MgfSA9IGF3YWl0IHRoaXMucXVlcnlMb2dzKHF1ZXJ5KTtcbiAgICAgIHJldHVybiBsb2dzO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0ZhaWxlZCB0byBzZWFyY2ggbG9nczonLCBlcnJvcik7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEV4cG9ydCBsb2dzXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgZXhwb3J0TG9ncyhxdWVyeTogTG9nUXVlcnksIGZvcm1hdDogJ2pzb24nIHwgJ2NzdicgPSAnanNvbicpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IGxvZ3MgfSA9IGF3YWl0IHRoaXMucXVlcnlMb2dzKHsgLi4ucXVlcnksIGxpbWl0OiAxMDAwMCB9KTtcblxuICAgICAgaWYgKGZvcm1hdCA9PT0gJ2NzdicpIHtcbiAgICAgICAgY29uc3QgaGVhZGVycyA9IFtcbiAgICAgICAgICAnaWQnLFxuICAgICAgICAgICd0aW1lc3RhbXAnLFxuICAgICAgICAgICdsZXZlbCcsXG4gICAgICAgICAgJ3NlcnZpY2UnLFxuICAgICAgICAgICd1c2VySWQnLFxuICAgICAgICAgICdtZXNzYWdlJyxcbiAgICAgICAgICAnaXBBZGRyZXNzJyxcbiAgICAgICAgICAnZHVyYXRpb24nLFxuICAgICAgICBdO1xuICAgICAgICBjb25zdCBjc3ZEYXRhID0gbG9ncy5tYXAobG9nID0+IFtcbiAgICAgICAgICBsb2cuaWQsXG4gICAgICAgICAgbG9nLnRpbWVzdGFtcC50b0lTT1N0cmluZygpLFxuICAgICAgICAgIGxvZy5sZXZlbCxcbiAgICAgICAgICBsb2cuc2VydmljZSxcbiAgICAgICAgICBsb2cudXNlcklkIHx8ICcnLFxuICAgICAgICAgIGxvZy5tZXNzYWdlLnJlcGxhY2UoL1wiL2csICdcIlwiJyksIC8vIEVzY2FwZSBxdW90ZXNcbiAgICAgICAgICBsb2cuaXBBZGRyZXNzIHx8ICcnLFxuICAgICAgICAgIGxvZy5kdXJhdGlvbiB8fCAnJyxcbiAgICAgICAgXSk7XG5cbiAgICAgICAgcmV0dXJuIFtoZWFkZXJzLCAuLi5jc3ZEYXRhXS5tYXAocm93ID0+IHJvdy5qb2luKCcsJykpLmpvaW4oJ1xcbicpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkobG9ncywgbnVsbCwgMik7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRmFpbGVkIHRvIGV4cG9ydCBsb2dzOicsIGVycm9yKTtcbiAgICAgIHJldHVybiAnJztcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRmx1c2ggYnVmZmVyIHRvIHBlcnNpc3RlbnQgc3RvcmFnZVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBmbHVzaExvZ3MoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGlmICh0aGlzLmxvZ0J1ZmZlci5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBsb2dzVG9GbHVzaCA9IFsuLi50aGlzLmxvZ0J1ZmZlcl07XG4gICAgICB0aGlzLmxvZ0J1ZmZlci5sZW5ndGggPSAwOyAvLyBDbGVhciBidWZmZXJcblxuICAgICAgLy8gV3JpdGUgdG8gZGFpbHkgbG9nIGZpbGVcbiAgICAgIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XG4gICAgICBjb25zdCBsb2dGaWxlID0gcGF0aC5qb2luKHRoaXMubG9nRGlyZWN0b3J5LCBgbmV4dXMtJHt0b2RheX0ubG9nYCk7XG5cbiAgICAgIGNvbnN0IGxvZ0xpbmVzID0gbG9nc1RvRmx1c2gubWFwKFxuICAgICAgICBsb2cgPT5cbiAgICAgICAgICBgJHtsb2cudGltZXN0YW1wLnRvSVNPU3RyaW5nKCl9IFske2xvZy5sZXZlbC50b1VwcGVyQ2FzZSgpfV0gJHtsb2cuc2VydmljZX06ICR7XG4gICAgICAgICAgICBsb2cubWVzc2FnZVxuICAgICAgICAgIH0gYCArXG4gICAgICAgICAgYCR7bG9nLnVzZXJJZCA/IGBbdXNlcjoke2xvZy51c2VySWR9XWAgOiAnJ30gJHtcbiAgICAgICAgICAgIGxvZy5pcEFkZHJlc3MgPyBgW2lwOiR7bG9nLmlwQWRkcmVzc31dYCA6ICcnXG4gICAgICAgICAgfSBgICtcbiAgICAgICAgICBgJHtsb2cuZHVyYXRpb24gPyBgW2R1cmF0aW9uOiR7bG9nLmR1cmF0aW9ufW1zXWAgOiAnJ30gYCArXG4gICAgICAgICAgYCR7XG4gICAgICAgICAgICBPYmplY3Qua2V5cyhsb2cubWV0YWRhdGEpLmxlbmd0aCA+IDAgPyBgW21ldGFkYXRhOiR7SlNPTi5zdHJpbmdpZnkobG9nLm1ldGFkYXRhKX1dYCA6ICcnXG4gICAgICAgICAgfWAsXG4gICAgICApO1xuXG4gICAgICBhd2FpdCBmcy5hcHBlbmRGaWxlKGxvZ0ZpbGUsIGxvZ0xpbmVzLmpvaW4oJ1xcbicpICsgJ1xcbicpO1xuXG4gICAgICAvLyBTdG9yZSBpbiBSZWRpcyBmb3IgcXVpY2sgYWNjZXNzXG4gICAgICBmb3IgKGNvbnN0IGxvZyBvZiBsb2dzVG9GbHVzaCkge1xuICAgICAgICBjb25zdCByZWRpc0tleSA9IGBsb2c6JHtsb2cuc2VydmljZX06JHtsb2cuaWR9YDtcbiAgICAgICAgYXdhaXQgdGhpcy5yZWRpcy5zZXRFeChyZWRpc0tleSwgMjQgKiA2MCAqIDYwLCBKU09OLnN0cmluZ2lmeShsb2cpKTtcblxuICAgICAgICAvLyBBZGQgdG8gc2VydmljZSBpbmRleFxuICAgICAgICBhd2FpdCB0aGlzLnJlZGlzLmxQdXNoKGBsb2dzOiR7bG9nLnNlcnZpY2V9OnJlY2VudGAsIEpTT04uc3RyaW5naWZ5KGxvZykpO1xuICAgICAgICBhd2FpdCB0aGlzLnJlZGlzLmxUcmltKGBsb2dzOiR7bG9nLnNlcnZpY2V9OnJlY2VudGAsIDAsIDk5OSk7IC8vIEtlZXAgbGFzdCAxMDAwXG5cbiAgICAgICAgLy8gQWRkIHRvIGxldmVsIGluZGV4IGlmIGVycm9yIG9yIGNyaXRpY2FsXG4gICAgICAgIGlmIChsb2cubGV2ZWwgPT09ICdlcnJvcicgfHwgbG9nLmxldmVsID09PSAnY3JpdGljYWwnKSB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5yZWRpcy5sUHVzaCgnbG9nczplcnJvcnM6cmVjZW50JywgSlNPTi5zdHJpbmdpZnkobG9nKSk7XG4gICAgICAgICAgYXdhaXQgdGhpcy5yZWRpcy5sVHJpbSgnbG9nczplcnJvcnM6cmVjZW50JywgMCwgOTk5KTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBsb2dnZXIuZGVidWcoYEZsdXNoZWQgJHtsb2dzVG9GbHVzaC5sZW5ndGh9IGxvZ3MgdG8gc3RvcmFnZWApO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0ZhaWxlZCB0byBmbHVzaCBsb2dzOicsIGVycm9yKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUXVlcnkgbG9ncyBmcm9tIGZpbGUgc3lzdGVtXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHF1ZXJ5TG9nc0Zyb21GaWxlKHF1ZXJ5OiBMb2dRdWVyeSk6IFByb21pc2U8TG9nRW50cnlbXT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB0b2RheSA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdO1xuICAgICAgY29uc3QgbG9nRmlsZSA9IHBhdGguam9pbih0aGlzLmxvZ0RpcmVjdG9yeSwgYG5leHVzLSR7dG9kYXl9LmxvZ2ApO1xuXG4gICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgZnMucmVhZEZpbGUobG9nRmlsZSwgJ3V0Zi04Jyk7XG4gICAgICBjb25zdCBsaW5lcyA9IGNvbnRlbnQuc3BsaXQoJ1xcbicpLmZpbHRlcihsaW5lID0+IGxpbmUudHJpbSgpICYmICFsaW5lLnN0YXJ0c1dpdGgoJyMnKSk7XG5cbiAgICAgIGNvbnN0IGxvZ3M6IExvZ0VudHJ5W10gPSBbXTtcblxuICAgICAgZm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgbG9nID0gdGhpcy5wYXJzZUxvZ0xpbmUobGluZSk7XG4gICAgICAgICAgaWYgKHRoaXMubWF0Y2hlc1F1ZXJ5KGxvZywgcXVlcnkpKSB7XG4gICAgICAgICAgICBsb2dzLnB1c2gobG9nKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgLy8gU2tpcCBtYWxmb3JtZWQgbGluZXNcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBTb3J0IGJ5IHRpbWVzdGFtcCAobmV3ZXN0IGZpcnN0KVxuICAgICAgbG9ncy5zb3J0KChhLCBiKSA9PiBiLnRpbWVzdGFtcC5nZXRUaW1lKCkgLSBhLnRpbWVzdGFtcC5nZXRUaW1lKCkpO1xuXG4gICAgICByZXR1cm4gbG9ncztcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdGYWlsZWQgdG8gcXVlcnkgbG9ncyBmcm9tIGZpbGU6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBQYXJzZSBsb2cgbGluZVxuICAgKi9cbiAgcHJpdmF0ZSBwYXJzZUxvZ0xpbmUobGluZTogc3RyaW5nKTogTG9nRW50cnkge1xuICAgIGNvbnN0IHRpbWVzdGFtcE1hdGNoID0gbGluZS5tYXRjaCgvXihcXGR7NH0tXFxkezJ9LVxcZHsyfVRcXGR7Mn06XFxkezJ9OlxcZHsyfVxcLlxcZHszfVopLyk7XG4gICAgY29uc3QgbGV2ZWxNYXRjaCA9IGxpbmUubWF0Y2goL1xcWyhERUJVR3xJTkZPfFdBUk58RVJST1J8Q1JJVElDQUwpXFxdLyk7XG4gICAgY29uc3Qgc2VydmljZU1hdGNoID0gbGluZS5tYXRjaCgvXFxdIChbXjpdKyk6Lyk7XG4gICAgY29uc3QgbWVzc2FnZU1hdGNoID0gbGluZS5tYXRjaCgvOiAoLis/KSg/OiBcXFt8JCkvKTtcblxuICAgIGNvbnN0IHVzZXJJZE1hdGNoID0gbGluZS5tYXRjaCgvXFxbdXNlcjooW15cXF1dKylcXF0vKTtcbiAgICBjb25zdCBpcE1hdGNoID0gbGluZS5tYXRjaCgvXFxbaXA6KFteXFxdXSspXFxdLyk7XG4gICAgY29uc3QgZHVyYXRpb25NYXRjaCA9IGxpbmUubWF0Y2goL1xcW2R1cmF0aW9uOihcXGQrKW1zXFxdLyk7XG4gICAgY29uc3QgbWV0YWRhdGFNYXRjaCA9IGxpbmUubWF0Y2goL1xcW21ldGFkYXRhOihbXlxcXV0rKVxcXS8pO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGlkOiBjcnlwdG8ucmFuZG9tQnl0ZXMoMTYpLnRvU3RyaW5nKCdoZXgnKSxcbiAgICAgIHRpbWVzdGFtcDogdGltZXN0YW1wTWF0Y2ggPyBuZXcgRGF0ZSh0aW1lc3RhbXBNYXRjaFsxXSkgOiBuZXcgRGF0ZSgpLFxuICAgICAgbGV2ZWw6IChsZXZlbE1hdGNoPy5bMV0gfHwgJ2luZm8nKS50b0xvd2VyQ2FzZSgpIGFzIGFueSxcbiAgICAgIHNlcnZpY2U6IHNlcnZpY2VNYXRjaD8uWzFdIHx8ICd1bmtub3duJyxcbiAgICAgIG1lc3NhZ2U6IG1lc3NhZ2VNYXRjaD8uWzFdIHx8IGxpbmUsXG4gICAgICB1c2VySWQ6IHVzZXJJZE1hdGNoPy5bMV0sXG4gICAgICBpcEFkZHJlc3M6IGlwTWF0Y2g/LlsxXSxcbiAgICAgIGR1cmF0aW9uOiBkdXJhdGlvbk1hdGNoID8gcGFyc2VJbnQoZHVyYXRpb25NYXRjaFsxXSkgOiB1bmRlZmluZWQsXG4gICAgICBtZXRhZGF0YTogbWV0YWRhdGFNYXRjaCA/IEpTT04ucGFyc2UobWV0YWRhdGFNYXRjaFsxXSkgOiB7fSxcbiAgICAgIHRhZ3M6IFtdLFxuICAgICAgc2Vzc2lvbklkOiB1bmRlZmluZWQsXG4gICAgICByZXF1ZXN0SWQ6IHVuZGVmaW5lZCxcbiAgICAgIHVzZXJBZ2VudDogdW5kZWZpbmVkLFxuICAgICAgc3RhY2s6IHVuZGVmaW5lZCxcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIGxvZyBtYXRjaGVzIHF1ZXJ5XG4gICAqL1xuICBwcml2YXRlIG1hdGNoZXNRdWVyeShsb2c6IExvZ0VudHJ5LCBxdWVyeTogTG9nUXVlcnkpOiBib29sZWFuIHtcbiAgICBpZiAocXVlcnkubGV2ZWwgJiYgbG9nLmxldmVsICE9PSBxdWVyeS5sZXZlbCkgcmV0dXJuIGZhbHNlO1xuICAgIGlmIChxdWVyeS5zZXJ2aWNlICYmIGxvZy5zZXJ2aWNlICE9PSBxdWVyeS5zZXJ2aWNlKSByZXR1cm4gZmFsc2U7XG4gICAgaWYgKHF1ZXJ5LnVzZXJJZCAmJiBsb2cudXNlcklkICE9PSBxdWVyeS51c2VySWQpIHJldHVybiBmYWxzZTtcbiAgICBpZiAocXVlcnkuc3RhcnRUaW1lICYmIGxvZy50aW1lc3RhbXAgPCBxdWVyeS5zdGFydFRpbWUpIHJldHVybiBmYWxzZTtcbiAgICBpZiAocXVlcnkuZW5kVGltZSAmJiBsb2cudGltZXN0YW1wID4gcXVlcnkuZW5kVGltZSkgcmV0dXJuIGZhbHNlO1xuICAgIGlmIChxdWVyeS5zZWFyY2ggJiYgIWxvZy5tZXNzYWdlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMocXVlcnkuc2VhcmNoLnRvTG93ZXJDYXNlKCkpKVxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIGlmIChxdWVyeS50YWdzICYmIHF1ZXJ5LnRhZ3MubGVuZ3RoID4gMCAmJiAhcXVlcnkudGFncy5zb21lKHRhZyA9PiBsb2cudGFncy5pbmNsdWRlcyh0YWcpKSlcbiAgICAgIHJldHVybiBmYWxzZTtcblxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIHF1ZXJ5IGNhY2hlIGtleVxuICAgKi9cbiAgcHJpdmF0ZSBnZW5lcmF0ZVF1ZXJ5Q2FjaGVLZXkocXVlcnk6IExvZ1F1ZXJ5KTogc3RyaW5nIHtcbiAgICBjb25zdCBrZXkgPSBgcXVlcnk6JHtKU09OLnN0cmluZ2lmeShxdWVyeSl9YDtcbiAgICByZXR1cm4gY3J5cHRvLmNyZWF0ZUhhc2goJ21kNScpLnVwZGF0ZShrZXkpLmRpZ2VzdCgnaGV4Jyk7XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGUgbG9nIElEXG4gICAqL1xuICBwcml2YXRlIGdlbmVyYXRlTG9nSWQoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYGxvZ18ke0RhdGUubm93KCl9XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpfWA7XG4gIH1cblxuICAvKipcbiAgICogU2VuZCBhbGVydCBmb3IgY3JpdGljYWwgbG9nc1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBzZW5kQWxlcnQobG9nOiBMb2dFbnRyeSk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBUaGlzIHdvdWxkIGludGVncmF0ZSB3aXRoIHlvdXIgYWxlcnRpbmcgc3lzdGVtIChTZW50cnksIFBhZ2VyRHV0eSwgZXRjLilcbiAgICAgIGxvZ2dlci5lcnJvcignQ1JJVElDQUwgQUxFUlQnLCB7XG4gICAgICAgIGlkOiBsb2cuaWQsXG4gICAgICAgIHNlcnZpY2U6IGxvZy5zZXJ2aWNlLFxuICAgICAgICBtZXNzYWdlOiBsb2cubWVzc2FnZSxcbiAgICAgICAgdXNlcklkOiBsb2cudXNlcklkLFxuICAgICAgICBpcEFkZHJlc3M6IGxvZy5pcEFkZHJlc3MsXG4gICAgICAgIG1ldGFkYXRhOiBsb2cubWV0YWRhdGEsXG4gICAgICB9KTtcblxuICAgICAgLy8gU3RvcmUgYWxlcnQgZm9yIG1vbml0b3JpbmdcbiAgICAgIGF3YWl0IHRoaXMucmVkaXMuc2V0RXgoXG4gICAgICAgIGBhbGVydDoke2xvZy5pZH1gLFxuICAgICAgICAyNCAqIDYwICogNjAsIC8vIDI0IGhvdXJzXG4gICAgICAgIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAuLi5sb2csXG4gICAgICAgICAgYWxlcnRMZXZlbDogJ2NyaXRpY2FsJyxcbiAgICAgICAgICBzZW50QXQ6IG5ldyBEYXRlKCksXG4gICAgICAgIH0pLFxuICAgICAgKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdGYWlsZWQgdG8gc2VuZCBhbGVydDonLCBlcnJvcik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFN0YXJ0IGxvZyBmbHVzaCBpbnRlcnZhbFxuICAgKi9cbiAgcHJpdmF0ZSBzdGFydExvZ0ZsdXNoKCk6IHZvaWQge1xuICAgIHNldEludGVydmFsKCgpID0+IHtcbiAgICAgIHRoaXMuZmx1c2hMb2dzKCk7XG4gICAgfSwgdGhpcy5mbHVzaEludGVydmFsKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTdGFydCBsb2cgcm90YXRpb25cbiAgICovXG4gIHByaXZhdGUgc3RhcnRMb2dSb3RhdGlvbigpOiB2b2lkIHtcbiAgICBzZXRJbnRlcnZhbChcbiAgICAgIGFzeW5jICgpID0+IHtcbiAgICAgICAgYXdhaXQgdGhpcy5yb3RhdGVMb2dzKCk7XG4gICAgICB9LFxuICAgICAgMjQgKiA2MCAqIDYwICogMTAwMCxcbiAgICApOyAvLyBEYWlseVxuICB9XG5cbiAgLyoqXG4gICAqIFJvdGF0ZSBvbGQgbG9nIGZpbGVzXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHJvdGF0ZUxvZ3MoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGZpbGVzID0gYXdhaXQgZnMucmVhZGRpcih0aGlzLmxvZ0RpcmVjdG9yeSk7XG4gICAgICBjb25zdCBsb2dGaWxlcyA9IGZpbGVzLmZpbHRlcihmaWxlID0+IGZpbGUuc3RhcnRzV2l0aCgnbmV4dXMtJykgJiYgZmlsZS5lbmRzV2l0aCgnLmxvZycpKTtcblxuICAgICAgLy8gU29ydCBieSBkYXRlIChvbGRlc3QgZmlyc3QpXG4gICAgICBsb2dGaWxlcy5zb3J0KChhLCBiKSA9PiB7XG4gICAgICAgIGNvbnN0IGRhdGVBID0gYS5zcGxpdCgnLScpWzFdLnNwbGl0KCcuJylbMF07XG4gICAgICAgIGNvbnN0IGRhdGVCID0gYi5zcGxpdCgnLScpWzFdLnNwbGl0KCcuJylbMF07XG4gICAgICAgIHJldHVybiBkYXRlQS5sb2NhbGVDb21wYXJlKGRhdGVCKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBSZW1vdmUgb2xkIGZpbGVzIGJleW9uZCByZXRlbnRpb24gcGVyaW9kXG4gICAgICBjb25zdCBjdXRvZmZEYXRlID0gbmV3IERhdGUoRGF0ZS5ub3coKSAtIHRoaXMubG9nUmV0ZW50aW9uKTtcblxuICAgICAgZm9yIChjb25zdCBmaWxlIG9mIGxvZ0ZpbGVzKSB7XG4gICAgICAgIGlmIChsb2dGaWxlcy5sZW5ndGggPiB0aGlzLm1heExvZ0ZpbGVzKSB7XG4gICAgICAgICAgY29uc3QgZmlsZVBhdGggPSBwYXRoLmpvaW4odGhpcy5sb2dEaXJlY3RvcnksIGZpbGUpO1xuICAgICAgICAgIGF3YWl0IGZzLnVubGluayhmaWxlUGF0aCk7XG4gICAgICAgICAgbG9nZ2VyLmluZm8oYFJvdGF0ZWQgb2xkIGxvZyBmaWxlOiAke2ZpbGV9YCk7XG4gICAgICAgICAgbG9nRmlsZXMuc2hpZnQoKTsgLy8gUmVtb3ZlIGZyb20gYXJyYXlcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENoZWNrIGZpbGUgZGF0ZVxuICAgICAgICBjb25zdCBmaWxlRGF0ZSA9IGZpbGUuc3BsaXQoJy0nKVsxXS5zcGxpdCgnLicpWzBdO1xuICAgICAgICBjb25zdCBmaWxlRGF0ZVRpbWUgPSBuZXcgRGF0ZShmaWxlRGF0ZSk7XG5cbiAgICAgICAgaWYgKGZpbGVEYXRlVGltZSA8IGN1dG9mZkRhdGUpIHtcbiAgICAgICAgICBjb25zdCBmaWxlUGF0aCA9IHBhdGguam9pbih0aGlzLmxvZ0RpcmVjdG9yeSwgZmlsZSk7XG4gICAgICAgICAgYXdhaXQgZnMudW5saW5rKGZpbGVQYXRoKTtcbiAgICAgICAgICBsb2dnZXIuaW5mbyhgUm90YXRlZCBleHBpcmVkIGxvZyBmaWxlOiAke2ZpbGV9YCk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgbG9nZ2VyLmluZm8oJ0xvZyByb3RhdGlvbiBjb21wbGV0ZWQnKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdGYWlsZWQgdG8gcm90YXRlIGxvZ3M6JywgZXJyb3IpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgcmVjZW50IGxvZ3MgZm9yIGEgc2VydmljZVxuICAgKi9cbiAgcHVibGljIGFzeW5jIGdldFJlY2VudExvZ3Moc2VydmljZTogc3RyaW5nLCBsaW1pdDogbnVtYmVyID0gMTAwKTogUHJvbWlzZTxMb2dFbnRyeVtdPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGxvZ0RhdGEgPSBhd2FpdCB0aGlzLnJlZGlzLmxSYW5nZShgbG9nczoke3NlcnZpY2V9OnJlY2VudGAsIDAsIGxpbWl0IC0gMSk7XG4gICAgICByZXR1cm4gbG9nRGF0YS5tYXAoZGF0YSA9PiBKU09OLnBhcnNlKGRhdGEpKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdGYWlsZWQgdG8gZ2V0IHJlY2VudCBsb2dzOicsIGVycm9yKTtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IHJlY2VudCBlcnJvciBsb2dzXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgZ2V0UmVjZW50RXJyb3JzKGxpbWl0OiBudW1iZXIgPSAxMDApOiBQcm9taXNlPExvZ0VudHJ5W10+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgZXJyb3JEYXRhID0gYXdhaXQgdGhpcy5yZWRpcy5sUmFuZ2UoJ2xvZ3M6ZXJyb3JzOnJlY2VudCcsIDAsIGxpbWl0IC0gMSk7XG4gICAgICByZXR1cm4gZXJyb3JEYXRhLm1hcChkYXRhID0+IEpTT04ucGFyc2UoZGF0YSkpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0ZhaWxlZCB0byBnZXQgcmVjZW50IGVycm9yczonLCBlcnJvcik7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuICB9XG59XG4iXSwidmVyc2lvbiI6M30=