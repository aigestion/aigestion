dfc519f300e020161e0adb4138aeedb3
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.schemas = exports.validateParams = exports.validateQuery = exports.validateBody = exports.validate = void 0;
const zod_1 = require("zod");
/**
 * Enhanced validation middleware that supports validating body, query, and params.
 * Throws ZodError to be caught by the global errorHandler.
 */
/**
 * Create a validation middleware for Express routes.
 *
 * The `schema` argument can contain Zod objects for `body`, `query`, and
 * `params`. Each part is validated asynchronously; on success the parsed
 * value replaces the original request property. Validation errors are passed
 * to `next` so the global error handler can convert them to a proper HTTP
 * response (e.g., 400 Bad Request).
 */
const validate = (schema) => {
    return async (req, _res, next) => {
        console.log(`[DEBUG] validate middleware called for ${req.method} ${req.originalUrl}`);
        try {
            if (schema.body) {
                console.log('[DEBUG] Validating body...');
                req.body = await schema.body.parseAsync(req.body);
            }
            if (schema.query) {
                req.query = (await schema.query.parseAsync(req.query));
            }
            if (schema.params) {
                req.params = (await schema.params.parseAsync(req.params));
            }
            console.log('[DEBUG] Validation successful');
            next();
        }
        catch (error) {
            console.log('[DEBUG] Validation failed:', error.message);
            next(error);
        }
    };
};
exports.validate = validate;
/**
 * Legacy wrappers for backward compatibility if needed, or specific use cases.
 */
/** Legacy wrappers for backward compatibility */
const validateBody = (schema) => (0, exports.validate)({ body: schema });
exports.validateBody = validateBody;
const validateQuery = (schema) => (0, exports.validate)({ query: schema });
exports.validateQuery = validateQuery;
const validateParams = (schema) => (0, exports.validate)({ params: schema });
exports.validateParams = validateParams;
/**
 * Common Zod schemas used across the application.
 * Includes generic ID validation, authentication payloads, user creation /
 * update schemas, AI prompts, and pagination helpers.
 */
// Estandarizaci√≥n de esquemas comunes
exports.schemas = {
    common: {
        id: zod_1.z.object({
            id: zod_1.z.string().regex(/^(?:\d+|[0-9a-fA-F]{24})$/, 'Invalid ID format'),
        }),
    },
    auth: {
        register: zod_1.z.object({
            email: zod_1.z.string().email(),
            password: zod_1.z
                .string()
                .min(12)
                .regex(/^(?=.*[0-9])(?=.*[!@#$%^&*])/, 'Password must include number and special character'),
            name: zod_1.z.string().min(2),
        }),
        login: zod_1.z.object({
            email: zod_1.z.string().email(),
            password: zod_1.z
                .string()
                .min(12)
                .regex(/^(?=.*[0-9])(?=.*[!@#$%^&*])/, 'Password must include number and special character'),
        }),
        enable2FA: zod_1.z.object({
            userId: zod_1.z.string(), // Allow Mongo ID or UUID
        }),
        verify2FA: zod_1.z.object({
            userId: zod_1.z.string(),
            token: zod_1.z.string().min(6), // Allow longer for backup codes
        }),
    },
    user: {
        create: zod_1.z.object({
            name: zod_1.z.string().min(1),
            email: zod_1.z.string().email(),
            password: zod_1.z
                .string()
                .min(12)
                .regex(/^(?=.*[0-9])(?=.*[!@#$%^&*])/, 'Password must include number and special character')
                .optional(),
        }),
        update: zod_1.z.object({
            name: zod_1.z.string().min(1).optional(),
            email: zod_1.z.string().email().optional(),
            password: zod_1.z
                .string()
                .min(12)
                .regex(/^(?=.*[0-9])(?=.*[!@#$%^&*])/, 'Password must include number and special character')
                .optional(),
        }),
    },
    ai: {
        prompt: zod_1.z.object({
            prompt: zod_1.z.string().min(1),
        }),
        chat: zod_1.z.object({
            prompt: zod_1.z.string().min(1),
            history: zod_1.z
                .array(zod_1.z.object({
                role: zod_1.z.enum(['user', 'assistant', 'system']),
                content: zod_1.z.string().min(1),
            }))
                .optional(),
        }),
        sessionId: zod_1.z.string().optional(),
        userId: zod_1.z.string().optional(),
        text: zod_1.z.string().optional(),
        audio: zod_1.z.string().optional(),
    },
    pagination: zod_1.z.object({
        page: zod_1.z.string().regex(/^\d+$/).transform(Number).optional(),
        limit: zod_1.z.string().regex(/^\d+$/).transform(Number).optional(),
    }),
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxBbGVqYW5kcm9cXEFJR2VzdGlvblxcYmFja2VuZFxcc3JjXFxtaWRkbGV3YXJlXFx2YWxpZGF0aW9uLm1pZGRsZXdhcmUudHMiLCJtYXBwaW5ncyI6Ijs7O0FBUUEsNkJBQTJDO0FBUTNDOzs7R0FHRztBQUNIOzs7Ozs7OztHQVFHO0FBQ0ksTUFBTSxRQUFRLEdBQUcsQ0FBQyxNQUF3QixFQUFFLEVBQUU7SUFDbkQsT0FBTyxLQUFLLEVBQUUsR0FBWSxFQUFFLElBQWMsRUFBRSxJQUFrQixFQUFFLEVBQUU7UUFDaEUsT0FBTyxDQUFDLEdBQUcsQ0FBQywwQ0FBMEMsR0FBRyxDQUFDLE1BQU0sSUFBSSxHQUFHLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQztRQUN2RixJQUFJLENBQUM7WUFDSCxJQUFJLE1BQU0sQ0FBQyxJQUFJLEVBQUUsQ0FBQztnQkFDaEIsT0FBTyxDQUFDLEdBQUcsQ0FBQyw0QkFBNEIsQ0FBQyxDQUFDO2dCQUMxQyxHQUFHLENBQUMsSUFBSSxHQUFHLE1BQU0sTUFBTSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ3BELENBQUM7WUFDRCxJQUFJLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQztnQkFDakIsR0FBRyxDQUFDLEtBQUssR0FBRyxDQUFDLE1BQU0sTUFBTSxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFRLENBQUM7WUFDaEUsQ0FBQztZQUNELElBQUksTUFBTSxDQUFDLE1BQU0sRUFBRSxDQUFDO2dCQUNsQixHQUFHLENBQUMsTUFBTSxHQUFHLENBQUMsTUFBTSxNQUFNLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQVEsQ0FBQztZQUNuRSxDQUFDO1lBQ0QsT0FBTyxDQUFDLEdBQUcsQ0FBQywrQkFBK0IsQ0FBQyxDQUFDO1lBQzdDLElBQUksRUFBRSxDQUFDO1FBQ1QsQ0FBQztRQUFDLE9BQU8sS0FBVSxFQUFFLENBQUM7WUFDcEIsT0FBTyxDQUFDLEdBQUcsQ0FBQyw0QkFBNEIsRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDekQsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ2QsQ0FBQztJQUNILENBQUMsQ0FBQztBQUNKLENBQUMsQ0FBQztBQXJCVyxRQUFBLFFBQVEsWUFxQm5CO0FBRUY7O0dBRUc7QUFDSCxpREFBaUQ7QUFDMUMsTUFBTSxZQUFZLEdBQUcsQ0FBQyxNQUFvQixFQUFFLEVBQUUsQ0FBQyxJQUFBLGdCQUFRLEVBQUMsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLENBQUMsQ0FBQztBQUFwRSxRQUFBLFlBQVksZ0JBQXdEO0FBQzFFLE1BQU0sYUFBYSxHQUFHLENBQUMsTUFBb0IsRUFBRSxFQUFFLENBQUMsSUFBQSxnQkFBUSxFQUFDLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxDQUFDLENBQUM7QUFBdEUsUUFBQSxhQUFhLGlCQUF5RDtBQUM1RSxNQUFNLGNBQWMsR0FBRyxDQUFDLE1BQW9CLEVBQUUsRUFBRSxDQUFDLElBQUEsZ0JBQVEsRUFBQyxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsQ0FBQyxDQUFDO0FBQXhFLFFBQUEsY0FBYyxrQkFBMEQ7QUFFckY7Ozs7R0FJRztBQUNILHNDQUFzQztBQUN6QixRQUFBLE9BQU8sR0FBRztJQUNyQixNQUFNLEVBQUU7UUFDTixFQUFFLEVBQUUsT0FBQyxDQUFDLE1BQU0sQ0FBQztZQUNYLEVBQUUsRUFBRSxPQUFDLENBQUMsTUFBTSxFQUFFLENBQUMsS0FBSyxDQUFDLDJCQUEyQixFQUFFLG1CQUFtQixDQUFDO1NBQ3ZFLENBQUM7S0FDSDtJQUNELElBQUksRUFBRTtRQUNKLFFBQVEsRUFBRSxPQUFDLENBQUMsTUFBTSxDQUFDO1lBQ2pCLEtBQUssRUFBRSxPQUFDLENBQUMsTUFBTSxFQUFFLENBQUMsS0FBSyxFQUFFO1lBQ3pCLFFBQVEsRUFBRSxPQUFDO2lCQUNSLE1BQU0sRUFBRTtpQkFDUixHQUFHLENBQUMsRUFBRSxDQUFDO2lCQUNQLEtBQUssQ0FDSiw4QkFBOEIsRUFDOUIsb0RBQW9ELENBQ3JEO1lBQ0gsSUFBSSxFQUFFLE9BQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1NBQ3hCLENBQUM7UUFDRixLQUFLLEVBQUUsT0FBQyxDQUFDLE1BQU0sQ0FBQztZQUNkLEtBQUssRUFBRSxPQUFDLENBQUMsTUFBTSxFQUFFLENBQUMsS0FBSyxFQUFFO1lBQ3pCLFFBQVEsRUFBRSxPQUFDO2lCQUNSLE1BQU0sRUFBRTtpQkFDUixHQUFHLENBQUMsRUFBRSxDQUFDO2lCQUNQLEtBQUssQ0FDSiw4QkFBOEIsRUFDOUIsb0RBQW9ELENBQ3JEO1NBQ0osQ0FBQztRQUNGLFNBQVMsRUFBRSxPQUFDLENBQUMsTUFBTSxDQUFDO1lBQ2xCLE1BQU0sRUFBRSxPQUFDLENBQUMsTUFBTSxFQUFFLEVBQUUseUJBQXlCO1NBQzlDLENBQUM7UUFDRixTQUFTLEVBQUUsT0FBQyxDQUFDLE1BQU0sQ0FBQztZQUNsQixNQUFNLEVBQUUsT0FBQyxDQUFDLE1BQU0sRUFBRTtZQUNsQixLQUFLLEVBQUUsT0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxnQ0FBZ0M7U0FDM0QsQ0FBQztLQUNIO0lBQ0QsSUFBSSxFQUFFO1FBQ0osTUFBTSxFQUFFLE9BQUMsQ0FBQyxNQUFNLENBQUM7WUFDZixJQUFJLEVBQUUsT0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7WUFDdkIsS0FBSyxFQUFFLE9BQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxLQUFLLEVBQUU7WUFDekIsUUFBUSxFQUFFLE9BQUM7aUJBQ1IsTUFBTSxFQUFFO2lCQUNSLEdBQUcsQ0FBQyxFQUFFLENBQUM7aUJBQ1AsS0FBSyxDQUFDLDhCQUE4QixFQUFFLG9EQUFvRCxDQUFDO2lCQUMzRixRQUFRLEVBQUU7U0FDZCxDQUFDO1FBQ0YsTUFBTSxFQUFFLE9BQUMsQ0FBQyxNQUFNLENBQUM7WUFDZixJQUFJLEVBQUUsT0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLEVBQUU7WUFDbEMsS0FBSyxFQUFFLE9BQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxRQUFRLEVBQUU7WUFDcEMsUUFBUSxFQUFFLE9BQUM7aUJBQ1IsTUFBTSxFQUFFO2lCQUNSLEdBQUcsQ0FBQyxFQUFFLENBQUM7aUJBQ1AsS0FBSyxDQUFDLDhCQUE4QixFQUFFLG9EQUFvRCxDQUFDO2lCQUMzRixRQUFRLEVBQUU7U0FDZCxDQUFDO0tBQ0g7SUFDRCxFQUFFLEVBQUU7UUFDRixNQUFNLEVBQUUsT0FBQyxDQUFDLE1BQU0sQ0FBQztZQUNmLE1BQU0sRUFBRSxPQUFDLENBQUMsTUFBTSxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztTQUMxQixDQUFDO1FBQ0YsSUFBSSxFQUFFLE9BQUMsQ0FBQyxNQUFNLENBQUM7WUFDYixNQUFNLEVBQUUsT0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7WUFDekIsT0FBTyxFQUFFLE9BQUM7aUJBQ1AsS0FBSyxDQUNKLE9BQUMsQ0FBQyxNQUFNLENBQUM7Z0JBQ1AsSUFBSSxFQUFFLE9BQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxNQUFNLEVBQUUsV0FBVyxFQUFFLFFBQVEsQ0FBQyxDQUFDO2dCQUM3QyxPQUFPLEVBQUUsT0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7YUFDM0IsQ0FBQyxDQUNIO2lCQUNBLFFBQVEsRUFBRTtTQUNkLENBQUM7UUFDRixTQUFTLEVBQUUsT0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDLFFBQVEsRUFBRTtRQUNoQyxNQUFNLEVBQUUsT0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDLFFBQVEsRUFBRTtRQUM3QixJQUFJLEVBQUUsT0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDLFFBQVEsRUFBRTtRQUMzQixLQUFLLEVBQUUsT0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDLFFBQVEsRUFBRTtLQUM3QjtJQUNELFVBQVUsRUFBRSxPQUFDLENBQUMsTUFBTSxDQUFDO1FBQ25CLElBQUksRUFBRSxPQUFDLENBQUMsTUFBTSxFQUFFLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxRQUFRLEVBQUU7UUFDNUQsS0FBSyxFQUFFLE9BQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxDQUFDLFFBQVEsRUFBRTtLQUM5RCxDQUFDO0NBQ0gsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXEFsZWphbmRyb1xcQUlHZXN0aW9uXFxiYWNrZW5kXFxzcmNcXG1pZGRsZXdhcmVcXHZhbGlkYXRpb24ubWlkZGxld2FyZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFZhbGlkYXRpb24gTWlkZGxld2FyZSBNb2R1bGVcbiAqXG4gKiBQcm92aWRlcyBhIGZsZXhpYmxlIHZhbGlkYXRpb24gdXRpbGl0eSBiYXNlZCBvbiBab2Qgc2NoZW1hcyBmb3IgcmVxdWVzdFxuICogYm9kaWVzLCBxdWVyeSBzdHJpbmdzLCBhbmQgVVJMIHBhcmFtZXRlcnMuIEVycm9ycyBhcmUgZm9yd2FyZGVkIHRvIHRoZVxuICogZ2xvYmFsIGBlcnJvckhhbmRsZXJgIG1pZGRsZXdhcmUuXG4gKi9cbmltcG9ydCB0eXBlIHsgTmV4dEZ1bmN0aW9uLCBSZXF1ZXN0LCBSZXNwb25zZSB9IGZyb20gJ2V4cHJlc3MnO1xuaW1wb3J0IHsgeiwgdHlwZSBBbnlab2RPYmplY3QgfSBmcm9tICd6b2QnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFZhbGlkYXRpb25TY2hlbWEge1xuICBib2R5PzogQW55Wm9kT2JqZWN0O1xuICBxdWVyeT86IEFueVpvZE9iamVjdDtcbiAgcGFyYW1zPzogQW55Wm9kT2JqZWN0O1xufVxuXG4vKipcbiAqIEVuaGFuY2VkIHZhbGlkYXRpb24gbWlkZGxld2FyZSB0aGF0IHN1cHBvcnRzIHZhbGlkYXRpbmcgYm9keSwgcXVlcnksIGFuZCBwYXJhbXMuXG4gKiBUaHJvd3MgWm9kRXJyb3IgdG8gYmUgY2F1Z2h0IGJ5IHRoZSBnbG9iYWwgZXJyb3JIYW5kbGVyLlxuICovXG4vKipcbiAqIENyZWF0ZSBhIHZhbGlkYXRpb24gbWlkZGxld2FyZSBmb3IgRXhwcmVzcyByb3V0ZXMuXG4gKlxuICogVGhlIGBzY2hlbWFgIGFyZ3VtZW50IGNhbiBjb250YWluIFpvZCBvYmplY3RzIGZvciBgYm9keWAsIGBxdWVyeWAsIGFuZFxuICogYHBhcmFtc2AuIEVhY2ggcGFydCBpcyB2YWxpZGF0ZWQgYXN5bmNocm9ub3VzbHk7IG9uIHN1Y2Nlc3MgdGhlIHBhcnNlZFxuICogdmFsdWUgcmVwbGFjZXMgdGhlIG9yaWdpbmFsIHJlcXVlc3QgcHJvcGVydHkuIFZhbGlkYXRpb24gZXJyb3JzIGFyZSBwYXNzZWRcbiAqIHRvIGBuZXh0YCBzbyB0aGUgZ2xvYmFsIGVycm9yIGhhbmRsZXIgY2FuIGNvbnZlcnQgdGhlbSB0byBhIHByb3BlciBIVFRQXG4gKiByZXNwb25zZSAoZS5nLiwgNDAwIEJhZCBSZXF1ZXN0KS5cbiAqL1xuZXhwb3J0IGNvbnN0IHZhbGlkYXRlID0gKHNjaGVtYTogVmFsaWRhdGlvblNjaGVtYSkgPT4ge1xuICByZXR1cm4gYXN5bmMgKHJlcTogUmVxdWVzdCwgX3JlczogUmVzcG9uc2UsIG5leHQ6IE5leHRGdW5jdGlvbikgPT4ge1xuICAgIGNvbnNvbGUubG9nKGBbREVCVUddIHZhbGlkYXRlIG1pZGRsZXdhcmUgY2FsbGVkIGZvciAke3JlcS5tZXRob2R9ICR7cmVxLm9yaWdpbmFsVXJsfWApO1xuICAgIHRyeSB7XG4gICAgICBpZiAoc2NoZW1hLmJvZHkpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1tERUJVR10gVmFsaWRhdGluZyBib2R5Li4uJyk7XG4gICAgICAgIHJlcS5ib2R5ID0gYXdhaXQgc2NoZW1hLmJvZHkucGFyc2VBc3luYyhyZXEuYm9keSk7XG4gICAgICB9XG4gICAgICBpZiAoc2NoZW1hLnF1ZXJ5KSB7XG4gICAgICAgIHJlcS5xdWVyeSA9IChhd2FpdCBzY2hlbWEucXVlcnkucGFyc2VBc3luYyhyZXEucXVlcnkpKSBhcyBhbnk7XG4gICAgICB9XG4gICAgICBpZiAoc2NoZW1hLnBhcmFtcykge1xuICAgICAgICByZXEucGFyYW1zID0gKGF3YWl0IHNjaGVtYS5wYXJhbXMucGFyc2VBc3luYyhyZXEucGFyYW1zKSkgYXMgYW55O1xuICAgICAgfVxuICAgICAgY29uc29sZS5sb2coJ1tERUJVR10gVmFsaWRhdGlvbiBzdWNjZXNzZnVsJyk7XG4gICAgICBuZXh0KCk7XG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgY29uc29sZS5sb2coJ1tERUJVR10gVmFsaWRhdGlvbiBmYWlsZWQ6JywgZXJyb3IubWVzc2FnZSk7XG4gICAgICBuZXh0KGVycm9yKTtcbiAgICB9XG4gIH07XG59O1xuXG4vKipcbiAqIExlZ2FjeSB3cmFwcGVycyBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eSBpZiBuZWVkZWQsIG9yIHNwZWNpZmljIHVzZSBjYXNlcy5cbiAqL1xuLyoqIExlZ2FjeSB3cmFwcGVycyBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eSAqL1xuZXhwb3J0IGNvbnN0IHZhbGlkYXRlQm9keSA9IChzY2hlbWE6IEFueVpvZE9iamVjdCkgPT4gdmFsaWRhdGUoeyBib2R5OiBzY2hlbWEgfSk7XG5leHBvcnQgY29uc3QgdmFsaWRhdGVRdWVyeSA9IChzY2hlbWE6IEFueVpvZE9iamVjdCkgPT4gdmFsaWRhdGUoeyBxdWVyeTogc2NoZW1hIH0pO1xuZXhwb3J0IGNvbnN0IHZhbGlkYXRlUGFyYW1zID0gKHNjaGVtYTogQW55Wm9kT2JqZWN0KSA9PiB2YWxpZGF0ZSh7IHBhcmFtczogc2NoZW1hIH0pO1xuXG4vKipcbiAqIENvbW1vbiBab2Qgc2NoZW1hcyB1c2VkIGFjcm9zcyB0aGUgYXBwbGljYXRpb24uXG4gKiBJbmNsdWRlcyBnZW5lcmljIElEIHZhbGlkYXRpb24sIGF1dGhlbnRpY2F0aW9uIHBheWxvYWRzLCB1c2VyIGNyZWF0aW9uIC9cbiAqIHVwZGF0ZSBzY2hlbWFzLCBBSSBwcm9tcHRzLCBhbmQgcGFnaW5hdGlvbiBoZWxwZXJzLlxuICovXG4vLyBFc3RhbmRhcml6YWNpw7NuIGRlIGVzcXVlbWFzIGNvbXVuZXNcbmV4cG9ydCBjb25zdCBzY2hlbWFzID0ge1xuICBjb21tb246IHtcbiAgICBpZDogei5vYmplY3Qoe1xuICAgICAgaWQ6IHouc3RyaW5nKCkucmVnZXgoL14oPzpcXGQrfFswLTlhLWZBLUZdezI0fSkkLywgJ0ludmFsaWQgSUQgZm9ybWF0JyksXG4gICAgfSksXG4gIH0sXG4gIGF1dGg6IHtcbiAgICByZWdpc3Rlcjogei5vYmplY3Qoe1xuICAgICAgZW1haWw6IHouc3RyaW5nKCkuZW1haWwoKSxcbiAgICAgIHBhc3N3b3JkOiB6XG4gICAgICAgIC5zdHJpbmcoKVxuICAgICAgICAubWluKDEyKVxuICAgICAgICAucmVnZXgoXG4gICAgICAgICAgL14oPz0uKlswLTldKSg/PS4qWyFAIyQlXiYqXSkvLFxuICAgICAgICAgICdQYXNzd29yZCBtdXN0IGluY2x1ZGUgbnVtYmVyIGFuZCBzcGVjaWFsIGNoYXJhY3RlcicsXG4gICAgICAgICksXG4gICAgICBuYW1lOiB6LnN0cmluZygpLm1pbigyKSxcbiAgICB9KSxcbiAgICBsb2dpbjogei5vYmplY3Qoe1xuICAgICAgZW1haWw6IHouc3RyaW5nKCkuZW1haWwoKSxcbiAgICAgIHBhc3N3b3JkOiB6XG4gICAgICAgIC5zdHJpbmcoKVxuICAgICAgICAubWluKDEyKVxuICAgICAgICAucmVnZXgoXG4gICAgICAgICAgL14oPz0uKlswLTldKSg/PS4qWyFAIyQlXiYqXSkvLFxuICAgICAgICAgICdQYXNzd29yZCBtdXN0IGluY2x1ZGUgbnVtYmVyIGFuZCBzcGVjaWFsIGNoYXJhY3RlcicsXG4gICAgICAgICksXG4gICAgfSksXG4gICAgZW5hYmxlMkZBOiB6Lm9iamVjdCh7XG4gICAgICB1c2VySWQ6IHouc3RyaW5nKCksIC8vIEFsbG93IE1vbmdvIElEIG9yIFVVSURcbiAgICB9KSxcbiAgICB2ZXJpZnkyRkE6IHoub2JqZWN0KHtcbiAgICAgIHVzZXJJZDogei5zdHJpbmcoKSxcbiAgICAgIHRva2VuOiB6LnN0cmluZygpLm1pbig2KSwgLy8gQWxsb3cgbG9uZ2VyIGZvciBiYWNrdXAgY29kZXNcbiAgICB9KSxcbiAgfSxcbiAgdXNlcjoge1xuICAgIGNyZWF0ZTogei5vYmplY3Qoe1xuICAgICAgbmFtZTogei5zdHJpbmcoKS5taW4oMSksXG4gICAgICBlbWFpbDogei5zdHJpbmcoKS5lbWFpbCgpLFxuICAgICAgcGFzc3dvcmQ6IHpcbiAgICAgICAgLnN0cmluZygpXG4gICAgICAgIC5taW4oMTIpXG4gICAgICAgIC5yZWdleCgvXig/PS4qWzAtOV0pKD89LipbIUAjJCVeJipdKS8sICdQYXNzd29yZCBtdXN0IGluY2x1ZGUgbnVtYmVyIGFuZCBzcGVjaWFsIGNoYXJhY3RlcicpXG4gICAgICAgIC5vcHRpb25hbCgpLFxuICAgIH0pLFxuICAgIHVwZGF0ZTogei5vYmplY3Qoe1xuICAgICAgbmFtZTogei5zdHJpbmcoKS5taW4oMSkub3B0aW9uYWwoKSxcbiAgICAgIGVtYWlsOiB6LnN0cmluZygpLmVtYWlsKCkub3B0aW9uYWwoKSxcbiAgICAgIHBhc3N3b3JkOiB6XG4gICAgICAgIC5zdHJpbmcoKVxuICAgICAgICAubWluKDEyKVxuICAgICAgICAucmVnZXgoL14oPz0uKlswLTldKSg/PS4qWyFAIyQlXiYqXSkvLCAnUGFzc3dvcmQgbXVzdCBpbmNsdWRlIG51bWJlciBhbmQgc3BlY2lhbCBjaGFyYWN0ZXInKVxuICAgICAgICAub3B0aW9uYWwoKSxcbiAgICB9KSxcbiAgfSxcbiAgYWk6IHtcbiAgICBwcm9tcHQ6IHoub2JqZWN0KHtcbiAgICAgIHByb21wdDogei5zdHJpbmcoKS5taW4oMSksXG4gICAgfSksXG4gICAgY2hhdDogei5vYmplY3Qoe1xuICAgICAgcHJvbXB0OiB6LnN0cmluZygpLm1pbigxKSxcbiAgICAgIGhpc3Rvcnk6IHpcbiAgICAgICAgLmFycmF5KFxuICAgICAgICAgIHoub2JqZWN0KHtcbiAgICAgICAgICAgIHJvbGU6IHouZW51bShbJ3VzZXInLCAnYXNzaXN0YW50JywgJ3N5c3RlbSddKSxcbiAgICAgICAgICAgIGNvbnRlbnQ6IHouc3RyaW5nKCkubWluKDEpLFxuICAgICAgICAgIH0pLFxuICAgICAgICApXG4gICAgICAgIC5vcHRpb25hbCgpLFxuICAgIH0pLFxuICAgIHNlc3Npb25JZDogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICAgIHVzZXJJZDogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICAgIHRleHQ6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgICBhdWRpbzogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICB9LFxuICBwYWdpbmF0aW9uOiB6Lm9iamVjdCh7XG4gICAgcGFnZTogei5zdHJpbmcoKS5yZWdleCgvXlxcZCskLykudHJhbnNmb3JtKE51bWJlcikub3B0aW9uYWwoKSxcbiAgICBsaW1pdDogei5zdHJpbmcoKS5yZWdleCgvXlxcZCskLykudHJhbnNmb3JtKE51bWJlcikub3B0aW9uYWwoKSxcbiAgfSksXG59O1xuXG5leHBvcnQgdHlwZSBSZWdpc3RlckR0byA9IHouaW5mZXI8dHlwZW9mIHNjaGVtYXMuYXV0aC5yZWdpc3Rlcj47XG5leHBvcnQgdHlwZSBMb2dpbkR0byA9IHouaW5mZXI8dHlwZW9mIHNjaGVtYXMuYXV0aC5sb2dpbj47XG5leHBvcnQgdHlwZSBDcmVhdGVVc2VyRHRvID0gei5pbmZlcjx0eXBlb2Ygc2NoZW1hcy51c2VyLmNyZWF0ZT47XG5leHBvcnQgdHlwZSBVcGRhdGVVc2VyRHRvID0gei5pbmZlcjx0eXBlb2Ygc2NoZW1hcy51c2VyLnVwZGF0ZT47XG5leHBvcnQgdHlwZSBBSVByb21wdER0byA9IHouaW5mZXI8dHlwZW9mIHNjaGVtYXMuYWkucHJvbXB0PjtcbmV4cG9ydCB0eXBlIEFJQ2hhdER0byA9IHouaW5mZXI8dHlwZW9mIHNjaGVtYXMuYWkuY2hhdD47XG4iXSwidmVyc2lvbiI6M30=