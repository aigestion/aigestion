{"file":"C:\\Users\\Alejandro\\AIGestion\\backend\\src\\services\\security-dashboard.service.ts","mappings":";;;;;;;;;;;;AAAA,yCAAuC;AAEvC,0CAAgD;AAChD,4CAAyC;AAEzC,+EAGuC;AAEvC,iEAA8D;AAC9D,qDAAiD;AAIjD,mEAA8D;AA0FvD,IAAM,wBAAwB,GAA9B,MAAM,wBAAwB;IAClB,KAAK,CAAkB;IACvB,UAAU,CAAa;IACvB,cAAc,CAAwB;IACtC,gBAAgB,CAAmB;IACnC,kBAAkB,CAA4B;IAC9C,eAAe,CAAsB;IACrC,cAAc,CAA4B;IAC1C,iBAAiB,CAAoB;IACrC,aAAa,CAAuB;IAErD;QACE,IAAI,CAAC,KAAK,GAAG,IAAA,sBAAc,GAAE,CAAC;QAE9B,8DAA8D;QAC9D,IAAI,CAAC,UAAU,GAAG,4BAAS,CAAC,GAAG,CAAa,wBAAK,CAAC,UAAU,CAAC,CAAC;QAC9D,IAAI,CAAC,cAAc,GAAG,4BAAS,CAAC,GAAG,CAAwB,wBAAK,CAAC,qBAAqB,CAAC,CAAC;QACxF,IAAI,CAAC,gBAAgB,GAAG,4BAAS,CAAC,GAAG,CAAmB,wBAAK,CAAC,gBAAgB,CAAC,CAAC;QAChF,IAAI,CAAC,kBAAkB,GAAG,4BAAS,CAAC,GAAG,CACrC,wBAAK,CAAC,yBAAyB,CAChC,CAAC;QACF,IAAI,CAAC,eAAe,GAAG,4BAAS,CAAC,GAAG,CAAsB,2CAAmB,CAAC,CAAC;QAC/E,IAAI,CAAC,cAAc,GAAG,4BAAS,CAAC,GAAG,CAA4B,0DAA4B,CAAC,CAAC;QAC7F,IAAI,CAAC,iBAAiB,GAAG,4BAAS,CAAC,GAAG,CAAoB,wBAAK,CAAC,iBAAiB,CAAC,CAAC;QACnF,IAAI,CAAC,aAAa,GAAG,4BAAS,CAAC,GAAG,CAAuB,wBAAK,CAAC,oBAAoB,CAAC,CAAC;IACvF,CAAC;IAED;;OAEG;IACI,KAAK,CAAC,gBAAgB;QAC3B,IAAI,CAAC;YACH,MAAM,CAAC,QAAQ,EAAE,GAAG,EAAE,OAAO,EAAE,SAAS,EAAE,WAAW,EAAE,QAAQ,EAAE,IAAI,EAAE,UAAU,CAAC,GAChF,MAAM,OAAO,CAAC,GAAG,CAAC;gBAChB,IAAI,CAAC,eAAe,EAAE;gBACtB,IAAI,CAAC,UAAU,EAAE;gBACjB,IAAI,CAAC,cAAc,EAAE;gBACrB,IAAI,CAAC,gBAAgB,EAAE;gBACvB,IAAI,CAAC,kBAAkB,EAAE;gBACzB,IAAI,CAAC,eAAe,EAAE;gBACtB,IAAI,CAAC,UAAU,EAAE;gBACjB,IAAI,CAAC,iBAAiB,EAAE;aACzB,CAAC,CAAC;YAEL,MAAM,UAAU,GAAG,MAAM,IAAI,CAAC,aAAa,CAAC,QAAQ,EAAE,CAAC;YAEvD,OAAO;gBACL,QAAQ;gBACR,GAAG;gBACH,OAAO;gBACP,SAAS;gBACT,WAAW;gBACX,QAAQ;gBACR,IAAI;gBACJ,UAAU;gBACV,MAAM,EAAE;oBACN,KAAK,EAAE,UAAU;oBACjB,UAAU,EAAE,UAAU,CAAC,aAAa;iBACrC;aACF,CAAC;QACJ,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YACf,eAAM,CAAC,KAAK,CAAC,+BAA+B,EAAE,KAAK,CAAC,CAAC;YACrD,OAAO,IAAI,CAAC,uBAAuB,EAAE,CAAC;QACxC,CAAC;IACH,CAAC;IAED;;OAEG;IACK,KAAK,CAAC,eAAe;QAO3B,IAAI,CAAC;YACH,MAAM,aAAa,GAAG,4BAAS,CAAC,GAAG,CAAgB,8BAAa,CAAC,CAAC;YAClE,MAAM,MAAM,GAAG,MAAM,aAAa,CAAC,iBAAiB,EAAE,CAAC;YAEvD,MAAM,aAAa,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,QAAQ,EAAE,CAAC;YAC5D,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,kBAAkB,CAAC,eAAe,CAAC,EAAE,CAAC,CAAC;YACvE,MAAM,eAAe,GAAG,YAAY,CAAC,MAAM,CAAC,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,KAAK,UAAU,CAAC,CAAC,MAAM,CAAC;YAE3F,IAAI,YAAY,GAAuC,SAAS,CAAC;YACjE,IAAI,MAAM,CAAC,MAAM,KAAK,UAAU,IAAI,aAAa,CAAC,aAAa,GAAG,CAAC,IAAI,eAAe,GAAG,CAAC,EAAE,CAAC;gBAC3F,YAAY,GAAG,UAAU,CAAC;YAC5B,CAAC;iBAAM,IAAI,aAAa,CAAC,aAAa,GAAG,CAAC,IAAI,eAAe,GAAG,CAAC,EAAE,CAAC;gBAClE,YAAY,GAAG,SAAS,CAAC;YAC3B,CAAC;YAED,OAAO;gBACL,YAAY;gBACZ,WAAW,EAAE,aAAa,CAAC,cAAc,GAAG,YAAY,CAAC,MAAM;gBAC/D,cAAc,EAAE,eAAe;gBAC/B,aAAa,EAAE,YAAY,CAAC,MAAM;gBAClC,QAAQ,EAAE,IAAI,IAAI,EAAE;aACrB,CAAC;QACJ,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YACf,eAAM,CAAC,KAAK,CAAC,8BAA8B,EAAE,KAAK,CAAC,CAAC;YACpD,OAAO;gBACL,YAAY,EAAE,SAAS;gBACvB,WAAW,EAAE,CAAC;gBACd,cAAc,EAAE,CAAC;gBACjB,aAAa,EAAE,CAAC;gBAChB,QAAQ,EAAE,IAAI,IAAI,EAAE;aACrB,CAAC;QACJ,CAAC;IACH,CAAC;IAED;;OAEG;IACK,KAAK,CAAC,UAAU;QAUtB,IAAI,CAAC;YACH,MAAM,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,UAAU,EAAE,CAAC;YAC3C,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,kBAAkB,CAAC,eAAe,CAAC,EAAE,CAAC,CAAC;YACvE,MAAM,YAAY,GAAG,YAAY,CAAC,MAAM,CAAC,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,MAAM,KAAK,OAAO,CAAC,CAAC,MAAM,CAAC;YAEnF,MAAM,UAAU,GAAG,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,UAAU,CAAC;iBAChD,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE,MAAM,CAAgB,EAAE,EAAE,CAAC,CAAC;gBACpC,IAAI,EAAE,MAAM,CAAC,IAAI;gBACjB,KAAK,EAAE,MAAM,CAAC,KAAK;gBACnB,QAAQ,EAAE,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,IAAI,CAAC;aAC5C,CAAC,CAAC;iBACF,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC,KAAK,CAAC;iBACjC,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;YAEhB,OAAO;gBACL,KAAK;gBACL,YAAY;gBACZ,UAAU;gBACV,UAAU,EAAE,EAAE,EAAE,mCAAmC;aACpD,CAAC;QACJ,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YACf,eAAM,CAAC,KAAK,CAAC,yBAAyB,EAAE,KAAK,CAAC,CAAC;YAC/C,OAAO;gBACL,KAAK,EAAE,EAAE,aAAa,EAAE,CAAC,EAAE,eAAe,EAAE,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE,cAAc,EAAE,EAAE,EAAE;gBAChF,YAAY,EAAE,CAAC;gBACf,UAAU,EAAE,EAAE;gBACd,UAAU,EAAE,EAAE;aACf,CAAC;QACJ,CAAC;IACH,CAAC;IAED;;OAEG;IACK,KAAK,CAAC,cAAc;QAS1B,IAAI,CAAC;YACH,MAAM,KAAK,GAAG,IAAI,CAAC,cAAc,CAAC,YAAY,EAAE,CAAC;YACjD,MAAM,gBAAgB,GAAG,MAAM,IAAI,CAAC,cAAc,CAAC,mBAAmB,EAAE,CAAC;YAEzE,MAAM,gBAAgB,GAAG,gBAAgB;iBACtC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,aAAa,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC,aAAa,CAAC,OAAO,EAAE,CAAC;iBACrE,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC;iBACZ,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;gBACZ,IAAI,EAAE,IAAI,CAAC,YAAY;gBACvB,MAAM,EAAE,IAAI,CAAC,MAAM;gBACnB,SAAS,EAAE,IAAI,CAAC,aAAa;aAC9B,CAAC,CAAC,CAAC;YAEN,OAAO;gBACL,KAAK;gBACL,gBAAgB,EAAE,gBAAgB,CAAC,MAAM;gBACzC,gBAAgB;aACjB,CAAC;QACJ,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YACf,eAAM,CAAC,KAAK,CAAC,6BAA6B,EAAE,KAAK,CAAC,CAAC;YACnD,OAAO;gBACL,KAAK,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,aAAa,EAAE,CAAC,EAAE,gBAAgB,EAAE,CAAC,EAAE,eAAe,EAAE,CAAC,EAAE;gBACnF,gBAAgB,EAAE,CAAC;gBACnB,gBAAgB,EAAE,EAAE;aACrB,CAAC;QACJ,CAAC;IACH,CAAC;IAED;;OAEG;IACK,KAAK,CAAC,gBAAgB;QAK5B,IAAI,CAAC;YACH,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,gBAAgB,CAAC,QAAQ,EAAE,CAAC;YAErD,OAAO;gBACL,KAAK;gBACL,YAAY,EAAE,KAAK,CAAC,YAAY;gBAChC,mBAAmB,EAAE,KAAK,CAAC,mBAAmB;aAC/C,CAAC;QACJ,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YACf,eAAM,CAAC,KAAK,CAAC,yBAAyB,EAAE,KAAK,CAAC,CAAC;YAC/C,OAAO;gBACL,KAAK,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,CAAC,EAAE,kBAAkB,EAAE,EAAE,EAAE,mBAAmB,EAAE,CAAC,EAAE;gBACzF,YAAY,EAAE,CAAC;gBACf,mBAAmB,EAAE,CAAC;aACvB,CAAC;QACJ,CAAC;IACH,CAAC;IAED;;OAEG;IACK,KAAK,CAAC,kBAAkB;QAS9B,IAAI,CAAC;YACH,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,kBAAkB,CAAC,QAAQ,EAAE,CAAC;YACvD,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,kBAAkB,CAAC,eAAe,CAAC,EAAE,CAAC,CAAC;YAEvE,OAAO;gBACL,KAAK;gBACL,YAAY,EAAE,YAAY,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC;oBACvC,IAAI,EAAE,KAAK,CAAC,IAAI;oBAChB,QAAQ,EAAE,KAAK,CAAC,QAAQ;oBACxB,SAAS,EAAE,KAAK,CAAC,SAAS;oBAC1B,SAAS,EAAE,KAAK,CAAC,SAAS;iBAC3B,CAAC,CAAC;aACJ,CAAC;QACJ,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YACf,eAAM,CAAC,KAAK,CAAC,kCAAkC,EAAE,KAAK,CAAC,CAAC;YACxD,OAAO;gBACL,KAAK,EAAE;oBACL,UAAU,EAAE,CAAC;oBACb,WAAW,EAAE,CAAC;oBACd,WAAW,EAAE,CAAC;oBACd,gBAAgB,EAAE,EAAE;oBACpB,YAAY,EAAE,EAAE;oBAChB,YAAY,EAAE,CAAC;iBAChB;gBACD,YAAY,EAAE,EAAE;aACjB,CAAC;QACJ,CAAC;IACH,CAAC;IAED;;OAEG;IACK,KAAK,CAAC,eAAe;QAU3B,IAAI,CAAC;YACH,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,QAAQ,EAAE,CAAC;YACpD,MAAM,eAAe,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,kBAAkB,CAAC,EAAE,CAAC,CAAC;YAE1E,OAAO;gBACL,KAAK;gBACL,aAAa,EAAE,KAAK,CAAC,aAAa;gBAClC,eAAe,EAAE,eAAe,CAAC,GAAG,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;oBAC/C,MAAM,EAAE,OAAO,CAAC,MAAM;oBACtB,IAAI,EAAE,OAAO,CAAC,IAAI;oBAClB,QAAQ,EAAE,OAAO,CAAC,QAAQ;oBAC1B,SAAS,EAAE,OAAO,CAAC,UAAU;iBAC9B,CAAC,CAAC;aACJ,CAAC;QACJ,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YACf,eAAM,CAAC,KAAK,CAAC,8BAA8B,EAAE,KAAK,CAAC,CAAC;YACpD,OAAO;gBACL,KAAK,EAAE;oBACL,aAAa,EAAE,CAAC;oBAChB,YAAY,EAAE,CAAC;oBACf,eAAe,EAAE,EAAE;oBACnB,mBAAmB,EAAE,EAAE;oBACvB,gBAAgB,EAAE,CAAC;oBACnB,aAAa,EAAE,CAAC;iBACjB;gBACD,aAAa,EAAE,CAAC;gBAChB,eAAe,EAAE,EAAE;aACpB,CAAC;QACJ,CAAC;IACH,CAAC;IAED;;OAEG;IACK,KAAK,CAAC,UAAU;QActB,IAAI,CAAC;YACH,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;YACzD,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,cAAc,CAAC,eAAe,CAAC,EAAE,CAAC,CAAC;YACnE,MAAM,cAAc,GAAG,YAAY,CAAC,MAAM,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,KAAK,KAAK,UAAU,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;YAEzF,OAAO;gBACL,KAAK;gBACL,YAAY,EAAE,YAAY,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;oBACrC,SAAS,EAAE,GAAG,CAAC,SAAS;oBACxB,KAAK,EAAE,GAAG,CAAC,KAAK;oBAChB,OAAO,EAAE,GAAG,CAAC,OAAO;oBACpB,OAAO,EAAE,GAAG,CAAC,OAAO;iBACrB,CAAC,CAAC;gBACH,cAAc,EAAE,cAAc,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;oBACzC,SAAS,EAAE,GAAG,CAAC,SAAS;oBACxB,OAAO,EAAE,GAAG,CAAC,OAAO;oBACpB,OAAO,EAAE,GAAG,CAAC,OAAO;iBACrB,CAAC,CAAC;aACJ,CAAC;QACJ,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YACf,eAAM,CAAC,KAAK,CAAC,yBAAyB,EAAE,KAAK,CAAC,CAAC;YAC/C,OAAO;gBACL,KAAK,EAAE;oBACL,SAAS,EAAE,CAAC;oBACZ,WAAW,EAAE,EAAE;oBACf,aAAa,EAAE,EAAE;oBACjB,SAAS,EAAE,CAAC;oBACZ,mBAAmB,EAAE,CAAC;iBACvB;gBACD,YAAY,EAAE,EAAE;gBAChB,cAAc,EAAE,EAAE;aACnB,CAAC;QACJ,CAAC;IACH,CAAC;IAED;;OAEG;IACK,KAAK,CAAC,iBAAiB;QAS7B,IAAI,CAAC;YACH,MAAM,WAAW,GAAG,MAAM,IAAI,CAAC,iBAAiB,CAAC,qBAAqB,CAAC,MAAM,CAAC,CAAC;YAC/E,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,iBAAiB,CAAC,eAAe,CAAC,EAAE,CAAC,CAAC;YAEhE,OAAO;gBACL,WAAW;gBACX,MAAM,EAAE,MAAM,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC;oBAC3B,IAAI,EAAE,KAAK,CAAC,IAAI;oBAChB,QAAQ,EAAE,KAAK,CAAC,QAAQ;oBACxB,OAAO,EAAE,KAAK,CAAC,OAAO;oBACtB,SAAS,EAAE,KAAK,CAAC,SAAS;iBAC3B,CAAC,CAAC;aACJ,CAAC;QACJ,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YACf,eAAM,CAAC,KAAK,CAAC,gCAAgC,EAAE,KAAK,CAAC,CAAC;YACtD,OAAO;gBACL,WAAW,EAAE,IAAI,CAAC,4BAA4B,EAAE;gBAChD,MAAM,EAAE,EAAE;aACX,CAAC;QACJ,CAAC;IACH,CAAC;IAED;;OAEG;IACK,eAAe,CAAC,QAAgB;QACtC,MAAM,WAAW,GAA8B;YAC7C,aAAa,EAAE,UAAU;YACzB,UAAU,EAAE,UAAU;YACtB,iBAAiB,EAAE,UAAU;YAC7B,cAAc,EAAE,MAAM;YACtB,WAAW,EAAE,MAAM;YACnB,cAAc,EAAE,MAAM;YACtB,eAAe,EAAE,QAAQ;YACzB,gBAAgB,EAAE,QAAQ;YAC1B,mBAAmB,EAAE,KAAK;SAC3B,CAAC;QAEF,OAAO,WAAW,CAAC,QAAQ,CAAC,IAAI,QAAQ,CAAC;IAC3C,CAAC;IAED;;OAEG;IACK,4BAA4B;QAClC,OAAO;YACL,YAAY,EAAE,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE;YAChE,UAAU,EAAE,EAAE,iBAAiB,EAAE,CAAC,EAAE,iBAAiB,EAAE,CAAC,EAAE,eAAe,EAAE,CAAC,EAAE;YAC9E,SAAS,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,UAAU,EAAE,CAAC,EAAE,QAAQ,EAAE,EAAE,EAAE;YACpD,aAAa,EAAE,EAAE,GAAG,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,OAAO,EAAE,EAAE,OAAO,EAAE,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE,EAAE;YACnF,QAAQ,EAAE,EAAE,WAAW,EAAE,CAAC,EAAE,SAAS,EAAE,EAAE,GAAG,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,EAAE,YAAY,EAAE,CAAC,EAAE;SAC9E,CAAC;IACJ,CAAC;IAED;;OAEG;IACK,uBAAuB;QAC7B,OAAO;YACL,QAAQ,EAAE;gBACR,YAAY,EAAE,SAAS;gBACvB,WAAW,EAAE,CAAC;gBACd,cAAc,EAAE,CAAC;gBACjB,aAAa,EAAE,CAAC;gBAChB,QAAQ,EAAE,IAAI,IAAI,EAAE;aACrB;YACD,GAAG,EAAE;gBACH,KAAK,EAAE,EAAE,aAAa,EAAE,CAAC,EAAE,eAAe,EAAE,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE,cAAc,EAAE,EAAE,EAAE;gBAChF,YAAY,EAAE,CAAC;gBACf,UAAU,EAAE,EAAE;gBACd,UAAU,EAAE,EAAE;aACf;YACD,OAAO,EAAE;gBACP,KAAK,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,aAAa,EAAE,CAAC,EAAE,gBAAgB,EAAE,CAAC,EAAE,eAAe,EAAE,CAAC,EAAE;gBACnF,gBAAgB,EAAE,CAAC;gBACnB,gBAAgB,EAAE,EAAE;aACrB;YACD,SAAS,EAAE;gBACT,KAAK,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,CAAC,EAAE,kBAAkB,EAAE,EAAE,EAAE,mBAAmB,EAAE,CAAC,EAAE;gBACzF,YAAY,EAAE,CAAC;gBACf,mBAAmB,EAAE,CAAC;aACvB;YACD,WAAW,EAAE;gBACX,KAAK,EAAE;oBACL,UAAU,EAAE,CAAC;oBACb,WAAW,EAAE,CAAC;oBACd,WAAW,EAAE,CAAC;oBACd,gBAAgB,EAAE,EAAE;oBACpB,YAAY,EAAE,EAAE;oBAChB,YAAY,EAAE,CAAC;iBAChB;gBACD,YAAY,EAAE,EAAE;aACjB;YACD,QAAQ,EAAE;gBACR,KAAK,EAAE;oBACL,aAAa,EAAE,CAAC;oBAChB,YAAY,EAAE,CAAC;oBACf,eAAe,EAAE,EAAE;oBACnB,mBAAmB,EAAE,EAAE;oBACvB,gBAAgB,EAAE,CAAC;oBACnB,aAAa,EAAE,CAAC;iBACjB;gBACD,aAAa,EAAE,CAAC;gBAChB,eAAe,EAAE,EAAE;aACpB;YACD,IAAI,EAAE;gBACJ,KAAK,EAAE;oBACL,SAAS,EAAE,CAAC;oBACZ,WAAW,EAAE,EAAE;oBACf,aAAa,EAAE,EAAE;oBACjB,SAAS,EAAE,CAAC;oBACZ,mBAAmB,EAAE,CAAC;iBACvB;gBACD,YAAY,EAAE,EAAE;gBAChB,cAAc,EAAE,EAAE;aACnB;YACD,UAAU,EAAE;gBACV,WAAW,EAAE,IAAI,CAAC,4BAA4B,EAAE;gBAChD,MAAM,EAAE,EAAE;aACX;YACD,MAAM,EAAE;gBACN,KAAK,EAAE;oBACL,YAAY,EAAE,CAAC;oBACf,iBAAiB,EAAE,CAAC;oBACpB,aAAa,EAAE,CAAC;oBAChB,SAAS,EAAE,CAAC;oBACZ,WAAW,EAAE,CAAC;oBACd,aAAa,EAAE,EAAE;oBACjB,aAAa,EAAE,EAAE;iBAClB;gBACD,UAAU,EAAE,EAAE;aACf;SACF,CAAC;IACJ,CAAC;IAED;;OAEG;IACI,KAAK,CAAC,kBAAkB;QAY7B,IAAI,CAAC;YACH,MAAM,WAAW,GAAG,MAAM,IAAI,CAAC,iBAAiB,CAAC,qBAAqB,CAAC,QAAQ,CAAC,CAAC;YACjF,MAAM,QAAQ,GAAG,IAAI,CAAC,UAAU,CAAC,UAAU,EAAE,CAAC;YAC9C,MAAM,YAAY,GAAG,IAAI,CAAC,cAAc,CAAC,YAAY,EAAE,CAAC;YAExD,OAAO;gBACL,SAAS,EAAE,IAAI,IAAI,EAAE;gBACrB,cAAc,EAAE,QAAQ,CAAC,eAAe;gBACxC,cAAc,EAAE,YAAY,CAAC,UAAU;gBACvC,sBAAsB,EAAE,CAAC,EAAE,gCAAgC;gBAC3D,cAAc,EAAE,CAAC,EAAE,mCAAmC;gBACtD,UAAU,EAAE,WAAW,CAAC,aAAa;aACtC,CAAC;QACJ,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YACf,eAAM,CAAC,KAAK,CAAC,kCAAkC,EAAE,KAAK,CAAC,CAAC;YACxD,OAAO;gBACL,SAAS,EAAE,IAAI,IAAI,EAAE;gBACrB,cAAc,EAAE,CAAC;gBACjB,cAAc,EAAE,CAAC;gBACjB,sBAAsB,EAAE,CAAC;gBACzB,cAAc,EAAE,CAAC;gBACjB,UAAU,EAAE,EAAE,GAAG,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE;aAC3C,CAAC;QACJ,CAAC;IACH,CAAC;IAED;;OAEG;IACI,KAAK,CAAC,oBAAoB,CAAC,QAAgB,EAAE;QAalD,IAAI,CAAC;YACH,0DAA0D;YAC1D,6CAA6C;YAC7C,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,kBAAkB,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC;YACrE,MAAM,SAAS,GAAG,IAAI,CAAC,UAAU,CAAC,UAAU,EAAE,CAAC;YAC/C,MAAM,iBAAiB,GAAG,MAAM,IAAI,CAAC,cAAc,CAAC,mBAAmB,EAAE,CAAC;YAE1E,MAAM,SAAS,GAAG;gBAChB,GAAG,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACxB,EAAE,EAAE,MAAM,CAAC,EAAE;oBACb,IAAI,EAAE,iBAAiB;oBACvB,QAAQ,EAAE,MAAM,CAAC,QAAQ;oBACzB,KAAK,EAAE,oBAAoB,MAAM,CAAC,IAAI,EAAE;oBACxC,WAAW,EAAE,MAAM,CAAC,WAAW;oBAC/B,SAAS,EAAE,MAAM,CAAC,SAAS;oBAC3B,MAAM,EAAE,MAAe;oBACvB,IAAI,EAAE,CAAC,MAAM,CAAC,IAAI,EAAE,MAAM,CAAC,QAAQ,CAAC;iBACrC,CAAC,CAAC;gBACH,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,IAAI,CAAC,GAAG,CAAC,EAAE,EAAE,SAAS,CAAC,eAAe,CAAC,EAAE,EAAE,CAAC,CAAC,EAAE,KAAK,EAAE,EAAE,CAAC,CAAC;oBAChF,EAAE,EAAE,aAAa,KAAK,EAAE;oBACxB,IAAI,EAAE,WAAW;oBACjB,QAAQ,EAAE,QAAiB;oBAC3B,KAAK,EAAE,WAAW;oBAClB,WAAW,EAAE,2BAA2B,SAAS,CAAC,UAAU,CAAC,KAAK,CAAC,EAAE,IAAI,IAAI,SAAS,EAAE;oBACxF,SAAS,EAAE,IAAI,IAAI,EAAE;oBACrB,MAAM,EAAE,UAAmB;oBAC3B,IAAI,EAAE,CAAC,KAAK,EAAE,UAAU,CAAC;iBAC1B,CAAC,CAAC;gBACH,GAAG,iBAAiB,CAAC,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,KAAK,EAAE,EAAE,CAAC,CAAC;oBACtD,EAAE,EAAE,WAAW,KAAK,EAAE;oBACtB,IAAI,EAAE,kBAAkB;oBACxB,QAAQ,EAAE,MAAe;oBACzB,KAAK,EAAE,kBAAkB;oBACzB,WAAW,EAAE,qBAAqB,IAAI,CAAC,YAAY,EAAE;oBACrD,SAAS,EAAE,IAAI,CAAC,aAAa;oBAC7B,MAAM,EAAE,MAAe;oBACvB,IAAI,EAAE,CAAC,SAAS,EAAE,UAAU,CAAC;iBAC9B,CAAC,CAAC;aACJ;iBACE,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,SAAS,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC,SAAS,CAAC,OAAO,EAAE,CAAC;iBAC7D,KAAK,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC;YAEnB,OAAO,SAAS,CAAC;QACnB,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YACf,eAAM,CAAC,KAAK,CAAC,mCAAmC,EAAE,KAAK,CAAC,CAAC;YACzD,OAAO,EAAE,CAAC;QACZ,CAAC;IACH,CAAC;IAED;;OAEG;IACI,KAAK,CAAC,gBAAgB;QAW3B,IAAI,CAAC;YACH,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,eAAe,EAAE,CAAC;YAC9C,MAAM,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,UAAU,EAAE,CAAC,CAAC,wBAAwB;YACzE,MAAM,YAAY,GAAG,IAAI,CAAC,cAAc,CAAC,YAAY,EAAE,CAAC;YACxD,MAAM,cAAc,GAAG,MAAM,IAAI,CAAC,gBAAgB,CAAC,QAAQ,EAAE,CAAC;YAC9D,MAAM,kBAAkB,GAAG,IAAI,CAAC,iBAAiB,CAAC,kBAAkB,EAAE,CAAC;YACvE,MAAM,WAAW,GAAG,MAAM,IAAI,CAAC,aAAa,CAAC,QAAQ,EAAE,CAAC;YAExD,qCAAqC;YACrC,MAAM,QAAQ,GAAG,IAAI,CAAC,sBAAsB,CAAC,UAAU,CAAC,CAAC,CAAC,0BAA0B;YACpF,MAAM,YAAY,GAAG,IAAI,CAAC,sBAAsB,CAAC,YAAY,CAAC,CAAC;YAC/D,MAAM,SAAS,GAAG,IAAI,CAAC,sBAAsB,CAAC,cAAc,CAAC,CAAC;YAC9D,MAAM,eAAe,GAAG,IAAI,CAAC,sBAAsB,CAAC,kBAAkB,CAAC,CAAC;YACxE,MAAM,WAAW,GAAG,IAAI,CAAC,sBAAsB,CAAC,WAAW,CAAC,CAAC;YAE7D,MAAM,OAAO,GAAG,IAAI,CAAC,KAAK,CACxB,CAAC,QAAQ,GAAG,YAAY,GAAG,SAAS,GAAG,eAAe,GAAG,WAAW,CAAC,GAAG,CAAC,CAC1E,CAAC;YAEF,MAAM,eAAe,GAAG,IAAI,CAAC,uBAAuB,CAAC;gBACnD,GAAG,EAAE,QAAQ;gBACb,OAAO,EAAE,YAAY;gBACrB,IAAI,EAAE,SAAS;gBACf,UAAU,EAAE,eAAe;gBAC3B,MAAM,EAAE,WAAW;aACpB,CAAC,CAAC;YAEH,OAAO;gBACL,OAAO;gBACP,UAAU,EAAE;oBACV,GAAG,EAAE,QAAQ;oBACb,OAAO,EAAE,YAAY;oBACrB,cAAc,EAAE,SAAS;oBACzB,UAAU,EAAE,eAAe;oBAC3B,MAAM,EAAE,WAAW;iBACpB;gBACD,eAAe;aAChB,CAAC;QACJ,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YACf,eAAM,CAAC,KAAK,CAAC,+BAA+B,EAAE,KAAK,CAAC,CAAC;YACrD,OAAO;gBACL,OAAO,EAAE,CAAC;gBACV,UAAU,EAAE;oBACV,GAAG,EAAE,CAAC;oBACN,OAAO,EAAE,CAAC;oBACV,cAAc,EAAE,CAAC;oBACjB,UAAU,EAAE,CAAC;oBACb,MAAM,EAAE,CAAC;iBACV;gBACD,eAAe,EAAE,EAAE;aACpB,CAAC;QACJ,CAAC;IACH,CAAC;IAED;;OAEG;IACK,sBAAsB,CAAC,KAAU;QACvC,uEAAuE;QACvE,IAAI,KAAK,GAAG,EAAE,CAAC,CAAC,aAAa;QAE7B,IAAI,KAAK,CAAC,aAAa,GAAG,CAAC,EAAE,CAAC;YAC5B,MAAM,SAAS,GAAG,KAAK,CAAC,eAAe,GAAG,KAAK,CAAC,aAAa,CAAC;YAC9D,IAAI,SAAS,GAAG,IAAI;gBAAE,KAAK,IAAI,EAAE,CAAC;YAClC,IAAI,SAAS,GAAG,GAAG;gBAAE,KAAK,IAAI,EAAE,CAAC;QACnC,CAAC;QAED,IAAI,KAAK,CAAC,YAAY,GAAG,CAAC,EAAE,CAAC;YAC3B,KAAK,IAAI,EAAE,CAAC;QACd,CAAC;QAED,IAAI,KAAK,CAAC,UAAU,GAAG,CAAC,EAAE,CAAC;YACzB,MAAM,aAAa,GAAG,KAAK,CAAC,aAAa,GAAG,KAAK,CAAC,UAAU,CAAC;YAC7D,IAAI,aAAa,KAAK,CAAC;gBAAE,KAAK,IAAI,EAAE,CAAC;YACrC,IAAI,aAAa,GAAG,IAAI;gBAAE,KAAK,IAAI,EAAE,CAAC;QACxC,CAAC;QAED,OAAO,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC,CAAC;IAC3C,CAAC;IAED;;OAEG;IACK,uBAAuB,CAAC,MAM/B;QACC,MAAM,eAAe,GAAa,EAAE,CAAC;QAErC,IAAI,MAAM,CAAC,GAAG,GAAG,EAAE,EAAE,CAAC;YACpB,eAAe,CAAC,IAAI,CAAC,2DAA2D,CAAC,CAAC;QACpF,CAAC;QACD,IAAI,MAAM,CAAC,OAAO,GAAG,EAAE,EAAE,CAAC;YACxB,eAAe,CAAC,IAAI,CAAC,oDAAoD,CAAC,CAAC;QAC7E,CAAC;QACD,IAAI,MAAM,CAAC,IAAI,GAAG,EAAE,EAAE,CAAC;YACrB,eAAe,CAAC,IAAI,CAAC,mDAAmD,CAAC,CAAC;QAC5E,CAAC;QACD,IAAI,MAAM,CAAC,UAAU,GAAG,EAAE,EAAE,CAAC;YAC3B,eAAe,CAAC,IAAI,CAAC,mDAAmD,CAAC,CAAC;QAC5E,CAAC;QACD,IAAI,MAAM,CAAC,MAAM,GAAG,EAAE,EAAE,CAAC;YACvB,eAAe,CAAC,IAAI,CAAC,iDAAiD,CAAC,CAAC;QAC1E,CAAC;QAED,OAAO,eAAe,CAAC;IACzB,CAAC;IAED;;OAEG;IACI,KAAK,CAAC,mBAAmB,CAAC,SAAyB,MAAM;QAC9D,IAAI,CAAC;YACH,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,gBAAgB,EAAE,CAAC;YAE3C,IAAI,MAAM,KAAK,MAAM,EAAE,CAAC;gBACtB,OAAO,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC;YACvC,CAAC;iBAAM,CAAC;gBACN,iBAAiB;gBACjB,MAAM,OAAO,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC;gBACxC,OAAO,OAAO,CAAC;YACjB,CAAC;QACH,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YACf,eAAM,CAAC,KAAK,CAAC,kCAAkC,EAAE,KAAK,CAAC,CAAC;YACxD,OAAO,EAAE,CAAC;QACZ,CAAC;IACH,CAAC;IAED;;OAEG;IACK,YAAY,CAAC,IAA2B;QAC9C,MAAM,OAAO,GAAG,CAAC,UAAU,EAAE,QAAQ,EAAE,OAAO,EAAE,WAAW,EAAE,QAAQ,CAAC,CAAC;QAEvE,MAAM,IAAI,GAAG;YACX,OAAO;YACP,CAAC,UAAU,EAAE,eAAe,EAAE,IAAI,CAAC,QAAQ,CAAC,YAAY,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,EAAE,EAAE,CAAC;YACvF,CAAC,UAAU,EAAE,cAAc,EAAE,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,EAAE,EAAE,CAAC;YACrF,CAAC,UAAU,EAAE,iBAAiB,EAAE,IAAI,CAAC,QAAQ,CAAC,cAAc,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,EAAE,EAAE,CAAC;YAC3F,CAAC,UAAU,EAAE,gBAAgB,EAAE,IAAI,CAAC,QAAQ,CAAC,aAAa,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,EAAE,EAAE,CAAC;YACzF,CAAC,KAAK,EAAE,kBAAkB,EAAE,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,eAAe,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,EAAE,EAAE,CAAC;YACzF,CAAC,KAAK,EAAE,gBAAgB,EAAE,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,aAAa,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,EAAE,EAAE,CAAC;YACrF,CAAC,SAAS,EAAE,mBAAmB,EAAE,IAAI,CAAC,OAAO,CAAC,gBAAgB,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,EAAE,EAAE,CAAC;YAC7F,CAAC,SAAS,EAAE,aAAa,EAAE,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,UAAU,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,EAAE,EAAE,CAAC;YACvF,CAAC,KAAK,EAAE,eAAe,EAAE,IAAI,CAAC,SAAS,CAAC,YAAY,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,EAAE,EAAE,CAAC;YACnF;gBACE,cAAc;gBACd,cAAc;gBACd,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,WAAW;gBAClC,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE;gBACxB,EAAE;aACH;YACD,CAAC,UAAU,EAAE,iBAAiB,EAAE,IAAI,CAAC,QAAQ,CAAC,aAAa,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,EAAE,EAAE,CAAC;YAC1F,CAAC,MAAM,EAAE,YAAY,EAAE,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,EAAE,EAAE,CAAC;YAC/E,CAAC,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,GAAG,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,EAAE,EAAE,CAAC;YACrF,CAAC,YAAY,EAAE,eAAe,EAAE,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,MAAM,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,EAAE,EAAE,CAAC;YAC5F,CAAC,QAAQ,EAAE,eAAe,EAAE,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,YAAY,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,EAAE,EAAE,CAAC;YACzF;gBACE,QAAQ;gBACR,cAAc;gBACd,GAAG,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,iBAAiB,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,YAAY,CAAC,GAAG,GAAG,CAAC,CAAC,OAAO,CACvF,CAAC,CACF,GAAG;gBACJ,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE;gBACxB,EAAE;aACH;SACF,CAAC;QAEF,OAAO,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IACnD,CAAC;CACF,CAAA;AA7xBY,4DAAwB;mCAAxB,wBAAwB;IADpC,IAAA,sBAAU,GAAE;;GACA,wBAAwB,CA6xBpC","names":[],"sources":["C:\\Users\\Alejandro\\AIGestion\\backend\\src\\services\\security-dashboard.service.ts"],"sourcesContent":["import { injectable } from 'inversify';\nimport type { RedisClientType } from 'redis';\nimport { getRedisClient } from '../cache/redis';\nimport { logger } from '../utils/logger';\nimport { BackupRestoreService } from './backup-restore.service';\nimport {\n  CENTRAL_LOGGING_SERVICE_NAME,\n  CentralizedLoggingService,\n} from './centralized-logging.service';\nimport { MalwareScannerService } from './malware-scanner.service';\nimport { container, TYPES } from '../config/inversify.config';\nimport { HealthService } from './health.service';\nimport { MonitoringService } from './monitoring.service';\nimport { ThreatIntelligenceService } from './threat-intelligence.service';\nimport { TwoFactorService } from './two-factor.service';\nimport { UserBehaviorService } from './user-behavior.service';\nimport { WAFService } from './waf.service';\n\ninterface SecurityDashboardData {\n  overview: {\n    systemHealth: 'healthy' | 'warning' | 'critical';\n    totalAlerts: number;\n    criticalAlerts: number;\n    activeThreats: number;\n    lastScan: Date;\n  };\n  waf: {\n    stats: any;\n    recentBlocks: number;\n    topAttacks: Array<{\n      rule: string;\n      count: number;\n      severity: string;\n    }>;\n    blockedIPs: string[];\n  };\n  malware: {\n    stats: any;\n    quarantinedFiles: number;\n    recentDetections: Array<{\n      file: string;\n      threat: string;\n      timestamp: Date;\n    }>;\n  };\n  twoFactor: {\n    stats: any;\n    enabledUsers: number;\n    recentVerifications: number;\n  };\n  threatIntel: {\n    stats: any;\n    recentAlerts: Array<{\n      type: string;\n      severity: string;\n      indicator: string;\n      timestamp: Date;\n    }>;\n  };\n  behavior: {\n    stats: any;\n    highRiskUsers: number;\n    recentAnomalies: Array<{\n      userId: string;\n      type: string;\n      severity: string;\n      timestamp: Date;\n    }>;\n  };\n  logs: {\n    stats: any;\n    recentErrors: Array<{\n      timestamp: Date;\n      level: string;\n      service: string;\n      message: string;\n    }>;\n    recentCritical: Array<{\n      timestamp: Date;\n      message: string;\n      service: string;\n    }>;\n  };\n  monitoring: {\n    performance: any;\n    alerts: Array<{\n      name: string;\n      severity: string;\n      message: string;\n      timestamp: Date;\n    }>;\n  };\n  backup: {\n    stats: any;\n    recentJobs: Array<{\n      id: string;\n      type: string;\n      status: string;\n      size: number;\n      timestamp: Date;\n    }>;\n  };\n}\n\n@injectable()\nexport class SecurityDashboardService {\n  private readonly redis: RedisClientType;\n  private readonly wafService: WAFService;\n  private readonly malwareScanner: MalwareScannerService;\n  private readonly twoFactorService: TwoFactorService;\n  private readonly threatIntelService: ThreatIntelligenceService;\n  private readonly behaviorService: UserBehaviorService;\n  private readonly loggingService: CentralizedLoggingService;\n  private readonly monitoringService: MonitoringService;\n  private readonly backupService: BackupRestoreService;\n\n  constructor() {\n    this.redis = getRedisClient();\n\n    // Initialize services via container to ensure singleton usage\n    this.wafService = container.get<WAFService>(TYPES.WAFService);\n    this.malwareScanner = container.get<MalwareScannerService>(TYPES.MalwareScannerService);\n    this.twoFactorService = container.get<TwoFactorService>(TYPES.TwoFactorService);\n    this.threatIntelService = container.get<ThreatIntelligenceService>(\n      TYPES.ThreatIntelligenceService,\n    );\n    this.behaviorService = container.get<UserBehaviorService>(UserBehaviorService);\n    this.loggingService = container.get<CentralizedLoggingService>(CENTRAL_LOGGING_SERVICE_NAME);\n    this.monitoringService = container.get<MonitoringService>(TYPES.MonitoringService);\n    this.backupService = container.get<BackupRestoreService>(TYPES.BackupRestoreService);\n  }\n\n  /**\n   * Get complete security dashboard data\n   */\n  public async getDashboardData(): Promise<SecurityDashboardData> {\n    try {\n      const [overview, waf, malware, twoFactor, threatIntel, behavior, logs, monitoring] =\n        await Promise.all([\n          this.getOverviewData(),\n          this.getWAFData(),\n          this.getMalwareData(),\n          this.getTwoFactorData(),\n          this.getThreatIntelData(),\n          this.getBehaviorData(),\n          this.getLogData(),\n          this.getMonitoringData(),\n        ]);\n\n      const backupData = await this.backupService.getStats();\n\n      return {\n        overview,\n        waf,\n        malware,\n        twoFactor,\n        threatIntel,\n        behavior,\n        logs,\n        monitoring,\n        backup: {\n          stats: backupData,\n          recentJobs: backupData.recentBackups,\n        },\n      };\n    } catch (error) {\n      logger.error('Failed to get dashboard data:', error);\n      return this.getDefaultDashboardData();\n    }\n  }\n\n  /**\n   * Get overview data integrated with HealthService\n   */\n  private async getOverviewData(): Promise<{\n    systemHealth: 'healthy' | 'warning' | 'critical';\n    totalAlerts: number;\n    criticalAlerts: number;\n    activeThreats: number;\n    lastScan: Date;\n  }> {\n    try {\n      const healthService = container.get<HealthService>(HealthService);\n      const health = await healthService.getDetailedHealth();\n\n      const behaviorStats = await this.behaviorService.getStats();\n      const threatAlerts = await this.threatIntelService.getRecentAlerts(50);\n      const criticalThreats = threatAlerts.filter(alert => alert.severity === 'critical').length;\n\n      let systemHealth: 'healthy' | 'warning' | 'critical' = 'healthy';\n      if (health.status === 'degraded' || behaviorStats.highRiskUsers > 5 || criticalThreats > 3) {\n        systemHealth = 'critical';\n      } else if (behaviorStats.highRiskUsers > 0 || criticalThreats > 0) {\n        systemHealth = 'warning';\n      }\n\n      return {\n        systemHealth,\n        totalAlerts: behaviorStats.totalAnomalies + threatAlerts.length,\n        criticalAlerts: criticalThreats,\n        activeThreats: threatAlerts.length,\n        lastScan: new Date(),\n      };\n    } catch (error) {\n      logger.error('Failed to get overview data:', error);\n      return {\n        systemHealth: 'healthy',\n        totalAlerts: 0,\n        criticalAlerts: 0,\n        activeThreats: 0,\n        lastScan: new Date(),\n      };\n    }\n  }\n\n  /**\n   * Get WAF data\n   */\n  private async getWAFData(): Promise<{\n    stats: any;\n    recentBlocks: number;\n    topAttacks: Array<{\n      rule: string;\n      count: number;\n      severity: string;\n    }>;\n    blockedIPs: string[];\n  }> {\n    try {\n      const stats = this.wafService.getMetrics();\n      const recentAlerts = await this.threatIntelService.getRecentAlerts(50);\n      const recentBlocks = recentAlerts.filter(alert => alert.action === 'block').length;\n\n      const topAttacks = Object.entries(stats.topAttacks)\n        .map(([_, attack]: [string, any]) => ({\n          rule: attack.rule,\n          count: attack.count,\n          severity: this.getRuleSeverity(attack.rule),\n        }))\n        .sort((a, b) => b.count - a.count)\n        .slice(0, 10);\n\n      return {\n        stats,\n        recentBlocks,\n        topAttacks,\n        blockedIPs: [], // Would get from recent WAF blocks\n      };\n    } catch (error) {\n      logger.error('Failed to get WAF data:', error);\n      return {\n        stats: { totalRequests: 0, blockedRequests: 0, warnings: 0, rulesTriggered: {} },\n        recentBlocks: 0,\n        topAttacks: [],\n        blockedIPs: [],\n      };\n    }\n  }\n\n  /**\n   * Get malware data\n   */\n  private async getMalwareData(): Promise<{\n    stats: any;\n    quarantinedFiles: number;\n    recentDetections: Array<{\n      file: string;\n      threat: string;\n      timestamp: Date;\n    }>;\n  }> {\n    try {\n      const stats = this.malwareScanner.getScanStats();\n      const quarantinedFiles = await this.malwareScanner.getQuarantinedFiles();\n\n      const recentDetections = quarantinedFiles\n        .sort((a, b) => b.quarantinedAt.getTime() - a.quarantinedAt.getTime())\n        .slice(0, 10)\n        .map(file => ({\n          file: file.originalPath,\n          threat: file.threat,\n          timestamp: file.quarantinedAt,\n        }));\n\n      return {\n        stats,\n        quarantinedFiles: quarantinedFiles.length,\n        recentDetections,\n      };\n    } catch (error) {\n      logger.error('Failed to get malware data:', error);\n      return {\n        stats: { totalScans: 0, infectedFiles: 0, quarantinedFiles: 0, averageScanTime: 0 },\n        quarantinedFiles: 0,\n        recentDetections: [],\n      };\n    }\n  }\n\n  /**\n   * Get 2FA data\n   */\n  private async getTwoFactorData(): Promise<{\n    stats: any;\n    enabledUsers: number;\n    recentVerifications: number;\n  }> {\n    try {\n      const stats = await this.twoFactorService.getStats();\n\n      return {\n        stats,\n        enabledUsers: stats.enabledUsers,\n        recentVerifications: stats.recentVerifications,\n      };\n    } catch (error) {\n      logger.error('Failed to get 2FA data:', error);\n      return {\n        stats: { totalUsers: 0, enabledUsers: 0, methodDistribution: {}, recentVerifications: 0 },\n        enabledUsers: 0,\n        recentVerifications: 0,\n      };\n    }\n  }\n\n  /**\n   * Get threat intelligence data\n   */\n  private async getThreatIntelData(): Promise<{\n    stats: any;\n    recentAlerts: Array<{\n      type: string;\n      severity: string;\n      indicator: string;\n      timestamp: Date;\n    }>;\n  }> {\n    try {\n      const stats = await this.threatIntelService.getStats();\n      const recentAlerts = await this.threatIntelService.getRecentAlerts(50);\n\n      return {\n        stats,\n        recentAlerts: recentAlerts.map(alert => ({\n          type: alert.type,\n          severity: alert.severity,\n          indicator: alert.indicator,\n          timestamp: alert.timestamp,\n        })),\n      };\n    } catch (error) {\n      logger.error('Failed to get threat intel data:', error);\n      return {\n        stats: {\n          totalFeeds: 0,\n          activeFeeds: 0,\n          totalAlerts: 0,\n          alertsBySeverity: {},\n          alertsByType: {},\n          recentAlerts: 0,\n        },\n        recentAlerts: [],\n      };\n    }\n  }\n\n  /**\n   * Get behavior analysis data\n   */\n  private async getBehaviorData(): Promise<{\n    stats: any;\n    highRiskUsers: number;\n    recentAnomalies: Array<{\n      userId: string;\n      type: string;\n      severity: string;\n      timestamp: Date;\n    }>;\n  }> {\n    try {\n      const stats = await this.behaviorService.getStats();\n      const recentAnomalies = await this.behaviorService.getRecentAnomalies(50);\n\n      return {\n        stats,\n        highRiskUsers: stats.highRiskUsers,\n        recentAnomalies: recentAnomalies.map(anomaly => ({\n          userId: anomaly.userId,\n          type: anomaly.type,\n          severity: anomaly.severity,\n          timestamp: anomaly.detectedAt,\n        })),\n      };\n    } catch (error) {\n      logger.error('Failed to get behavior data:', error);\n      return {\n        stats: {\n          totalProfiles: 0,\n          enabledUsers: 0,\n          anomaliesByType: {},\n          anomaliesBySeverity: {},\n          averageRiskScore: 0,\n          highRiskUsers: 0,\n        },\n        highRiskUsers: 0,\n        recentAnomalies: [],\n      };\n    }\n  }\n\n  /**\n   * Get log data\n   */\n  private async getLogData(): Promise<{\n    stats: any;\n    recentErrors: Array<{\n      timestamp: Date;\n      level: string;\n      service: string;\n      message: string;\n    }>;\n    recentCritical: Array<{\n      timestamp: Date;\n      message: string;\n      service: string;\n    }>;\n  }> {\n    try {\n      const stats = await this.loggingService.getStats('hour');\n      const recentErrors = await this.loggingService.getRecentErrors(20);\n      const recentCritical = recentErrors.filter(log => log.level === 'critical').slice(0, 10);\n\n      return {\n        stats,\n        recentErrors: recentErrors.map(log => ({\n          timestamp: log.timestamp,\n          level: log.level,\n          service: log.service,\n          message: log.message,\n        })),\n        recentCritical: recentCritical.map(log => ({\n          timestamp: log.timestamp,\n          message: log.message,\n          service: log.service,\n        })),\n      };\n    } catch (error) {\n      logger.error('Failed to get log data:', error);\n      return {\n        stats: {\n          totalLogs: 0,\n          logsByLevel: {},\n          logsByService: {},\n          errorRate: 0,\n          averageResponseTime: 0,\n        },\n        recentErrors: [],\n        recentCritical: [],\n      };\n    }\n  }\n\n  /**\n   * Get monitoring data\n   */\n  private async getMonitoringData(): Promise<{\n    performance: any;\n    alerts: Array<{\n      name: string;\n      severity: string;\n      message: string;\n      timestamp: Date;\n    }>;\n  }> {\n    try {\n      const performance = await this.monitoringService.getPerformanceMetrics('hour');\n      const alerts = await this.monitoringService.getRecentAlerts(20);\n\n      return {\n        performance,\n        alerts: alerts.map(alert => ({\n          name: alert.name,\n          severity: alert.severity,\n          message: alert.message,\n          timestamp: alert.timestamp,\n        })),\n      };\n    } catch (error) {\n      logger.error('Failed to get monitoring data:', error);\n      return {\n        performance: this.getDefaultPerformanceMetrics(),\n        alerts: [],\n      };\n    }\n  }\n\n  /**\n   * Get rule severity\n   */\n  private getRuleSeverity(ruleName: string): string {\n    const severityMap: { [key: string]: string } = {\n      SQL_INJECTION: 'critical',\n      XSS_ATTACK: 'critical',\n      COMMAND_INJECTION: 'critical',\n      PATH_TRAVERSAL: 'high',\n      SSRF_ATTACK: 'high',\n      FILE_INCLUSION: 'high',\n      BUFFER_OVERFLOW: 'medium',\n      HEADER_INJECTION: 'medium',\n      PARAMETER_POLLUTION: 'low',\n    };\n\n    return severityMap[ruleName] || 'medium';\n  }\n\n  /**\n   * Get default performance metrics\n   */\n  private getDefaultPerformanceMetrics(): any {\n    return {\n      responseTime: { avg: 0, min: 0, max: 0, p50: 0, p95: 0, p99: 0 },\n      throughput: { requestsPerSecond: 0, requestsPerMinute: 0, requestsPerHour: 0 },\n      errorRate: { total: 0, percentage: 0, byStatus: {} },\n      resourceUsage: { cpu: 0, memory: 0, disk: 0, network: { inbound: 0, outbound: 0 } },\n      database: { connections: 0, queryTime: { avg: 0, slow: 0 }, cacheHitRate: 0 },\n    };\n  }\n\n  /**\n   * Get default dashboard data\n   */\n  private getDefaultDashboardData(): SecurityDashboardData {\n    return {\n      overview: {\n        systemHealth: 'healthy',\n        totalAlerts: 0,\n        criticalAlerts: 0,\n        activeThreats: 0,\n        lastScan: new Date(),\n      },\n      waf: {\n        stats: { totalRequests: 0, blockedRequests: 0, warnings: 0, rulesTriggered: {} },\n        recentBlocks: 0,\n        topAttacks: [],\n        blockedIPs: [],\n      },\n      malware: {\n        stats: { totalScans: 0, infectedFiles: 0, quarantinedFiles: 0, averageScanTime: 0 },\n        quarantinedFiles: 0,\n        recentDetections: [],\n      },\n      twoFactor: {\n        stats: { totalUsers: 0, enabledUsers: 0, methodDistribution: {}, recentVerifications: 0 },\n        enabledUsers: 0,\n        recentVerifications: 0,\n      },\n      threatIntel: {\n        stats: {\n          totalFeeds: 0,\n          activeFeeds: 0,\n          totalAlerts: 0,\n          alertsBySeverity: {},\n          alertsByType: {},\n          recentAlerts: 0,\n        },\n        recentAlerts: [],\n      },\n      behavior: {\n        stats: {\n          totalProfiles: 0,\n          enabledUsers: 0,\n          anomaliesByType: {},\n          anomaliesBySeverity: {},\n          averageRiskScore: 0,\n          highRiskUsers: 0,\n        },\n        highRiskUsers: 0,\n        recentAnomalies: [],\n      },\n      logs: {\n        stats: {\n          totalLogs: 0,\n          logsByLevel: {},\n          logsByService: {},\n          errorRate: 0,\n          averageResponseTime: 0,\n        },\n        recentErrors: [],\n        recentCritical: [],\n      },\n      monitoring: {\n        performance: this.getDefaultPerformanceMetrics(),\n        alerts: [],\n      },\n      backup: {\n        stats: {\n          totalBackups: 0,\n          successfulBackups: 0,\n          failedBackups: 0,\n          totalSize: 0,\n          averageSize: 0,\n          backupsByType: {},\n          recentBackups: [],\n        },\n        recentJobs: [],\n      },\n    };\n  }\n\n  /**\n   * Get real-time security metrics\n   */\n  public async getRealTimeMetrics(): Promise<{\n    timestamp: Date;\n    threatsBlocked: number;\n    scansCompleted: number;\n    authenticationAttempts: number;\n    activeSessions: number;\n    systemLoad: {\n      cpu: number;\n      memory: number;\n      disk: number;\n    };\n  }> {\n    try {\n      const performance = await this.monitoringService.getPerformanceMetrics('minute');\n      const wafStats = this.wafService.getMetrics();\n      const malwareStats = this.malwareScanner.getScanStats();\n\n      return {\n        timestamp: new Date(),\n        threatsBlocked: wafStats.blockedRequests,\n        scansCompleted: malwareStats.totalScans,\n        authenticationAttempts: 0, // Would track from auth service\n        activeSessions: 0, // Would track from session service\n        systemLoad: performance.resourceUsage,\n      };\n    } catch (error) {\n      logger.error('Failed to get real-time metrics:', error);\n      return {\n        timestamp: new Date(),\n        threatsBlocked: 0,\n        scansCompleted: 0,\n        authenticationAttempts: 0,\n        activeSessions: 0,\n        systemLoad: { cpu: 0, memory: 0, disk: 0 },\n      };\n    }\n  }\n\n  /**\n   * Get security incidents\n   */\n  public async getSecurityIncidents(limit: number = 50): Promise<\n    Array<{\n      id: string;\n      type: string;\n      severity: string;\n      title: string;\n      description: string;\n      timestamp: Date;\n      status: 'open' | 'investigating' | 'resolved' | 'closed';\n      assignedTo?: string;\n      tags: string[];\n    }>\n  > {\n    try {\n      // This would integrate with an incident management system\n      // For now, return recent alerts as incidents\n      const threats = await this.threatIntelService.getRecentAlerts(limit);\n      const wafBlocks = this.wafService.getMetrics();\n      const malwareDetections = await this.malwareScanner.getQuarantinedFiles();\n\n      const incidents = [\n        ...threats.map(threat => ({\n          id: threat.id,\n          type: 'threat_detected',\n          severity: threat.severity,\n          title: `Threat Detected: ${threat.type}`,\n          description: threat.description,\n          timestamp: threat.timestamp,\n          status: 'open' as const,\n          tags: [threat.type, threat.severity],\n        })),\n        ...Array.from({ length: Math.min(10, wafBlocks.blockedRequests) }, (_, index) => ({\n          id: `waf_block_${index}`,\n          type: 'waf_block',\n          severity: 'medium' as const,\n          title: 'WAF Block',\n          description: `Request blocked by WAF: ${wafBlocks.topAttacks[index]?.rule || 'Unknown'}`,\n          timestamp: new Date(),\n          status: 'resolved' as const,\n          tags: ['waf', 'security'],\n        })),\n        ...malwareDetections.slice(0, 10).map((file, index) => ({\n          id: `malware_${index}`,\n          type: 'malware_detected',\n          severity: 'high' as const,\n          title: 'Malware Detected',\n          description: `Malware found in: ${file.originalPath}`,\n          timestamp: file.quarantinedAt,\n          status: 'open' as const,\n          tags: ['malware', 'security'],\n        })),\n      ]\n        .sort((a, b) => b.timestamp.getTime() - a.timestamp.getTime())\n        .slice(0, limit);\n\n      return incidents;\n    } catch (error) {\n      logger.error('Failed to get security incidents:', error);\n      return [];\n    }\n  }\n\n  /**\n   * Get security score\n   */\n  public async getSecurityScore(): Promise<{\n    overall: number;\n    categories: {\n      waf: number;\n      malware: number;\n      authentication: number;\n      monitoring: number;\n      backup: number;\n    };\n    recommendations: string[];\n  }> {\n    try {\n      const overview = await this.getOverviewData();\n      const wafMetrics = this.wafService.getMetrics(); // Renamed from wafStats\n      const malwareStats = this.malwareScanner.getScanStats();\n      const twoFactorStats = await this.twoFactorService.getStats();\n      const monitoringOverview = this.monitoringService.getMetricsOverview();\n      const backupStats = await this.backupService.getStats();\n\n      // Calculate scores for each category\n      const wafScore = this.calculateCategoryScore(wafMetrics); // Corrected variable name\n      const malwareScore = this.calculateCategoryScore(malwareStats);\n      const authScore = this.calculateCategoryScore(twoFactorStats);\n      const monitoringScore = this.calculateCategoryScore(monitoringOverview);\n      const backupScore = this.calculateCategoryScore(backupStats);\n\n      const overall = Math.round(\n        (wafScore + malwareScore + authScore + monitoringScore + backupScore) / 5,\n      );\n\n      const recommendations = this.generateRecommendations({\n        waf: wafScore,\n        malware: malwareScore,\n        auth: authScore,\n        monitoring: monitoringScore,\n        backup: backupScore,\n      });\n\n      return {\n        overall,\n        categories: {\n          waf: wafScore,\n          malware: malwareScore,\n          authentication: authScore,\n          monitoring: monitoringScore,\n          backup: backupScore,\n        },\n        recommendations,\n      };\n    } catch (error) {\n      logger.error('Failed to get security score:', error);\n      return {\n        overall: 0,\n        categories: {\n          waf: 0,\n          malware: 0,\n          authentication: 0,\n          monitoring: 0,\n          backup: 0,\n        },\n        recommendations: [],\n      };\n    }\n  }\n\n  /**\n   * Calculate category score\n   */\n  private calculateCategoryScore(stats: any): number {\n    // Simple scoring algorithm - would be more sophisticated in production\n    let score = 50; // Base score\n\n    if (stats.totalRequests > 0) {\n      const blockRate = stats.blockedRequests / stats.totalRequests;\n      if (blockRate > 0.05) score -= 20;\n      if (blockRate > 0.1) score -= 30;\n    }\n\n    if (stats.enabledUsers > 0) {\n      score += 20;\n    }\n\n    if (stats.totalScans > 0) {\n      const infectionRate = stats.infectedFiles / stats.totalScans;\n      if (infectionRate === 0) score += 20;\n      if (infectionRate < 0.01) score += 10;\n    }\n\n    return Math.max(0, Math.min(100, score));\n  }\n\n  /**\n   * Generate recommendations\n   */\n  private generateRecommendations(scores: {\n    waf: number;\n    malware: number;\n    auth: number;\n    monitoring: number;\n    backup: number;\n  }): string[] {\n    const recommendations: string[] = [];\n\n    if (scores.waf < 70) {\n      recommendations.push('Consider enabling more WAF rules or adjusting sensitivity');\n    }\n    if (scores.malware < 70) {\n      recommendations.push('Update malware signatures and scan more frequently');\n    }\n    if (scores.auth < 70) {\n      recommendations.push('Encourage users to enable 2FA for better security');\n    }\n    if (scores.monitoring < 70) {\n      recommendations.push('Set up more comprehensive monitoring and alerting');\n    }\n    if (scores.backup < 70) {\n      recommendations.push('Ensure regular backups are scheduled and tested');\n    }\n\n    return recommendations;\n  }\n\n  /**\n   * Export dashboard data\n   */\n  public async exportDashboardData(format: 'json' | 'csv' = 'json'): Promise<string> {\n    try {\n      const data = await this.getDashboardData();\n\n      if (format === 'json') {\n        return JSON.stringify(data, null, 2);\n      } else {\n        // Convert to CSV\n        const csvData = this.convertToCSV(data);\n        return csvData;\n      }\n    } catch (error) {\n      logger.error('Failed to export dashboard data:', error);\n      return '';\n    }\n  }\n\n  /**\n   * Convert to CSV format\n   */\n  private convertToCSV(data: SecurityDashboardData): string {\n    const headers = ['Category', 'Metric', 'Value', 'Timestamp', 'Status'];\n\n    const rows = [\n      headers,\n      ['Overview', 'System Health', data.overview.systemHealth, new Date().toISOString(), ''],\n      ['Overview', 'Total Alerts', data.overview.totalAlerts, new Date().toISOString(), ''],\n      ['Overview', 'Critical Alerts', data.overview.criticalAlerts, new Date().toISOString(), ''],\n      ['Overview', 'Active Threats', data.overview.activeThreats, new Date().toISOString(), ''],\n      ['WAF', 'Blocked Requests', data.waf.stats.blockedRequests, new Date().toISOString(), ''],\n      ['WAF', 'Total Requests', data.waf.stats.totalRequests, new Date().toISOString(), ''],\n      ['Malware', 'Quarantined Files', data.malware.quarantinedFiles, new Date().toISOString(), ''],\n      ['Malware', 'Total Scans', data.malware.stats.totalScans, new Date().toISOString(), ''],\n      ['2FA', 'Enabled Users', data.twoFactor.enabledUsers, new Date().toISOString(), ''],\n      [\n        'Threat Intel',\n        'Total Alerts',\n        data.threatIntel.stats.totalAlerts,\n        new Date().toISOString(),\n        '',\n      ],\n      ['Behavior', 'High Risk Users', data.behavior.highRiskUsers, new Date().toISOString(), ''],\n      ['Logs', 'Total Logs', data.logs.stats.totalLogs, new Date().toISOString(), ''],\n      ['Logs', 'Error Rate', `${data.logs.stats.errorRate}%`, new Date().toISOString(), ''],\n      ['Monitoring', 'Active Alerts', data.monitoring.alerts.length, new Date().toISOString(), ''],\n      ['Backup', 'Total Backups', data.backup.stats.totalBackups, new Date().toISOString(), ''],\n      [\n        'Backup',\n        'Success Rate',\n        `${((data.backup.stats.successfulBackups / data.backup.stats.totalBackups) * 100).toFixed(\n          1,\n        )}%`,\n        new Date().toISOString(),\n        '',\n      ],\n    ];\n\n    return rows.map(row => row.join(',')).join('\\n');\n  }\n}\n"],"version":3}