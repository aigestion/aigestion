{"file":"C:\\Users\\Alejandro\\AIGestion\\backend\\src\\__tests__\\api-v1.test.ts","mappings":";AAAA;;GAEG;;;;;AAEH,0DAAgC;AAChC,gCAA6B;AAE7B,MAAM,aAAa,GAAG,OAAO,CAAC,GAAG,CAAC,QAAQ,KAAK,MAAM,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,qBAAqB,CAAC;AAE5F,CAAC,aAAa,CAAC,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,2BAA2B,EAAE,GAAG,EAAE;IAC3E,IAAI,SAAiB,CAAC;IACtB,IAAI,UAAkB,CAAC;IAEvB,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;IAEvB,SAAS,CAAC,KAAK,IAAI,EAAE;QACnB,MAAM,QAAQ,GAAG,OAAO,CAAC,oBAAoB,CAAC,CAAC;QAC/C,MAAM,QAAQ,CAAC,iBAAiB,EAAE,CAAC;QAEnC,MAAM,UAAU,GAAG,OAAO,CAAC,gBAAgB,CAAC,CAAC;QAC7C,MAAM,IAAI,GAAG,UAAU,CAAC,IAAI,CAAC;QAE7B,MAAM,IAAI,CAAC,UAAU,CAAC,EAAE,KAAK,EAAE,yBAAyB,EAAE,CAAC,CAAC;QAE5D,MAAM,QAAQ,GAAG,MAAM,IAAA,mBAAO,EAAC,SAAG,CAAC,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC,IAAI,CAAC;YAC7D,KAAK,EAAE,yBAAyB;YAChC,IAAI,EAAE,eAAe;YACrB,QAAQ,EAAE,gBAAgB;SAC3B,CAAC,CAAC;QAEH,IAAI,QAAQ,CAAC,MAAM,KAAK,GAAG,EAAE,CAAC;YAC5B,UAAU,GAAG,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC;QACrC,CAAC;IACH,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,aAAa,EAAE,GAAG,EAAE;QAC3B,EAAE,CAAC,4CAA4C,EAAE,KAAK,IAAI,EAAE;YAC1D,MAAM,QAAQ,GAAG,MAAM,IAAA,mBAAO,EAAC,SAAG,CAAC,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;YACtE,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,cAAc,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC;YACpD,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC;YAC7C,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,cAAc,CAAC,QAAQ,EAAE,SAAS,CAAC,CAAC;YAC/D,SAAS,GAAG,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC;QACtC,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,sBAAsB,EAAE,GAAG,EAAE;QACpC,EAAE,CAAC,qCAAqC,EAAE,KAAK,IAAI,EAAE;YACnD,MAAM,WAAW,GAAG,UAAU,IAAI,CAAC,GAAG,EAAE,cAAc,CAAC;YACvD,MAAM,QAAQ,GAAG,MAAM,IAAA,mBAAO,EAAC,SAAG,CAAC;iBAChC,IAAI,CAAC,eAAe,CAAC;iBACrB,IAAI,CAAC;gBACJ,KAAK,EAAE,WAAW;gBAClB,IAAI,EAAE,kBAAkB;gBACxB,QAAQ,EAAE,eAAe;aAC1B,CAAC;iBACD,MAAM,CAAC,GAAG,CAAC,CAAC;YAEf,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YACvC,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;QACrD,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","names":[],"sources":["C:\\Users\\Alejandro\\AIGestion\\backend\\src\\__tests__\\api-v1.test.ts"],"sourcesContent":["/**\r\n * Sprint 1: Task 1.1 - REST API Refactoring Tests\r\n */\r\n\r\nimport request from 'supertest';\r\nimport { app } from '../app';\r\n\r\nconst SKIP_DB_TESTS = process.env.NODE_ENV === 'test' && !process.env.RUN_INTEGRATION_TESTS;\r\n\r\n(SKIP_DB_TESTS ? describe.skip : describe)('API v1 - REST Refactoring', () => {\r\n  let requestId: string;\r\n  let testUserId: string;\r\n\r\n  jest.setTimeout(30000);\r\n\r\n  beforeAll(async () => {\r\n    const dbModule = require('../config/database');\r\n    await dbModule.connectToDatabase();\r\n\r\n    const userModule = require('../models/User');\r\n    const User = userModule.User;\r\n    \r\n    await User.deleteMany({ email: 'api-v1-test@example.com' });\r\n\r\n    const response = await request(app).post('/api/v1/users').send({\r\n      email: 'api-v1-test@example.com',\r\n      name: 'API Test User',\r\n      password: 'AIGestion2026!',\r\n    });\r\n\r\n    if (response.status === 201) {\r\n      testUserId = response.body.data.id;\r\n    }\r\n  });\r\n\r\n  describe('GET /health', () => {\r\n    it('should return standardized health response', async () => {\r\n      const response = await request(app).get('/api/v1/health').expect(200);\r\n      expect(response.body).toHaveProperty('status', 200);\r\n      expect(response.body).toHaveProperty('data');\r\n      expect(response.body.data).toHaveProperty('status', 'healthy');\r\n      requestId = response.body.requestId;\r\n    });\r\n  });\r\n\r\n  describe('POST /users (create)', () => {\r\n    it('should create user with valid input', async () => {\r\n      const uniqueEmail = `unique-${Date.now()}@example.com`;\r\n      const response = await request(app)\r\n        .post('/api/v1/users')\r\n        .send({\r\n          email: uniqueEmail,\r\n          name: 'Unique Test User',\r\n          password: 'AIGestion123!',\r\n        })\r\n        .expect(201);\r\n\r\n      expect(response.body.status).toBe(201);\r\n      expect(response.body.data.email).toBe(uniqueEmail);\r\n    });\r\n  });\r\n});\r\n"],"version":3}