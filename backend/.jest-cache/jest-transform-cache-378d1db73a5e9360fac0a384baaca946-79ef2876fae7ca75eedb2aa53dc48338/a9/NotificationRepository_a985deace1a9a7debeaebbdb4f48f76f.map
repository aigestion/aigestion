{"file":"C:\\Users\\Alejandro\\AIGestion\\backend\\src\\infrastructure\\repository\\NotificationRepository.ts","mappings":";;;;;;;;;AAAA,yCAAuC;AACvC,qDAAkD;AAClD,4DAAwE;AASjE,IAAM,sBAAsB,GAA5B,MAAM,sBACX,SAAQ,+BAA6B;IAG5B,KAAK,CAAC,MAAM,CAAC,QAAa,EAAE,SAAe;QAClD,MAAM,IAAI,GAAG,OAAO,QAAQ,KAAK,QAAQ,CAAC,CAAC,CAAC,SAAS,IAAI,EAAE,CAAC,CAAC,CAAC,QAAQ,CAAC;QACvE,MAAM,YAAY,GAAG,IAAI,2BAAY,CAAC,IAAW,CAAC,CAAC;QACnD,OAAO,MAAM,YAAY,CAAC,IAAI,EAAE,CAAC;IACnC,CAAC;IAEQ,KAAK,CAAC,QAAQ,CAAC,EAAU;QAChC,OAAO,MAAM,2BAAY,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,IAAI,EAAE,CAAC;IAChD,CAAC;IAED,KAAK,CAAC,UAAU,CAAC,MAAc,EAAE,QAAgB,EAAE,EAAE,OAAe,CAAC;QACnE,OAAO,MAAM,2BAAY,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,CAAC;aACvC,IAAI,CAAC,EAAE,SAAS,EAAE,CAAC,CAAC,EAAE,CAAC;aACvB,IAAI,CAAC,IAAI,CAAC;aACV,KAAK,CAAC,KAAK,CAAC;aACZ,IAAI,EAAE,CAAC;IACZ,CAAC;IAED,KAAK,CAAC,UAAU,CAAC,EAAU;QACzB,OAAO,MAAM,2BAAY,CAAC,iBAAiB,CAAC,EAAE,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,EAAE,EAAE,GAAG,EAAE,IAAI,EAAE,CAAC,CAAC,IAAI,EAAE,CAAC;IACxF,CAAC;IAED,KAAK,CAAC,aAAa,CAAC,MAAc;QAChC,MAAM,2BAAY,CAAC,UAAU,CAAC,EAAE,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC,IAAI,EAAE,CAAC;IAChF,CAAC;IAEQ,KAAK,CAAC,MAAM,CAAC,EAAU,EAAE,IAA4B;QAC5D,OAAO,MAAM,2BAAY,CAAC,iBAAiB,CAAC,EAAE,EAAE,IAAI,EAAE,EAAE,GAAG,EAAE,IAAI,EAAE,CAAC,CAAC,IAAI,EAAE,CAAC;IAC9E,CAAC;IAEQ,KAAK,CAAC,MAAM,CAAC,EAAU;QAC9B,MAAM,MAAM,GAAG,MAAM,2BAAY,CAAC,iBAAiB,CAAC,EAAE,CAAC,CAAC,IAAI,EAAE,CAAC;QAC/D,OAAO,CAAC,CAAC,MAAM,CAAC;IAClB,CAAC;CACF,CAAA;AAtCY,wDAAsB;iCAAtB,sBAAsB;IADlC,IAAA,sBAAU,GAAE;GACA,sBAAsB,CAsClC","names":[],"sources":["C:\\Users\\Alejandro\\AIGestion\\backend\\src\\infrastructure\\repository\\NotificationRepository.ts"],"sourcesContent":["import { injectable } from 'inversify';\nimport { BaseRepository } from './BaseRepository';\nimport { Notification, INotification } from '../../models/Notification';\n\nexport interface INotificationRepository extends BaseRepository<INotification> {\n  findByUser(userId: string, limit?: number, skip?: number): Promise<INotification[]>;\n  markAsRead(id: string): Promise<INotification | null>;\n  markAllAsRead(userId: string): Promise<void>;\n}\n\n@injectable()\nexport class NotificationRepository\n  extends BaseRepository<INotification>\n  implements INotificationRepository\n{\n  override async create(idOrItem: any, maybeItem?: any): Promise<INotification> {\n    const data = typeof idOrItem === 'string' ? maybeItem ?? {} : idOrItem;\n    const notification = new Notification(data as any);\n    return await notification.save();\n  }\n\n  override async findById(id: string): Promise<INotification | null> {\n    return await Notification.findById(id).exec();\n  }\n\n  async findByUser(userId: string, limit: number = 50, skip: number = 0): Promise<INotification[]> {\n    return await Notification.find({ userId })\n      .sort({ createdAt: -1 })\n      .skip(skip)\n      .limit(limit)\n      .exec();\n  }\n\n  async markAsRead(id: string): Promise<INotification | null> {\n    return await Notification.findByIdAndUpdate(id, { read: true }, { new: true }).exec();\n  }\n\n  async markAllAsRead(userId: string): Promise<void> {\n    await Notification.updateMany({ userId, read: false }, { read: true }).exec();\n  }\n\n  override async update(id: string, data: Partial<INotification>): Promise<INotification | null> {\n    return await Notification.findByIdAndUpdate(id, data, { new: true }).exec();\n  }\n\n  override async delete(id: string): Promise<boolean> {\n    const result = await Notification.findByIdAndDelete(id).exec();\n    return !!result;\n  }\n}\n"],"version":3}