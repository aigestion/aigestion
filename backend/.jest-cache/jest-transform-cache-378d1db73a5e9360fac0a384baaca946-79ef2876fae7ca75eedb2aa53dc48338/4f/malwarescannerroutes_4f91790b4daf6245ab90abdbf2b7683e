50c864f5ffad657e6be4e054fda4fc11
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const express_1 = require("express");
const malware_scanner_middleware_1 = require("../middleware/malware-scanner.middleware");
const security_middleware_1 = require("../middleware/security.middleware");
const malware_scanner_service_1 = require("../services/malware-scanner.service");
const logger_1 = require("../utils/logger");
const router = (0, express_1.Router)();
const scannerService = new malware_scanner_service_1.MalwareScannerService();
/**
 * Malware Scanner Management Routes
 */
// Get scanner statistics
router.get('/stats', security_middleware_1.requireApiKey, (req, res) => {
    try {
        const stats = malware_scanner_middleware_1.malwareScanner.getScannerStats();
        res.json({
            success: true,
            data: {
                ...stats,
                timestamp: new Date().toISOString(),
            },
        });
    }
    catch (error) {
        logger_1.logger.error('Error getting malware scanner stats:', error);
        res.status(500).json({
            success: false,
            error: 'Internal server error',
        });
    }
});
// Get quarantined files
router.get('/quarantine', security_middleware_1.requireApiKey, async (req, res) => {
    try {
        const quarantinedFiles = await scannerService.getQuarantinedFiles();
        res.json({
            success: true,
            data: quarantinedFiles.map(file => ({
                originalPath: file.originalPath,
                quarantinePath: file.quarantinePath,
                hash: file.hash,
                threat: file.threat,
                quarantinedAt: file.quarantinedAt,
                userId: file.userId,
            })),
        });
    }
    catch (error) {
        logger_1.logger.error('Error getting quarantined files:', error);
        res.status(500).json({
            success: false,
            error: 'Internal server error',
        });
    }
});
// Release file from quarantine
router.post('/quarantine/:quarantinePath/release', security_middleware_1.requireApiKey, async (req, res) => {
    try {
        const { quarantinePath } = req.params;
        const { targetPath } = req.body;
        if (!targetPath) {
            return res.status(400).json({
                success: false,
                error: 'Target path is required',
            });
        }
        await scannerService.releaseFromQuarantine(quarantinePath, targetPath);
        logger_1.logger.info('File released from quarantine', {
            quarantinePath,
            targetPath,
            ip: req.ip,
        });
        res.json({
            success: true,
            message: 'File released from quarantine successfully',
        });
    }
    catch (error) {
        logger_1.logger.error('Error releasing file from quarantine:', error);
        res.status(500).json({
            success: false,
            error: 'Internal server error',
        });
    }
});
// Delete quarantined file
router.delete('/quarantine/:quarantinePath', security_middleware_1.requireApiKey, async (req, res) => {
    try {
        const { quarantinePath } = req.params;
        await scannerService.deleteQuarantinedFile(quarantinePath);
        logger_1.logger.info('Quarantined file deleted', {
            quarantinePath,
            ip: req.ip,
        });
        res.json({
            success: true,
            message: 'Quarantined file deleted successfully',
        });
    }
    catch (error) {
        logger_1.logger.error('Error deleting quarantined file:', error);
        res.status(500).json({
            success: false,
            error: 'Internal server error',
        });
    }
});
// Clear scanner cache
router.post('/cache/clear', security_middleware_1.requireApiKey, (req, res) => {
    try {
        malware_scanner_middleware_1.malwareScanner.clearCache();
        logger_1.logger.info('Malware scanner cache cleared', {
            ip: req.ip,
        });
        res.json({
            success: true,
            message: 'Scanner cache cleared successfully',
        });
    }
    catch (error) {
        logger_1.logger.error('Error clearing scanner cache:', error);
        res.status(500).json({
            success: false,
            error: 'Internal server error',
        });
    }
});
// Upload and scan file (test endpoint)
router.post('/scan', security_middleware_1.requireApiKey, malware_scanner_middleware_1.malwareScanner.uploadSingle('file'), async (req, res) => {
    try {
        const uploadedFile = req.file;
        if (!uploadedFile) {
            return res.status(400).json({
                success: false,
                error: 'No file uploaded',
            });
        }
        const scanResult = req.fileScanResult;
        res.json({
            success: true,
            data: {
                file: {
                    originalname: uploadedFile.originalname,
                    filename: uploadedFile.filename,
                    size: uploadedFile.size,
                    mimetype: uploadedFile.mimetype,
                },
                scanResult: {
                    isInfected: scanResult.isInfected,
                    threats: scanResult.threats,
                    scanTime: scanResult.scanTime,
                    engine: scanResult.engine,
                    hash: scanResult.hash,
                },
            },
        });
    }
    catch (error) {
        logger_1.logger.error('Error in scan endpoint:', error);
        res.status(500).json({
            success: false,
            error: 'Internal server error',
        });
    }
});
// Upload and scan multiple files (test endpoint)
router.post('/scan-batch', security_middleware_1.requireApiKey, malware_scanner_middleware_1.malwareScanner.uploadMultiple('files', 5), async (req, res) => {
    try {
        const scanResults = req.fileScanResults;
        if (!scanResults || scanResults.length === 0) {
            return res.status(400).json({
                success: false,
                error: 'No files uploaded',
            });
        }
        res.json({
            success: true,
            data: {
                totalFiles: scanResults.length,
                cleanFiles: scanResults.filter((r) => r.isClean).length,
                infectedFiles: scanResults.filter((r) => !r.isClean).length,
                results: scanResults.map((result) => ({
                    file: {
                        originalname: result.originalname,
                        filename: result.filename,
                        size: result.size,
                        mimetype: result.mimetype,
                    },
                    scanResult: {
                        isInfected: result.scanResult.isInfected,
                        threats: result.scanResult.threats,
                        scanTime: result.scanResult.scanTime,
                        engine: result.scanResult.engine,
                        hash: result.scanResult.hash,
                    },
                })),
            },
        });
    }
    catch (error) {
        logger_1.logger.error('Error in batch scan endpoint:', error);
        res.status(500).json({
            success: false,
            error: 'Internal server error',
        });
    }
});
// Get scanner health
router.get('/health', (req, res) => {
    try {
        const stats = malware_scanner_middleware_1.malwareScanner.getScannerStats();
        const health = {
            status: 'healthy',
            scanner: 'active',
            stats: {
                totalScans: stats.totalScans,
                infectedFiles: stats.infectedFiles,
                quarantinedFiles: stats.quarantinedFiles,
                averageScanTime: Math.round(stats.averageScanTime * 100) / 100,
            },
            timestamp: new Date().toISOString(),
        };
        res.json({
            success: true,
            data: health,
        });
    }
    catch (error) {
        logger_1.logger.error('Error getting scanner health:', error);
        res.status(500).json({
            success: false,
            error: 'Internal server error',
        });
    }
});
exports.default = router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxBbGVqYW5kcm9cXEFJR2VzdGlvblxcYmFja2VuZFxcc3JjXFxyb3V0ZXNcXG1hbHdhcmUtc2Nhbm5lci5yb3V0ZXMudHMiLCJtYXBwaW5ncyI6Ijs7QUFBQSxxQ0FBaUM7QUFDakMseUZBQTBFO0FBQzFFLDJFQUFrRTtBQUNsRSxpRkFBNEU7QUFDNUUsNENBQXlDO0FBRXpDLE1BQU0sTUFBTSxHQUFHLElBQUEsZ0JBQU0sR0FBRSxDQUFDO0FBQ3hCLE1BQU0sY0FBYyxHQUFHLElBQUksK0NBQXFCLEVBQUUsQ0FBQztBQUVuRDs7R0FFRztBQUVILHlCQUF5QjtBQUN6QixNQUFNLENBQUMsR0FBRyxDQUFDLFFBQVEsRUFBRSxtQ0FBYSxFQUFFLENBQUMsR0FBUSxFQUFFLEdBQVEsRUFBRSxFQUFFO0lBQ3pELElBQUksQ0FBQztRQUNILE1BQU0sS0FBSyxHQUFHLDJDQUFjLENBQUMsZUFBZSxFQUFFLENBQUM7UUFFL0MsR0FBRyxDQUFDLElBQUksQ0FBQztZQUNQLE9BQU8sRUFBRSxJQUFJO1lBQ2IsSUFBSSxFQUFFO2dCQUNKLEdBQUcsS0FBSztnQkFDUixTQUFTLEVBQUUsSUFBSSxJQUFJLEVBQUUsQ0FBQyxXQUFXLEVBQUU7YUFDcEM7U0FDRixDQUFDLENBQUM7SUFDTCxDQUFDO0lBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQztRQUNmLGVBQU0sQ0FBQyxLQUFLLENBQUMsc0NBQXNDLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFDNUQsR0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUM7WUFDbkIsT0FBTyxFQUFFLEtBQUs7WUFDZCxLQUFLLEVBQUUsdUJBQXVCO1NBQy9CLENBQUMsQ0FBQztJQUNMLENBQUM7QUFDSCxDQUFDLENBQUMsQ0FBQztBQUVILHdCQUF3QjtBQUN4QixNQUFNLENBQUMsR0FBRyxDQUFDLGFBQWEsRUFBRSxtQ0FBYSxFQUFFLEtBQUssRUFBRSxHQUFRLEVBQUUsR0FBUSxFQUFFLEVBQUU7SUFDcEUsSUFBSSxDQUFDO1FB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Q0QsU0FBUyxFQUFFLElBQUksSUFBSSxFQUFFLENBQUMsV0FBVyxFQUFFO1NBQ3BDLENBQUM7UUFFRixHQUFHLENBQUMsSUFBSSxDQUFDO1lBQ1AsT0FBTyxFQUFFLElBQUk7WUFDYixJQUFJLEVBQUUsTUFBTTtTQUNiLENBQUMsQ0FBQztJQUNMLENBQUM7SUFBQyxPQUFPLEtBQUssRUFBRSxDQUFDO1FBQ2YsZUFBTSxDQUFDLEtBQUssQ0FBQywrQkFBK0IsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUNyRCxHQUFHLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQztZQUNuQixPQUFPLEVBQUUsS0FBSztZQUNkLEtBQUssRUFBRSx1QkFBdUI7U0FDL0IsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztBQUNILENBQUMsQ0FBQyxDQUFDO0FBRUgsa0JBQWUsTUFBTSxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcQWxlamFuZHJvXFxBSUdlc3Rpb25cXGJhY2tlbmRcXHNyY1xccm91dGVzXFxtYWx3YXJlLXNjYW5uZXIucm91dGVzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFJvdXRlciB9IGZyb20gJ2V4cHJlc3MnO1xuaW1wb3J0IHsgbWFsd2FyZVNjYW5uZXIgfSBmcm9tICcuLi9taWRkbGV3YXJlL21hbHdhcmUtc2Nhbm5lci5taWRkbGV3YXJlJztcbmltcG9ydCB7IHJlcXVpcmVBcGlLZXkgfSBmcm9tICcuLi9taWRkbGV3YXJlL3NlY3VyaXR5Lm1pZGRsZXdhcmUnO1xuaW1wb3J0IHsgTWFsd2FyZVNjYW5uZXJTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvbWFsd2FyZS1zY2FubmVyLnNlcnZpY2UnO1xuaW1wb3J0IHsgbG9nZ2VyIH0gZnJvbSAnLi4vdXRpbHMvbG9nZ2VyJztcblxuY29uc3Qgcm91dGVyID0gUm91dGVyKCk7XG5jb25zdCBzY2FubmVyU2VydmljZSA9IG5ldyBNYWx3YXJlU2Nhbm5lclNlcnZpY2UoKTtcblxuLyoqXG4gKiBNYWx3YXJlIFNjYW5uZXIgTWFuYWdlbWVudCBSb3V0ZXNcbiAqL1xuXG4vLyBHZXQgc2Nhbm5lciBzdGF0aXN0aWNzXG5yb3V0ZXIuZ2V0KCcvc3RhdHMnLCByZXF1aXJlQXBpS2V5LCAocmVxOiBhbnksIHJlczogYW55KSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3Qgc3RhdHMgPSBtYWx3YXJlU2Nhbm5lci5nZXRTY2FubmVyU3RhdHMoKTtcblxuICAgIHJlcy5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBkYXRhOiB7XG4gICAgICAgIC4uLnN0YXRzLFxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nZ2VyLmVycm9yKCdFcnJvciBnZXR0aW5nIG1hbHdhcmUgc2Nhbm5lciBzdGF0czonLCBlcnJvcik7XG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjogJ0ludGVybmFsIHNlcnZlciBlcnJvcicsXG4gICAgfSk7XG4gIH1cbn0pO1xuXG4vLyBHZXQgcXVhcmFudGluZWQgZmlsZXNcbnJvdXRlci5nZXQoJy9xdWFyYW50aW5lJywgcmVxdWlyZUFwaUtleSwgYXN5bmMgKHJlcTogYW55LCByZXM6IGFueSkgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHF1YXJhbnRpbmVkRmlsZXMgPSBhd2FpdCBzY2FubmVyU2VydmljZS5nZXRRdWFyYW50aW5lZEZpbGVzKCk7XG5cbiAgICByZXMuanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgZGF0YTogcXVhcmFudGluZWRGaWxlcy5tYXAoZmlsZSA9PiAoe1xuICAgICAgICBvcmlnaW5hbFBhdGg6IGZpbGUub3JpZ2luYWxQYXRoLFxuICAgICAgICBxdWFyYW50aW5lUGF0aDogZmlsZS5xdWFyYW50aW5lUGF0aCxcbiAgICAgICAgaGFzaDogZmlsZS5oYXNoLFxuICAgICAgICB0aHJlYXQ6IGZpbGUudGhyZWF0LFxuICAgICAgICBxdWFyYW50aW5lZEF0OiBmaWxlLnF1YXJhbnRpbmVkQXQsXG4gICAgICAgIHVzZXJJZDogZmlsZS51c2VySWQsXG4gICAgICB9KSksXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nZ2VyLmVycm9yKCdFcnJvciBnZXR0aW5nIHF1YXJhbnRpbmVkIGZpbGVzOicsIGVycm9yKTtcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiAnSW50ZXJuYWwgc2VydmVyIGVycm9yJyxcbiAgICB9KTtcbiAgfVxufSk7XG5cbi8vIFJlbGVhc2UgZmlsZSBmcm9tIHF1YXJhbnRpbmVcbnJvdXRlci5wb3N0KCcvcXVhcmFudGluZS86cXVhcmFudGluZVBhdGgvcmVsZWFzZScsIHJlcXVpcmVBcGlLZXksIGFzeW5jIChyZXE6IGFueSwgcmVzOiBhbnkpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB7IHF1YXJhbnRpbmVQYXRoIH0gPSByZXEucGFyYW1zO1xuICAgIGNvbnN0IHsgdGFyZ2V0UGF0aCB9ID0gcmVxLmJvZHk7XG5cbiAgICBpZiAoIXRhcmdldFBhdGgpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogJ1RhcmdldCBwYXRoIGlzIHJlcXVpcmVkJyxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGF3YWl0IHNjYW5uZXJTZXJ2aWNlLnJlbGVhc2VGcm9tUXVhcmFudGluZShxdWFyYW50aW5lUGF0aCwgdGFyZ2V0UGF0aCk7XG5cbiAgICBsb2dnZXIuaW5mbygnRmlsZSByZWxlYXNlZCBmcm9tIHF1YXJhbnRpbmUnLCB7XG4gICAgICBxdWFyYW50aW5lUGF0aCxcbiAgICAgIHRhcmdldFBhdGgsXG4gICAgICBpcDogcmVxLmlwLFxuICAgIH0pO1xuXG4gICAgcmVzLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIG1lc3NhZ2U6ICdGaWxlIHJlbGVhc2VkIGZyb20gcXVhcmFudGluZSBzdWNjZXNzZnVsbHknLFxuICAgIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGxvZ2dlci5lcnJvcignRXJyb3IgcmVsZWFzaW5nIGZpbGUgZnJvbSBxdWFyYW50aW5lOicsIGVycm9yKTtcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiAnSW50ZXJuYWwgc2VydmVyIGVycm9yJyxcbiAgICB9KTtcbiAgfVxufSk7XG5cbi8vIERlbGV0ZSBxdWFyYW50aW5lZCBmaWxlXG5yb3V0ZXIuZGVsZXRlKCcvcXVhcmFudGluZS86cXVhcmFudGluZVBhdGgnLCByZXF1aXJlQXBpS2V5LCBhc3luYyAocmVxOiBhbnksIHJlczogYW55KSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgeyBxdWFyYW50aW5lUGF0aCB9ID0gcmVxLnBhcmFtcztcblxuICAgIGF3YWl0IHNjYW5uZXJTZXJ2aWNlLmRlbGV0ZVF1YXJhbnRpbmVkRmlsZShxdWFyYW50aW5lUGF0aCk7XG5cbiAgICBsb2dnZXIuaW5mbygnUXVhcmFudGluZWQgZmlsZSBkZWxldGVkJywge1xuICAgICAgcXVhcmFudGluZVBhdGgsXG4gICAgICBpcDogcmVxLmlwLFxuICAgIH0pO1xuXG4gICAgcmVzLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIG1lc3NhZ2U6ICdRdWFyYW50aW5lZCBmaWxlIGRlbGV0ZWQgc3VjY2Vzc2Z1bGx5JyxcbiAgICB9KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIHF1YXJhbnRpbmVkIGZpbGU6JywgZXJyb3IpO1xuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InLFxuICAgIH0pO1xuICB9XG59KTtcblxuLy8gQ2xlYXIgc2Nhbm5lciBjYWNoZVxucm91dGVyLnBvc3QoJy9jYWNoZS9jbGVhcicsIHJlcXVpcmVBcGlLZXksIChyZXE6IGFueSwgcmVzOiBhbnkpID0+IHtcbiAgdHJ5IHtcbiAgICBtYWx3YXJlU2Nhbm5lci5jbGVhckNhY2hlKCk7XG5cbiAgICBsb2dnZXIuaW5mbygnTWFsd2FyZSBzY2FubmVyIGNhY2hlIGNsZWFyZWQnLCB7XG4gICAgICBpcDogcmVxLmlwLFxuICAgIH0pO1xuXG4gICAgcmVzLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIG1lc3NhZ2U6ICdTY2FubmVyIGNhY2hlIGNsZWFyZWQgc3VjY2Vzc2Z1bGx5JyxcbiAgICB9KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGNsZWFyaW5nIHNjYW5uZXIgY2FjaGU6JywgZXJyb3IpO1xuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InLFxuICAgIH0pO1xuICB9XG59KTtcblxuLy8gVXBsb2FkIGFuZCBzY2FuIGZpbGUgKHRlc3QgZW5kcG9pbnQpXG5yb3V0ZXIucG9zdChcbiAgJy9zY2FuJyxcbiAgcmVxdWlyZUFwaUtleSxcbiAgbWFsd2FyZVNjYW5uZXIudXBsb2FkU2luZ2xlKCdmaWxlJyksXG4gIGFzeW5jIChyZXE6IGFueSwgcmVzOiBhbnkpID0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgdXBsb2FkZWRGaWxlID0gKHJlcSBhcyBhbnkpLmZpbGU7XG4gICAgICBpZiAoIXVwbG9hZGVkRmlsZSkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiAnTm8gZmlsZSB1cGxvYWRlZCcsXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBzY2FuUmVzdWx0ID0gKHJlcSBhcyBhbnkpLmZpbGVTY2FuUmVzdWx0O1xuXG4gICAgICByZXMuanNvbih7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBmaWxlOiB7XG4gICAgICAgICAgICBvcmlnaW5hbG5hbWU6IHVwbG9hZGVkRmlsZS5vcmlnaW5hbG5hbWUsXG4gICAgICAgICAgICBmaWxlbmFtZTogdXBsb2FkZWRGaWxlLmZpbGVuYW1lLFxuICAgICAgICAgICAgc2l6ZTogdXBsb2FkZWRGaWxlLnNpemUsXG4gICAgICAgICAgICBtaW1ldHlwZTogdXBsb2FkZWRGaWxlLm1pbWV0eXBlLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgc2NhblJlc3VsdDoge1xuICAgICAgICAgICAgaXNJbmZlY3RlZDogc2NhblJlc3VsdC5pc0luZmVjdGVkLFxuICAgICAgICAgICAgdGhyZWF0czogc2NhblJlc3VsdC50aHJlYXRzLFxuICAgICAgICAgICAgc2NhblRpbWU6IHNjYW5SZXN1bHQuc2NhblRpbWUsXG4gICAgICAgICAgICBlbmdpbmU6IHNjYW5SZXN1bHQuZW5naW5lLFxuICAgICAgICAgICAgaGFzaDogc2NhblJlc3VsdC5oYXNoLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciBpbiBzY2FuIGVuZHBvaW50OicsIGVycm9yKTtcbiAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiAnSW50ZXJuYWwgc2VydmVyIGVycm9yJyxcbiAgICAgIH0pO1xuICAgIH1cbiAgfSxcbik7XG5cbi8vIFVwbG9hZCBhbmQgc2NhbiBtdWx0aXBsZSBmaWxlcyAodGVzdCBlbmRwb2ludClcbnJvdXRlci5wb3N0KFxuICAnL3NjYW4tYmF0Y2gnLFxuICByZXF1aXJlQXBpS2V5LFxuICBtYWx3YXJlU2Nhbm5lci51cGxvYWRNdWx0aXBsZSgnZmlsZXMnLCA1KSxcbiAgYXN5bmMgKHJlcTogYW55LCByZXM6IGFueSkgPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBzY2FuUmVzdWx0cyA9IChyZXEgYXMgYW55KS5maWxlU2NhblJlc3VsdHM7XG5cbiAgICAgIGlmICghc2NhblJlc3VsdHMgfHwgc2NhblJlc3VsdHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgZXJyb3I6ICdObyBmaWxlcyB1cGxvYWRlZCcsXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICByZXMuanNvbih7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICB0b3RhbEZpbGVzOiBzY2FuUmVzdWx0cy5sZW5ndGgsXG4gICAgICAgICAgY2xlYW5GaWxlczogc2NhblJlc3VsdHMuZmlsdGVyKChyOiBhbnkpID0+IHIuaXNDbGVhbikubGVuZ3RoLFxuICAgICAgICAgIGluZmVjdGVkRmlsZXM6IHNjYW5SZXN1bHRzLmZpbHRlcigocjogYW55KSA9PiAhci5pc0NsZWFuKS5sZW5ndGgsXG4gICAgICAgICAgcmVzdWx0czogc2NhblJlc3VsdHMubWFwKChyZXN1bHQ6IGFueSkgPT4gKHtcbiAgICAgICAgICAgIGZpbGU6IHtcbiAgICAgICAgICAgICAgb3JpZ2luYWxuYW1lOiByZXN1bHQub3JpZ2luYWxuYW1lLFxuICAgICAgICAgICAgICBmaWxlbmFtZTogcmVzdWx0LmZpbGVuYW1lLFxuICAgICAgICAgICAgICBzaXplOiByZXN1bHQuc2l6ZSxcbiAgICAgICAgICAgICAgbWltZXR5cGU6IHJlc3VsdC5taW1ldHlwZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzY2FuUmVzdWx0OiB7XG4gICAgICAgICAgICAgIGlzSW5mZWN0ZWQ6IHJlc3VsdC5zY2FuUmVzdWx0LmlzSW5mZWN0ZWQsXG4gICAgICAgICAgICAgIHRocmVhdHM6IHJlc3VsdC5zY2FuUmVzdWx0LnRocmVhdHMsXG4gICAgICAgICAgICAgIHNjYW5UaW1lOiByZXN1bHQuc2NhblJlc3VsdC5zY2FuVGltZSxcbiAgICAgICAgICAgICAgZW5naW5lOiByZXN1bHQuc2NhblJlc3VsdC5lbmdpbmUsXG4gICAgICAgICAgICAgIGhhc2g6IHJlc3VsdC5zY2FuUmVzdWx0Lmhhc2gsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0pKSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGluIGJhdGNoIHNjYW4gZW5kcG9pbnQ6JywgZXJyb3IpO1xuICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InLFxuICAgICAgfSk7XG4gICAgfVxuICB9LFxuKTtcblxuLy8gR2V0IHNjYW5uZXIgaGVhbHRoXG5yb3V0ZXIuZ2V0KCcvaGVhbHRoJywgKHJlcTogYW55LCByZXM6IGFueSkgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHN0YXRzID0gbWFsd2FyZVNjYW5uZXIuZ2V0U2Nhbm5lclN0YXRzKCk7XG5cbiAgICBjb25zdCBoZWFsdGggPSB7XG4gICAgICBzdGF0dXM6ICdoZWFsdGh5JyxcbiAgICAgIHNjYW5uZXI6ICdhY3RpdmUnLFxuICAgICAgc3RhdHM6IHtcbiAgICAgICAgdG90YWxTY2Fuczogc3RhdHMudG90YWxTY2FucyxcbiAgICAgICAgaW5mZWN0ZWRGaWxlczogc3RhdHMuaW5mZWN0ZWRGaWxlcyxcbiAgICAgICAgcXVhcmFudGluZWRGaWxlczogc3RhdHMucXVhcmFudGluZWRGaWxlcyxcbiAgICAgICAgYXZlcmFnZVNjYW5UaW1lOiBNYXRoLnJvdW5kKHN0YXRzLmF2ZXJhZ2VTY2FuVGltZSAqIDEwMCkgLyAxMDAsXG4gICAgICB9LFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgfTtcblxuICAgIHJlcy5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBkYXRhOiBoZWFsdGgsXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nZ2VyLmVycm9yKCdFcnJvciBnZXR0aW5nIHNjYW5uZXIgaGVhbHRoOicsIGVycm9yKTtcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiAnSW50ZXJuYWwgc2VydmVyIGVycm9yJyxcbiAgICB9KTtcbiAgfVxufSk7XG5cbmV4cG9ydCBkZWZhdWx0IHJvdXRlcjtcbiJdLCJ2ZXJzaW9uIjozfQ==