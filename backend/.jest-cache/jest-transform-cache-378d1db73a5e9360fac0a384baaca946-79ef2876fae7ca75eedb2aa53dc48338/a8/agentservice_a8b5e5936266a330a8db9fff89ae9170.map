{"file":"C:\\Users\\Alejandro\\AIGestion\\backend\\src\\services\\agent.service.ts","mappings":";;;;;;;;;;;;;;;;AAAA,yCAA+C;AAC/C,4CAAyC;AACzC,2DAA4D;AAC5D,qDAAiD;AACjD,oCAAiC;AAG1B,IAAM,YAAY,GAAlB,MAAM,YAAY;IAEgB;IACQ;IAF/C,YACuC,aAA4B,EACpB,cAAqC;QAD7C,kBAAa,GAAb,aAAa,CAAe;QACpB,mBAAc,GAAd,cAAc,CAAuB;IACjF,CAAC;IAEG,KAAK,CAAC,YAAY,CAAC,MAAc,EAAE,KAAa,EAAE,OAAa;QACpE,eAAM,CAAC,IAAI,CAAC,mCAAmC,MAAM,KAAK,KAAK,EAAE,CAAC,CAAC;QAEnE,yCAAyC;QACzC,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;QACzD,MAAM,eAAe,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAE,CAAS,CAAC,OAAO,IAAI,CAAC,CAAC,IAAI,IAAI,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAEvF,eAAM,CAAC,KAAK,CAAC,aAAa,MAAM,CAAC,MAAM,mBAAmB,CAAC,CAAC;QAE5D,yCAAyC;QACzC,MAAM,KAAK,GAAG,SAAS,CAAC,CAAC,qBAAqB;QAE9C,0CAA0C;QAC1C,kFAAkF;QAElF,OAAO;YACL,KAAK;YACL,KAAK;YACL,OAAO,EAAE,eAAe;YACxB,QAAQ,EAAE,+CAAgD,KAAa,CAAC,IAAI,IAAI,KAAK,EAAE;SACxF,CAAC;IACJ,CAAC;IAEM,KAAK,CAAC,cAAc,CAAC,MAAc,EAAE,OAAe,EAAE,QAAc;QACzE,MAAM,GAAG,GAAG;YACV,EAAE,EAAE,GAAG,MAAM,IAAI,IAAI,CAAC,GAAG,EAAE,EAAE;YAC7B,IAAI,EAAE,OAAO;YACb,QAAQ,EAAE,EAAE,GAAG,QAAQ,EAAE,MAAM,EAAE;SAClC,CAAC;QACF,MAAM,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;QACrC,eAAM,CAAC,IAAI,CAAC,uCAAuC,MAAM,EAAE,CAAC,CAAC;IAC/D,CAAC;CACF,CAAA;AAtCY,oCAAY;uBAAZ,YAAY;IADxB,IAAA,sBAAU,GAAE;IAGR,WAAA,IAAA,kBAAM,EAAC,aAAK,CAAC,aAAa,CAAC,CAAA;IAC3B,WAAA,IAAA,kBAAM,EAAC,aAAK,CAAC,qBAAqB,CAAC,CAAA;yDADgB,8BAAa,oBAAb,8BAAa,oDACJ,yCAAqB,oBAArB,yCAAqB;GAHzE,YAAY,CAsCxB","names":[],"sources":["C:\\Users\\Alejandro\\AIGestion\\backend\\src\\services\\agent.service.ts"],"sourcesContent":["import { injectable, inject } from 'inversify';\nimport { logger } from '../utils/logger';\nimport { SemanticRouterService } from './ai-router.service';\nimport { VectorService } from './vector.service';\nimport { TYPES } from '../types';\n\n@injectable()\nexport class AgentService {\n  constructor(\n    @inject(TYPES.VectorService) private vectorService: VectorService,\n    @inject(TYPES.SemanticRouterService) private semanticRouter: SemanticRouterService,\n  ) {}\n\n  public async processQuery(userId: string, query: string, context?: any): Promise<any> {\n    logger.info(`Agent processing query for user ${userId}: ${query}`);\n\n    // 1. Retrieve Long-Term Memory (Context)\n    const memory = await this.vectorService.search(query, 5);\n    const relevantContext = memory.map(m => (m as any).content || m.text || '').join('\\n');\n\n    logger.debug(`Retrieved ${memory.length} memory fragments`);\n\n    // 2. Decide Strategy via Semantic Router\n    const route = 'default'; // Simplified for now\n\n    // 3. Execute Action (Placeholder for now)\n    // Here we would switch based on 'route' (e.g. valid tool call, simple chat, etc.)\n\n    return {\n      query,\n      route,\n      context: relevantContext,\n      response: `[Agent] Processed via vector memory. Route: ${(route as any).type || route}`,\n    };\n  }\n\n  public async saveExperience(userId: string, content: string, metadata?: any): Promise<void> {\n    const doc = {\n      id: `${userId}-${Date.now()}`,\n      text: content,\n      metadata: { ...metadata, userId },\n    };\n    await this.vectorService.upsert(doc);\n    logger.info(`Agent saved new experience for user ${userId}`);\n  }\n}\n"],"version":3}