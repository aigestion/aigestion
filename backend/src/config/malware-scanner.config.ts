import path from 'path';

/**
 * Malware Scanner Configuration
 */
export const malwareScannerConfig = {
  /**
   * Directory where infected files and their metadata are stored
   */
  quarantineDir: path.join(process.cwd(), 'quarantine'),

  /**
   * Directory for temporary uploads before scanning
   */
  uploadDir: path.join(process.cwd(), 'uploads'),

  /**
   * Cache timeout for scan results (5 minutes)
   */
  cacheTimeout: 5 * 60 * 1000,

  /**
   * Maximum file size allowed for uploads (10MB)
   */
  maxFileSize: 10 * 1024 * 1024,

  /**
   * Maximum number of files in a single request
   */
  maxFiles: 5,

  /**
   * Path to YARA rules file
   */
  yaraRulesPath: process.env.YARA_RULES_PATH || '/usr/share/yara/rules/malware.yar',

  /**
   * Number of days to keep files in quarantine before automatic deletion
   */
  quarantineRetentionDays: 30,

  /**
   * Allowed MIME types for uploaded files
   */
  allowedMimeTypes: [
    'image/jpeg',
    'image/png',
    'image/gif',
    'image/webp',
    'application/pdf',
    'text/plain',
    'application/json',
    'text/csv',
    'application/vnd.ms-excel',
    'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',
    'application/msword',
    'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
  ],
};
