import{j as e}from"./vendor-3d-CTa5dsNI.js";import{h as t,r}from"./vendor-react-C91fTXKM.js";import{a as n}from"./api-C4qJlA7Y.js";import{e as o}from"./main-CxnbXITZ.js";import{A as s,f as a,au as l,ah as f,av as u,a7 as c,aw as h,g as d,Z as p,P as y,ax as g,J as w}from"./vendor-ui-KKjElUIq.js";import{A as m,m as b}from"./vendor-motion-DnYhxDjc.js";import"./index-D9FR0nMa.js";import"./useAuth-CdTKzB0b.js";import"./vendor-data-CncgVCKE.js";import"./TiltCard-C6XZQ9v4.js";function x(e){const t=new Uint8Array(e);let r="";for(const n of t)r+=String.fromCharCode(n);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function A(e){const t=e.replace(/-/g,"+").replace(/_/g,"/"),r=(4-t.length%4)%4,n=t.padEnd(t.length+r,"="),o=atob(n),i=new ArrayBuffer(o.length),s=new Uint8Array(i);for(let a=0;a<o.length;a++)s[a]=o.charCodeAt(a);return i}function v(){return E.stubThis(void 0!==globalThis?.PublicKeyCredential&&"function"==typeof globalThis.PublicKeyCredential)}const E={stubThis:e=>e};function R(e){const{id:t}=e;return{...e,id:A(t),transports:e.transports}}function B(e){return"localhost"===e||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}class N extends Error{constructor({message:e,code:t,cause:r,name:n}){super(e,{cause:r}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=n??r.name,this.code=t}}const _=new class{constructor(){Object.defineProperty(this,"controller",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}createNewAbortSignal(){if(this.controller){const e=new Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}},U=["cross-platform","platform"];function I(e){if(e&&!(U.indexOf(e)<0))return e}async function S(e){!e.optionsJSON&&e.challenge&&(e={optionsJSON:e});const{optionsJSON:t,useAutoRegister:r=!1}=e;if(!v())throw new Error("WebAuthn is not supported in this browser");const n={...t,challenge:A(t.challenge),user:{...t.user,id:A(t.user.id)},excludeCredentials:t.excludeCredentials?.map(R)},o={};let i;r&&(o.mediation="conditional"),o.publicKey=n,o.signal=_.createNewAbortSignal();try{i=await navigator.credentials.create(o)}catch(p){throw function({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new N({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if("ConstraintError"===e.name){if(!0===r.authenticatorSelection?.requireResidentKey)return new N({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if("conditional"===t.mediation&&"required"===r.authenticatorSelection?.userVerification)return new N({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if("required"===r.authenticatorSelection?.userVerification)return new N({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if("InvalidStateError"===e.name)return new N({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if("NotAllowedError"===e.name)return new N({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if("NotSupportedError"===e.name)return 0===r.pubKeyCredParams.filter(e=>"public-key"===e.type).length?new N({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new N({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if("SecurityError"===e.name){const t=globalThis.location.hostname;if(!B(t))return new N({message:`${globalThis.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(r.rp.id!==t)return new N({message:`The RP ID "${r.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("TypeError"===e.name){if(r.user.id.byteLength<1||r.user.id.byteLength>64)return new N({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if("UnknownError"===e.name)return new N({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return e}({error:p,options:o})}if(!i)throw new Error("Registration was not completed");const{id:s,rawId:a,response:l,type:f}=i;let u,c,h,d;if("function"==typeof l.getTransports&&(u=l.getTransports()),"function"==typeof l.getPublicKeyAlgorithm)try{c=l.getPublicKeyAlgorithm()}catch(y){T("getPublicKeyAlgorithm()",y)}if("function"==typeof l.getPublicKey)try{const e=l.getPublicKey();null!==e&&(h=x(e))}catch(y){T("getPublicKey()",y)}if("function"==typeof l.getAuthenticatorData)try{d=x(l.getAuthenticatorData())}catch(y){T("getAuthenticatorData()",y)}return{id:s,rawId:x(a),response:{attestationObject:x(l.attestationObject),clientDataJSON:x(l.clientDataJSON),transports:u,publicKeyAlgorithm:c,publicKey:h,authenticatorData:d},type:f,clientExtensionResults:i.getClientExtensionResults(),authenticatorAttachment:I(i.authenticatorAttachment)}}function T(e,t){}const O={stubThis:e=>e};async function C(e){!e.optionsJSON&&e.challenge&&(e={optionsJSON:e});const{optionsJSON:t,useBrowserAutofill:r=!1,verifyBrowserAutofillInput:n=!0}=e;if(!v())throw new Error("WebAuthn is not supported in this browser");let o;0!==t.allowCredentials?.length&&(o=t.allowCredentials?.map(R));const i={...t,challenge:A(t.challenge),allowCredentials:o},s={};if(r){if(!(await function(){if(!v())return O.stubThis(new Promise(e=>e(!1)));const e=globalThis.PublicKeyCredential;return void 0===e?.isConditionalMediationAvailable?O.stubThis(new Promise(e=>e(!1))):O.stubThis(e.isConditionalMediationAvailable())}()))throw Error("Browser does not support WebAuthn autofill");if(document.querySelectorAll("input[autocomplete$='webauthn']").length<1&&n)throw Error('No <input> with "webauthn" as the only or last value in its `autocomplete` attribute was detected');s.mediation="conditional",i.allowCredentials=[]}let a;s.publicKey=i,s.signal=_.createNewAbortSignal();try{a=await navigator.credentials.get(s)}catch(d){throw function({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new N({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if("NotAllowedError"===e.name)return new N({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if("SecurityError"===e.name){const t=globalThis.location.hostname;if(!B(t))return new N({message:`${globalThis.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(r.rpId!==t)return new N({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("UnknownError"===e.name)return new N({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return e}({error:d,options:s})}if(!a)throw new Error("Authentication was not completed");const{id:l,rawId:f,response:u,type:c}=a;let h;return u.userHandle&&(h=x(u.userHandle)),{id:l,rawId:x(f),response:{authenticatorData:x(u.authenticatorData),clientDataJSON:x(u.clientDataJSON),signature:x(u.signature),userHandle:h},type:c,clientExtensionResults:a.getClientExtensionResults(),authenticatorAttachment:I(a.authenticatorAttachment)}}for(var M={},L={},D={},P={byteLength:function(e){var t=V(e),r=t[0],n=t[1];return 3*(r+n)/4-n},toByteArray:function(e){var t,r,n=V(e),o=n[0],i=n[1],s=new z(function(e,t,r){return 3*(t+r)/4-r}(0,o,i)),a=0,l=i>0?o-4:o;for(r=0;r<l;r+=4)t=K[e.charCodeAt(r)]<<18|K[e.charCodeAt(r+1)]<<12|K[e.charCodeAt(r+2)]<<6|K[e.charCodeAt(r+3)],s[a++]=t>>16&255,s[a++]=t>>8&255,s[a++]=255&t;2===i&&(t=K[e.charCodeAt(r)]<<2|K[e.charCodeAt(r+1)]>>4,s[a++]=255&t);1===i&&(t=K[e.charCodeAt(r)]<<10|K[e.charCodeAt(r+1)]<<4|K[e.charCodeAt(r+2)]>>2,s[a++]=t>>8&255,s[a++]=255&t);return s},fromByteArray:function(e){for(var t,r=e.length,n=r%3,o=[],i=16383,s=0,a=r-n;s<a;s+=i)o.push(Y(e,s,s+i>a?a:s+i));1===n?(t=e[r-1],o.push(k[t>>2]+k[t<<4&63]+"==")):2===n&&(t=(e[r-2]<<8)+e[r-1],o.push(k[t>>10]+k[t>>4&63]+k[t<<2&63]+"="));return o.join("")}},k=[],K=[],z="undefined"!=typeof Uint8Array?Uint8Array:Array,G="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",H=0;H<64;++H)k[H]=G[H],K[G.charCodeAt(H)]=H;function V(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function F(e){return k[e>>18&63]+k[e>>12&63]+k[e>>6&63]+k[63&e]}function Y(e,t,r){for(var n,o=[],i=t;i<r;i+=3)n=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]),o.push(F(n));return o.join("")}K["-".charCodeAt(0)]=62,K["_".charCodeAt(0)]=63;var $={
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
read:function(e,t,r,n,o){var i,s,a=8*o-n-1,l=(1<<a)-1,f=l>>1,u=-7,c=r?o-1:0,h=r?-1:1,d=e[t+c];for(c+=h,i=d&(1<<-u)-1,d>>=-u,u+=a;u>0;i=256*i+e[t+c],c+=h,u-=8);for(s=i&(1<<-u)-1,i>>=-u,u+=n;u>0;s=256*s+e[t+c],c+=h,u-=8);if(0===i)i=1-f;else{if(i===l)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,n),i-=f}return(d?-1:1)*s*Math.pow(2,i-n)},write:function(e,t,r,n,o,i){var s,a,l,f=8*i-o-1,u=(1<<f)-1,c=u>>1,h=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:i-1,p=n?1:-1,y=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),(t+=s+c>=1?h/l:h*Math.pow(2,1-c))*l>=2&&(s++,l/=2),s+c>=u?(a=0,s=u):s+c>=1?(a=(t*l-1)*Math.pow(2,o),s+=c):(a=t*Math.pow(2,c-1)*Math.pow(2,o),s=0));o>=8;e[r+d]=255&a,d+=p,a/=256,o-=8);for(s=s<<o|a,f+=o;f>0;e[r+d]=255&s,d+=p,s/=256,f-=8);e[r+d-p]|=128*y}};
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
!function(e){const t=P,r=$,n="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=s,e.SlowBuffer=function(e){+e!=e&&(e=0);return s.alloc(+e)},e.INSPECT_MAX_BYTES=50;const o=2147483647;function i(e){if(e>o)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,s.prototype),t}function s(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return f(e)}return a(e,t,r)}function a(e,t,r){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!s.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const r=0|d(e,t);let n=i(r);const o=n.write(e,t);o!==r&&(n=n.slice(0,o));return n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(J(e,Uint8Array)){const t=new Uint8Array(e);return c(t.buffer,t.byteOffset,t.byteLength)}return u(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(J(e,ArrayBuffer)||e&&J(e.buffer,ArrayBuffer))return c(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&(J(e,SharedArrayBuffer)||e&&J(e.buffer,SharedArrayBuffer)))return c(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return s.from(n,t,r);const o=function(e){if(s.isBuffer(e)){const t=0|h(e.length),r=i(t);return 0===r.length||e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!=typeof e.length||W(e.length)?i(0):u(e);if("Buffer"===e.type&&Array.isArray(e.data))return u(e.data)}(e);if(o)return o;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return s.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function f(e){return l(e),i(e<0?0:0|h(e))}function u(e){const t=e.length<0?0:0|h(e.length),r=i(t);for(let n=0;n<t;n+=1)r[n]=255&e[n];return r}function c(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,s.prototype),n}function h(e){if(e>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|e}function d(e,t){if(s.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||J(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let o=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return F(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return Y(e).length;default:if(o)return n?-1:F(e).length;t=(""+t).toLowerCase(),o=!0}}function p(e,t,r){let n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return _(this,t,r);case"utf8":case"utf-8":return R(this,t,r);case"ascii":return j(this,t,r);case"latin1":case"binary":return N(this,t,r);case"base64":return E(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function y(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function g(e,t,r,n,o){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),W(r=+r)&&(r=o?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(o)return-1;r=e.length-1}else if(r<0){if(!o)return-1;r=0}if("string"==typeof t&&(t=s.from(t,n)),s.isBuffer(t))return 0===t.length?-1:w(e,t,r,n,o);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):w(e,[t],r,n,o);throw new TypeError("val must be string, number or Buffer")}function w(e,t,r,n,o){let i,s=1,a=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,a/=2,l/=2,r/=2}function f(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(o){let n=-1;for(i=r;i<a;i++)if(f(e,i)===f(t,-1===n?0:i-n)){if(-1===n&&(n=i),i-n+1===l)return n*s}else-1!==n&&(i-=i-n),n=-1}else for(r+l>a&&(r=a-l),i=r;i>=0;i--){let r=!0;for(let n=0;n<l;n++)if(f(e,i+n)!==f(t,n)){r=!1;break}if(r)return i}return-1}function m(e,t,r,n){r=Number(r)||0;const o=e.length-r;n?(n=Number(n))>o&&(n=o):n=o;const i=t.length;let s;for(n>i/2&&(n=i/2),s=0;s<n;++s){const n=parseInt(t.substr(2*s,2),16);if(W(n))return s;e[r+s]=n}return s}function b(e,t,r,n){return q(F(t,e.length-r),e,r,n)}function x(e,t,r,n){return q(function(e){const t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function A(e,t,r,n){return q(Y(t),e,r,n)}function v(e,t,r,n){return q(function(e,t){let r,n,o;const i=[];for(let s=0;s<e.length&&!((t-=2)<0);++s)r=e.charCodeAt(s),n=r>>8,o=r%256,i.push(o),i.push(n);return i}(t,e.length-r),e,r,n)}function E(e,r,n){return 0===r&&n===e.length?t.fromByteArray(e):t.fromByteArray(e.slice(r,n))}function R(e,t,r){r=Math.min(e.length,r);const n=[];let o=t;for(;o<r;){const t=e[o];let i=null,s=t>239?4:t>223?3:t>191?2:1;if(o+s<=r){let r,n,a,l;switch(s){case 1:t<128&&(i=t);break;case 2:r=e[o+1],128==(192&r)&&(l=(31&t)<<6|63&r,l>127&&(i=l));break;case 3:r=e[o+1],n=e[o+2],128==(192&r)&&128==(192&n)&&(l=(15&t)<<12|(63&r)<<6|63&n,l>2047&&(l<55296||l>57343)&&(i=l));break;case 4:r=e[o+1],n=e[o+2],a=e[o+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(l=(15&t)<<18|(63&r)<<12|(63&n)<<6|63&a,l>65535&&l<1114112&&(i=l))}}null===i?(i=65533,s=1):i>65535&&(i-=65536,n.push(i>>>10&1023|55296),i=56320|1023&i),n.push(i),o+=s}return function(e){const t=e.length;if(t<=B)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=B));return r}(n)}e.kMaxLength=o,s.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),!s.TYPED_ARRAY_SUPPORT&&"undefined"!=typeof console&&console.error,Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}}),s.poolSize=8192,s.from=function(e,t,r){return a(e,t,r)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array),s.alloc=function(e,t,r){return function(e,t,r){return l(e),e<=0?i(e):void 0!==t?"string"==typeof r?i(e).fill(t,r):i(e).fill(t):i(e)}(e,t,r)},s.allocUnsafe=function(e){return f(e)},s.allocUnsafeSlow=function(e){return f(e)},s.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==s.prototype},s.compare=function(e,t){if(J(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),J(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(e)||!s.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,n=t.length;for(let o=0,i=Math.min(r,n);o<i;++o)if(e[o]!==t[o]){r=e[o],n=t[o];break}return r<n?-1:n<r?1:0},s.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return s.alloc(0);let r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;const n=s.allocUnsafe(t);let o=0;for(r=0;r<e.length;++r){let t=e[r];if(J(t,Uint8Array))o+t.length>n.length?(s.isBuffer(t)||(t=s.from(t)),t.copy(n,o)):Uint8Array.prototype.set.call(n,t,o);else{if(!s.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(n,o)}o+=t.length}return n},s.byteLength=d,s.prototype._isBuffer=!0,s.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)y(this,t,t+1);return this},s.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},s.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},s.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?R(this,0,e):p.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(e){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===s.compare(this,e)},s.prototype.inspect=function(){let t="";const r=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(t+=" ... "),"<Buffer "+t+">"},n&&(s.prototype[n]=s.prototype.inspect),s.prototype.compare=function(e,t,r,n,o){if(J(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),t<0||r>e.length||n<0||o>this.length)throw new RangeError("out of range index");if(n>=o&&t>=r)return 0;if(n>=o)return-1;if(t>=r)return 1;if(this===e)return 0;let i=(o>>>=0)-(n>>>=0),a=(r>>>=0)-(t>>>=0);const l=Math.min(i,a),f=this.slice(n,o),u=e.slice(t,r);for(let s=0;s<l;++s)if(f[s]!==u[s]){i=f[s],a=u[s];break}return i<a?-1:a<i?1:0},s.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},s.prototype.indexOf=function(e,t,r){return g(this,e,t,r,!0)},s.prototype.lastIndexOf=function(e,t,r){return g(this,e,t,r,!1)},s.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const o=this.length-t;if((void 0===r||r>o)&&(r=o),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let i=!1;for(;;)switch(n){case"hex":return m(this,e,t,r);case"utf8":case"utf-8":return b(this,e,t,r);case"ascii":case"latin1":case"binary":return x(this,e,t,r);case"base64":return A(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return v(this,e,t,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const B=4096;function j(e,t,r){let n="";r=Math.min(e.length,r);for(let o=t;o<r;++o)n+=String.fromCharCode(127&e[o]);return n}function N(e,t,r){let n="";r=Math.min(e.length,r);for(let o=t;o<r;++o)n+=String.fromCharCode(e[o]);return n}function _(e,t,r){const n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);let o="";for(let i=t;i<r;++i)o+=Z[e[i]];return o}function U(e,t,r){const n=e.slice(t,r);let o="";for(let i=0;i<n.length-1;i+=2)o+=String.fromCharCode(n[i]+256*n[i+1]);return o}function I(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function S(e,t,r,n,o,i){if(!s.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<i)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function T(e,t,r,n,o){z(t,n,o,e,r,7);let i=Number(t&BigInt(4294967295));e[r++]=i,i>>=8,e[r++]=i,i>>=8,e[r++]=i,i>>=8,e[r++]=i;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,r}function O(e,t,r,n,o){z(t,n,o,e,r,7);let i=Number(t&BigInt(4294967295));e[r+7]=i,i>>=8,e[r+6]=i,i>>=8,e[r+5]=i,i>>=8,e[r+4]=i;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=s,s>>=8,e[r+2]=s,s>>=8,e[r+1]=s,s>>=8,e[r]=s,r+8}function C(e,t,r,n,o,i){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function M(e,t,n,o,i){return t=+t,n>>>=0,i||C(e,0,n,4),r.write(e,t,n,o,23,4),n+4}function L(e,t,n,o,i){return t=+t,n>>>=0,i||C(e,0,n,8),r.write(e,t,n,o,52,8),n+8}s.prototype.slice=function(e,t){const r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);const n=this.subarray(e,t);return Object.setPrototypeOf(n,s.prototype),n},s.prototype.readUintLE=s.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||I(e,t,this.length);let n=this[e],o=1,i=0;for(;++i<t&&(o*=256);)n+=this[e+i]*o;return n},s.prototype.readUintBE=s.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||I(e,t,this.length);let n=this[e+--t],o=1;for(;t>0&&(o*=256);)n+=this[e+--t]*o;return n},s.prototype.readUint8=s.prototype.readUInt8=function(e,t){return e>>>=0,t||I(e,1,this.length),this[e]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(e,t){return e>>>=0,t||I(e,2,this.length),this[e]|this[e+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(e,t){return e>>>=0,t||I(e,2,this.length),this[e]<<8|this[e+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(e,t){return e>>>=0,t||I(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(e,t){return e>>>=0,t||I(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},s.prototype.readBigUInt64LE=Q(function(e){G(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||H(e,this.length-8);const n=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,o=this[++e]+256*this[++e]+65536*this[++e]+r*2**24;return BigInt(n)+(BigInt(o)<<BigInt(32))}),s.prototype.readBigUInt64BE=Q(function(e){G(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||H(e,this.length-8);const n=t*2**24+65536*this[++e]+256*this[++e]+this[++e],o=this[++e]*2**24+65536*this[++e]+256*this[++e]+r;return(BigInt(n)<<BigInt(32))+BigInt(o)}),s.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||I(e,t,this.length);let n=this[e],o=1,i=0;for(;++i<t&&(o*=256);)n+=this[e+i]*o;return o*=128,n>=o&&(n-=Math.pow(2,8*t)),n},s.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||I(e,t,this.length);let n=t,o=1,i=this[e+--n];for(;n>0&&(o*=256);)i+=this[e+--n]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*t)),i},s.prototype.readInt8=function(e,t){return e>>>=0,t||I(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},s.prototype.readInt16LE=function(e,t){e>>>=0,t||I(e,2,this.length);const r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt16BE=function(e,t){e>>>=0,t||I(e,2,this.length);const r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt32LE=function(e,t){return e>>>=0,t||I(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},s.prototype.readInt32BE=function(e,t){return e>>>=0,t||I(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},s.prototype.readBigInt64LE=Q(function(e){G(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||H(e,this.length-8);const n=this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)}),s.prototype.readBigInt64BE=Q(function(e){G(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||H(e,this.length-8);const n=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+r)}),s.prototype.readFloatLE=function(e,t){return e>>>=0,t||I(e,4,this.length),r.read(this,e,!0,23,4)},s.prototype.readFloatBE=function(e,t){return e>>>=0,t||I(e,4,this.length),r.read(this,e,!1,23,4)},s.prototype.readDoubleLE=function(e,t){return e>>>=0,t||I(e,8,this.length),r.read(this,e,!0,52,8)},s.prototype.readDoubleBE=function(e,t){return e>>>=0,t||I(e,8,this.length),r.read(this,e,!1,52,8)},s.prototype.writeUintLE=s.prototype.writeUIntLE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){S(this,e,t,r,Math.pow(2,8*r)-1,0)}let o=1,i=0;for(this[t]=255&e;++i<r&&(o*=256);)this[t+i]=e/o&255;return t+r},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){S(this,e,t,r,Math.pow(2,8*r)-1,0)}let o=r-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+r},s.prototype.writeUint8=s.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||S(this,e,t,1,255,0),this[t]=255&e,t+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||S(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||S(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||S(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||S(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeBigUInt64LE=Q(function(e,t=0){return T(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),s.prototype.writeBigUInt64BE=Q(function(e,t=0){return O(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),s.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);S(this,e,t,r,n-1,-n)}let o=0,i=1,s=0;for(this[t]=255&e;++o<r&&(i*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/i|0)-s&255;return t+r},s.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);S(this,e,t,r,n-1,-n)}let o=r-1,i=1,s=0;for(this[t+o]=255&e;--o>=0&&(i*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/i|0)-s&255;return t+r},s.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||S(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},s.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||S(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||S(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||S(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},s.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||S(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeBigInt64LE=Q(function(e,t=0){return T(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),s.prototype.writeBigInt64BE=Q(function(e,t=0){return O(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),s.prototype.writeFloatLE=function(e,t,r){return M(this,e,t,!0,r)},s.prototype.writeFloatBE=function(e,t,r){return M(this,e,t,!1,r)},s.prototype.writeDoubleLE=function(e,t,r){return L(this,e,t,!0,r)},s.prototype.writeDoubleBE=function(e,t,r){return L(this,e,t,!1,r)},s.prototype.copy=function(e,t,r,n){if(!s.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);const o=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),o},s.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!s.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){const t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;let o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(o=t;o<r;++o)this[o]=e;else{const i=s.isBuffer(e)?e:s.from(e,n),a=i.length;if(0===a)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<r-t;++o)this[o+t]=i[o%a]}return this};const D={};function k(e,t,r){D[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function K(e){let t="",r=e.length;const n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function z(e,t,r,n,o,i){if(e>r||e<t){const r="bigint"==typeof t?"n":"";let n;throw n=0===t||t===BigInt(0)?`>= 0${r} and < 2${r} ** ${8*(i+1)}${r}`:`>= -(2${r} ** ${8*(i+1)-1}${r}) and < 2 ** ${8*(i+1)-1}${r}`,new D.ERR_OUT_OF_RANGE("value",n,e)}!function(e,t,r){G(t,"offset"),void 0!==e[t]&&void 0!==e[t+r]||H(t,e.length-(r+1))}(n,o,i)}function G(e,t){if("number"!=typeof e)throw new D.ERR_INVALID_ARG_TYPE(t,"number",e)}function H(e,t,r){if(Math.floor(e)!==e)throw G(e,r),new D.ERR_OUT_OF_RANGE("offset","an integer",e);if(t<0)throw new D.ERR_BUFFER_OUT_OF_BOUNDS;throw new D.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${t}`,e)}k("ERR_BUFFER_OUT_OF_BOUNDS",function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),k("ERR_INVALID_ARG_TYPE",function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`},TypeError),k("ERR_OUT_OF_RANGE",function(e,t,r){let n=`The value of "${e}" is out of range.`,o=r;return Number.isInteger(r)&&Math.abs(r)>2**32?o=K(String(r)):"bigint"==typeof r&&(o=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(o=K(o)),o+="n"),n+=` It must be ${t}. Received ${o}`,n},RangeError);const V=/[^+/0-9A-Za-z-_]/g;function F(e,t){let r;t=t||1/0;const n=e.length;let o=null;const i=[];for(let s=0;s<n;++s){if(r=e.charCodeAt(s),r>55295&&r<57344){if(!o){if(r>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&i.push(239,191,189);continue}o=r;continue}if(r<56320){(t-=3)>-1&&i.push(239,191,189),o=r;continue}r=65536+(o-55296<<10|r-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function Y(e){return t.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(V,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function q(e,t,r,n){let o;for(o=0;o<n&&!(o+r>=t.length||o>=e.length);++o)t[o+r]=e[o];return o}function J(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function W(e){return e!=e}const Z=function(){const e="0123456789abcdef",t=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let o=0;o<16;++o)t[n+o]=e[r]+e[o]}return t}();function Q(e){return"undefined"==typeof BigInt?X:e}function X(){throw new Error("BigInt not supported")}}(D);var q={},J={},W={},Z=function(e,t){return function(r,n){var o=2*n,i=2*t;r[o]=e[i],r[o+1]=e[i+1]}};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t,r=(t=Z)&&t.__esModule?t:{default:t};var n=function(e){for(var t=e.A,n=e.C,o=0;o<25;o+=5){for(var i=0;i<5;i++)(0,r.default)(t,o+i)(n,i);for(var s=0;s<5;s++){var a=2*(o+s),l=(s+1)%5*2,f=(s+2)%5*2;t[a]^=~n[l]&n[f],t[a+1]^=~n[l+1]&n[f+1]}}};e.default=n}(W);var Q={},X={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=new Uint32Array([0,1,0,32898,2147483648,32906,2147483648,2147516416,0,32907,0,2147483649,2147483648,2147516545,2147483648,32777,0,138,0,136,0,2147516425,0,2147483658,0,2147516555,2147483648,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,0,32778,2147483648,2147483658,2147483648,2147516545,2147483648,32896,0,2147483649,2147483648,2147516424]);e.default=t}(X),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t,r=(t=X)&&t.__esModule?t:{default:t};var n=function(e){var t=e.A,n=2*e.roundIndex;t[0]^=r.default[n],t[1]^=r.default[n+1]};e.default=n}(Q);var ee={},te={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=[10,7,11,17,18,3,5,16,8,21,24,4,15,23,19,13,12,2,20,14,22,9,6,1];e.default=t}(te);var re={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=[1,3,6,10,15,21,28,36,45,55,2,14,27,41,56,8,25,43,62,18,39,61,20,44];e.default=t}(re),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=o(te),r=o(re),n=o(Z);function o(e){return e&&e.__esModule?e:{default:e}}var i=function(e){var o=e.A,i=e.C,s=e.W;(0,n.default)(o,1)(s,0);for(var a=0,l=0,f=0,u=32,c=0;c<24;c++){var h=t.default[c],d=r.default[c];(0,n.default)(o,h)(i,0),a=s[0],l=s[1],u=32-d,s[f=d<32?0:1]=a<<d|l>>>u,s[(f+1)%2]=l<<d|a>>>u,(0,n.default)(s,0)(o,h),(0,n.default)(i,0)(s,0)}};e.default=i}(ee);var ne={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t,r=(t=Z)&&t.__esModule?t:{default:t};var n=function(e){for(var t=e.A,n=e.C,o=e.D,i=e.W,s=0,a=0,l=0;l<5;l++){var f=2*l,u=2*(l+5),c=2*(l+10),h=2*(l+15),d=2*(l+20);n[f]=t[f]^t[u]^t[c]^t[h]^t[d],n[f+1]=t[f+1]^t[u+1]^t[c+1]^t[h+1]^t[d+1]}for(var p=0;p<5;p++){(0,r.default)(n,(p+1)%5)(i,0),s=i[0],a=i[1],i[0]=s<<1|a>>>31,i[1]=a<<1|s>>>31,o[2*p]=n[(p+4)%5*2]^i[0],o[2*p+1]=n[(p+4)%5*2+1]^i[1];for(var y=0;y<25;y+=5)t[2*(y+p)]^=o[2*p],t[2*(y+p)+1]^=o[2*p+1]}};e.default=n}(ne),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=i(W),r=i(Q),n=i(ee),o=i(ne);function i(e){return e&&e.__esModule?e:{default:e}}var s=function(){var e=new Uint32Array(10),i=new Uint32Array(10),s=new Uint32Array(2);return function(a){for(var l=0;l<24;l++)(0,o.default)({A:a,C:e,D:i,W:s}),(0,n.default)({A:a,C:e,W:s}),(0,t.default)({A:a,C:e}),(0,r.default)({A:a,roundIndex:l});e.fill(0),i.fill(0),s.fill(0)}};e.default=s}(J),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t,r=D,n=(t=J)&&t.__esModule?t:{default:t};var o=function(e,t){for(var r=0;r<e.length;r+=8){var n=r/4;t[n]^=e[r+7]<<24|e[r+6]<<16|e[r+5]<<8|e[r+4],t[n+1]^=e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]}return t},i=function(e,t){for(var r=0;r<t.length;r+=8){var n=r/4;t[r]=e[n+1],t[r+1]=e[n+1]>>>8,t[r+2]=e[n+1]>>>16,t[r+3]=e[n+1]>>>24,t[r+4]=e[n],t[r+5]=e[n]>>>8,t[r+6]=e[n]>>>16,t[r+7]=e[n]>>>24}return t},s=function(e){var t=this,s=e.capacity,a=e.padding,l=(0,n.default)(),f=s/8,u=200-s/4,c=0,h=new Uint32Array(50),d=r.Buffer.allocUnsafe(u);return this.absorb=function(e){for(var r=0;r<e.length;r++)d[c]=e[r],(c+=1)>=u&&(o(d,h),l(h),c=0);return t},this.squeeze=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={buffer:e.buffer||r.Buffer.allocUnsafe(f),padding:e.padding||a,queue:r.Buffer.allocUnsafe(d.length),state:new Uint32Array(h.length)};d.copy(t.queue);for(var n=0;n<h.length;n++)t.state[n]=h[n];t.queue.fill(0,c),t.queue[c]|=t.padding,t.queue[u-1]|=128,o(t.queue,t.state);for(var s=0;s<t.buffer.length;s+=u)l(t.state),i(t.state,t.buffer.slice(s,s+u));return t.buffer},this.reset=function(){return d.fill(0),h.fill(0),c=0,t},this};e.default=s}(q),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.SHAKE=e.SHA3Hash=e.SHA3=e.Keccak=void 0;var t,r=D,n=(t=q)&&t.__esModule?t:{default:t};var o=function(e){var t=e.allowedSizes,o=e.defaultSize,i=e.padding;return function e(){var s=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o;if(!this||this.constructor!==e)return new e(a);if(t&&!t.includes(a))throw new Error("Unsupported hash length");var l=new n.default({capacity:a});return this.update=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";if(r.Buffer.isBuffer(e))return l.absorb(e),s;if("string"==typeof e)return s.update(r.Buffer.from(e,t));throw new TypeError("Not a string or buffer")},this.digest=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"binary",t="string"==typeof e?{format:e}:e,r=l.squeeze({buffer:t.buffer,padding:t.padding||i});return t.format&&"binary"!==t.format?r.toString(t.format):r},this.reset=function(){return l.reset(),s},this}},i=o({allowedSizes:[224,256,384,512],defaultSize:512,padding:1});e.Keccak=i;var s=o({allowedSizes:[224,256,384,512],defaultSize:512,padding:6});e.SHA3=s;var a=o({allowedSizes:[128,256],defaultSize:256,padding:31});e.SHAKE=a;var l=i;e.SHA3Hash=l,s.SHA3Hash=l;var f=s;e.default=f}(L);const oe=t(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"}))),{SHA3:ie,SHAKE:se}=L,ae=oe.webcrypto,le=[2285,2571,2970,1812,1493,1422,287,202,3158,622,1577,182,962,2127,1855,1468,573,2004,264,383,2500,1458,1727,3199,2648,1017,732,608,1787,411,3124,1758,1223,652,2777,1015,2036,1491,3047,1785,516,3321,3009,2663,1711,2167,126,1469,2476,3239,3058,830,107,1908,3082,2378,2931,961,1821,2604,448,2264,677,2054,2226,430,555,843,2078,871,1550,105,422,587,177,3094,3038,2869,1574,1653,3083,778,1159,3182,2552,1483,2727,1119,1739,644,2457,349,418,329,3173,3254,817,1097,603,610,1322,2044,1864,384,2114,3193,1218,1994,2455,220,2142,1670,2144,1799,2051,794,1819,2475,2459,478,3221,3021,996,991,958,1869,1522,1628],fe=[1701,1807,1460,2371,2338,2333,308,108,2851,870,854,1510,2535,1278,1530,1185,1659,1187,3109,874,1335,2111,136,1215,2945,1465,1285,2007,2719,2726,2232,2512,75,156,3e3,2911,2980,872,2685,1590,2210,602,1846,777,147,2170,2551,246,1676,1755,460,291,235,3152,2742,2907,3224,1779,2458,1251,2486,2774,2899,1103,1275,2652,1065,2881,725,1508,2368,398,951,247,1421,3222,2499,271,90,853,1860,3203,1162,1618,666,320,8,2813,1544,282,1838,1293,2314,552,2677,2106,1571,205,2918,1542,2721,2597,2312,681,130,1602,1871,829,2946,3065,1325,2756,1861,1474,1202,2367,3147,1752,2707,171,3127,3042,1907,1836,1517,359,758,1441],ue=256,ce=3329;function he(e,t,r){let n,o,s=new Array(2);for(let i=0;i<2;i++)n=384*i,o=384*(i+1),s[i]=pe(e.slice(n,o));let a=ye(e.slice(768,800),!0),l=new Array(2),f=0;for(let i=0;i<2;i++)l[i]=we(r,f),f+=1;let u=new Array(2);for(let i=0;i<2;i++)u[i]=me(r,f),f+=1;let c=me(r,f);for(let i=0;i<2;i++)l[i]=ve(l[i]);for(let i=0;i<2;i++)l[i]=Re(l[i]);let h=new Array(2);for(i=0;i<2;i++)h[i]=_e(a[i],l);for(let i=0;i<2;i++)h[i]=Te(h[i]);for(let i=0;i<2;i++)h[i]=Se(h[i],u[i]);let d=function(e){let t,r=new Array(384).fill(0);for(let n=0;n<32;n++)for(let o=0;o<8;o++)t=-1*Me(e[n]>>o&1),r[8*n+o]=t&Me(1665);return r}(t),p=_e(s,l);p=Te(p),p=Se(p,c),p=Se(p,d);for(let i=0;i<2;i++)h[i]=Re(h[i]);p=Re(p);let y=function(e){let t=0,r=new Array(640),n=new Array(4);for(let o=0;o<2;o++)for(let i=0;i<64;i++){for(let t=0;t<4;t++)n[t]=(1664.5+(e[o][4*i+t]<<10))/ce&1023;r[t+0]=Ce(n[0]|0),r[t+1]=Ce(n[0]>>8|n[1]<<2),r[t+2]=Ce(n[1]>>6|n[2]<<4),r[t+3]=Ce(n[2]>>4|n[3]<<6),r[t+4]=Ce(n[3]>>2),t+=5}return r}(h),g=function(e){let t=0,r=new Array(128),n=new Array(8);for(let o=0;o<32;o++){for(let t=0;t<8;t++)n[t]=15&Ce((1664.5+(e[8*o+t]<<4))/ce);r[t+0]=n[0]|n[1]<<4,r[t+1]=n[2]|n[3]<<4,r[t+2]=n[4]|n[5]<<4,r[t+3]=n[6]|n[7]<<4,t+=4}return r}(p);return y.concat(g)}function de(e){let t,r,n=new Array(384),o=Oe(e);for(let i=0;i<128;i++)t=Le(o[2*i]),r=Le(o[2*i+1]),n[3*i+0]=Ce(t|0),n[3*i+1]=Ce(t>>8)|Ce(r<<4),n[3*i+2]=Ce(r>>4);return n}function pe(e){let t=new Array(384).fill(0);for(let r=0;r<128;r++)t[2*r]=Me(4095&(Le(e[3*r+0])|Le(e[3*r+1])<<8)),t[2*r+1]=Me(4095&(Le(e[3*r+1])>>4|Le(e[3*r+2])<<4));return t}function ye(e,t){let r=new Array(2);new Array(504);const n=new se(128);let o=0;for(let i=0;i<2;i++){r[i]=new Array(2);let s=new Array(2);for(let a=0;a<2;a++){s[0]=a,s[1]=i,t&&(s[0]=i,s[1]=a),n.reset();const l=Buffer.from(e),f=Buffer.from(s);n.update(l).update(f);let u=new Uint8Array(n.digest({buffer:Buffer.alloc(672)})),c=504,h=new Array(2);for(h=ge(u.slice(0,504),c,ue),r[i][a]=h[0],o=h[1];o<ue;){let e=u.slice(504,672),t=new Array(2);t=ge(e,168,ue-o);let n=t[0],s=t[1];for(let l=o;l<ue;l++)r[i][a][l]=n[l-o];o+=s}}}return r}function ge(e,t,r){let n,o,i=new Array(384).fill(0),s=0,a=0;for(;a<r&&s+3<=t;)n=4095&(Le(e[s]|0)|Le(e[s+1])<<8),o=4095&(Le(e[s+1]>>4)|Le(e[s+2])<<4),s+=3,n<ce&&(i[a]=n,a+=1),a<r&&o<ce&&(i[a]=o,a+=1);let l=new Array(2);return l[0]=i,l[1]=a,l}function we(e,t){return function(e){let t,r,n,o,i=new Array(384).fill(0);for(let s=0;s<64;s++){t=xe(e.slice(3*s,e.length)),r=2396745&t,r+=t>>1&2396745,r+=t>>2&2396745;for(let e=0;e<4;e++)n=Me(r>>6*e+0&7),o=Me(r>>6*e+3&7),i[4*s+e]=n-o}return i}(be(192,e,t))}function me(e,t){return function(e){let t,r,n,o,i=new Array(384).fill(0);for(let s=0;s<32;s++){t=Ae(e.slice(4*s,e.length)),r=1431655765&t,r+=t>>1&1431655765;for(let e=0;e<8;e++)n=Me(r>>4*e+0&3),o=Me(r>>4*e+2&3),i[8*s+e]=n-o}return i}(be(128,e,t))}function be(e,t,r){let n=new Array(1);n[0]=r;const o=new se(256);o.reset();const i=Buffer.from(t),s=Buffer.from(n);return o.update(i).update(s),o.digest({buffer:Buffer.alloc(e)})}function xe(e){let t;return t=Pe(e[0]),t|=Pe(e[1])<<8,t|=Pe(e[2])<<16,t}function Ae(e){let t;return t=Pe(e[0]),t|=Pe(e[1])<<8,t|=Pe(e[2])<<16,t|=Pe(e[3])<<24,t}function ve(e){let t,r,n=0,o=1;for(let i=128;i>=2;i>>=1)for(let s=0;s<256;s=n+i)for(t=le[o],o+=1,n=s;n<s+i;n++)r=Ee(t,e[n+i]),e[n+i]=e[n]-r,e[n]=e[n]+r;return e}function Ee(e,t){return je(e*t)}function Re(e){for(let t=0;t<ue;t++)e[t]=Be(e[t]);return e}function Be(e){let t=5040.216431360769*e>>24;return t*=ce,e-t}function je(e){let t=Me(62209*De(e))*ce;return t=e-t,t>>=16,Me(t)}function Ne(e){for(let t=0;t<ue;t++)e[t]=je(De(e[t])*De(1353));return e}function _e(e,t){let r,n=Ue(e[0],t[0]);for(let o=1;o<2;o++)r=Ue(e[o],t[o]),n=Se(n,r);return Re(n)}function Ue(e,t){let r,n;for(let o=0;o<64;o++)r=Ie(e[4*o+0],e[4*o+1],t[4*o+0],t[4*o+1],le[64+o]),n=Ie(e[4*o+2],e[4*o+3],t[4*o+2],t[4*o+3],-le[64+o]),e[4*o+0]=r[0],e[4*o+1]=r[1],e[4*o+2]=n[0],e[4*o+3]=n[1];return e}function Ie(e,t,r,n,o){let i=new Array(2);return i[0]=Ee(t,n),i[0]=Ee(i[0],o),i[0]=i[0]+Ee(e,r),i[1]=Ee(e,n),i[1]=i[1]+Ee(t,r),i}function Se(e,t){let r=new Array(384);for(let n=0;n<ue;n++)r[n]=e[n]+t[n];return r}function Te(e){let t,r,n=0,o=0;for(let i=2;i<=128;i<<=1)for(let s=0;s<256;s=n+i)for(t=fe[o],o+=1,n=s;n<s+i;n++)r=e[n],e[n]=Be(r+e[n+i]),e[n+i]=r-e[n+i],e[n+i]=Ee(t,e[n+i]);for(n=0;n<256;n++)e[n]=Ee(e[n],fe[127]);return e}function Oe(e){for(let t=0;t<ue;t++)e[t]=e[t]-ce,e[t]=e[t]+(e[t]>>31&ce);return e}function Ce(e){return e%=256}function Me(e){let t=-32768,r=32767;return e>=t&&e<=r?e:e<t?(e+=32769,e=r+(e%=65536)):e>r?(e-=32768,e=t+(e%=65536)):void 0}function Le(e){return e%=65536}function De(e){let t=-2147483648,r=2147483647;return e>=t&&e<=r?e:e<t?(e+=2147483649,e=r+(e%=4294967296)):e>r?(e-=2147483648,e=t+(e%=4294967296)):void 0}function Pe(e){return e%=4294967296}function ke(e,t){if(e.length!=t.length)return 0;for(let r=0;r<e.length;r++)if(e[r]!=t[r])return 0;return 1}function Ke(e){return parseInt(e,16)}KeyGen512=function(){let e=function(){let e=new Uint8Array(32);ae.getRandomValues(e);const t=Buffer.from(e),r=new ie(512);r.update(t);let n=new Uint8Array(r.digest()),o=n.slice(0,32),i=n.slice(32,64),s=ye(o,!1),a=new Array(2),l=0;for(let d=0;d<2;d++)a[d]=we(i,l),l+=1;let f=new Array(2);for(let d=0;d<2;d++)f[d]=we(i,l),l+=1;for(let d=0;d<2;d++)a[d]=ve(a[d]);for(let d=0;d<2;d++)f[d]=ve(f[d]);for(let d=0;d<2;d++)a[d]=Re(a[d]);let u=new Array(2);for(let d=0;d<2;d++)u[d]=Ne(_e(s[d],a));for(let d=0;d<2;d++)u[d]=Se(u[d],f[d]);for(let d=0;d<2;d++)u[d]=Re(u[d]);let c=new Array(2);c[0]=[];let h=[];for(let d=0;d<2;d++){h=de(u[d]);for(let e=0;e<h.length;e++)c[0].push(h[e])}for(let d=0;d<o.length;d++)c[0].push(o[d]);c[1]=[],h=[];for(let d=0;d<2;d++){h=de(a[d]);for(let e=0;e<h.length;e++)c[1].push(h[e])}return c}(),t=e[0],r=e[1];const n=Buffer.from(t),o=new ie(256);o.update(n);let i=o.digest(),s=new Uint8Array(32);ae.getRandomValues(s);for(let l=0;l<t.length;l++)r.push(t[l]);for(let l=0;l<i.length;l++)r.push(i[l]);for(let l=0;l<s.length;l++)r.push(s[l]);let a=new Array(2);return a[0]=t,a[1]=r,a},Encrypt512=function(e){let t=new Uint8Array(32);ae.getRandomValues(t);const r=Buffer.from(t),n=new ie(256);n.update(r);let o=n.digest();const i=Buffer.from(e),s=new ie(256);s.update(i);let a=s.digest();const l=Buffer.from(o),f=Buffer.from(a),u=new ie(512);u.update(l).update(f);let c=new Uint8Array(u.digest()),h=c.slice(0,32),d=he(e,o,c.slice(32,64));const p=Buffer.from(d),y=new ie(256);y.update(p);let g=y.digest();const w=Buffer.from(h),m=Buffer.from(g),b=new se(256);b.update(w).update(m);let x=b.digest(),A=new Array(2);return A[0]=d,A[1]=x,A},Decrypt512=function(e,t){let r=t.slice(0,768),n=t.slice(768,1568),o=t.slice(1568,1600),i=t.slice(1600,1632),s=function(e,t){let r=function(e){let t=new Array(2);for(let o=0;o<2;o++)t[o]=new Array(384);let r=0,n=new Array(4);for(let o=0;o<2;o++)for(let i=0;i<64;i++){n[0]=Le(e[r+0])|Le(e[r+1])<<8,n[1]=Le(e[r+1])>>2|Le(e[r+2])<<6,n[2]=Le(e[r+2])>>4|Le(e[r+3])<<4,n[3]=Le(e[r+3])>>6|Le(e[r+4])<<2,r+=5;for(let e=0;e<4;e++)t[o][4*i+e]=Me(((Pe(1023&n[e])>>>0)*(Pe(ce)>>>0)>>>0)+512>>10>>>0)}return t}(e.slice(0,640)),n=function(e){let t=new Array(384),r=0;for(let n=0;n<128;n++)t[2*n+0]=Me(Le(15&e[r])*Le(ce)+8>>4),t[2*n+1]=Me(Le(e[r]>>4)*Le(ce)+8>>4),r+=1;return t}(e.slice(640,768)),o=function(e){let t,r,n=new Array(2);for(let o=0;o<2;o++)n[o]=new Array(384);for(let o=0;o<2;o++)t=384*o,r=384*(o+1),n[o]=pe(e.slice(t,r));return n}(t);for(let s=0;s<2;s++)r[s]=ve(r[s]);let i=_e(o,r);return i=Te(i),i=function(e,t){for(let r=0;r<ue;r++)e[r]=e[r]-t[r];return e}(n,i),i=Re(i),function(e){let t,r=new Array(32),n=Oe(e);for(let o=0;o<32;o++){r[o]=0;for(let e=0;e<8;e++)t=((Le(n[8*o+e])<<1)+Le(1664.5))/Le(ce)&1,r[o]|=Ce(t<<e)}return r}(i)}(e,r);const a=Buffer.from(s),l=Buffer.from(o),f=new ie(512);f.update(a).update(l);let u=new Uint8Array(f.digest()),c=u.slice(0,32),h=ke(e,he(n,s,u.slice(32,64)))-1;const d=Buffer.from(e),p=new ie(256);p.update(d);let y=p.digest(),g=[];if(h){const e=Buffer.from(i),t=Buffer.from(y),r=new se(256);r.update(e).update(t),g=r.digest()}else{const e=Buffer.from(c),t=Buffer.from(y),r=new se(256);r.update(e).update(t),g=r.digest()}return g},Test512=function(){let e=oe.readFileSync("./node_modules/crystals-kyber/PQCkemKAT_1632.rsp").toString().split("\n"),t=[],r=[],n=[],o=0;for(;o<e.length;){if("c"==e[o][0]&&"t"==e[o][1]){let t=[];for(j=0;j<768;j++)t[j]=Ke(e[o][2*j+5]+e[o][2*j+1+5]);r.push(t),o+=1;continue}if("s"==e[o][0]&&"s"==e[o][1]){let t=[];for(j=0;j<32;j++)t[j]=Ke(e[o][2*j+5]+e[o][2*j+1+5]);n.push(t),o+=1;continue}if("s"==e[o][0]&&"k"==e[o][1]){let r=[];for(j=0;j<1632;j++)r[j]=Ke(e[o][2*j+5]+e[o][2*j+1+5]);t.push(r),o+=1;continue}o+=1}let i=0;for(let c=0;c<100;c++){let e=Decrypt512(r[c],t[c]);ke(n[c],e)||(i+=1)}let s=KeyGen512(),a=s[0],l=s[1],f=Encrypt512(a),u=f[0];f[1],Decrypt512(u,l)},M.KeyGen512=KeyGen512,M.Encrypt512=Encrypt512,M.Decrypt512=Decrypt512,M.Test512=Test512;var ze={};const{SHA3:Ge,SHAKE:He}=L,Ve=oe.webcrypto,Fe=[2285,2571,2970,1812,1493,1422,287,202,3158,622,1577,182,962,2127,1855,1468,573,2004,264,383,2500,1458,1727,3199,2648,1017,732,608,1787,411,3124,1758,1223,652,2777,1015,2036,1491,3047,1785,516,3321,3009,2663,1711,2167,126,1469,2476,3239,3058,830,107,1908,3082,2378,2931,961,1821,2604,448,2264,677,2054,2226,430,555,843,2078,871,1550,105,422,587,177,3094,3038,2869,1574,1653,3083,778,1159,3182,2552,1483,2727,1119,1739,644,2457,349,418,329,3173,3254,817,1097,603,610,1322,2044,1864,384,2114,3193,1218,1994,2455,220,2142,1670,2144,1799,2051,794,1819,2475,2459,478,3221,3021,996,991,958,1869,1522,1628],Ye=[1701,1807,1460,2371,2338,2333,308,108,2851,870,854,1510,2535,1278,1530,1185,1659,1187,3109,874,1335,2111,136,1215,2945,1465,1285,2007,2719,2726,2232,2512,75,156,3e3,2911,2980,872,2685,1590,2210,602,1846,777,147,2170,2551,246,1676,1755,460,291,235,3152,2742,2907,3224,1779,2458,1251,2486,2774,2899,1103,1275,2652,1065,2881,725,1508,2368,398,951,247,1421,3222,2499,271,90,853,1860,3203,1162,1618,666,320,8,2813,1544,282,1838,1293,2314,552,2677,2106,1571,205,2918,1542,2721,2597,2312,681,130,1602,1871,829,2946,3065,1325,2756,1861,1474,1202,2367,3147,1752,2707,171,3127,3042,1907,1836,1517,359,758,1441],$e=256,qe=3329;function Je(e,t,r){let n,o,s=new Array(3);for(let i=0;i<3;i++)n=384*i,o=384*(i+1),s[i]=Ze(e.slice(n,o));let a=Qe(e.slice(1152,1184),!0),l=new Array(3),f=0;for(let i=0;i<3;i++)l[i]=et(r,f),f+=1;let u=new Array(3);for(let i=0;i<3;i++)u[i]=et(r,f),f+=1;let c=et(r,f);for(let i=0;i<3;i++)l[i]=rt(l[i]);for(let i=0;i<3;i++)l[i]=ot(l[i]);let h=new Array(3);for(i=0;i<3;i++)h[i]=lt(a[i],l);for(let i=0;i<3;i++)h[i]=ht(h[i]);for(let i=0;i<3;i++)h[i]=ct(h[i],u[i]);let d=function(e){let t,r=new Array(384).fill(0);for(let n=0;n<32;n++)for(let o=0;o<8;o++)t=-1*yt(e[n]>>o&1),r[8*n+o]=t&yt(1665);return r}(t),p=lt(s,l);p=ht(p),p=ct(p,c),p=ct(p,d);for(let i=0;i<3;i++)h[i]=ot(h[i]);p=ot(p);let y=function(e){let t=0,r=new Array(960),n=new Array(4);for(let o=0;o<3;o++)for(let i=0;i<64;i++){for(let t=0;t<4;t++)n[t]=(1664.5+(e[o][4*i+t]<<10))/qe&1023;r[t+0]=pt(n[0]|0),r[t+1]=pt(n[0]>>8|n[1]<<2),r[t+2]=pt(n[1]>>6|n[2]<<4),r[t+3]=pt(n[2]>>4|n[3]<<6),r[t+4]=pt(n[3]>>2),t+=5}return r}(h),g=function(e){let t=0,r=new Array(128),n=new Array(8);for(let o=0;o<32;o++){for(let t=0;t<8;t++)n[t]=15&pt((1664.5+(e[8*o+t]<<4))/qe);r[t+0]=n[0]|n[1]<<4,r[t+1]=n[2]|n[3]<<4,r[t+2]=n[4]|n[5]<<4,r[t+3]=n[6]|n[7]<<4,t+=4}return r}(p);return y.concat(g)}function We(e){let t,r,n=new Array(384),o=dt(e);for(let i=0;i<128;i++)t=gt(o[2*i]),r=gt(o[2*i+1]),n[3*i+0]=pt(t|0),n[3*i+1]=pt(t>>8)|pt(r<<4),n[3*i+2]=pt(r>>4);return n}function Ze(e){let t=new Array(384).fill(0);for(let r=0;r<128;r++)t[2*r]=yt(4095&(gt(e[3*r+0])|gt(e[3*r+1])<<8)),t[2*r+1]=yt(4095&(gt(e[3*r+1])>>4|gt(e[3*r+2])<<4));return t}function Qe(e,t){let r=new Array(3);new Array(504);const n=new He(128);let o=0;for(let i=0;i<3;i++){r[i]=new Array(3);let s=new Array(2);for(let a=0;a<3;a++){s[0]=a,s[1]=i,t&&(s[0]=i,s[1]=a),n.reset();const l=Buffer.from(e),f=Buffer.from(s);n.update(l).update(f);let u=new Uint8Array(n.digest({buffer:Buffer.alloc(672)})),c=504,h=new Array(2);for(h=Xe(u.slice(0,504),c,$e),r[i][a]=h[0],o=h[1];o<$e;){let e=u.slice(504,672),t=new Array(2);t=Xe(e,168,$e-o);let n=t[0],s=t[1];for(let l=o;l<$e;l++)r[i][a][l]=n[l-o];o+=s}}}return r}function Xe(e,t,r){let n,o,i=new Array(384).fill(0),s=0,a=0;for(;a<r&&s+3<=t;)n=4095&(gt(e[s]|0)|gt(e[s+1])<<8),o=4095&(gt(e[s+1]>>4)|gt(e[s+2])<<4),s+=3,n<qe&&(i[a]=n,a+=1),a<r&&o<qe&&(i[a]=o,a+=1);let l=new Array(2);return l[0]=i,l[1]=a,l}function et(e,t){let r=function(e,t,r){let n=new Array(1);n[0]=r;const o=new He(256);o.reset();const i=Buffer.from(t),s=Buffer.from(n);o.update(i).update(s);let a=o.digest({buffer:Buffer.alloc(e)});return a}(128,e,t);return function(e){let t,r,n,o,i=new Array(384).fill(0);for(let s=0;s<32;s++){t=tt(e.slice(4*s,e.length))>>>0,r=(1431655765&t)>>>0,r=r+((t>>1>>>0&1431655765)>>>0)>>>0;for(let e=0;e<8;e++)n=yt((r>>4*e+0>>>0&3)>>>0),o=yt((r>>4*e+2>>>0&3)>>>0),i[8*s+e]=n-o}return i}(r)}function tt(e){let t;return t=mt(e[0]),t=(t|mt(e[1])<<8)>>>0>>>0,t=(t|mt(e[2])<<16)>>>0>>>0,t=(t|mt(e[3])<<24)>>>0>>>0,mt(t)}function rt(e){let t,r,n=0,o=1;for(let i=128;i>=2;i>>=1)for(let s=0;s<256;s=n+i)for(t=Fe[o],o+=1,n=s;n<s+i;n++)r=nt(t,e[n+i]),e[n+i]=e[n]-r,e[n]=e[n]+r;return e}function nt(e,t){return st(e*t)}function ot(e){for(let t=0;t<$e;t++)e[t]=it(e[t]);return e}function it(e){let t=5040.216431360769*e>>24;return t*=qe,e-t}function st(e){let t=yt(62209*wt(e))*qe;return t=e-t,t>>=16,yt(t)}function at(e){for(let t=0;t<$e;t++)e[t]=st(wt(e[t])*wt(1353));return e}function lt(e,t){let r,n=ft(e[0],t[0]);for(let o=1;o<3;o++)r=ft(e[o],t[o]),n=ct(n,r);return ot(n)}function ft(e,t){let r,n;for(let o=0;o<64;o++)r=ut(e[4*o+0],e[4*o+1],t[4*o+0],t[4*o+1],Fe[64+o]),n=ut(e[4*o+2],e[4*o+3],t[4*o+2],t[4*o+3],-Fe[64+o]),e[4*o+0]=r[0],e[4*o+1]=r[1],e[4*o+2]=n[0],e[4*o+3]=n[1];return e}function ut(e,t,r,n,o){let i=new Array(2);return i[0]=nt(t,n),i[0]=nt(i[0],o),i[0]=i[0]+nt(e,r),i[1]=nt(e,n),i[1]=i[1]+nt(t,r),i}function ct(e,t){let r=new Array(384);for(let n=0;n<$e;n++)r[n]=e[n]+t[n];return r}function ht(e){let t,r,n=0,o=0;for(let i=2;i<=128;i<<=1)for(let s=0;s<256;s=n+i)for(t=Ye[o],o+=1,n=s;n<s+i;n++)r=e[n],e[n]=it(r+e[n+i]),e[n+i]=r-e[n+i],e[n+i]=nt(t,e[n+i]);for(n=0;n<256;n++)e[n]=nt(e[n],Ye[127]);return e}function dt(e){for(let t=0;t<$e;t++)e[t]=e[t]-qe,e[t]=e[t]+(e[t]>>31&qe);return e}function pt(e){return e%=256}function yt(e){let t=-32768,r=32767;return e>=t&&e<=r?e:e<t?(e+=32769,e=r+(e%=65536)):e>r?(e-=32768,e=t+(e%=65536)):void 0}function gt(e){return e%=65536}function wt(e){let t=-2147483648,r=2147483647;return e>=t&&e<=r?e:e<t?(e+=2147483649,e=r+(e%=4294967296)):e>r?(e-=2147483648,e=t+(e%=4294967296)):void 0}function mt(e){return e%=4294967296}function bt(e,t){if(e.length!=t.length)return 0;for(let r=0;r<e.length;r++)if(e[r]!=t[r])return 0;return 1}function xt(e){return parseInt(e,16)}KeyGen768=function(){let e=function(){let e=new Uint8Array(32);Ve.getRandomValues(e);const t=Buffer.from(e),r=new Ge(512);r.update(t);let n=new Uint8Array(r.digest()),o=n.slice(0,32),i=n.slice(32,64),s=Qe(o,!1),a=new Array(3),l=0;for(let d=0;d<3;d++)a[d]=et(i,l),l+=1;let f=new Array(3);for(let d=0;d<3;d++)f[d]=et(i,l),l+=1;for(let d=0;d<3;d++)a[d]=rt(a[d]);for(let d=0;d<3;d++)f[d]=rt(f[d]);for(let d=0;d<3;d++)a[d]=ot(a[d]);let u=new Array(3);for(let d=0;d<3;d++)u[d]=at(lt(s[d],a));for(let d=0;d<3;d++)u[d]=ct(u[d],f[d]);for(let d=0;d<3;d++)u[d]=ot(u[d]);let c=new Array(2);c[0]=[];let h=[];for(let d=0;d<3;d++){h=We(u[d]);for(let e=0;e<h.length;e++)c[0].push(h[e])}for(let d=0;d<o.length;d++)c[0].push(o[d]);c[1]=[],h=[];for(let d=0;d<3;d++){h=We(a[d]);for(let e=0;e<h.length;e++)c[1].push(h[e])}return c}(),t=e[0],r=e[1];const n=Buffer.from(t),o=new Ge(256);o.update(n);let i=o.digest(),s=new Uint8Array(32);Ve.getRandomValues(s);for(let l=0;l<t.length;l++)r.push(t[l]);for(let l=0;l<i.length;l++)r.push(i[l]);for(let l=0;l<s.length;l++)r.push(s[l]);let a=new Array(2);return a[0]=t,a[1]=r,a},Encrypt768=function(e){let t=new Uint8Array(32);Ve.getRandomValues(t);const r=Buffer.from(t),n=new Ge(256);n.update(r);let o=n.digest();const i=Buffer.from(e),s=new Ge(256);s.update(i);let a=s.digest();const l=Buffer.from(o),f=Buffer.from(a),u=new Ge(512);u.update(l).update(f);let c=new Uint8Array(u.digest()),h=c.slice(0,32),d=Je(e,o,c.slice(32,64));const p=Buffer.from(d),y=new Ge(256);y.update(p);let g=y.digest();const w=Buffer.from(h),m=Buffer.from(g),b=new He(256);b.update(w).update(m);let x=b.digest(),A=new Array(2);return A[0]=d,A[1]=x,A},Decrypt768=function(e,t){let r=t.slice(0,1152),n=t.slice(1152,2336),o=t.slice(2336,2368),i=t.slice(2368,2400),s=function(e,t){let r=function(e){let t=new Array(3);for(let o=0;o<3;o++)t[o]=new Array(384);let r=0,n=new Array(4);for(let o=0;o<3;o++)for(let i=0;i<64;i++){n[0]=gt(e[r+0])|gt(e[r+1])<<8,n[1]=gt(e[r+1])>>2|gt(e[r+2])<<6,n[2]=gt(e[r+2])>>4|gt(e[r+3])<<4,n[3]=gt(e[r+3])>>6|gt(e[r+4])<<2,r+=5;for(let e=0;e<4;e++)t[o][4*i+e]=yt(((mt(1023&n[e])>>>0)*(mt(qe)>>>0)>>>0)+512>>10>>>0)}return t}(e.slice(0,960)),n=function(e){let t=new Array(384),r=0;for(let n=0;n<128;n++)t[2*n+0]=yt(gt(15&e[r])*gt(qe)+8>>4),t[2*n+1]=yt(gt(e[r]>>4)*gt(qe)+8>>4),r+=1;return t}(e.slice(960,1088)),o=function(e){let t,r,n=new Array(3);for(let o=0;o<3;o++)n[o]=new Array(384);for(let o=0;o<3;o++)t=384*o,r=384*(o+1),n[o]=Ze(e.slice(t,r));return n}(t);for(let s=0;s<3;s++)r[s]=rt(r[s]);let i=lt(o,r);return i=ht(i),i=function(e,t){for(let r=0;r<$e;r++)e[r]=e[r]-t[r];return e}(n,i),i=ot(i),function(e){let t,r=new Array(32),n=dt(e);for(let o=0;o<32;o++){r[o]=0;for(let e=0;e<8;e++)t=((gt(n[8*o+e])<<1)+gt(1664.5))/gt(qe)&1,r[o]|=pt(t<<e)}return r}(i)}(e,r);const a=Buffer.from(s),l=Buffer.from(o),f=new Ge(512);f.update(a).update(l);let u=new Uint8Array(f.digest()),c=u.slice(0,32),h=bt(e,Je(n,s,u.slice(32,64)))-1;const d=Buffer.from(e),p=new Ge(256);p.update(d);let y=p.digest(),g=[];if(h){const e=Buffer.from(i),t=Buffer.from(y),r=new He(256);r.update(e).update(t),g=r.digest()}else{const e=Buffer.from(c),t=Buffer.from(y),r=new He(256);r.update(e).update(t),g=r.digest()}return g},Test768=function(){let e=oe.readFileSync("./node_modules/crystals-kyber/PQCkemKAT_2400.rsp").toString().split("\n"),t=[],r=[],n=[],o=0;for(;o<e.length;){if("c"==e[o][0]&&"t"==e[o][1]){let t=[];for(j=0;j<1088;j++)t[j]=xt(e[o][2*j+5]+e[o][2*j+1+5]);r.push(t),o+=1;continue}if("s"==e[o][0]&&"s"==e[o][1]){let t=[];for(j=0;j<32;j++)t[j]=xt(e[o][2*j+5]+e[o][2*j+1+5]);n.push(t),o+=1;continue}if("s"==e[o][0]&&"k"==e[o][1]){let r=[];for(j=0;j<2400;j++)r[j]=xt(e[o][2*j+5]+e[o][2*j+1+5]);t.push(r),o+=1;continue}o+=1}let i=0;for(let c=0;c<100;c++){let e=Decrypt768(r[c],t[c]);bt(n[c],e)||(i+=1)}let s=KeyGen768(),a=s[0],l=s[1],f=Encrypt768(a),u=f[0];f[1],Decrypt768(u,l)},ze.KeyGen768=KeyGen768,ze.Encrypt768=Encrypt768,ze.Decrypt768=Decrypt768,ze.Test768=Test768;var At={};const{SHA3:vt,SHAKE:Et}=L,Rt=oe.webcrypto,Bt=[2285,2571,2970,1812,1493,1422,287,202,3158,622,1577,182,962,2127,1855,1468,573,2004,264,383,2500,1458,1727,3199,2648,1017,732,608,1787,411,3124,1758,1223,652,2777,1015,2036,1491,3047,1785,516,3321,3009,2663,1711,2167,126,1469,2476,3239,3058,830,107,1908,3082,2378,2931,961,1821,2604,448,2264,677,2054,2226,430,555,843,2078,871,1550,105,422,587,177,3094,3038,2869,1574,1653,3083,778,1159,3182,2552,1483,2727,1119,1739,644,2457,349,418,329,3173,3254,817,1097,603,610,1322,2044,1864,384,2114,3193,1218,1994,2455,220,2142,1670,2144,1799,2051,794,1819,2475,2459,478,3221,3021,996,991,958,1869,1522,1628],jt=[1701,1807,1460,2371,2338,2333,308,108,2851,870,854,1510,2535,1278,1530,1185,1659,1187,3109,874,1335,2111,136,1215,2945,1465,1285,2007,2719,2726,2232,2512,75,156,3e3,2911,2980,872,2685,1590,2210,602,1846,777,147,2170,2551,246,1676,1755,460,291,235,3152,2742,2907,3224,1779,2458,1251,2486,2774,2899,1103,1275,2652,1065,2881,725,1508,2368,398,951,247,1421,3222,2499,271,90,853,1860,3203,1162,1618,666,320,8,2813,1544,282,1838,1293,2314,552,2677,2106,1571,205,2918,1542,2721,2597,2312,681,130,1602,1871,829,2946,3065,1325,2756,1861,1474,1202,2367,3147,1752,2707,171,3127,3042,1907,1836,1517,359,758,1441],Nt=256,_t=3329;function Ut(e,t,r){let n,o,s=new Array(4);for(let i=0;i<4;i++)n=384*i,o=384*(i+1),s[i]=St(e.slice(n,o));let a=Tt(e.slice(1536,1568),!0),l=new Array(4),f=0;for(let i=0;i<4;i++)l[i]=Ct(r,f),f+=1;let u=new Array(4);for(let i=0;i<4;i++)u[i]=Ct(r,f),f+=1;let c=Ct(r,f);for(let i=0;i<4;i++)l[i]=Lt(l[i]);for(let i=0;i<4;i++)l[i]=Pt(l[i]);let h=new Array(4);for(i=0;i<4;i++)h[i]=Gt(a[i],l);for(let i=0;i<4;i++)h[i]=Yt(h[i]);for(let i=0;i<4;i++)h[i]=Ft(h[i],u[i]);let d=function(e){let t,r=new Array(384).fill(0);for(let n=0;n<32;n++)for(let o=0;o<8;o++)t=-1*Jt(e[n]>>o&1),r[8*n+o]=t&Jt(1665);return r}(t),p=Gt(s,l);p=Yt(p),p=Ft(p,c),p=Ft(p,d);for(let i=0;i<4;i++)h[i]=Pt(h[i]);p=Pt(p);let y=function(e){let t=0,r=new Array(1408),n=new Array(8);for(let o=0;o<4;o++)for(let i=0;i<32;i++){for(let t=0;t<8;t++)n[t]=Wt(((Qt(e[o][8*i+t])<<11>>>0)+Qt(1664.5))/Qt(_t)&2047);r[t+0]=qt(n[0]|0),r[t+1]=qt(n[0]>>8|n[1]<<3),r[t+2]=qt(n[1]>>5|n[2]<<6),r[t+3]=qt(n[2]>>2),r[t+4]=qt(n[2]>>10|n[3]<<1),r[t+5]=qt(n[3]>>7|n[4]<<4),r[t+6]=qt(n[4]>>4|n[5]<<7),r[t+7]=qt(n[5]>>1),r[t+8]=qt(n[5]>>9|n[6]<<2),r[t+9]=qt(n[6]>>6|n[7]<<5),r[t+10]=qt(n[7]>>3),t+=11}return r}(h),g=function(e){let t=0,r=new Array(160),n=new Array(8);for(let o=0;o<32;o++){for(let t=0;t<8;t++)n[t]=31&qt(((Qt(e[8*o+t])<<5>>>0)+Qt(1664.5))/Qt(_t));r[t+0]=qt(n[0]|n[1]<<5),r[t+1]=qt(n[1]>>3|n[2]<<2|n[3]<<7),r[t+2]=qt(n[3]>>1|n[4]<<4),r[t+3]=qt(n[4]>>4|n[5]<<1|n[6]<<6),r[t+4]=qt(n[6]>>2|n[7]<<3),t+=5}return r}(p);return y.concat(g)}function It(e){let t,r,n=new Array(384),o=$t(e);for(let i=0;i<128;i++)t=Wt(o[2*i]),r=Wt(o[2*i+1]),n[3*i+0]=qt(t|0),n[3*i+1]=qt(t>>8)|qt(r<<4),n[3*i+2]=qt(r>>4);return n}function St(e){let t=new Array(384).fill(0);for(let r=0;r<128;r++)t[2*r]=Jt(4095&(Wt(e[3*r+0])|Wt(e[3*r+1])<<8)),t[2*r+1]=Jt(4095&(Wt(e[3*r+1])>>4|Wt(e[3*r+2])<<4));return t}function Tt(e,t){let r=new Array(4);new Array(504);const n=new Et(128);let o=0;for(let i=0;i<4;i++){r[i]=new Array(4);let s=new Array(2);for(let a=0;a<4;a++){s[0]=a,s[1]=i,t&&(s[0]=i,s[1]=a),n.reset();const l=Buffer.from(e),f=Buffer.from(s);n.update(l).update(f);let u=new Uint8Array(n.digest({buffer:Buffer.alloc(672)})),c=504,h=new Array(2);for(h=Ot(u.slice(0,504),c,Nt),r[i][a]=h[0],o=h[1];o<Nt;){let e=u.slice(504,672),t=new Array(2);t=Ot(e,168,Nt-o);let n=t[0],s=t[1];for(let l=o;l<Nt;l++)r[i][a][l]=n[l-o];o+=s}}}return r}function Ot(e,t,r){let n,o,i=new Array(384).fill(0),s=0,a=0;for(;a<r&&s+3<=t;)n=4095&(Wt(e[s]|0)|Wt(e[s+1])<<8),o=4095&(Wt(e[s+1]>>4)|Wt(e[s+2])<<4),s+=3,n<_t&&(i[a]=n,a+=1),a<r&&o<_t&&(i[a]=o,a+=1);let l=new Array(2);return l[0]=i,l[1]=a,l}function Ct(e,t){let r=function(e,t,r){let n=new Array(1);n[0]=r;const o=new Et(256);o.reset();const i=Buffer.from(t),s=Buffer.from(n);o.update(i).update(s);let a=o.digest({buffer:Buffer.alloc(e)});return a}(128,e,t);return function(e){let t,r,n,o,i=new Array(384).fill(0);for(let s=0;s<32;s++){t=Mt(e.slice(4*s,e.length))>>>0,r=(1431655765&t)>>>0,r=r+((t>>1>>>0&1431655765)>>>0)>>>0;for(let e=0;e<8;e++)n=Jt((r>>4*e+0>>>0&3)>>>0),o=Jt((r>>4*e+2>>>0&3)>>>0),i[8*s+e]=n-o}return i}(r)}function Mt(e){let t;return t=Qt(e[0]),t=(t|Qt(e[1])<<8)>>>0>>>0,t=(t|Qt(e[2])<<16)>>>0>>>0,t=(t|Qt(e[3])<<24)>>>0>>>0,Qt(t)}function Lt(e){let t,r,n=0,o=1;for(let i=128;i>=2;i>>=1)for(let s=0;s<256;s=n+i)for(t=Bt[o],o+=1,n=s;n<s+i;n++)r=Dt(t,e[n+i]),e[n+i]=e[n]-r,e[n]=e[n]+r;return e}function Dt(e,t){return Kt(e*t)}function Pt(e){for(let t=0;t<Nt;t++)e[t]=kt(e[t]);return e}function kt(e){let t=5040.216431360769*e>>24;return t*=_t,e-t}function Kt(e){let t=Jt(62209*Zt(e))*_t;return t=e-t,t>>=16,Jt(t)}function zt(e){for(let t=0;t<Nt;t++)e[t]=Kt(Zt(e[t])*Zt(1353));return e}function Gt(e,t){let r,n=Ht(e[0],t[0]);for(let o=1;o<4;o++)r=Ht(e[o],t[o]),n=Ft(n,r);return Pt(n)}function Ht(e,t){let r,n;for(let o=0;o<64;o++)r=Vt(e[4*o+0],e[4*o+1],t[4*o+0],t[4*o+1],Bt[64+o]),n=Vt(e[4*o+2],e[4*o+3],t[4*o+2],t[4*o+3],-Bt[64+o]),e[4*o+0]=r[0],e[4*o+1]=r[1],e[4*o+2]=n[0],e[4*o+3]=n[1];return e}function Vt(e,t,r,n,o){let i=new Array(2);return i[0]=Dt(t,n),i[0]=Dt(i[0],o),i[0]=i[0]+Dt(e,r),i[1]=Dt(e,n),i[1]=i[1]+Dt(t,r),i}function Ft(e,t){let r=new Array(384);for(let n=0;n<Nt;n++)r[n]=e[n]+t[n];return r}function Yt(e){let t,r,n=0,o=0;for(let i=2;i<=128;i<<=1)for(let s=0;s<256;s=n+i)for(t=jt[o],o+=1,n=s;n<s+i;n++)r=e[n],e[n]=kt(r+e[n+i]),e[n+i]=r-e[n+i],e[n+i]=Dt(t,e[n+i]);for(n=0;n<256;n++)e[n]=Dt(e[n],jt[127]);return e}function $t(e){for(let t=0;t<Nt;t++)e[t]=e[t]-_t,e[t]=e[t]+(e[t]>>31&_t);return e}function qt(e){return e%=256}function Jt(e){let t=-32768,r=32767;return e>=t&&e<=r?e:e<t?(e+=32769,e=r+(e%=65536)):e>r?(e-=32768,e=t+(e%=65536)):void 0}function Wt(e){return e%=65536}function Zt(e){let t=-2147483648,r=2147483647;return e>=t&&e<=r?e:e<t?(e+=2147483649,e=r+(e%=4294967296)):e>r?(e-=2147483648,e=t+(e%=4294967296)):void 0}function Qt(e){return e%=4294967296}function Xt(e,t){if(e.length!=t.length)return 0;for(let r=0;r<e.length;r++)if(e[r]!=t[r])return 0;return 1}function er(e){return parseInt(e,16)}KeyGen1024=function(){let e=function(){let e=new Uint8Array(32);Rt.getRandomValues(e);const t=Buffer.from(e),r=new vt(512);r.update(t);let n=new Uint8Array(r.digest()),o=n.slice(0,32),i=n.slice(32,64),s=Tt(o,!1),a=new Array(4),l=0;for(let d=0;d<4;d++)a[d]=Ct(i,l),l+=1;let f=new Array(4);for(let d=0;d<4;d++)f[d]=Ct(i,l),l+=1;for(let d=0;d<4;d++)a[d]=Lt(a[d]);for(let d=0;d<4;d++)f[d]=Lt(f[d]);for(let d=0;d<4;d++)a[d]=Pt(a[d]);let u=new Array(4);for(let d=0;d<4;d++)u[d]=zt(Gt(s[d],a));for(let d=0;d<4;d++)u[d]=Ft(u[d],f[d]);for(let d=0;d<4;d++)u[d]=Pt(u[d]);let c=new Array(2);c[0]=[];let h=[];for(let d=0;d<4;d++){h=It(u[d]);for(let e=0;e<h.length;e++)c[0].push(h[e])}for(let d=0;d<o.length;d++)c[0].push(o[d]);c[1]=[],h=[];for(let d=0;d<4;d++){h=It(a[d]);for(let e=0;e<h.length;e++)c[1].push(h[e])}return c}(),t=e[0],r=e[1];const n=Buffer.from(t),o=new vt(256);o.update(n);let i=o.digest(),s=new Uint8Array(32);Rt.getRandomValues(s);for(let l=0;l<t.length;l++)r.push(t[l]);for(let l=0;l<i.length;l++)r.push(i[l]);for(let l=0;l<s.length;l++)r.push(s[l]);let a=new Array(2);return a[0]=t,a[1]=r,a},Encrypt1024=function(e){let t=new Uint8Array(32);Rt.getRandomValues(t);const r=Buffer.from(t),n=new vt(256);n.update(r);let o=n.digest();const i=Buffer.from(e),s=new vt(256);s.update(i);let a=s.digest();const l=Buffer.from(o),f=Buffer.from(a),u=new vt(512);u.update(l).update(f);let c=new Uint8Array(u.digest()),h=c.slice(0,32),d=Ut(e,o,c.slice(32,64));const p=Buffer.from(d),y=new vt(256);y.update(p);let g=y.digest();const w=Buffer.from(h),m=Buffer.from(g),b=new Et(256);b.update(w).update(m);let x=b.digest(),A=new Array(2);return A[0]=d,A[1]=x,A},Decrypt1024=function(e,t){let r=t.slice(0,1536),n=t.slice(1536,3104),o=t.slice(3104,3136),i=t.slice(3136,3168),s=function(e,t){let r=function(e){let t=new Array(4);for(let o=0;o<4;o++)t[o]=new Array(384);let r=0,n=new Array(8);for(let o=0;o<4;o++)for(let i=0;i<32;i++){n[0]=Wt(e[r+0])|Wt(e[r+1])<<8,n[1]=Wt(e[r+1])>>3|Wt(e[r+2])<<5,n[2]=Wt(e[r+2])>>6|Wt(e[r+3])<<2|Wt(e[r+4])<<10,n[3]=Wt(e[r+4])>>1|Wt(e[r+5])<<7,n[4]=Wt(e[r+5])>>4|Wt(e[r+6])<<4,n[5]=Wt(e[r+6])>>7|Wt(e[r+7])<<1|Wt(e[r+8])<<9,n[6]=Wt(e[r+8])>>2|Wt(e[r+9])<<6,n[7]=Wt(e[r+9])>>5|Wt(e[r+10])<<3,r+=11;for(let e=0;e<8;e++)t[o][8*i+e]=Qt(2047&n[e])*_t+1024>>11}return t}(e.slice(0,1408)),n=function(e){let t=new Array(384),r=new Array(8),n=0;for(let o=0;o<32;o++){r[0]=e[n+0]|0,r[1]=e[n+0]>>5|e[n+1]<<3,r[2]=e[n+1]>>2,r[3]=e[n+1]>>7|e[n+2]<<1,r[4]=e[n+2]>>4|e[n+3]<<4,r[5]=e[n+3]>>1,r[6]=e[n+3]>>6|e[n+4]<<2,r[7]=e[n+4]>>3,n+=5;for(let e=0;e<8;e++)t[8*o+e]=Jt(Qt(31&r[e])*Qt(_t)+16>>5)}return t}(e.slice(1408,1568)),o=function(e){let t,r,n=new Array(4);for(let o=0;o<4;o++)n[o]=new Array(384);for(let o=0;o<4;o++)t=384*o,r=384*(o+1),n[o]=St(e.slice(t,r));return n}(t);for(let s=0;s<4;s++)r[s]=Lt(r[s]);let i=Gt(o,r);return i=Yt(i),i=function(e,t){for(let r=0;r<Nt;r++)e[r]=e[r]-t[r];return e}(n,i),i=Pt(i),function(e){let t,r=new Array(32),n=$t(e);for(let o=0;o<32;o++){r[o]=0;for(let e=0;e<8;e++)t=((Wt(n[8*o+e])<<1)+Wt(1664.5))/Wt(_t)&1,r[o]|=qt(t<<e)}return r}(i)}(e,r);const a=Buffer.from(s),l=Buffer.from(o),f=new vt(512);f.update(a).update(l);let u=new Uint8Array(f.digest()),c=u.slice(0,32),h=Xt(e,Ut(n,s,u.slice(32,64)))-1;const d=Buffer.from(e),p=new vt(256);p.update(d);let y=p.digest(),g=[];if(h){const e=Buffer.from(i),t=Buffer.from(y),r=new Et(256);r.update(e).update(t),g=r.digest()}else{const e=Buffer.from(c),t=Buffer.from(y),r=new Et(256);r.update(e).update(t),g=r.digest()}return g},Test1024=function(){let e=oe.readFileSync("./node_modules/crystals-kyber/PQCkemKAT_3168.rsp").toString().split("\n"),t=[],r=[],n=[],o=0;for(;o<e.length;){if("c"==e[o][0]&&"t"==e[o][1]){let t=[];for(j=0;j<1568;j++)t[j]=er(e[o][2*j+5]+e[o][2*j+1+5]);r.push(t),o+=1;continue}if("s"==e[o][0]&&"s"==e[o][1]){let t=[];for(j=0;j<32;j++)t[j]=er(e[o][2*j+5]+e[o][2*j+1+5]);n.push(t),o+=1;continue}if("s"==e[o][0]&&"k"==e[o][1]){let r=[];for(j=0;j<3168;j++)r[j]=er(e[o][2*j+5]+e[o][2*j+1+5]);t.push(r),o+=1;continue}o+=1}let i=0;for(let c=0;c<100;c++){let e=Decrypt1024(r[c],t[c]);Xt(n[c],e)||(i+=1)}let s=KeyGen1024(),a=s[0],l=s[1],f=Encrypt1024(a),u=f[0];f[1],Decrypt1024(u,l)},At.KeyGen1024=KeyGen1024,At.Encrypt1024=Encrypt1024,At.Decrypt1024=Decrypt1024,At.Test1024=Test1024;var tr={...M,...ze,...At};function rr(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var nr={exports:{}};!function(e){var t=function(e){var t,r=new Float64Array(16);if(e)for(t=0;t<e.length;t++)r[t]=e[t];return r},r=function(){throw new Error("no PRNG")},n=new Uint8Array(16),o=new Uint8Array(32);o[0]=9;var i=t(),s=t([1]),a=t([56129,1]),l=t([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),f=t([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),u=t([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),c=t([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),h=t([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function d(e,t,r,n){e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r,e[t+4]=n>>24&255,e[t+5]=n>>16&255,e[t+6]=n>>8&255,e[t+7]=255&n}function p(e,t,r,n,o){var i,s=0;for(i=0;i<o;i++)s|=e[t+i]^r[n+i];return(1&s-1>>>8)-1}function y(e,t,r,n){return p(e,t,r,n,16)}function g(e,t,r,n){return p(e,t,r,n,32)}function w(e,t,r,n){!function(e,t,r,n){for(var o,i=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,s=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,a=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,l=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,f=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,u=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,c=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,h=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,d=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,p=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,y=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,g=255&r[16]|(255&r[17])<<8|(255&r[18])<<16|(255&r[19])<<24,w=255&r[20]|(255&r[21])<<8|(255&r[22])<<16|(255&r[23])<<24,m=255&r[24]|(255&r[25])<<8|(255&r[26])<<16|(255&r[27])<<24,b=255&r[28]|(255&r[29])<<8|(255&r[30])<<16|(255&r[31])<<24,x=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,A=i,v=s,E=a,R=l,B=f,j=u,N=c,_=h,U=d,I=p,S=y,T=g,O=w,C=m,M=b,L=x,D=0;D<20;D+=2)A^=(o=(O^=(o=(U^=(o=(B^=(o=A+O|0)<<7|o>>>25)+A|0)<<9|o>>>23)+B|0)<<13|o>>>19)+U|0)<<18|o>>>14,j^=(o=(v^=(o=(C^=(o=(I^=(o=j+v|0)<<7|o>>>25)+j|0)<<9|o>>>23)+I|0)<<13|o>>>19)+C|0)<<18|o>>>14,S^=(o=(N^=(o=(E^=(o=(M^=(o=S+N|0)<<7|o>>>25)+S|0)<<9|o>>>23)+M|0)<<13|o>>>19)+E|0)<<18|o>>>14,L^=(o=(T^=(o=(_^=(o=(R^=(o=L+T|0)<<7|o>>>25)+L|0)<<9|o>>>23)+R|0)<<13|o>>>19)+_|0)<<18|o>>>14,A^=(o=(R^=(o=(E^=(o=(v^=(o=A+R|0)<<7|o>>>25)+A|0)<<9|o>>>23)+v|0)<<13|o>>>19)+E|0)<<18|o>>>14,j^=(o=(B^=(o=(_^=(o=(N^=(o=j+B|0)<<7|o>>>25)+j|0)<<9|o>>>23)+N|0)<<13|o>>>19)+_|0)<<18|o>>>14,S^=(o=(I^=(o=(U^=(o=(T^=(o=S+I|0)<<7|o>>>25)+S|0)<<9|o>>>23)+T|0)<<13|o>>>19)+U|0)<<18|o>>>14,L^=(o=(M^=(o=(C^=(o=(O^=(o=L+M|0)<<7|o>>>25)+L|0)<<9|o>>>23)+O|0)<<13|o>>>19)+C|0)<<18|o>>>14;A=A+i|0,v=v+s|0,E=E+a|0,R=R+l|0,B=B+f|0,j=j+u|0,N=N+c|0,_=_+h|0,U=U+d|0,I=I+p|0,S=S+y|0,T=T+g|0,O=O+w|0,C=C+m|0,M=M+b|0,L=L+x|0,e[0]=A>>>0&255,e[1]=A>>>8&255,e[2]=A>>>16&255,e[3]=A>>>24&255,e[4]=v>>>0&255,e[5]=v>>>8&255,e[6]=v>>>16&255,e[7]=v>>>24&255,e[8]=E>>>0&255,e[9]=E>>>8&255,e[10]=E>>>16&255,e[11]=E>>>24&255,e[12]=R>>>0&255,e[13]=R>>>8&255,e[14]=R>>>16&255,e[15]=R>>>24&255,e[16]=B>>>0&255,e[17]=B>>>8&255,e[18]=B>>>16&255,e[19]=B>>>24&255,e[20]=j>>>0&255,e[21]=j>>>8&255,e[22]=j>>>16&255,e[23]=j>>>24&255,e[24]=N>>>0&255,e[25]=N>>>8&255,e[26]=N>>>16&255,e[27]=N>>>24&255,e[28]=_>>>0&255,e[29]=_>>>8&255,e[30]=_>>>16&255,e[31]=_>>>24&255,e[32]=U>>>0&255,e[33]=U>>>8&255,e[34]=U>>>16&255,e[35]=U>>>24&255,e[36]=I>>>0&255,e[37]=I>>>8&255,e[38]=I>>>16&255,e[39]=I>>>24&255,e[40]=S>>>0&255,e[41]=S>>>8&255,e[42]=S>>>16&255,e[43]=S>>>24&255,e[44]=T>>>0&255,e[45]=T>>>8&255,e[46]=T>>>16&255,e[47]=T>>>24&255,e[48]=O>>>0&255,e[49]=O>>>8&255,e[50]=O>>>16&255,e[51]=O>>>24&255,e[52]=C>>>0&255,e[53]=C>>>8&255,e[54]=C>>>16&255,e[55]=C>>>24&255,e[56]=M>>>0&255,e[57]=M>>>8&255,e[58]=M>>>16&255,e[59]=M>>>24&255,e[60]=L>>>0&255,e[61]=L>>>8&255,e[62]=L>>>16&255,e[63]=L>>>24&255}(e,t,r,n)}function m(e,t,r,n){!function(e,t,r,n){for(var o,i=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,s=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,a=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,l=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,f=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,u=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,c=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,h=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,d=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,p=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,y=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,g=255&r[16]|(255&r[17])<<8|(255&r[18])<<16|(255&r[19])<<24,w=255&r[20]|(255&r[21])<<8|(255&r[22])<<16|(255&r[23])<<24,m=255&r[24]|(255&r[25])<<8|(255&r[26])<<16|(255&r[27])<<24,b=255&r[28]|(255&r[29])<<8|(255&r[30])<<16|(255&r[31])<<24,x=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,A=0;A<20;A+=2)i^=(o=(w^=(o=(d^=(o=(f^=(o=i+w|0)<<7|o>>>25)+i|0)<<9|o>>>23)+f|0)<<13|o>>>19)+d|0)<<18|o>>>14,u^=(o=(s^=(o=(m^=(o=(p^=(o=u+s|0)<<7|o>>>25)+u|0)<<9|o>>>23)+p|0)<<13|o>>>19)+m|0)<<18|o>>>14,y^=(o=(c^=(o=(a^=(o=(b^=(o=y+c|0)<<7|o>>>25)+y|0)<<9|o>>>23)+b|0)<<13|o>>>19)+a|0)<<18|o>>>14,x^=(o=(g^=(o=(h^=(o=(l^=(o=x+g|0)<<7|o>>>25)+x|0)<<9|o>>>23)+l|0)<<13|o>>>19)+h|0)<<18|o>>>14,i^=(o=(l^=(o=(a^=(o=(s^=(o=i+l|0)<<7|o>>>25)+i|0)<<9|o>>>23)+s|0)<<13|o>>>19)+a|0)<<18|o>>>14,u^=(o=(f^=(o=(h^=(o=(c^=(o=u+f|0)<<7|o>>>25)+u|0)<<9|o>>>23)+c|0)<<13|o>>>19)+h|0)<<18|o>>>14,y^=(o=(p^=(o=(d^=(o=(g^=(o=y+p|0)<<7|o>>>25)+y|0)<<9|o>>>23)+g|0)<<13|o>>>19)+d|0)<<18|o>>>14,x^=(o=(b^=(o=(m^=(o=(w^=(o=x+b|0)<<7|o>>>25)+x|0)<<9|o>>>23)+w|0)<<13|o>>>19)+m|0)<<18|o>>>14;e[0]=i>>>0&255,e[1]=i>>>8&255,e[2]=i>>>16&255,e[3]=i>>>24&255,e[4]=u>>>0&255,e[5]=u>>>8&255,e[6]=u>>>16&255,e[7]=u>>>24&255,e[8]=y>>>0&255,e[9]=y>>>8&255,e[10]=y>>>16&255,e[11]=y>>>24&255,e[12]=x>>>0&255,e[13]=x>>>8&255,e[14]=x>>>16&255,e[15]=x>>>24&255,e[16]=c>>>0&255,e[17]=c>>>8&255,e[18]=c>>>16&255,e[19]=c>>>24&255,e[20]=h>>>0&255,e[21]=h>>>8&255,e[22]=h>>>16&255,e[23]=h>>>24&255,e[24]=d>>>0&255,e[25]=d>>>8&255,e[26]=d>>>16&255,e[27]=d>>>24&255,e[28]=p>>>0&255,e[29]=p>>>8&255,e[30]=p>>>16&255,e[31]=p>>>24&255}(e,t,r,n)}var b=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function x(e,t,r,n,o,i,s){var a,l,f=new Uint8Array(16),u=new Uint8Array(64);for(l=0;l<16;l++)f[l]=0;for(l=0;l<8;l++)f[l]=i[l];for(;o>=64;){for(w(u,f,s,b),l=0;l<64;l++)e[t+l]=r[n+l]^u[l];for(a=1,l=8;l<16;l++)a=a+(255&f[l])|0,f[l]=255&a,a>>>=8;o-=64,t+=64,n+=64}if(o>0)for(w(u,f,s,b),l=0;l<o;l++)e[t+l]=r[n+l]^u[l];return 0}function A(e,t,r,n,o){var i,s,a=new Uint8Array(16),l=new Uint8Array(64);for(s=0;s<16;s++)a[s]=0;for(s=0;s<8;s++)a[s]=n[s];for(;r>=64;){for(w(l,a,o,b),s=0;s<64;s++)e[t+s]=l[s];for(i=1,s=8;s<16;s++)i=i+(255&a[s])|0,a[s]=255&i,i>>>=8;r-=64,t+=64}if(r>0)for(w(l,a,o,b),s=0;s<r;s++)e[t+s]=l[s];return 0}function v(e,t,r,n,o){var i=new Uint8Array(32);m(i,n,o,b);for(var s=new Uint8Array(8),a=0;a<8;a++)s[a]=n[a+16];return A(e,t,r,s,i)}function E(e,t,r,n,o,i,s){var a=new Uint8Array(32);m(a,i,s,b);for(var l=new Uint8Array(8),f=0;f<8;f++)l[f]=i[f+16];return x(e,t,r,n,o,l,a)}var R=function(e){var t,r,n,o,i,s,a,l;this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0,t=255&e[0]|(255&e[1])<<8,this.r[0]=8191&t,r=255&e[2]|(255&e[3])<<8,this.r[1]=8191&(t>>>13|r<<3),n=255&e[4]|(255&e[5])<<8,this.r[2]=7939&(r>>>10|n<<6),o=255&e[6]|(255&e[7])<<8,this.r[3]=8191&(n>>>7|o<<9),i=255&e[8]|(255&e[9])<<8,this.r[4]=255&(o>>>4|i<<12),this.r[5]=i>>>1&8190,s=255&e[10]|(255&e[11])<<8,this.r[6]=8191&(i>>>14|s<<2),a=255&e[12]|(255&e[13])<<8,this.r[7]=8065&(s>>>11|a<<5),l=255&e[14]|(255&e[15])<<8,this.r[8]=8191&(a>>>8|l<<8),this.r[9]=l>>>5&127,this.pad[0]=255&e[16]|(255&e[17])<<8,this.pad[1]=255&e[18]|(255&e[19])<<8,this.pad[2]=255&e[20]|(255&e[21])<<8,this.pad[3]=255&e[22]|(255&e[23])<<8,this.pad[4]=255&e[24]|(255&e[25])<<8,this.pad[5]=255&e[26]|(255&e[27])<<8,this.pad[6]=255&e[28]|(255&e[29])<<8,this.pad[7]=255&e[30]|(255&e[31])<<8};function B(e,t,r,n,o,i){var s=new R(i);return s.update(r,n,o),s.finish(e,t),0}function j(e,t,r,n,o,i){var s=new Uint8Array(16);return B(s,0,r,n,o,i),y(e,t,s,0)}function N(e,t,r,n,o){var i;if(r<32)return-1;for(E(e,0,t,0,r,n,o),B(e,16,e,32,r-32,e),i=0;i<16;i++)e[i]=0;return 0}function _(e,t,r,n,o){var i,s=new Uint8Array(32);if(r<32)return-1;if(v(s,0,32,n,o),0!==j(t,16,t,32,r-32,s))return-1;for(E(e,0,t,0,r,n,o),i=0;i<32;i++)e[i]=0;return 0}function U(e,t){var r;for(r=0;r<16;r++)e[r]=0|t[r]}function I(e){var t,r,n=1;for(t=0;t<16;t++)r=e[t]+n+65535,n=Math.floor(r/65536),e[t]=r-65536*n;e[0]+=n-1+37*(n-1)}function S(e,t,r){for(var n,o=~(r-1),i=0;i<16;i++)n=o&(e[i]^t[i]),e[i]^=n,t[i]^=n}function T(e,r){var n,o,i,s=t(),a=t();for(n=0;n<16;n++)a[n]=r[n];for(I(a),I(a),I(a),o=0;o<2;o++){for(s[0]=a[0]-65517,n=1;n<15;n++)s[n]=a[n]-65535-(s[n-1]>>16&1),s[n-1]&=65535;s[15]=a[15]-32767-(s[14]>>16&1),i=s[15]>>16&1,s[14]&=65535,S(a,s,1-i)}for(n=0;n<16;n++)e[2*n]=255&a[n],e[2*n+1]=a[n]>>8}function O(e,t){var r=new Uint8Array(32),n=new Uint8Array(32);return T(r,e),T(n,t),g(r,0,n,0)}function C(e){var t=new Uint8Array(32);return T(t,e),1&t[0]}function M(e,t){var r;for(r=0;r<16;r++)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}function L(e,t,r){for(var n=0;n<16;n++)e[n]=t[n]+r[n]}function D(e,t,r){for(var n=0;n<16;n++)e[n]=t[n]-r[n]}function P(e,t,r){var n,o,i=0,s=0,a=0,l=0,f=0,u=0,c=0,h=0,d=0,p=0,y=0,g=0,w=0,m=0,b=0,x=0,A=0,v=0,E=0,R=0,B=0,j=0,N=0,_=0,U=0,I=0,S=0,T=0,O=0,C=0,M=0,L=r[0],D=r[1],P=r[2],k=r[3],K=r[4],z=r[5],G=r[6],H=r[7],V=r[8],F=r[9],Y=r[10],$=r[11],q=r[12],J=r[13],W=r[14],Z=r[15];i+=(n=t[0])*L,s+=n*D,a+=n*P,l+=n*k,f+=n*K,u+=n*z,c+=n*G,h+=n*H,d+=n*V,p+=n*F,y+=n*Y,g+=n*$,w+=n*q,m+=n*J,b+=n*W,x+=n*Z,s+=(n=t[1])*L,a+=n*D,l+=n*P,f+=n*k,u+=n*K,c+=n*z,h+=n*G,d+=n*H,p+=n*V,y+=n*F,g+=n*Y,w+=n*$,m+=n*q,b+=n*J,x+=n*W,A+=n*Z,a+=(n=t[2])*L,l+=n*D,f+=n*P,u+=n*k,c+=n*K,h+=n*z,d+=n*G,p+=n*H,y+=n*V,g+=n*F,w+=n*Y,m+=n*$,b+=n*q,x+=n*J,A+=n*W,v+=n*Z,l+=(n=t[3])*L,f+=n*D,u+=n*P,c+=n*k,h+=n*K,d+=n*z,p+=n*G,y+=n*H,g+=n*V,w+=n*F,m+=n*Y,b+=n*$,x+=n*q,A+=n*J,v+=n*W,E+=n*Z,f+=(n=t[4])*L,u+=n*D,c+=n*P,h+=n*k,d+=n*K,p+=n*z,y+=n*G,g+=n*H,w+=n*V,m+=n*F,b+=n*Y,x+=n*$,A+=n*q,v+=n*J,E+=n*W,R+=n*Z,u+=(n=t[5])*L,c+=n*D,h+=n*P,d+=n*k,p+=n*K,y+=n*z,g+=n*G,w+=n*H,m+=n*V,b+=n*F,x+=n*Y,A+=n*$,v+=n*q,E+=n*J,R+=n*W,B+=n*Z,c+=(n=t[6])*L,h+=n*D,d+=n*P,p+=n*k,y+=n*K,g+=n*z,w+=n*G,m+=n*H,b+=n*V,x+=n*F,A+=n*Y,v+=n*$,E+=n*q,R+=n*J,B+=n*W,j+=n*Z,h+=(n=t[7])*L,d+=n*D,p+=n*P,y+=n*k,g+=n*K,w+=n*z,m+=n*G,b+=n*H,x+=n*V,A+=n*F,v+=n*Y,E+=n*$,R+=n*q,B+=n*J,j+=n*W,N+=n*Z,d+=(n=t[8])*L,p+=n*D,y+=n*P,g+=n*k,w+=n*K,m+=n*z,b+=n*G,x+=n*H,A+=n*V,v+=n*F,E+=n*Y,R+=n*$,B+=n*q,j+=n*J,N+=n*W,_+=n*Z,p+=(n=t[9])*L,y+=n*D,g+=n*P,w+=n*k,m+=n*K,b+=n*z,x+=n*G,A+=n*H,v+=n*V,E+=n*F,R+=n*Y,B+=n*$,j+=n*q,N+=n*J,_+=n*W,U+=n*Z,y+=(n=t[10])*L,g+=n*D,w+=n*P,m+=n*k,b+=n*K,x+=n*z,A+=n*G,v+=n*H,E+=n*V,R+=n*F,B+=n*Y,j+=n*$,N+=n*q,_+=n*J,U+=n*W,I+=n*Z,g+=(n=t[11])*L,w+=n*D,m+=n*P,b+=n*k,x+=n*K,A+=n*z,v+=n*G,E+=n*H,R+=n*V,B+=n*F,j+=n*Y,N+=n*$,_+=n*q,U+=n*J,I+=n*W,S+=n*Z,w+=(n=t[12])*L,m+=n*D,b+=n*P,x+=n*k,A+=n*K,v+=n*z,E+=n*G,R+=n*H,B+=n*V,j+=n*F,N+=n*Y,_+=n*$,U+=n*q,I+=n*J,S+=n*W,T+=n*Z,m+=(n=t[13])*L,b+=n*D,x+=n*P,A+=n*k,v+=n*K,E+=n*z,R+=n*G,B+=n*H,j+=n*V,N+=n*F,_+=n*Y,U+=n*$,I+=n*q,S+=n*J,T+=n*W,O+=n*Z,b+=(n=t[14])*L,x+=n*D,A+=n*P,v+=n*k,E+=n*K,R+=n*z,B+=n*G,j+=n*H,N+=n*V,_+=n*F,U+=n*Y,I+=n*$,S+=n*q,T+=n*J,O+=n*W,C+=n*Z,x+=(n=t[15])*L,s+=38*(v+=n*P),a+=38*(E+=n*k),l+=38*(R+=n*K),f+=38*(B+=n*z),u+=38*(j+=n*G),c+=38*(N+=n*H),h+=38*(_+=n*V),d+=38*(U+=n*F),p+=38*(I+=n*Y),y+=38*(S+=n*$),g+=38*(T+=n*q),w+=38*(O+=n*J),m+=38*(C+=n*W),b+=38*(M+=n*Z),i=(n=(i+=38*(A+=n*D))+(o=1)+65535)-65536*(o=Math.floor(n/65536)),s=(n=s+o+65535)-65536*(o=Math.floor(n/65536)),a=(n=a+o+65535)-65536*(o=Math.floor(n/65536)),l=(n=l+o+65535)-65536*(o=Math.floor(n/65536)),f=(n=f+o+65535)-65536*(o=Math.floor(n/65536)),u=(n=u+o+65535)-65536*(o=Math.floor(n/65536)),c=(n=c+o+65535)-65536*(o=Math.floor(n/65536)),h=(n=h+o+65535)-65536*(o=Math.floor(n/65536)),d=(n=d+o+65535)-65536*(o=Math.floor(n/65536)),p=(n=p+o+65535)-65536*(o=Math.floor(n/65536)),y=(n=y+o+65535)-65536*(o=Math.floor(n/65536)),g=(n=g+o+65535)-65536*(o=Math.floor(n/65536)),w=(n=w+o+65535)-65536*(o=Math.floor(n/65536)),m=(n=m+o+65535)-65536*(o=Math.floor(n/65536)),b=(n=b+o+65535)-65536*(o=Math.floor(n/65536)),x=(n=x+o+65535)-65536*(o=Math.floor(n/65536)),i=(n=(i+=o-1+37*(o-1))+(o=1)+65535)-65536*(o=Math.floor(n/65536)),s=(n=s+o+65535)-65536*(o=Math.floor(n/65536)),a=(n=a+o+65535)-65536*(o=Math.floor(n/65536)),l=(n=l+o+65535)-65536*(o=Math.floor(n/65536)),f=(n=f+o+65535)-65536*(o=Math.floor(n/65536)),u=(n=u+o+65535)-65536*(o=Math.floor(n/65536)),c=(n=c+o+65535)-65536*(o=Math.floor(n/65536)),h=(n=h+o+65535)-65536*(o=Math.floor(n/65536)),d=(n=d+o+65535)-65536*(o=Math.floor(n/65536)),p=(n=p+o+65535)-65536*(o=Math.floor(n/65536)),y=(n=y+o+65535)-65536*(o=Math.floor(n/65536)),g=(n=g+o+65535)-65536*(o=Math.floor(n/65536)),w=(n=w+o+65535)-65536*(o=Math.floor(n/65536)),m=(n=m+o+65535)-65536*(o=Math.floor(n/65536)),b=(n=b+o+65535)-65536*(o=Math.floor(n/65536)),x=(n=x+o+65535)-65536*(o=Math.floor(n/65536)),i+=o-1+37*(o-1),e[0]=i,e[1]=s,e[2]=a,e[3]=l,e[4]=f,e[5]=u,e[6]=c,e[7]=h,e[8]=d,e[9]=p,e[10]=y,e[11]=g,e[12]=w,e[13]=m,e[14]=b,e[15]=x}function k(e,t){P(e,t,t)}function K(e,r){var n,o=t();for(n=0;n<16;n++)o[n]=r[n];for(n=253;n>=0;n--)k(o,o),2!==n&&4!==n&&P(o,o,r);for(n=0;n<16;n++)e[n]=o[n]}function z(e,r){var n,o=t();for(n=0;n<16;n++)o[n]=r[n];for(n=250;n>=0;n--)k(o,o),1!==n&&P(o,o,r);for(n=0;n<16;n++)e[n]=o[n]}function G(e,r,n){var o,i,s=new Uint8Array(32),l=new Float64Array(80),f=t(),u=t(),c=t(),h=t(),d=t(),p=t();for(i=0;i<31;i++)s[i]=r[i];for(s[31]=127&r[31]|64,s[0]&=248,M(l,n),i=0;i<16;i++)u[i]=l[i],h[i]=f[i]=c[i]=0;for(f[0]=h[0]=1,i=254;i>=0;--i)S(f,u,o=s[i>>>3]>>>(7&i)&1),S(c,h,o),L(d,f,c),D(f,f,c),L(c,u,h),D(u,u,h),k(h,d),k(p,f),P(f,c,f),P(c,u,d),L(d,f,c),D(f,f,c),k(u,f),D(c,h,p),P(f,c,a),L(f,f,h),P(c,c,f),P(f,h,p),P(h,u,l),k(u,d),S(f,u,o),S(c,h,o);for(i=0;i<16;i++)l[i+16]=f[i],l[i+32]=c[i],l[i+48]=u[i],l[i+64]=h[i];var y=l.subarray(32),g=l.subarray(16);return K(y,y),P(g,g,y),T(e,g),0}function H(e,t){return G(e,t,o)}function V(e,t){return r(t,32),H(e,t)}function F(e,t,r){var o=new Uint8Array(32);return G(o,r,t),m(e,n,o,b)}R.prototype.blocks=function(e,t,r){for(var n,o,i,s,a,l,f,u,c,h,d,p,y,g,w,m,b,x,A,v=this.fin?0:2048,E=this.h[0],R=this.h[1],B=this.h[2],j=this.h[3],N=this.h[4],_=this.h[5],U=this.h[6],I=this.h[7],S=this.h[8],T=this.h[9],O=this.r[0],C=this.r[1],M=this.r[2],L=this.r[3],D=this.r[4],P=this.r[5],k=this.r[6],K=this.r[7],z=this.r[8],G=this.r[9];r>=16;)h=c=0,h+=(E+=8191&(n=255&e[t+0]|(255&e[t+1])<<8))*O,h+=(R+=8191&(n>>>13|(o=255&e[t+2]|(255&e[t+3])<<8)<<3))*(5*G),h+=(B+=8191&(o>>>10|(i=255&e[t+4]|(255&e[t+5])<<8)<<6))*(5*z),h+=(j+=8191&(i>>>7|(s=255&e[t+6]|(255&e[t+7])<<8)<<9))*(5*K),c=(h+=(N+=8191&(s>>>4|(a=255&e[t+8]|(255&e[t+9])<<8)<<12))*(5*k))>>>13,h&=8191,h+=(_+=a>>>1&8191)*(5*P),h+=(U+=8191&(a>>>14|(l=255&e[t+10]|(255&e[t+11])<<8)<<2))*(5*D),h+=(I+=8191&(l>>>11|(f=255&e[t+12]|(255&e[t+13])<<8)<<5))*(5*L),h+=(S+=8191&(f>>>8|(u=255&e[t+14]|(255&e[t+15])<<8)<<8))*(5*M),d=c+=(h+=(T+=u>>>5|v)*(5*C))>>>13,d+=E*C,d+=R*O,d+=B*(5*G),d+=j*(5*z),c=(d+=N*(5*K))>>>13,d&=8191,d+=_*(5*k),d+=U*(5*P),d+=I*(5*D),d+=S*(5*L),c+=(d+=T*(5*M))>>>13,d&=8191,p=c,p+=E*M,p+=R*C,p+=B*O,p+=j*(5*G),c=(p+=N*(5*z))>>>13,p&=8191,p+=_*(5*K),p+=U*(5*k),p+=I*(5*P),p+=S*(5*D),y=c+=(p+=T*(5*L))>>>13,y+=E*L,y+=R*M,y+=B*C,y+=j*O,c=(y+=N*(5*G))>>>13,y&=8191,y+=_*(5*z),y+=U*(5*K),y+=I*(5*k),y+=S*(5*P),g=c+=(y+=T*(5*D))>>>13,g+=E*D,g+=R*L,g+=B*M,g+=j*C,c=(g+=N*O)>>>13,g&=8191,g+=_*(5*G),g+=U*(5*z),g+=I*(5*K),g+=S*(5*k),w=c+=(g+=T*(5*P))>>>13,w+=E*P,w+=R*D,w+=B*L,w+=j*M,c=(w+=N*C)>>>13,w&=8191,w+=_*O,w+=U*(5*G),w+=I*(5*z),w+=S*(5*K),m=c+=(w+=T*(5*k))>>>13,m+=E*k,m+=R*P,m+=B*D,m+=j*L,c=(m+=N*M)>>>13,m&=8191,m+=_*C,m+=U*O,m+=I*(5*G),m+=S*(5*z),b=c+=(m+=T*(5*K))>>>13,b+=E*K,b+=R*k,b+=B*P,b+=j*D,c=(b+=N*L)>>>13,b&=8191,b+=_*M,b+=U*C,b+=I*O,b+=S*(5*G),x=c+=(b+=T*(5*z))>>>13,x+=E*z,x+=R*K,x+=B*k,x+=j*P,c=(x+=N*D)>>>13,x&=8191,x+=_*L,x+=U*M,x+=I*C,x+=S*O,A=c+=(x+=T*(5*G))>>>13,A+=E*G,A+=R*z,A+=B*K,A+=j*k,c=(A+=N*P)>>>13,A&=8191,A+=_*D,A+=U*L,A+=I*M,A+=S*C,E=h=8191&(c=(c=((c+=(A+=T*O)>>>13)<<2)+c|0)+(h&=8191)|0),R=d+=c>>>=13,B=p&=8191,j=y&=8191,N=g&=8191,_=w&=8191,U=m&=8191,I=b&=8191,S=x&=8191,T=A&=8191,t+=16,r-=16;this.h[0]=E,this.h[1]=R,this.h[2]=B,this.h[3]=j,this.h[4]=N,this.h[5]=_,this.h[6]=U,this.h[7]=I,this.h[8]=S,this.h[9]=T},R.prototype.finish=function(e,t){var r,n,o,i,s=new Uint16Array(10);if(this.leftover){for(i=this.leftover,this.buffer[i++]=1;i<16;i++)this.buffer[i]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(r=this.h[1]>>>13,this.h[1]&=8191,i=2;i<10;i++)this.h[i]+=r,r=this.h[i]>>>13,this.h[i]&=8191;for(this.h[0]+=5*r,r=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=r,r=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=r,s[0]=this.h[0]+5,r=s[0]>>>13,s[0]&=8191,i=1;i<10;i++)s[i]=this.h[i]+r,r=s[i]>>>13,s[i]&=8191;for(s[9]-=8192,n=(1^r)-1,i=0;i<10;i++)s[i]&=n;for(n=~n,i=0;i<10;i++)this.h[i]=this.h[i]&n|s[i];for(this.h[0]=65535&(this.h[0]|this.h[1]<<13),this.h[1]=65535&(this.h[1]>>>3|this.h[2]<<10),this.h[2]=65535&(this.h[2]>>>6|this.h[3]<<7),this.h[3]=65535&(this.h[3]>>>9|this.h[4]<<4),this.h[4]=65535&(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14),this.h[5]=65535&(this.h[6]>>>2|this.h[7]<<11),this.h[6]=65535&(this.h[7]>>>5|this.h[8]<<8),this.h[7]=65535&(this.h[8]>>>8|this.h[9]<<5),o=this.h[0]+this.pad[0],this.h[0]=65535&o,i=1;i<8;i++)o=(this.h[i]+this.pad[i]|0)+(o>>>16)|0,this.h[i]=65535&o;e[t+0]=this.h[0]>>>0&255,e[t+1]=this.h[0]>>>8&255,e[t+2]=this.h[1]>>>0&255,e[t+3]=this.h[1]>>>8&255,e[t+4]=this.h[2]>>>0&255,e[t+5]=this.h[2]>>>8&255,e[t+6]=this.h[3]>>>0&255,e[t+7]=this.h[3]>>>8&255,e[t+8]=this.h[4]>>>0&255,e[t+9]=this.h[4]>>>8&255,e[t+10]=this.h[5]>>>0&255,e[t+11]=this.h[5]>>>8&255,e[t+12]=this.h[6]>>>0&255,e[t+13]=this.h[6]>>>8&255,e[t+14]=this.h[7]>>>0&255,e[t+15]=this.h[7]>>>8&255},R.prototype.update=function(e,t,r){var n,o;if(this.leftover){for((o=16-this.leftover)>r&&(o=r),n=0;n<o;n++)this.buffer[this.leftover+n]=e[t+n];if(r-=o,t+=o,this.leftover+=o,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(r>=16&&(o=r-r%16,this.blocks(e,t,o),t+=o,r-=o),r){for(n=0;n<r;n++)this.buffer[this.leftover+n]=e[t+n];this.leftover+=r}};var Y=N,$=_,q=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function J(e,t,r,n){for(var o,i,s,a,l,f,u,c,h,d,p,y,g,w,m,b,x,A,v,E,R,B,j,N,_,U,I=new Int32Array(16),S=new Int32Array(16),T=e[0],O=e[1],C=e[2],M=e[3],L=e[4],D=e[5],P=e[6],k=e[7],K=t[0],z=t[1],G=t[2],H=t[3],V=t[4],F=t[5],Y=t[6],$=t[7],J=0;n>=128;){for(v=0;v<16;v++)E=8*v+J,I[v]=r[E+0]<<24|r[E+1]<<16|r[E+2]<<8|r[E+3],S[v]=r[E+4]<<24|r[E+5]<<16|r[E+6]<<8|r[E+7];for(v=0;v<80;v++)if(o=T,i=O,s=C,a=M,l=L,f=D,u=P,h=K,d=z,p=G,y=H,g=V,w=F,m=Y,j=65535&(B=$),N=B>>>16,_=65535&(R=k),U=R>>>16,j+=65535&(B=(V>>>14|L<<18)^(V>>>18|L<<14)^(L>>>9|V<<23)),N+=B>>>16,_+=65535&(R=(L>>>14|V<<18)^(L>>>18|V<<14)^(V>>>9|L<<23)),U+=R>>>16,j+=65535&(B=V&F^~V&Y),N+=B>>>16,_+=65535&(R=L&D^~L&P),U+=R>>>16,j+=65535&(B=q[2*v+1]),N+=B>>>16,_+=65535&(R=q[2*v]),U+=R>>>16,R=I[v%16],N+=(B=S[v%16])>>>16,_+=65535&R,U+=R>>>16,_+=(N+=(j+=65535&B)>>>16)>>>16,j=65535&(B=A=65535&j|N<<16),N=B>>>16,_=65535&(R=x=65535&_|(U+=_>>>16)<<16),U=R>>>16,j+=65535&(B=(K>>>28|T<<4)^(T>>>2|K<<30)^(T>>>7|K<<25)),N+=B>>>16,_+=65535&(R=(T>>>28|K<<4)^(K>>>2|T<<30)^(K>>>7|T<<25)),U+=R>>>16,N+=(B=K&z^K&G^z&G)>>>16,_+=65535&(R=T&O^T&C^O&C),U+=R>>>16,c=65535&(_+=(N+=(j+=65535&B)>>>16)>>>16)|(U+=_>>>16)<<16,b=65535&j|N<<16,j=65535&(B=y),N=B>>>16,_=65535&(R=a),U=R>>>16,N+=(B=A)>>>16,_+=65535&(R=x),U+=R>>>16,O=o,C=i,M=s,L=a=65535&(_+=(N+=(j+=65535&B)>>>16)>>>16)|(U+=_>>>16)<<16,D=l,P=f,k=u,T=c,z=h,G=d,H=p,V=y=65535&j|N<<16,F=g,Y=w,$=m,K=b,v%16==15)for(E=0;E<16;E++)R=I[E],j=65535&(B=S[E]),N=B>>>16,_=65535&R,U=R>>>16,R=I[(E+9)%16],j+=65535&(B=S[(E+9)%16]),N+=B>>>16,_+=65535&R,U+=R>>>16,x=I[(E+1)%16],j+=65535&(B=((A=S[(E+1)%16])>>>1|x<<31)^(A>>>8|x<<24)^(A>>>7|x<<25)),N+=B>>>16,_+=65535&(R=(x>>>1|A<<31)^(x>>>8|A<<24)^x>>>7),U+=R>>>16,x=I[(E+14)%16],N+=(B=((A=S[(E+14)%16])>>>19|x<<13)^(x>>>29|A<<3)^(A>>>6|x<<26))>>>16,_+=65535&(R=(x>>>19|A<<13)^(A>>>29|x<<3)^x>>>6),U+=R>>>16,U+=(_+=(N+=(j+=65535&B)>>>16)>>>16)>>>16,I[E]=65535&_|U<<16,S[E]=65535&j|N<<16;j=65535&(B=K),N=B>>>16,_=65535&(R=T),U=R>>>16,R=e[0],N+=(B=t[0])>>>16,_+=65535&R,U+=R>>>16,U+=(_+=(N+=(j+=65535&B)>>>16)>>>16)>>>16,e[0]=T=65535&_|U<<16,t[0]=K=65535&j|N<<16,j=65535&(B=z),N=B>>>16,_=65535&(R=O),U=R>>>16,R=e[1],N+=(B=t[1])>>>16,_+=65535&R,U+=R>>>16,U+=(_+=(N+=(j+=65535&B)>>>16)>>>16)>>>16,e[1]=O=65535&_|U<<16,t[1]=z=65535&j|N<<16,j=65535&(B=G),N=B>>>16,_=65535&(R=C),U=R>>>16,R=e[2],N+=(B=t[2])>>>16,_+=65535&R,U+=R>>>16,U+=(_+=(N+=(j+=65535&B)>>>16)>>>16)>>>16,e[2]=C=65535&_|U<<16,t[2]=G=65535&j|N<<16,j=65535&(B=H),N=B>>>16,_=65535&(R=M),U=R>>>16,R=e[3],N+=(B=t[3])>>>16,_+=65535&R,U+=R>>>16,U+=(_+=(N+=(j+=65535&B)>>>16)>>>16)>>>16,e[3]=M=65535&_|U<<16,t[3]=H=65535&j|N<<16,j=65535&(B=V),N=B>>>16,_=65535&(R=L),U=R>>>16,R=e[4],N+=(B=t[4])>>>16,_+=65535&R,U+=R>>>16,U+=(_+=(N+=(j+=65535&B)>>>16)>>>16)>>>16,e[4]=L=65535&_|U<<16,t[4]=V=65535&j|N<<16,j=65535&(B=F),N=B>>>16,_=65535&(R=D),U=R>>>16,R=e[5],N+=(B=t[5])>>>16,_+=65535&R,U+=R>>>16,U+=(_+=(N+=(j+=65535&B)>>>16)>>>16)>>>16,e[5]=D=65535&_|U<<16,t[5]=F=65535&j|N<<16,j=65535&(B=Y),N=B>>>16,_=65535&(R=P),U=R>>>16,R=e[6],N+=(B=t[6])>>>16,_+=65535&R,U+=R>>>16,U+=(_+=(N+=(j+=65535&B)>>>16)>>>16)>>>16,e[6]=P=65535&_|U<<16,t[6]=Y=65535&j|N<<16,j=65535&(B=$),N=B>>>16,_=65535&(R=k),U=R>>>16,R=e[7],N+=(B=t[7])>>>16,_+=65535&R,U+=R>>>16,U+=(_+=(N+=(j+=65535&B)>>>16)>>>16)>>>16,e[7]=k=65535&_|U<<16,t[7]=$=65535&j|N<<16,J+=128,n-=128}return n}function W(e,t,r){var n,o=new Int32Array(8),i=new Int32Array(8),s=new Uint8Array(256),a=r;for(o[0]=1779033703,o[1]=3144134277,o[2]=1013904242,o[3]=2773480762,o[4]=1359893119,o[5]=2600822924,o[6]=528734635,o[7]=1541459225,i[0]=4089235720,i[1]=2227873595,i[2]=4271175723,i[3]=1595750129,i[4]=2917565137,i[5]=725511199,i[6]=4215389547,i[7]=327033209,J(o,i,t,r),r%=128,n=0;n<r;n++)s[n]=t[a-r+n];for(s[r]=128,s[(r=256-128*(r<112?1:0))-9]=0,d(s,r-8,a/536870912|0,a<<3),J(o,i,s,r),n=0;n<8;n++)d(e,8*n,o[n],i[n]);return 0}function Z(e,r){var n=t(),o=t(),i=t(),s=t(),a=t(),l=t(),u=t(),c=t(),h=t();D(n,e[1],e[0]),D(h,r[1],r[0]),P(n,n,h),L(o,e[0],e[1]),L(h,r[0],r[1]),P(o,o,h),P(i,e[3],r[3]),P(i,i,f),P(s,e[2],r[2]),L(s,s,s),D(a,o,n),D(l,s,i),L(u,s,i),L(c,o,n),P(e[0],a,l),P(e[1],c,u),P(e[2],u,l),P(e[3],a,c)}function Q(e,t,r){var n;for(n=0;n<4;n++)S(e[n],t[n],r)}function X(e,r){var n=t(),o=t(),i=t();K(i,r[2]),P(n,r[0],i),P(o,r[1],i),T(e,o),e[31]^=C(n)<<7}function ee(e,t,r){var n,o;for(U(e[0],i),U(e[1],s),U(e[2],s),U(e[3],i),o=255;o>=0;--o)Q(e,t,n=r[o/8|0]>>(7&o)&1),Z(t,e),Z(e,e),Q(e,t,n)}function te(e,r){var n=[t(),t(),t(),t()];U(n[0],u),U(n[1],c),U(n[2],s),P(n[3],u,c),ee(e,n,r)}function re(e,n,o){var i,s=new Uint8Array(64),a=[t(),t(),t(),t()];for(o||r(n,32),W(s,n,32),s[0]&=248,s[31]&=127,s[31]|=64,te(a,s),X(e,a),i=0;i<32;i++)n[i+32]=e[i];return 0}var ne=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function ie(e,t){var r,n,o,i;for(n=63;n>=32;--n){for(r=0,o=n-32,i=n-12;o<i;++o)t[o]+=r-16*t[n]*ne[o-(n-32)],r=Math.floor((t[o]+128)/256),t[o]-=256*r;t[o]+=r,t[n]=0}for(r=0,o=0;o<32;o++)t[o]+=r-(t[31]>>4)*ne[o],r=t[o]>>8,t[o]&=255;for(o=0;o<32;o++)t[o]-=r*ne[o];for(n=0;n<32;n++)t[n+1]+=t[n]>>8,e[n]=255&t[n]}function se(e){var t,r=new Float64Array(64);for(t=0;t<64;t++)r[t]=e[t];for(t=0;t<64;t++)e[t]=0;ie(e,r)}function ae(e,r,n,o){var i,s,a=new Uint8Array(64),l=new Uint8Array(64),f=new Uint8Array(64),u=new Float64Array(64),c=[t(),t(),t(),t()];W(a,o,32),a[0]&=248,a[31]&=127,a[31]|=64;var h=n+64;for(i=0;i<n;i++)e[64+i]=r[i];for(i=0;i<32;i++)e[32+i]=a[32+i];for(W(f,e.subarray(32),n+32),se(f),te(c,f),X(e,c),i=32;i<64;i++)e[i]=o[i];for(W(l,e,n+64),se(l),i=0;i<64;i++)u[i]=0;for(i=0;i<32;i++)u[i]=f[i];for(i=0;i<32;i++)for(s=0;s<32;s++)u[i+s]+=l[i]*a[s];return ie(e.subarray(32),u),h}function le(e,r,n,o){var a,f=new Uint8Array(32),u=new Uint8Array(64),c=[t(),t(),t(),t()],d=[t(),t(),t(),t()];if(n<64)return-1;if(function(e,r){var n=t(),o=t(),a=t(),f=t(),u=t(),c=t(),d=t();return U(e[2],s),M(e[1],r),k(a,e[1]),P(f,a,l),D(a,a,e[2]),L(f,e[2],f),k(u,f),k(c,u),P(d,c,u),P(n,d,a),P(n,n,f),z(n,n),P(n,n,a),P(n,n,f),P(n,n,f),P(e[0],n,f),k(o,e[0]),P(o,o,f),O(o,a)&&P(e[0],e[0],h),k(o,e[0]),P(o,o,f),O(o,a)?-1:(C(e[0])===r[31]>>7&&D(e[0],i,e[0]),P(e[3],e[0],e[1]),0)}(d,o))return-1;for(a=0;a<n;a++)e[a]=r[a];for(a=0;a<32;a++)e[a+32]=o[a];if(W(u,e,n),se(u),ee(c,d,u),te(d,r.subarray(32)),Z(c,d),X(f,c),n-=64,g(r,0,f,0)){for(a=0;a<n;a++)e[a]=0;return-1}for(a=0;a<n;a++)e[a]=r[a+64];return n}var fe,ue=16,ce=64,he=32,de=64;function pe(e,t){if(32!==e.length)throw new Error("bad key size");if(24!==t.length)throw new Error("bad nonce size")}function ye(){for(var e=0;e<arguments.length;e++)if(!(arguments[e]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function ge(e){for(var t=0;t<e.length;t++)e[t]=0}e.lowlevel={crypto_core_hsalsa20:m,crypto_stream_xor:E,crypto_stream:v,crypto_stream_salsa20_xor:x,crypto_stream_salsa20:A,crypto_onetimeauth:B,crypto_onetimeauth_verify:j,crypto_verify_16:y,crypto_verify_32:g,crypto_secretbox:N,crypto_secretbox_open:_,crypto_scalarmult:G,crypto_scalarmult_base:H,crypto_box_beforenm:F,crypto_box_afternm:Y,crypto_box:function(e,t,r,n,o,i){var s=new Uint8Array(32);return F(s,o,i),Y(e,t,r,n,s)},crypto_box_open:function(e,t,r,n,o,i){var s=new Uint8Array(32);return F(s,o,i),$(e,t,r,n,s)},crypto_box_keypair:V,crypto_hash:W,crypto_sign:ae,crypto_sign_keypair:re,crypto_sign_open:le,crypto_secretbox_KEYBYTES:32,crypto_secretbox_NONCEBYTES:24,crypto_secretbox_ZEROBYTES:32,crypto_secretbox_BOXZEROBYTES:ue,crypto_scalarmult_BYTES:32,crypto_scalarmult_SCALARBYTES:32,crypto_box_PUBLICKEYBYTES:32,crypto_box_SECRETKEYBYTES:32,crypto_box_BEFORENMBYTES:32,crypto_box_NONCEBYTES:24,crypto_box_ZEROBYTES:32,crypto_box_BOXZEROBYTES:16,crypto_sign_BYTES:ce,crypto_sign_PUBLICKEYBYTES:he,crypto_sign_SECRETKEYBYTES:de,crypto_sign_SEEDBYTES:32,crypto_hash_BYTES:64,gf:t,D:l,L:ne,pack25519:T,unpack25519:M,M:P,A:L,S:k,Z:D,pow2523:z,add:Z,set25519:U,modL:ie,scalarmult:ee,scalarbase:te},e.randomBytes=function(e){var t=new Uint8Array(e);return r(t,e),t},e.secretbox=function(e,t,r){ye(e,t,r),pe(r,t);for(var n=new Uint8Array(32+e.length),o=new Uint8Array(n.length),i=0;i<e.length;i++)n[i+32]=e[i];return N(o,n,n.length,t,r),o.subarray(ue)},e.secretbox.open=function(e,t,r){ye(e,t,r),pe(r,t);for(var n=new Uint8Array(ue+e.length),o=new Uint8Array(n.length),i=0;i<e.length;i++)n[i+ue]=e[i];return n.length<32||0!==_(o,n,n.length,t,r)?null:o.subarray(32)},e.secretbox.keyLength=32,e.secretbox.nonceLength=24,e.secretbox.overheadLength=ue,e.scalarMult=function(e,t){if(ye(e,t),32!==e.length)throw new Error("bad n size");if(32!==t.length)throw new Error("bad p size");var r=new Uint8Array(32);return G(r,e,t),r},e.scalarMult.base=function(e){if(ye(e),32!==e.length)throw new Error("bad n size");var t=new Uint8Array(32);return H(t,e),t},e.scalarMult.scalarLength=32,e.scalarMult.groupElementLength=32,e.box=function(t,r,n,o){var i=e.box.before(n,o);return e.secretbox(t,r,i)},e.box.before=function(e,t){ye(e,t),function(e,t){if(32!==e.length)throw new Error("bad public key size");if(32!==t.length)throw new Error("bad secret key size")}(e,t);var r=new Uint8Array(32);return F(r,e,t),r},e.box.after=e.secretbox,e.box.open=function(t,r,n,o){var i=e.box.before(n,o);return e.secretbox.open(t,r,i)},e.box.open.after=e.secretbox.open,e.box.keyPair=function(){var e=new Uint8Array(32),t=new Uint8Array(32);return V(e,t),{publicKey:e,secretKey:t}},e.box.keyPair.fromSecretKey=function(e){if(ye(e),32!==e.length)throw new Error("bad secret key size");var t=new Uint8Array(32);return H(t,e),{publicKey:t,secretKey:new Uint8Array(e)}},e.box.publicKeyLength=32,e.box.secretKeyLength=32,e.box.sharedKeyLength=32,e.box.nonceLength=24,e.box.overheadLength=e.secretbox.overheadLength,e.sign=function(e,t){if(ye(e,t),t.length!==de)throw new Error("bad secret key size");var r=new Uint8Array(ce+e.length);return ae(r,e,e.length,t),r},e.sign.open=function(e,t){if(ye(e,t),t.length!==he)throw new Error("bad public key size");var r=new Uint8Array(e.length),n=le(r,e,e.length,t);if(n<0)return null;for(var o=new Uint8Array(n),i=0;i<o.length;i++)o[i]=r[i];return o},e.sign.detached=function(t,r){for(var n=e.sign(t,r),o=new Uint8Array(ce),i=0;i<o.length;i++)o[i]=n[i];return o},e.sign.detached.verify=function(e,t,r){if(ye(e,t,r),t.length!==ce)throw new Error("bad signature size");if(r.length!==he)throw new Error("bad public key size");var n,o=new Uint8Array(ce+e.length),i=new Uint8Array(ce+e.length);for(n=0;n<ce;n++)o[n]=t[n];for(n=0;n<e.length;n++)o[n+ce]=e[n];return le(i,o,o.length,r)>=0},e.sign.keyPair=function(){var e=new Uint8Array(he),t=new Uint8Array(de);return re(e,t),{publicKey:e,secretKey:t}},e.sign.keyPair.fromSecretKey=function(e){if(ye(e),e.length!==de)throw new Error("bad secret key size");for(var t=new Uint8Array(he),r=0;r<t.length;r++)t[r]=e[32+r];return{publicKey:t,secretKey:new Uint8Array(e)}},e.sign.keyPair.fromSeed=function(e){if(ye(e),32!==e.length)throw new Error("bad seed size");for(var t=new Uint8Array(he),r=new Uint8Array(de),n=0;n<32;n++)r[n]=e[n];return re(t,r,!0),{publicKey:t,secretKey:r}},e.sign.publicKeyLength=he,e.sign.secretKeyLength=de,e.sign.seedLength=32,e.sign.signatureLength=ce,e.hash=function(e){ye(e);var t=new Uint8Array(64);return W(t,e,e.length),t},e.hash.hashLength=64,e.verify=function(e,t){return ye(e,t),0!==e.length&&0!==t.length&&e.length===t.length&&0===p(e,0,t,0,e.length)},e.setPRNG=function(e){r=e},(fe="undefined"!=typeof self?self.crypto||self.msCrypto:null)&&fe.getRandomValues?e.setPRNG(function(e,t){var r,n=new Uint8Array(t);for(r=0;r<t;r+=65536)fe.getRandomValues(n.subarray(r,r+Math.min(t-r,65536)));for(r=0;r<t;r++)e[r]=n[r];ge(n)}):void 0!==rr&&(fe=oe)&&fe.randomBytes&&e.setPRNG(function(e,t){var r,n=fe.randomBytes(t);for(r=0;r<t;r++)e[r]=n[r];ge(n)})}(nr.exports?nr.exports:self.nacl=self.nacl||{});var or=nr.exports;const ir="aig_sovereign_session_token";const sr=new class{async launchMission(e){try{return(await n.post("/swarm/mission",{objective:e})).data}catch(t){throw t}}async getKnowledgeGraph(){try{return(await n.get("/knowledge-graph/full")).data}catch(e){return{nodes:[{id:"mission_1",type:"mission",label:"Market Research 2026"},{id:"finding_1",type:"finding",label:"AI Trends: Agentic AI"},{id:"concept_1",type:"concept",label:"Sovereign Intelligence"}],edges:[{source:"mission_1",target:"finding_1",relation:"created"},{source:"finding_1",target:"concept_1",relation:"relates_to"}]}}}async getRecentMissions(){try{return(await n.get("/swarm/missions/recent")).data}catch(e){return[]}}async generateRegistrationOptions(){return(await n.get("/auth/webauthn/register-options")).data}async verifyRegistration(e){return(await n.post("/auth/webauthn/register-verify",e)).data}async generateAuthenticationOptions(){return(await n.get("/auth/webauthn/login-options")).data}async verifyAuthentication(e){return(await n.post("/auth/webauthn/login-verify",e)).data}async initiateSovereignHandshake(){try{const e=await n.get("/sovereign/handshake/init"),{handshakeId:t,publicKey:r}=e.data,o=or.box.keyPair(),[i,s]=tr.Encrypt768(this.hexToUint8Array(r.pqc)),a=or.box.before(this.hexToUint8Array(r.classic),o.secretKey),l=await n.post("/sovereign/handshake/finalize",{handshakeId:t,clientPublicKey:{classic:this.uint8ArrayToHex(o.publicKey)},clientCiphertext:this.uint8ArrayToHex(i)}),{sessionToken:f}=l.data;localStorage.setItem(ir,f);const u=new Uint8Array(a.length+s.length);return u.set(a),u.set(s,a.length),localStorage.setItem("aig_sovereign_secret",this.uint8ArrayToHex(u)),{sessionToken:f}}catch(e){throw e}}getSovereignToken(){return localStorage.getItem(ir)}isUnlocked(){return!!this.getSovereignToken()}logout(){localStorage.removeItem(ir),localStorage.removeItem("aig_sovereign_secret")}async decryptFinding(e){const t=localStorage.getItem("aig_sovereign_secret");if(!t)throw new Error("VAULT_LOCKED");try{const r=this.hexToBuffer(t),n=this.hexToBuffer(e.iv),o=this.hexToBuffer(e.ciphertext),i=this.hexToBuffer(e.tag),s=new Uint8Array(o.byteLength+i.byteLength);s.set(new Uint8Array(o)),s.set(new Uint8Array(i),o.byteLength);const a=await window.crypto.subtle.importKey("raw",r,"AES-GCM",!1,["decrypt"]),l=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:n,tagLength:128},a,s);return(new TextDecoder).decode(l)}catch(r){throw new Error("DECRYPTION_FAILED")}}async enrollVoice(e){return(await n.post("/sovereign/biometrics/voice-enroll",{audio:e})).data}async verifyVoice(e){return(await n.post("/sovereign/biometrics/voice-verify",{audio:e})).data}async getResourceForecast(){return(await n.get("/sovereign/sentinel/forecast")).data}hexToUint8Array(e){const t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++)t[r]=parseInt(e.substring(2*r,2*r+2),16);return t}uint8ArrayToHex(e){return Array.from(e).map(e=>e.toString(16).padStart(2,"0")).join("")}hexToBuffer(e){return this.hexToUint8Array(e).buffer}},ar=()=>{const{notify:t}=o(),[n,i]=r.useState(""),[x,A]=r.useState([]),[v,E]=r.useState(!1),[R,B]=r.useState(!0),[j,N]=r.useState(!1),[_,U]=r.useState(!1),[I,T]=r.useState(!1),[O,M]=r.useState(null),[L,D]=r.useState("terminal"),[P,k]=r.useState({}),[K,z]=r.useState(null),[G,H]=r.useState([]);r.useEffect(()=>{V(),"sentinel"===L&&F()},[L]);const V=async()=>{try{const e=await sr.getRecentMissions();A(e)}catch(e){}},F=async()=>{try{const e=await sr.getResourceForecast();e.success&&H(e.forecasts)}catch(e){}},Y=async(e,r)=>{t(r?"AUTORIZANDO REPARACI\xd3N":"RECHAZANDO PROPUESTA","Enviando comando soberano...","info");try{await sr.launchMission(`[REPAIR_AUTH] proposalId=${e.id} approved=${r}`),t(r?"ACCI\xd3N AUTORIZADA":"REPARACI\xd3N CANCELADA","El sistema ha procesado el comando.","success"),V()}catch(n){t("ERROR DE COMANDO","No se pudo procesar la autorizaci\xf3n.","error")}},$=x.filter(e=>e.metadata?.isHealingProposal),q=x.filter(e=>!e.metadata?.isHealingProposal);return e.jsxs("div",{className:"flex flex-col h-full smooth-mesh-bg text-white font-sans overflow-hidden",children:[e.jsxs("div",{className:"p-8 border-b border-white/5 flex justify-between items-center bg-black/50 backdrop-blur-md",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-orbitron font-bold tracking-[0.2em] text-transparent bg-clip-text bg-linear-to-r from-nexus-cyan via-white to-nexus-violet",children:"SOVEREIGN INTELLIGENCE HUB"}),e.jsx("p",{className:"text-nexus-silver/40 text-xs font-orbitron tracking-widest mt-2 uppercase",children:"Centro de Mando de Enjambre Aut\xf3nomo v2.5"})]}),e.jsxs("div",{className:"flex gap-4 items-center",children:[$.length>0&&!R&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-amber-500/10 border border-amber-500/30 rounded-lg animate-pulse",children:[e.jsx(s,{size:12,className:"text-amber-500"}),e.jsx("span",{className:"text-[10px] text-amber-500 font-orbitron font-bold",children:"SYSTEM HEALING REQUIRED"})]}),e.jsx("div",{className:"flex flex-col items-end mr-4",children:e.jsx("button",{onClick:R?async()=>{N(!0);try{const e=await sr.generateAuthenticationOptions(),r=await C(e);await sr.verifyAuthentication(r);if(!(await(async()=>(U(!0),t("DESAF\xcdO BIOM\xc9TRICO",'Habla ahora para verificar tu identidad: "Soberan\xeda AIGestion activa"',"info"),new Promise(e=>{navigator.mediaDevices.getUserMedia({audio:!0}).then(t=>{const r=new MediaRecorder(t),n=[];r.ondataavailable=e=>n.push(e.data),r.onstop=async()=>{const t=new Blob(n,{type:"audio/webm"}),r=new FileReader;r.readAsDataURL(t),r.onloadend=async()=>{const t=r.result.split(",")[1];try{await sr.verifyVoice(t),e(!0)}catch(n){e(!1)}finally{U(!1)}}},r.start(),setTimeout(()=>r.stop(),4e3)}).catch(()=>{U(!1),e(!1)})})))()))throw new Error("Biometric verification failed");t("ESTABLECIENDO CANAL PQC","Iniciando intercambio de llaves cu\xe1nticas...","info");const n=await sr.initiateSovereignHandshake();M(n.sessionToken),B(!1),t("SOVEREIGN ACCESS GRANTED","Canal cu\xe1ntico y biometr\xeda verificados. B\xf3veda desbloqueada.","success"),V()}catch(e){t("ACCESO DENEGADO","Fallo en la verificaci\xf3n multi-factor (Llave + Voz).","error")}finally{N(!1)}}:()=>B(!0),className:"flex items-center gap-2 px-4 py-2 rounded-xl text-[10px] font-orbitron font-bold transition-all "+(R?"bg-red-500/10 text-red-500 border border-red-500/30 animate-pulse":"bg-green-500/10 text-green-500 border border-green-500/30"),children:j?"VERIFICANDO...":R?e.jsxs(e.Fragment,{children:[e.jsx(a,{size:12})," VAULT LOCKED"]}):e.jsxs(e.Fragment,{children:[e.jsx(l,{size:12})," VAULT OPEN"]})})}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"text-[10px] text-nexus-cyan font-bold tracking-widest",children:"IA STATUS"}),e.jsx("span",{className:"text-xs text-white/80 animate-pulse uppercase",children:R?"RESTRICTED":"GOD MODE ACTIVE"})]}),O&&e.jsxs("div",{className:"flex flex-col items-start px-3 py-1 bg-nexus-cyan/5 rounded-lg border border-nexus-cyan/20",children:[e.jsx("span",{className:"text-[8px] text-nexus-cyan font-bold tracking-[0.2em]",children:"PQC SESSION"}),e.jsxs("span",{className:"text-[9px] text-white/40 font-mono",children:[O.substring(0,12),"..."]})]}),e.jsx("div",{className:"w-10 h-10 rounded-full border flex items-center justify-center cursor-pointer transition-all "+(_?"bg-red-500/20 border-red-500 animate-pulse":"bg-nexus-cyan/20 border-nexus-cyan/40 hover:bg-nexus-cyan/40"),onClick:async()=>{U(!0),t("GRABANDO BIOMETR\xcdA",'Habla ahora: "Soberan\xeda AIGestion activa"',"info");try{const e=await navigator.mediaDevices.getUserMedia({audio:!0}),r=new MediaRecorder(e),n=[];r.ondataavailable=e=>n.push(e.data),r.onstop=async()=>{const e=new Blob(n,{type:"audio/webm"}),r=new FileReader;r.readAsDataURL(e),r.onloadend=async()=>{const e=r.result.split(",")[1];await sr.enrollVoice(e),t("BIO-LLAVE REGISTRADA","Tu huella de voz ha sido vinculada al vault.","success"),T(!1),U(!1)}},r.start(),setTimeout(()=>r.stop(),4e3)}catch(e){t("FALLO BIOM\xc9TRICO","No se pudo acceder al micr\xf3fono.","error"),U(!1)}},title:"Enroll Sovereign VoiceKey",children:e.jsx(f,{size:20,className:_?"text-red-500":"text-nexus-cyan shadow-glow"})}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-nexus-cyan/20 border border-nexus-cyan/40 flex items-center justify-center cursor-pointer hover:bg-nexus-cyan/40 transition-all",onClick:async()=>{try{const e=await sr.generateRegistrationOptions(),r=await S(e);await sr.verifyRegistration(r),t("LLAVE REGISTRADA","Tu identidad soberana ha sido vinculada al hardware.","success")}catch(e){t("FALLO DE REGISTRO","No se pudo vincular la llave f\xedsica.","error")}},title:"Register Hardware Key",children:e.jsx(u,{size:20,className:"text-nexus-cyan shadow-glow"})})]})]}),e.jsx(m,{children:_&&e.jsxs(b.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 bg-black/80 backdrop-blur-xl flex flex-col items-center justify-center",children:[e.jsxs("div",{className:"relative w-48 h-48 flex items-center justify-center",children:[e.jsx(b.div,{animate:{scale:[1,1.5,1],opacity:[.2,.5,.2]},transition:{duration:2,repeat:1/0},className:"absolute inset-0 bg-red-500 rounded-full"}),e.jsx("div",{className:"relative w-24 h-24 rounded-full bg-red-500 flex items-center justify-center shadow-red-glow",children:e.jsx(f,{size:40,className:"text-white"})})]}),e.jsx("h2",{className:"text-2xl font-orbitron font-bold text-white mt-8 tracking-widest uppercase",children:"Escaneando Biometr\xeda de Voz"}),e.jsx("p",{className:"text-nexus-silver/60 font-orbitron text-xs mt-4 animate-pulse",children:'Habla ahora: "Soberan\xeda AIGestion activa"'})]})}),e.jsxs("div",{className:"flex-grow overflow-hidden flex",children:[e.jsxs("div",{className:"w-20 border-r border-white/5 flex flex-col items-center py-8 gap-8",children:[e.jsx("button",{onClick:()=>D("terminal"),className:"p-3 rounded-xl transition-all "+("terminal"===L?"bg-nexus-cyan/10 text-nexus-cyan border border-nexus-cyan/30":"text-white/30 hover:text-white"),title:"TERMINAL",children:e.jsx(c,{size:24})}),e.jsx("button",{onClick:()=>D("missions"),className:"p-3 rounded-xl transition-all "+("missions"===L?"bg-nexus-violet/10 text-nexus-violet border border-nexus-violet/30":"text-white/30 hover:text-white"),title:"MISIONES",children:e.jsxs("div",{className:"relative",children:[e.jsx(s,{size:24}),$.length>0&&e.jsx("div",{className:"absolute -top-1 -right-1 w-2 h-2 bg-amber-500 rounded-full animate-ping"})]})}),e.jsx("button",{onClick:()=>D("memory"),className:"p-3 rounded-xl transition-all "+("memory"===L?"bg-nexus-cyan/10 text-nexus-cyan border border-white/10":"text-white/30 hover:text-white"),title:"MEMORIA",children:e.jsx(h,{size:24})}),e.jsx("button",{onClick:()=>D("sentinel"),className:"p-3 rounded-xl transition-all "+("sentinel"===L?"bg-nexus-violet/10 text-nexus-violet border border-nexus-violet/30":"text-white/30 hover:text-white"),title:"CENTINELA",children:e.jsx(d,{size:24})})]}),e.jsx("div",{className:"flex-grow p-10 overflow-y-auto custom-scrollbar",children:e.jsxs(m,{mode:"wait",children:["terminal"===L&&e.jsxs(b.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"max-w-4xl mx-auto space-y-12",children:[$.length>0&&!R&&e.jsxs(b.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"p-6 rounded-2xl bg-amber-500/10 border border-amber-500/30 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-amber-500/20 flex items-center justify-center",children:e.jsx(s,{className:"text-amber-500"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-orbitron font-bold text-amber-500",children:"ANOMAL\xcdA DETECTADA"}),e.jsxs("p",{className:"text-xs text-nexus-silver/60",children:["Se requieren ",$.length," acciones de reparaci\xf3n soberana."]})]})]}),e.jsx("button",{onClick:()=>D("missions"),className:"text-[10px] font-orbitron font-bold px-4 py-2 bg-amber-500/20 text-amber-500 rounded-lg hover:bg-amber-500/30 transition-all",children:"REVISAR PROPUESTAS"})]}),e.jsxs("section",{className:"premium-glass p-8 rounded-3xl border border-white/5 relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10",children:e.jsx(p,{size:80})}),e.jsx("h3",{className:"text-xl font-orbitron font-bold text-nexus-cyan mb-6 tracking-wider",children:"DEPLEGAR MISI\xd3N DE ENJAMBRE"}),e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{value:n,onChange:e=>i(e.target.value),placeholder:"Define el objetivo estrat\xe9gico para el enjambre soberano...",className:"w-full h-32 bg-black/40 border border-white/10 rounded-2xl p-6 text-nexus-silver focus:border-nexus-cyan/50 outline-none transition-all resize-none placeholder:text-white/10"}),e.jsx("div",{className:"absolute bottom-4 right-4",children:e.jsx("button",{onClick:async()=>{if(n.trim()){E(!0),t("INICIANDO ENJAMBRE",`Objetivo: ${n.substring(0,30)}...`,"info");try{await sr.launchMission(n),t("MISI\xd3N DESPLEGADA","El enjambre aut\xf3nomo ha comenzado la investigaci\xf3n.","success"),i(""),V()}catch(e){t("ERROR DE DESPLIEGUE","No se pudo inicializar el enjambre soberano.","error")}finally{E(!1)}}},disabled:v||!n.trim(),className:"flex items-center gap-3 bg-gradient-to-r from-nexus-cyan to-nexus-violet px-8 py-3 rounded-xl font-orbitron font-bold text-xs tracking-widest uppercase hover:shadow-cyan-glow transition-all disabled:opacity-50",children:v?"DESPLEGANDO...":e.jsxs(e.Fragment,{children:[e.jsx(y,{size:16,fill:"white"}),"INICIAR MISI\xd3N"]})})})]}),e.jsxs("div",{className:"mt-8 grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white/5 p-4 rounded-xl border border-white/5 flex flex-col justify-between",children:[e.jsx("span",{className:"text-[10px] font-orbitron text-white/30 uppercase tracking-widest",children:"Estado Bridge"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-nexus-cyan animate-pulse"}),e.jsx("span",{className:"text-nexus-cyan text-xs font-bold",children:"SOVEREIGN_TUNNEL:8000"})]})]}),G.map(t=>e.jsxs("div",{className:"bg-white/5 p-4 rounded-xl border border-white/5",children:[e.jsxs("span",{className:"text-[10px] font-orbitron text-white/30 uppercase tracking-widest",children:["Proyecci\xf3n de ",t.metric]}),e.jsxs("div",{className:"flex items-baseline gap-2 mt-1",children:[e.jsxs("span",{className:"text-xl font-orbitron font-bold text-nexus-silver",children:[Math.round(t.currentValue),"%"]}),e.jsxs("span",{className:"text-[10px] "+(t.predictedValue1h>t.currentValue?"text-amber-500":"text-nexus-cyan"),children:["\u2192 ",Math.round(t.predictedValue1h),"% (1h)"]})]})]},t.metric))]}),e.jsxs("div",{className:"mt-8 grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white/5 p-4 rounded-xl border border-white/5",children:[e.jsx("div",{className:"text-[10px] text-nexus-cyan font-bold tracking-widest mb-1 uppercase",children:"ORQUESTACI\xd3N"}),e.jsx("p",{className:"text-xs text-nexus-silver/60",children:"Multimodelo y multiagente aut\xf3nomo."})]}),e.jsxs("div",{className:"bg-white/5 p-4 rounded-xl border border-white/5",children:[e.jsx("div",{className:"text-[10px] text-nexus-violet font-bold tracking-widest mb-1 uppercase",children:"SOBERAN\xcdA"}),e.jsx("p",{className:"text-xs text-nexus-silver/60",children:"Datos persistidos en Knowledge Graph privado."})]}),e.jsxs("div",{className:"bg-white/5 p-4 rounded-xl border border-white/5",children:[e.jsx("div",{className:"text-[10px] text-green-400 font-bold tracking-widest mb-1 uppercase",children:"ZERO TRUST"}),e.jsx("p",{className:"text-xs text-nexus-silver/60",children:"Comunicaci\xf3n cifrada inter-servicios."})]})]})]}),e.jsx("div",{className:"flex gap-4 overflow-x-auto pb-4 no-scrollbar",children:["NEUROCORE_READY","SWARM_ENGINE_STABLE","MEMORY_GRAPH_SYNCED"].map(t=>e.jsxs("div",{className:"flex-shrink-0 flex items-center gap-2 px-4 py-2 rounded-full border border-white/10 bg-black/40 text-[9px] font-orbitron tracking-widest text-nexus-silver/40",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-nexus-cyan animate-pulse"}),t]},t))})]}),"missions"===L&&e.jsxs(b.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"max-w-5xl mx-auto",children:[e.jsxs("div",{className:"mb-8 flex justify-between items-end",children:[e.jsx("h3",{className:"text-2xl font-orbitron font-bold tracking-tighter",children:"HISTORIAL DE OPERACIONES"}),e.jsx("button",{onClick:V,className:"text-nexus-cyan hover:text-white transition-colors",children:e.jsx(g,{size:20})})]}),$.length>0&&e.jsxs("div",{className:"mb-12",children:[e.jsx("h4",{className:"text-xs font-orbitron font-bold text-amber-500 mb-6 tracking-[0.2em] uppercase",children:"\u26a0\ufe0f Propuestas de Autocuraci\xf3n (Requiere Autorizaci\xf3n Soberana)"}),e.jsx("div",{className:"grid gap-4",children:$.map(t=>e.jsxs("div",{className:"bg-amber-500/5 border border-amber-500/20 p-6 rounded-2xl flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-amber-500/10 flex items-center justify-center",children:e.jsx(p,{className:"text-amber-500"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-bold text-amber-500/80",children:t.objective}),e.jsx("p",{className:"text-[10px] text-nexus-silver/40 uppercase tracking-widest mt-1",children:"Acci\xf3n sugerida por el detective de infraestructura"})]})]}),R?e.jsxs("div",{className:"text-[10px] text-nexus-silver/30 font-orbitron flex items-center gap-2",children:[e.jsx(a,{size:12})," UNLOCK VAULT TO ACTION"]}):e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>Y(t,!1),className:"px-4 py-2 rounded-lg border border-red-500/30 text-red-500 text-[10px] font-bold hover:bg-red-500/5 transition-all",children:"DENY"}),e.jsx("button",{onClick:()=>Y(t,!0),className:"px-6 py-2 bg-amber-500 text-black rounded-lg text-[10px] font-bold hover:shadow-amber-glow transition-all",children:"AUTHORIZE"})]})]},t.id))})]}),e.jsx("h4",{className:"text-xs font-orbitron font-bold text-nexus-cyan mb-6 tracking-[0.2em] uppercase",children:"Misiones de Investigaci\xf3n"}),e.jsx("div",{className:"grid gap-6",children:q.map(r=>e.jsxs("div",{className:"bg-[#111] p-6 rounded-2xl border border-white/5 group hover:border-nexus-cyan/20 transition-all",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 rounded-full "+("completed"===r.status?"bg-green-500/10 text-green-400":"bg-nexus-cyan/10 text-nexus-cyan animate-pulse"),children:"completed"===r.status?e.jsx(w,{size:24}):e.jsx(s,{size:24})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-nexus-silver group-hover:text-nexus-cyan transition-colors",children:r.objective}),e.jsxs("div",{className:"flex gap-4 mt-2 text-[10px] text-white/30 uppercase tracking-widest",children:[e.jsxs("span",{children:["ID: ",r.id]}),e.jsx("span",{children:new Date(r.createdAt).toLocaleString("es-ES")}),e.jsx("span",{className:"completed"===r.status?"text-green-500":"text-nexus-cyan",children:r.status})]})]})]}),e.jsx("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity",children:r.isEncrypted&&R?e.jsxs("div",{className:"flex items-center gap-2 text-red-400 text-xs font-orbitron",children:[e.jsx(a,{size:14})," ENCRYPTED"]}):e.jsx("button",{onClick:()=>(async e=>{if(!P[e.id]){z(e.id);try{const r={iv:e.vaultIV||"",ciphertext:e.results||"",tag:e.vaultTag||""},n=await sr.decryptFinding(r);k(t=>({...t,[e.id]:n})),t("DATOS DESBLOQUEADOS",`Hallazgos de misi\xf3n ${e.id} desencriptados.`,"success")}catch(r){t("FALLO DE DESENCRIPTACI\xd3N","No se pudo validar la firma del vault.","error")}finally{z(null)}}})(r),disabled:K===r.id,className:"bg-white/10 px-4 py-2 rounded-lg text-xs font-bold hover:bg-white/20 disabled:opacity-50",children:K===r.id?"DECRYPTING...":P[r.id]?"UNLOCKED":"VER FINDINGS"})})]}),P[r.id]&&e.jsx(b.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},className:"mt-4 p-4 bg-white/5 rounded-xl border border-white/5 text-xs text-nexus-silver/60 font-mono overflow-hidden",children:e.jsx("pre",{className:"whitespace-pre-wrap",children:P[r.id]})})]},r.id))})]})]})})]})]})};export{ar as SovereignIntelligenceHub};
