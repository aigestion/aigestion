const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DanielaWebsite-D2wri83W.js","assets/three-8Gax2YLg.js","assets/vendor-BIF_SMrh.js","assets/ui-BC88PsNE.js","assets/DanielaWebsite-BV2F20xm.css","assets/Dashboard-2hw_5wIA.js","assets/router-4ee1LRMY.js","assets/EnhancedROI-C56tfwDu.js","assets/CinematicPresentation-CBoxK1XM.js","assets/InteractiveShowcase-BQAseTYN.js","assets/DataVisualization-WC7dDC20.js","assets/DanielaAI-BkM5tVuX.js","assets/NexusAndroid-DROwc-xU.js","assets/DanielaShowcase-usPFUCbu.js","assets/DecentralandOffice-Dn5kQF3J.js","assets/AdminDashboard-B9NCLx0-.js","assets/Card-B-qyeGYp.js","assets/ClientDashboard-BlVZ7ZcN.js","assets/DemoDashboard-Bu_76lIp.js","assets/WorkbenchLayout-Dl9DUKlb.js","assets/DanielaDemo-BBU8cJ_n.js","assets/VirtualOfficePreview-Bz7buQbW.js","assets/WeaponDashboard-DxM4Lq9a.js"])))=>i.map(i=>d[i]);
var yn=Object.defineProperty;var Ms=t=>{throw TypeError(t)};var vn=(t,e,s)=>e in t?yn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var Z=(t,e,s)=>vn(t,typeof e!="symbol"?e+"":e,s),rs=(t,e,s)=>e.has(t)||Ms("Cannot "+s);var b=(t,e,s)=>(rs(t,e,"read from private field"),s?s.call(t):e.get(t)),R=(t,e,s)=>e.has(t)?Ms("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s),A=(t,e,s,r)=>(rs(t,e,"write to private field"),r?r.call(t,s):e.set(t,s),s),Q=(t,e,s)=>(rs(t,e,"access private method"),s);var Lt=(t,e,s,r)=>({set _(n){A(t,e,n,s)},get _(){return b(t,e,r)}});import{j as o,_ as H,c as wn}from"./three-8Gax2YLg.js";import{r as v,b as Dr}from"./vendor-BIF_SMrh.js";import{u as Lr,L as pt,N as Gt,R as xn,a as G,B as _n}from"./router-4ee1LRMY.js";import{m as T,A as Rt,S as Sn,M as kn,C as jn,U as En,B as An,a as Tn,Z as Cn,u as qs,b as Nn,L as Ur,c as On,X as Mr,d as Rn,e as In,f as Pn,g as $n,W as Dn,h as Ln,i as Un,P as Mn,G as qn,j as Bn,T as Fn,k as zn,I as Vn,l as Gn,E as Wn,n as Kn,o as Hn,p as Jn}from"./ui-BC88PsNE.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function s(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=s(n);fetch(n.href,i)}})();const Qn=()=>o.jsxs("div",{className:"fixed inset-0 -z-50 overflow-hidden pointer-events-none",children:[o.jsx(T.div,{animate:{scale:[1,1.2,1],rotate:[0,45,0],x:[0,100,0],y:[0,-50,0]},transition:{duration:20,repeat:1/0,ease:"easeInOut"},className:"absolute top-[-20%] left-[-10%] w-[70%] h-[70%] bg-nexus-violet/5 blur-[120px] rounded-full"}),o.jsx(T.div,{animate:{scale:[1.2,1,1.2],rotate:[0,-30,0],x:[0,-100,0],y:[0,50,0]},transition:{duration:25,repeat:1/0,ease:"easeInOut"},className:"absolute bottom-[-10%] right-[-10%] w-[60%] h-[60%] bg-nexus-cyan/5 blur-[100px] rounded-full"}),o.jsx("div",{className:"absolute inset-0 bg-nexus-obsidian/40 backdrop-blur-[20px]"})]}),Yn=[{sector:"Salud & ClÃ­nicas",title:"Triaje inteligente + automatizaciÃ³n de agenda",impact:["-48% tiempos de espera","+37% productividad del personal","+22% satisfacciÃ³n NPS"]},{sector:"LogÃ­stica & Transporte",title:"OrquestaciÃ³n de rutas con IA y monitoreo predictivo",impact:["-19% costos operativos","+31% cumplimiento de entregas","-54% incidencias crÃ­ticas"]},{sector:"EducaciÃ³n & Gremios",title:"Plataforma de aprendizaje y asistencia para socios",impact:["+62% adopciÃ³n digital","+41% retenciÃ³n de miembros","+28% ingresos por servicios"]}],Xn=()=>o.jsxs("section",{id:"cases",className:"py-32 bg-gradient-to-b from-black via-gray-900/30 to-black relative",children:[o.jsx("div",{className:"absolute inset-0 bg-radial-at-center from-nexus-cyan/10 via-transparent to-transparent"}),o.jsxs("div",{className:"max-w-7xl mx-auto px-6 relative z-10",children:[o.jsxs(T.div,{className:"text-center mb-16",initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.8},viewport:{once:!0},children:[o.jsxs("h2",{className:"text-5xl md:text-7xl font-orbitron font-black text-white mb-4",children:["CASOS DE ",o.jsx("span",{className:"text-nexus-violet text-glow",children:"Ã‰XITO"})]}),o.jsx("p",{className:"text-lg text-nexus-silver/70 max-w-3xl mx-auto",children:"Ejemplos reales con impacto medible. DiseÃ±amos estrategias adaptadas a tu industria y gremio."})]}),o.jsx("div",{className:"grid lg:grid-cols-3 gap-8",children:Yn.map((t,e)=>o.jsxs(T.div,{className:"p-8 rounded-3xl border border-white/10 bg-white/5 backdrop-blur-md",initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:e*.1},viewport:{once:!0},children:[o.jsx("div",{className:"text-xs font-orbitron tracking-[0.3em] text-nexus-cyan-glow mb-4 uppercase",children:t.sector}),o.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:t.title}),o.jsx("ul",{className:"space-y-3 text-sm text-nexus-silver/70",children:t.impact.map(s=>o.jsxs("li",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"h-2 w-2 rounded-full bg-nexus-cyan"}),s]},s))})]},t.title))})]})]});class Zn{constructor(){Z(this,"audioCache",new Map);Z(this,"isMuted",!1);Z(this,"ambiencePlaying",null);Z(this,"loadingPromises",new Map);Z(this,"maxCacheSize",20);Z(this,"preloadQueue",["hover_glass","click_activate","success_chime"]);this.preloadEssentialSounds()}async preloadEssentialSounds(){setTimeout(()=>{this.preloadQueue.forEach(async e=>{try{await this.loadSound(e)}catch{}})},1e3)}cleanupCache(){if(this.audioCache.size<=this.maxCacheSize)return;const e=Array.from(this.audioCache.entries());e.slice(0,e.length-this.maxCacheSize).forEach(([r])=>{const n=this.audioCache.get(r);n!=null&&n.audio&&(n.audio.pause(),n.audio.src=""),this.audioCache.delete(r)})}loadSound(e){if(this.loadingPromises.has(e))return this.loadingPromises.get(e);const s=new Promise(r=>{const n=this.audioCache.get(e);if(n!=null&&n.isLoaded){r(n.audio);return}const i=()=>{const l=new Audio;return l.volume=0,l};(l=>new Promise(c=>{const u=new Audio;u.src=l,u.volume=.3,u.preload="auto";const d=setTimeout(()=>{console.warn(`[AudioService] Timeout loading ${e} from ${l}`),c(i())},5e3);u.addEventListener("canplaythrough",()=>{clearTimeout(d);const h={audio:u,isLoaded:!0,error:!1};this.audioCache.set(e,h),this.cleanupCache(),c(u)},{once:!0}),u.addEventListener("error",()=>{clearTimeout(d),console.debug(`[AudioService] Failed to load ${e} from ${l}`),c(i())},{once:!0}),u.load()}))(`/sounds/${e}.mp3`).then(l=>{this.loadingPromises.delete(e),r(l)})});return this.loadingPromises.set(e,s),s}async play(e){var s,r;if(!this.isMuted)try{let n=(s=this.audioCache.get(e))==null?void 0:s.audio;(!n||!((r=this.audioCache.get(e))!=null&&r.isLoaded))&&(n=await this.loadSound(e));try{n.currentTime=0;const i=n.play();i!==void 0&&i.catch(a=>{a.name!=="NotAllowedError"&&console.debug(`[AudioService] Error playing ${e}:`,a)})}catch(i){console.debug(`[AudioService] Playback error for ${e}:`,i)}}catch(n){console.debug(`[AudioService] Failed to play ${e}:`,n)}}async startAmbience(){if(!(this.isMuted||this.ambiencePlaying))try{const e=await this.loadSound("nexus_hum");if(e.volume===0)return;e.loop=!0,e.volume=.05;try{await e.play(),this.ambiencePlaying=e}catch(s){console.debug("[AudioService] Ambience autoplay prevented:",s)}}catch(e){console.debug("[AudioService] Error starting ambience:",e)}}stopAmbience(){this.ambiencePlaying&&(this.ambiencePlaying.pause(),this.ambiencePlaying.currentTime=0,this.ambiencePlaying=null)}toggleMute(){return this.isMuted=!this.isMuted,this.isMuted&&(this.stopAmbience(),this.audioCache.forEach(e=>{e.isLoaded&&e.audio.pause()})),this.isMuted}getMutedState(){return this.isMuted}getCacheStats(){const e=Array.from(this.audioCache.values());return{size:e.length,loaded:e.filter(s=>s.isLoaded&&!s.error).length,errors:e.filter(s=>s.error).length}}destroy(){this.stopAmbience(),this.audioCache.forEach(e=>{e.audio&&(e.audio.pause(),e.audio.src="")}),this.audioCache.clear(),this.loadingPromises.clear()}}const ei=new Zn,ti=()=>{const t=v.useCallback(i=>{try{ei.play(i)}catch{}},[]),e=v.useCallback(()=>t("hover_glass"),[t]),s=v.useCallback(()=>t("click_activate"),[t]),r=v.useCallback(()=>t("wuaw_subtle"),[t]),n=v.useCallback(()=>t("data_pulse"),[t]);return{play:t,playHover:e,playClick:s,playWuaw:r,playPulse:n}},si=()=>{const{playHover:t,playClick:e}=ti(),[s,r]=v.useState(!1),[n,i]=v.useState(""),[a,l]=v.useState(0),u=[{id:"1",icon:o.jsx(kn,{className:"w-4 h-4"}),title:"Explorar Mapa Global",path:"/map",shortcut:"G M"},{id:"2",icon:o.jsx(jn,{className:"w-4 h-4"}),title:"Ver Planes y Precios",path:"/pricing",shortcut:"P"},{id:"3",icon:o.jsx(En,{className:"w-4 h-4"}),title:"Contactar Ventas",path:"/contact",shortcut:"C"},{id:"4",icon:o.jsx(An,{className:"w-4 h-4"}),title:"DocumentaciÃ³n API",path:"/docs",shortcut:"D"},{id:"5",icon:o.jsx(Tn,{className:"w-4 h-4"}),title:"Estado del Sistema",path:"/status"},{id:"6",icon:o.jsx(Cn,{className:"w-4 h-4"}),title:"Iniciar Prueba Gratuita",action:()=>alert("Starting Trial...")}].filter(h=>h.title.toLowerCase().includes(n.toLowerCase()));v.useEffect(()=>{const h=f=>{f.key==="k"&&(f.metaKey||f.ctrlKey)&&(f.preventDefault(),s?e():t(),r(p=>!p)),f.key==="Escape"&&r(!1)};return window.addEventListener("keydown",h),()=>window.removeEventListener("keydown",h)},[]),v.useEffect(()=>{l(0)},[n]);const d=h=>{const f=u[h];f&&(f.action&&f.action(),f.path&&console.log(`Navigating to ${f.title}`),r(!1),i(""))};return o.jsx(Rt,{children:s&&o.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-start justify-center pt-[20vh] font-sans",children:[o.jsx(T.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>r(!1),className:"absolute inset-0 bg-black/80 backdrop-blur-md"}),o.jsxs(T.div,{initial:{opacity:0,scale:.95,y:-20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-20},className:"relative w-full max-w-2xl bg-[#0a0a0a] border border-white/10 rounded-xl shadow-2xl overflow-hidden flex flex-col",children:[o.jsxs("div",{className:"flex items-center px-4 py-4 border-b border-white/5",children:[o.jsx(Sn,{className:"w-5 h-5 text-nexus-cyan mr-3"}),o.jsx("input",{autoFocus:!0,type:"text",placeholder:"Escribe un comando o busca...",value:n,onChange:h=>i(h.target.value),onKeyDown:h=>{h.key==="ArrowDown"&&(h.preventDefault(),l(f=>Math.min(f+1,u.length-1))),h.key==="ArrowUp"&&(h.preventDefault(),l(f=>Math.max(f-1,0))),h.key==="Enter"&&d(a)},className:"w-full bg-transparent text-white placeholder-gray-500 focus:outline-none text-lg font-mono"}),o.jsx("div",{className:"text-xs text-gray-400 font-mono border border-white/10 px-2 py-1 rounded",children:"ESC"})]}),o.jsxs("div",{className:"max-h-[60vh] overflow-y-auto py-2",children:[u.map((h,f)=>o.jsxs("div",{onClick:()=>d(f),onMouseEnter:()=>l(f),className:`px-4 py-3 flex items-center justify-between cursor-pointer transition-colors ${f===a?"bg-nexus-cyan/10 border-l-2 border-nexus-cyan":"border-l-2 border-transparent"}`,children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:`p-2 rounded-lg ${f===a?"text-nexus-cyan bg-nexus-cyan/10":"text-gray-400 bg-white/5"}`,children:h.icon}),o.jsx("span",{className:`text-sm font-medium ${f===a?"text-white":"text-gray-400"}`,children:h.title})]}),h.shortcut&&o.jsx("span",{className:"text-xs text-gray-500 font-mono tracking-widest",children:h.shortcut})]},h.id)),u.length===0&&o.jsxs("div",{className:"px-4 py-8 text-center text-gray-500 text-sm",children:['No se encontraron resultados para "',n,'"']})]}),o.jsxs("div",{className:"px-4 py-2 bg-white/5 border-t border-white/5 flex justify-between items-center text-[10px] text-gray-500 font-mono",children:[o.jsx("span",{children:"â†‘â†“ para navegar"}),o.jsx("span",{children:"AIGESTION COMMAND CENTER v2.0"})]})]})]})})},qr=v.createContext(void 0),ri=({children:t})=>{const[e,s]=v.useState(()=>{const c=localStorage.getItem("nexus-audio-muted");return c?JSON.parse(c):!1}),[r,n]=v.useState(()=>{const c=localStorage.getItem("nexus-audio-volume");return c?JSON.parse(c):.5});v.useEffect(()=>{localStorage.setItem("nexus-audio-muted",JSON.stringify(e))},[e]),v.useEffect(()=>{localStorage.setItem("nexus-audio-volume",JSON.stringify(r))},[r]);const i=v.useCallback(()=>s(c=>!c),[]),a=v.useCallback(c=>n(c),[]),l=v.useCallback(c=>{e||console.log(`[SoundContext] Playing: ${c}`)},[e]);return o.jsx(qr.Provider,{value:{isMuted:e,volume:r,toggleMute:i,setGlobalVolume:a,playSfx:l},children:t})},Br=()=>{const t=v.useContext(qr);if(!t)throw new Error("useSoundContext must be used within a SoundProvider");return t},ni=class{constructor(t){Z(this,"src");Z(this,"preload");Z(this,"volume");this.src=t.src,this.preload=t.preload,this.volume=t.volume}unload(){}play(){}},ii=ni,Ne={tick:"/sounds/hover_glass.mp3",thud:"/sounds/click_activate.mp3",glass:"/sounds/success_chime.mp3",whoosh:"/sounds/menu_open.mp3",pop:"/sounds/data_pulse.mp3",error:"/sounds/error_buzzer.mp3",toggle:"/sounds/menu_open.mp3"},Oe=(t,e)=>{const s=v.useRef(null);return v.useEffect(()=>(s.current=new ii({src:[t],preload:!0,volume:e.volume}),()=>{var n;(n=s.current)==null||n.unload()}),[t]),v.useEffect(()=>{s.current&&s.current.volume(e.volume)},[e.volume]),[v.useCallback(()=>{e.soundEnabled&&s.current&&s.current.play()},[e.soundEnabled])]},It=()=>{const{isMuted:t,volume:e}=Br(),[s]=Oe(Ne.tick,{volume:e*.2,soundEnabled:!t}),[r]=Oe(Ne.thud,{volume:e*.4,soundEnabled:!t}),[n]=Oe(Ne.glass,{volume:e*.3,soundEnabled:!t}),[i]=Oe(Ne.whoosh,{volume:e*.15,soundEnabled:!t}),[a]=Oe(Ne.pop,{volume:e*.25,soundEnabled:!t}),[l]=Oe(Ne.error,{volume:e*.4,soundEnabled:!t}),[c]=Oe(Ne.toggle,{volume:e*.2,soundEnabled:!t});return{playHover:s,playClick:r,playSuccess:n,playWhoosh:i,playPop:a,playError:l,playToggle:c}},ai=()=>{const[t,e]=v.useState(!1),{playWhoosh:s,playPop:r}=It(),[n,i]=v.useState(""),[a,l]=v.useState(["SISTEMA OPERATIVO AIGESTION v2.6","Consola de comandos autorizada.",'Escribe "help" para ver opciones.']),c=v.useRef(null);v.useEffect(()=>{const d=h=>{h.ctrlKey&&h.key==="`"&&(t?r():s(),e(f=>!f)),h.key==="Escape"&&t&&e(!1)};return window.addEventListener("keydown",d),()=>window.removeEventListener("keydown",d)},[t]),v.useEffect(()=>{t&&setTimeout(()=>{var d;return(d=c.current)==null?void 0:d.focus()},100)},[t]);const u=d=>{d.preventDefault();const h=n.trim().toLowerCase();if(!h)return;const f=[`> ${n}`];switch(h){case"help":f.push("COMANDOS DISPONIBLES:","- help: Muestra esta ayuda","- clear: Limpia la terminal","- daniela: Estado del nÃºcleo de voz","- exit: Cierra la terminal","- status: Estado de los nodos globales");break;case"clear":l([]),i("");return;case"daniela":f.push("DANIELA AI: ESTADO OPTIMAL","Latencia: 12ms","Sentimiento: Neutral/AnalÃ­tico");break;case"status":f.push("NODOS ACTIVOS: 142","Carga de Red: 24%","SincronizaciÃ³n: 100%");break;case"exit":e(!1);break;default:f.push(`Error: Comando "${h}" no reconocido.`)}l(p=>[...p,...f]),i("")};return o.jsx(Rt,{children:t&&o.jsx(T.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"fixed inset-x-0 top-0 z-[100] p-4 font-mono",children:o.jsxs("div",{className:"max-w-4xl mx-auto premium-glass border-nexus-cyan/30 bg-black/95 rounded-b-2xl overflow-hidden shadow-[0_0_50px_rgba(0,245,255,0.2)] relative",children:[o.jsx("div",{className:"scanline pointer-events-none"}),o.jsx("div",{className:"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-[0.05] pointer-events-none"}),o.jsxs("div",{className:"bg-nexus-cyan/5 px-4 py-2 border-b border-nexus-cyan/20 flex justify-between items-center text-[10px] font-orbitron tracking-[0.2em] text-nexus-cyan",children:[o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"animate-pulse",children:"â—"}),"AIGESTION_TERMINAL_v2.6 // SECURE_SHELL"]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500/50 shadow-[0_0_10px_rgba(239,68,68,0.5)]"}),o.jsx("div",{className:"w-2 h-2 rounded-full bg-yellow-500/50 shadow-[0_0_10px_rgba(234,179,8,0.5)]"}),o.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500/50 shadow-[0_0_10px_rgba(34,197,94,0.5)]"})]})]}),o.jsx("div",{className:"h-64 overflow-y-auto p-6 font-mono text-xs space-y-2 scrollbar-hide",children:a.map((d,h)=>o.jsx("div",{className:d.startsWith(">")?"text-nexus-cyan-glow":"text-nexus-silver",children:d},h))}),o.jsxs("form",{onSubmit:u,className:"p-4 bg-white/5 border-t border-white/5 flex items-center gap-3",children:[o.jsx("span",{className:"text-nexus-cyan-glow font-mono",children:"$"}),o.jsx("input",{ref:c,type:"text",value:n,onChange:d=>i(d.target.value),className:"bg-transparent border-none outline-none flex-1 font-mono text-nexus-cyan-glow",placeholder:"Escribe un comando..."})]})]})})})},oi=({title:t="INICIAR CONEXIÃ“N",description:e="Completa el protocolo para establecer comunicaciÃ³n con el Nexus.",onSubmit:s,variant:r="glass",className:n=""})=>{const[i,a]=v.useState(!1),[l,c]=v.useState(!1),[u,d]=v.useState({name:"",email:"",subject:"",message:""}),h=async m=>{m.preventDefault(),a(!0);try{await s(u),c(!0)}catch(g){console.error("Submission failed:",g)}finally{a(!1)}},f="w-full bg-white/5 border border-white/10 rounded-lg px-4 py-3 text-white placeholder-gray-500 outline-none focus:border-nexus-violet transition-all font-orbitron text-sm",p="block text-xs font-orbitron font-bold text-nexus-cyan mb-2 tracking-wider uppercase";return l?o.jsx("div",{className:`p-12 text-center rounded-2xl bg-white/5 border border-white/10 backdrop-blur-md ${n}`,children:o.jsxs(T.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},className:"flex flex-col items-center gap-6",children:[o.jsx("div",{className:"w-20 h-20 bg-nexus-cyan/20 rounded-full flex items-center justify-center border border-nexus-cyan box-shadow-glow",children:o.jsx("span",{className:"text-4xl text-nexus-cyan",children:"âœ“"})}),o.jsx("h3",{className:"text-2xl font-orbitron font-black text-white uppercase tracking-widest",children:"Protocolo Completado"}),o.jsx("p",{className:"text-gray-400",children:"Tu mensaje ha sido transmitido a travÃ©s de la red neural. Contactaremos en breve."}),o.jsx("button",{onClick:()=>c(!1),className:"px-6 py-3 border border-nexus-cyan/50 text-nexus-cyan font-orbitron font-bold rounded hover:bg-nexus-cyan/10 transition-colors uppercase tracking-widest text-xs",children:"Nueva ConexiÃ³n"})]})}):o.jsxs("div",{className:`p-8 md:p-12 rounded-2xl bg-white/5 border border-white/10 backdrop-blur-md ${n}`,children:[o.jsxs("div",{className:"mb-10 text-center",children:[o.jsx("h3",{className:"text-2xl font-orbitron font-black text-white uppercase tracking-widest mb-4",children:t}),o.jsx("p",{className:"text-gray-400 text-sm max-w-md mx-auto",children:e})]}),o.jsxs("form",{onSubmit:h,className:"space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:p,children:"IdentificaciÃ³n"}),o.jsx("input",{type:"text",placeholder:"Introduce tu nombre",required:!0,className:f,value:u.name,onChange:m=>d({...u,name:m.target.value})})]}),o.jsxs("div",{children:[o.jsx("label",{className:p,children:"DirecciÃ³n Neural"}),o.jsx("input",{type:"email",placeholder:"tu@email.com",required:!0,className:f,value:u.email,onChange:m=>d({...u,email:m.target.value})})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:p,children:"MÃ³dulo"}),o.jsx("input",{type:"text",placeholder:"Asunto de la comunicaciÃ³n",required:!0,className:f,value:u.subject,onChange:m=>d({...u,subject:m.target.value})})]}),o.jsxs("div",{children:[o.jsx("label",{className:p,children:"Mensaje de Datos"}),o.jsx("textarea",{required:!0,rows:4,className:f,placeholder:"Tu mensaje...",value:u.message,onChange:m=>d({...u,message:m.target.value})})]}),o.jsx("button",{type:"submit",className:"w-full h-14 bg-gradient-to-r from-nexus-violet to-nexus-cyan text-white font-orbitron font-bold text-lg tracking-widest uppercase rounded-lg hover:shadow-[0_0_20px_rgba(138,43,226,0.5)] transition-all transform hover:scale-[1.02] disabled:opacity-70 disabled:cursor-not-allowed",disabled:i,children:i?"TRANSMITIENDO...":"EJECUTAR TRANSMISIÃ“N"})]})]})},li=({text:t,className:e=""})=>o.jsxs("div",{className:`relative inline-block ${e}`,children:[o.jsx("span",{className:"relative z-10",children:t}),o.jsx("span",{className:"absolute top-0 left-0 -z-10 text-nexus-cyan opacity-50 animate-pulse translate-x-[2px]",children:t}),o.jsx("span",{className:"absolute top-0 left-0 -z-10 text-nexus-violet opacity-50 animate-pulse -translate-x-[2px]",children:t})]}),ci=()=>{const{playHover:t,playSuccess:e}=It();return o.jsxs("section",{id:"contact",className:"relative py-32 bg-gradient-to-b from-black via-nexus-obsidian to-black overflow-hidden",children:[o.jsxs("div",{className:"absolute inset-0",children:[o.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_30%_70%,rgba(138,43,226,0.1),transparent_60%)]"}),o.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_70%_30%,rgba(0,245,255,0.1),transparent_60%)]"}),[...Array(8)].map((s,r)=>o.jsx(T.div,{className:"absolute w-2 h-2 bg-nexus-cyan rounded-full opacity-30",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`},animate:{opacity:[.3,.8,.3],scale:[1,2,1],y:[0,-100,0]},transition:{duration:4+Math.random()*3,repeat:1/0,delay:Math.random()*2}},r))]}),o.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-6",children:[o.jsxs(T.div,{className:"text-center mb-20",initial:{opacity:0,y:50},whileInView:{opacity:1,y:0},transition:{duration:.8},viewport:{once:!0},children:[o.jsxs("h2",{className:"text-5xl md:text-7xl font-orbitron font-black text-white mb-6",children:["CONECTA CON EL",o.jsx("span",{className:"block text-nexus-cyan text-glow",children:o.jsx(li,{text:"FUTURO HOY"})})]}),o.jsx("p",{className:"text-xl text-gray-300 max-w-3xl mx-auto",children:"Da el primer paso hacia la transformaciÃ³n digital cuÃ¡ntica"})]}),o.jsxs("div",{className:"grid lg:grid-cols-2 gap-16",children:[o.jsx(T.div,{initial:{opacity:0,x:-50},whileInView:{opacity:1,x:0},transition:{duration:.8},viewport:{once:!0},children:o.jsx(oi,{title:"INICIA TU TRANSFORMACIÃ“N",description:"Establece el protocolo de conexiÃ³n con el Nexus para integrar IA soberana en tu ecosistema.",variant:"glass",onSubmit:async s=>{console.log("Form submitted:",s),e()}})}),o.jsxs(T.div,{className:"space-y-8",initial:{opacity:0,x:50},whileInView:{opacity:1,x:0},transition:{duration:.8,delay:.2},viewport:{once:!0},children:[o.jsxs("div",{className:"p-8 bg-white/5 border border-white/10 backdrop-blur-sm rounded-2xl",children:[o.jsx("h3",{className:"text-2xl font-orbitron font-bold text-white mb-6",children:"Contacto RÃ¡pido"}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs(T.div,{className:"flex items-center gap-4",whileHover:{x:5},onMouseEnter:t,children:[o.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-nexus-violet to-nexus-cyan rounded-lg flex items-center justify-center",children:o.jsx("span",{className:"text-xl",children:"ðŸ“§"})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-white font-medium",children:"Email"}),o.jsx("div",{className:"text-nexus-cyan",children:"contact@aigestion.net"})]})]}),o.jsxs(T.div,{className:"flex items-center gap-4",whileHover:{x:5},onMouseEnter:t,children:[o.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-nexus-violet to-nexus-cyan rounded-lg flex items-center justify-center",children:o.jsx("span",{className:"text-xl",children:"ðŸ“±"})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-white font-medium",children:"WhatsApp"}),o.jsx("div",{className:"text-nexus-cyan",children:"+34 600 000 000"})]})]}),o.jsxs(T.div,{className:"flex items-center gap-4",whileHover:{x:5},onMouseEnter:t,children:[o.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-nexus-violet to-nexus-cyan rounded-lg flex items-center justify-center",children:o.jsx("span",{className:"text-xl",children:"ðŸ“"})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-white font-medium",children:"Sede Global"}),o.jsx("div",{className:"text-nexus-cyan",children:"Madrid, EspaÃ±a & NYC, USA"})]})]})]})]}),o.jsxs("div",{className:"p-8 bg-white/5 border border-nexus-cyan/30 backdrop-blur-sm rounded-2xl",children:[o.jsx("h3",{className:"text-2xl font-orbitron font-bold text-white mb-6",children:"Horario de AtenciÃ³n"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-gray-300",children:"Lunes - Viernes"}),o.jsx("span",{className:"text-nexus-cyan font-medium",children:"9:00 - 18:00 CET"})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-gray-300",children:"SÃ¡bados"}),o.jsx("span",{className:"text-nexus-cyan font-medium",children:"10:00 - 14:00 CET"})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-gray-300",children:"Soporte 24/7"}),o.jsx("span",{className:"text-green-400 font-medium",children:"SIEMPRE ACTIVO"})]})]})]}),o.jsxs("div",{className:"p-8 bg-white/5 border border-white/10 backdrop-blur-sm rounded-2xl",children:[o.jsx("h3",{className:"text-2xl font-orbitron font-bold text-white mb-6",children:"Conecta con Nosotros"}),o.jsx("div",{className:"grid grid-cols-2 gap-4",children:[{name:"LinkedIn",icon:"ðŸ’¼",color:"from-blue-500 to-blue-700"},{name:"Twitter",icon:"ðŸ¦",color:"from-sky-400 to-sky-600"},{name:"GitHub",icon:"ðŸ™",color:"from-gray-600 to-gray-800"},{name:"YouTube",icon:"ðŸ“º",color:"from-red-500 to-red-700"}].map(s=>o.jsxs(T.button,{className:`p-4 bg-gradient-to-br ${s.color} rounded-xl text-white font-medium hover:scale-105 transition-transform`,whileHover:{scale:1.05},whileTap:{scale:.95},onMouseEnter:t,children:[o.jsx("div",{className:"text-2xl mb-1",children:s.icon}),o.jsx("div",{className:"text-sm",children:s.name})]},s.name))})]})]})]})]})]})},ui=()=>o.jsxs("div",{className:"fixed inset-0 -z-40 pointer-events-none overflow-hidden opacity-20",children:[o.jsx("div",{className:"absolute inset-0",style:{backgroundImage:`
            linear-gradient(to right, rgba(0, 245, 255, 0.1) 1px, transparent 1px),
            linear-gradient(to bottom, rgba(0, 245, 255, 0.1) 1px, transparent 1px)
          `,backgroundSize:"40px 40px",maskImage:"radial-gradient(circle at 50% 50%, black, transparent 80%)"}}),o.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-[40%] origin-bottom [transform:rotateX(60deg)]",style:{backgroundImage:`
            linear-gradient(to right, rgba(138, 43, 226, 0.2) 1px, transparent 1px),
            linear-gradient(to bottom, rgba(138, 43, 226, 0.2) 1px, transparent 1px)
          `,backgroundSize:"100px 100px"}})]}),di=()=>{const[t,e]=v.useState(!1),[s,r]=v.useState(""),[n,i]=v.useState(!1),a=v.useCallback(()=>{t?c():l()},[t]),l=()=>{e(!0);const{webkitSpeechRecognition:d}=window;if(!d)return;const h=new d;h.lang="es-ES",h.continuous=!1,h.interimResults=!0,h.onresult=f=>{const p=f.results,m=p[p.length-1][0].transcript;r(m)},h.onend=()=>{e(!1)},h.start()},c=()=>{e(!1)};return{isListening:t,transcript:s,isSpeaking:n,toggleListening:a,speak:d=>{i(!0);const h=new SpeechSynthesisUtterance(d);h.lang="es-ES",h.rate=1,h.pitch=1.1;const p=window.speechSynthesis.getVoices().find(m=>m.name.includes("Female")||m.name.includes("Google EspaÃ±ol"));p&&(h.voice=p),h.onend=()=>i(!1),window.speechSynthesis.speak(h)}}},hi=()=>{const[t,e]=v.useState(!1),{isListening:s,transcript:r,toggleListening:n}=di();return o.jsxs("div",{className:"fixed bottom-8 right-8 z-[9000] font-sans",children:[o.jsx(Rt,{children:t&&o.jsxs(T.div,{initial:{opacity:0,scale:.8,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.8,y:20},className:"absolute bottom-20 right-0 w-80 bg-black/60 backdrop-blur-xl p-6 rounded-3xl mb-4 border border-nexus-cyan/30 shadow-[0_0_50px_rgba(0,0,0,0.5)]",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4 border-b border-white/5 pb-2",children:[o.jsx("div",{className:"w-2 h-2 rounded-full bg-nexus-cyan animate-pulse shadow-[0_0_8px_rgba(34,211,238,1)]"}),o.jsx("span",{className:"text-[10px] font-orbitron tracking-[0.3em] text-nexus-cyan-glow uppercase",children:"Asistente Daniela"}),o.jsx("div",{className:"ml-auto w-12 h-px bg-nexus-cyan/20"})]}),o.jsx("div",{className:"min-h-[100px] text-sm text-nexus-silver/80 font-light leading-relaxed",children:r?o.jsxs("p",{className:"italic text-white border-l-2 border-nexus-cyan/30 pl-3",children:['"',r,'"']}):o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"opacity-70",children:"Â¡Hola! Soy Daniela. Estoy aquÃ­ para ayudarte con tu negocio."}),o.jsx("p",{className:"text-[10px] uppercase tracking-widest text-nexus-cyan/40",children:"Dime algo, te escucho..."})]})}),o.jsxs("div",{className:"mt-6 pt-4 border-t border-white/5 flex justify-between items-center",children:[o.jsx(T.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:n,className:`px-6 py-2 rounded-full text-[10px] font-orbitron tracking-widest transition-all duration-500 ${s?"bg-red-500/20 text-red-400 border border-red-500/30":"bg-nexus-cyan/10 hover:bg-nexus-cyan/20 text-nexus-cyan border border-nexus-cyan/30"}`,children:s?"â— PARAR":"ðŸŽ™ï¸ HABLAR CON ELLA"}),o.jsx("div",{className:"flex gap-1",children:[1,2,3].map(i=>o.jsx("div",{className:`w-1 h-1 rounded-full ${s?"bg-nexus-cyan animate-pulse":"bg-white/10"}`},i))})]})]})}),o.jsxs(T.button,{onClick:()=>e(!t),whileHover:{scale:1.1},whileTap:{scale:.95},className:"relative w-16 h-16 rounded-full flex items-center justify-center group",children:[o.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-nexus-violet to-nexus-cyan rounded-full blur-md opacity-70 group-hover:opacity-100 transition-opacity animate-pulse"}),o.jsxs("div",{className:"relative w-full h-full bg-black/40 backdrop-blur-md rounded-full border border-white/20 flex items-center justify-center overflow-hidden group-hover:border-nexus-cyan/50 transition-colors",children:[o.jsx("img",{src:"/images/daniela/daniela_office_godmode.png",alt:"Daniela AI",className:"w-full h-full object-cover rounded-full group-hover:scale-110 transition-transform duration-500"}),o.jsx("div",{className:"absolute inset-0 border border-nexus-cyan/20 rounded-full scale-90"}),o.jsx(T.div,{animate:{rotate:360},transition:{duration:10,repeat:1/0,ease:"linear"},className:"absolute inset-0 border-t-2 border-nexus-cyan/40 rounded-full"}),o.jsx(T.div,{animate:{rotate:-360},transition:{duration:15,repeat:1/0,ease:"linear"},className:"absolute inset-2 border-b-2 border-nexus-violet/30 rounded-full"})]})]})]})},fi=[{q:"Â¿CuÃ¡nto tarda la implementaciÃ³n?",a:"Entre 2 y 6 semanas segÃºn complejidad. Empezamos con un piloto rÃ¡pido para medir impacto."},{q:"Â¿CÃ³mo se protege la informaciÃ³n?",a:"Usamos gobernanza, cifrado, roles y auditorÃ­a completa. TambiÃ©n podemos operar en infraestructura privada."},{q:"Â¿AIGestion se integra con mis sistemas?",a:"SÃ­. IntegraciÃ³n con ERP, CRM, BI, data lakes y APIs personalizadas sin fricciÃ³n."},{q:"Â¿Tienen planes para gremios o asociaciones?",a:"SÃ­. Contamos con planes por miembro y funcionalidades especÃ­ficas para gestiÃ³n gremial."}],pi=()=>o.jsx("section",{id:"faq",className:"py-32 bg-gradient-to-b from-black via-gray-900/40 to-black",children:o.jsxs("div",{className:"max-w-6xl mx-auto px-6",children:[o.jsxs(T.div,{className:"text-center mb-12",initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.8},viewport:{once:!0},children:[o.jsxs("h2",{className:"text-4xl md:text-6xl font-orbitron font-black text-white mb-4",children:["PREGUNTAS ",o.jsx("span",{className:"text-nexus-violet text-glow",children:"CLAVE"})]}),o.jsx("p",{className:"text-nexus-silver/70",children:"Resolvemos dudas crÃ­ticas antes de implementar."})]}),o.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:fi.map((t,e)=>o.jsxs(T.div,{className:"p-6 rounded-2xl border border-white/10 bg-white/5",initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5,delay:e*.05},viewport:{once:!0},children:[o.jsx("h3",{className:"text-white font-semibold mb-2",children:t.q}),o.jsx("p",{className:"text-sm text-nexus-silver/70",children:t.a})]},t.q))})]})}),mi=[{title:"Fase 1 Â· DiagnÃ³stico Inteligente",description:"Mapeamos procesos, riesgos y oportunidades. Creamos un blueprint con prioridades y quick wins.",outcomes:["Mapa de procesos crÃ­ticos","Matriz de impacto","Propuesta de pilotos"]},{title:"Fase 2 Â· Piloto de Alto Impacto",description:"Implementamos un MVP con IA aplicada y mÃ©tricas claras para validar el ROI en semanas.",outcomes:["AutomatizaciÃ³n inicial","KPIs con tablero","ValidaciÃ³n ejecutiva"]},{title:"Fase 3 Â· Escala Soberana",description:"Extendemos la IA al resto del ecosistema con gobernanza, seguridad y optimizaciÃ³n continua.",outcomes:["OrquestaciÃ³n multi-Ã¡rea","Gobernanza y compliance","Centro de excelencia"]}],gi=()=>o.jsxs("section",{id:"plan",className:"py-32 bg-gradient-to-b from-black via-nexus-obsidian to-black relative",children:[o.jsx("div",{className:"absolute inset-0 bg-radial-at-center from-nexus-violet/10 via-transparent to-transparent"}),o.jsxs("div",{className:"max-w-7xl mx-auto px-6 relative z-10",children:[o.jsxs(T.div,{className:"text-center mb-16",initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.8},viewport:{once:!0},children:[o.jsxs("h2",{className:"text-5xl md:text-7xl font-orbitron font-black text-white mb-4",children:["PLAN ",o.jsx("span",{className:"text-nexus-violet text-glow",children:"INGENIOSO"})]}),o.jsx("p",{className:"text-lg text-nexus-silver/70 max-w-3xl mx-auto",children:"Un enfoque estratÃ©gico para desplegar IA con resultados rÃ¡pidos y escalables."})]}),o.jsx("div",{className:"grid lg:grid-cols-3 gap-8",children:mi.map((t,e)=>o.jsxs(T.div,{className:"p-8 rounded-3xl border border-white/10 bg-white/5 backdrop-blur-md",initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:e*.1},viewport:{once:!0},children:[o.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:t.title}),o.jsx("p",{className:"text-sm text-nexus-silver/70 mb-6",children:t.description}),o.jsx("ul",{className:"space-y-2 text-xs text-nexus-silver/60",children:t.outcomes.map(s=>o.jsxs("li",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-nexus-cyan"}),s]},s))})]},t.title))})]})]}),bi=()=>{const t=qs(0),e=qs(0),s=n=>{const{clientX:i,clientY:a}=n;t.set(i),e.set(a)};v.useEffect(()=>{const n=i=>{t.set(i.clientX),e.set(i.clientY)};return window.addEventListener("mousemove",n),()=>window.removeEventListener("mousemove",n)},[t,e]);const r=Nn`radial-gradient(
    circle at ${t}px ${e}px,
    rgba(138, 43, 226, 0.3) 0%,
    rgba(0, 245, 255, 0.1) 25%,
    rgba(255, 215, 0, 0.05) 50%,
    transparent 100%
  )`;return o.jsxs(T.div,{onMouseMove:s,style:{backgroundImage:r},className:"fixed inset-0 z-0 transition-opacity duration-300 pointer-events-none",children:[o.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-nexus-violet/5 via-transparent to-nexus-obsidian"}),o.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-nexus-cyan/5 via-transparent to-nexus-obsidian"}),o.jsx(T.div,{animate:{x:[0,50,0],y:[0,30,0]},transition:{duration:8,repeat:1/0,repeatType:"mirror"},className:"absolute top-20 -left-40 w-80 h-80 bg-gradient-to-r from-nexus-violet/20 to-transparent rounded-full blur-3xl"}),o.jsx(T.div,{animate:{x:[0,-50,0],y:[0,-30,0]},transition:{duration:8,repeat:1/0,repeatType:"mirror",delay:1},className:"absolute bottom-20 -right-40 w-80 h-80 bg-gradient-to-l from-nexus-cyan/20 to-transparent rounded-full blur-3xl"})]})},yi=({children:t,className:e=""})=>{const s=v.useRef(null),[r,n]=v.useState({x:0,y:0}),i=u=>{var S;const{clientX:d,clientY:h}=u,{height:f,width:p,left:m,top:g}=((S=s.current)==null?void 0:S.getBoundingClientRect())||{height:0,width:0,left:0,top:0},y=d-(m+p/2),w=h-(g+f/2);n({x:y*.5,y:w*.5})},a=()=>{n({x:0,y:0})},{x:l,y:c}=r;return o.jsx(T.div,{ref:s,onMouseMove:i,onMouseLeave:a,animate:{x:l,y:c},transition:{type:"spring",stiffness:150,damping:15,mass:.1},className:`magnetic-wrap ${e}`,children:t})},vi=()=>{const{isMuted:t,toggleMute:e,playSfx:s}=Br(),r=()=>{e(),t&&setTimeout(()=>s("success_chime"),100)};return o.jsx("button",{onClick:r,className:"p-2 text-white/50 hover:text-nexus-cyan transition-colors",title:t?"Unmute Sound":"Mute Sound",children:t?o.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"}),o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2"})]}):o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"})})})},wi=()=>{const{playHover:t,playClick:e,playWhoosh:s}=It(),[r,n]=v.useState(!1),[i,a]=v.useState(!1),l=Lr();v.useEffect(()=>{const d=()=>{n(window.scrollY>20)};return window.addEventListener("scroll",d),()=>window.removeEventListener("scroll",d)},[]);const c=[{label:"Servicios",path:"#services",isHash:!0},{label:"Casos",path:"#cases",isHash:!0},{label:"Precios",path:"#pricing",isHash:!0},{label:"Plan",path:"#plan",isHash:!0},{label:"Tutoriales",path:"#tutoriales",isHash:!0},{label:"Contacto",path:"#contact",isHash:!0},{label:"Dashboard",path:"/dashboard"}],u=(d,h)=>{if(e(),a(!1),h){const f=document.querySelector(d);f==null||f.scrollIntoView({behavior:"smooth"})}};return o.jsxs(T.nav,{initial:{y:-100},animate:{y:0},transition:{duration:.8,ease:[.16,1,.3,1]},className:`fixed top-0 w-full z-50 transition-all duration-500 ${r?"bg-black/80 backdrop-blur-xl border-b border-white/5 py-3":"bg-transparent py-6"}`,children:[o.jsxs("div",{className:"max-w-7xl mx-auto px-6 flex justify-between items-center",children:[o.jsxs(pt,{to:"/",onClick:()=>u("/"),onMouseEnter:t,className:"group flex items-center gap-0 relative",children:[o.jsxs("div",{className:"relative z-10 w-10 h-10 mr-3 transition-transform duration-500 group-hover:scale-110 group-hover:rotate-12",children:[o.jsx("div",{className:"absolute inset-0 bg-nexus-violet/50 blur-lg rounded-full opacity-50 group-hover:opacity-100 transition-opacity"}),o.jsx("img",{src:"/images/brand/logo.png",alt:"Logo",className:"w-full h-full object-contain filter drop-shadow-[0_0_8px_rgba(138,43,226,0.5)]"})]}),o.jsxs("div",{className:"flex flex-col justify-center h-10",children:[o.jsxs("h1",{className:"font-orbitron font-black text-xl tracking-[0.1em] leading-none text-white group-hover:text-transparent group-hover:bg-clip-text group-hover:bg-gradient-to-r group-hover:from-white group-hover:via-nexus-cyan group-hover:to-nexus-violet transition-all duration-300",children:["AIGESTION",o.jsx("span",{className:"text-nexus-cyan-glow",children:".NET"})]}),o.jsx("span",{className:"text-[8px] font-mono text-nexus-silver/50 tracking-[0.3em] uppercase opacity-0 group-hover:opacity-100 transition-opacity duration-300 -mt-1",children:"CONTROL MAESTRO"})]})]}),o.jsx("div",{className:"hidden lg:flex items-center gap-8",children:c.map(d=>o.jsxs(pt,{to:d.path,onClick:h=>{d.isHash?(h.preventDefault(),u(d.path,!0)):u(d.path)},onMouseEnter:t,className:`relative font-orbitron text-[11px] font-bold tracking-[0.15em] uppercase transition-all duration-300 hover:text-white hover:scale-105 ${l.pathname===d.path?"text-nexus-cyan":"text-nexus-silver/70"}`,children:[d.label,o.jsx("span",{className:"absolute -bottom-1 left-0 w-0 h-[2px] bg-nexus-cyan transition-all duration-300 group-hover:w-full"})]},d.label))}),o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx(vi,{}),o.jsx(yi,{strength:20,children:o.jsxs(pt,{to:"/login",onMouseEnter:()=>{t(),s()},onClick:e,className:"hidden sm:flex group relative items-center gap-3 px-6 py-2.5 overflow-hidden rounded-full bg-white/5 border border-white/10 hover:border-nexus-violet/50 transition-all duration-300",children:[o.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-nexus-violet/20 via-nexus-cyan/20 to-nexus-violet/20 opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),o.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-1000 ease-in-out"}),o.jsx(Ur,{size:14,className:"text-nexus-violet-glow group-hover:text-white transition-colors"}),o.jsx("span",{className:"relative font-orbitron text-[10px] font-bold tracking-[0.2em] uppercase text-white group-hover:text-shadow-glow",children:"ENTRAR"}),o.jsx(On,{size:14,className:"text-nexus-silver/50 group-hover:text-white group-hover:translate-x-1 transition-all"})]})}),o.jsx("button",{className:"lg:hidden p-2 text-white hover:text-nexus-cyan transition-colors",onClick:()=>a(!i),children:i?o.jsx(Mr,{size:24}):o.jsx(Rn,{size:24})})]})]}),o.jsx(Rt,{children:i&&o.jsx(T.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"lg:hidden bg-nexus-obsidian/95 backdrop-blur-xl border-b border-white/10 overflow-hidden",children:o.jsxs("div",{className:"flex flex-col p-6 gap-4",children:[c.map(d=>o.jsx(pt,{to:d.path,onClick:h=>{d.isHash?(h.preventDefault(),u(d.path,!0)):u(d.path)},className:"font-orbitron text-sm font-bold tracking-widest text-nexus-silver hover:text-white hover:pl-2 transition-all border-b border-white/5 pb-4",children:d.label},d.label)),o.jsx(pt,{to:"/login",onClick:()=>u("/login"),className:"btn-primary mt-4 w-full justify-center",children:"ENTRAR"})]})})})]})},xi=()=>{const t=Array.from({length:20});return o.jsx("div",{className:"fixed inset-0 -z-30 pointer-events-none overflow-hidden",children:t.map((e,s)=>o.jsx(T.div,{className:"absolute w-1 h-1 bg-nexus-cyan/20 rounded-full",initial:{x:Math.random()*100+"%",y:Math.random()*100+"%",scale:Math.random()*.5+.5},animate:{y:["-10%","110%"],opacity:[0,.5,0],x:[null,(Math.random()-.5)*50+"%"]},transition:{duration:Math.random()*10+10,repeat:1/0,ease:"linear",delay:Math.random()*10}},`particle-${s}`))})},_i=[{name:"Esencial",price:"Desde $490/mes",ideal:"Startups y pymes en crecimiento",features:["AutomatizaciÃ³n base","Panel de control","Soporte estÃ¡ndar","ImplementaciÃ³n rÃ¡pida"]},{name:"EvoluciÃ³n",price:"Desde $1.490/mes",ideal:"Empresas con equipos multi-Ã¡rea",features:["IA aplicada por Ã¡rea","Integraciones CRM/ERP","Reportes avanzados","Onboarding guiado"]},{name:"Soberano",price:"CotizaciÃ³n personalizada",ideal:"Corporativos y sector pÃºblico",features:["Modelos privados","Gobernanza y compliance","Equipo dedicado","SLA premium"]}],Si=[{name:"Plan Gremial",price:"Desde $2/miembro/mes",note:"Ideal para asociaciones, colegios profesionales y cÃ¡maras.",features:["Portal de miembros","Soporte multi-sede","AnalÃ­tica de participaciÃ³n"]},{name:"Plan Cooperativo",price:"Desde $990/mes",note:"Para cooperativas y organizaciones con mÃºltiples unidades.",features:["GestiÃ³n de procesos compartidos","Tableros por unidad","AutomatizaciÃ³n financiera"]},{name:"Plan Educativo",price:"Desde $750/mes",note:"Instituciones educativas y formaciÃ³n continua.",features:["Campus IA","Asistentes de aprendizaje","Seguimiento de cohortes"]}],ki=()=>o.jsxs("section",{id:"pricing",className:"py-32 bg-black relative overflow-hidden",children:[o.jsx("div",{className:"absolute inset-0 bg-radial-at-top from-nexus-violet/15 via-transparent to-transparent"}),o.jsxs("div",{className:"max-w-7xl mx-auto px-6 relative z-10",children:[o.jsxs(T.div,{className:"text-center mb-16",initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.8},viewport:{once:!0},children:[o.jsxs("h2",{className:"text-5xl md:text-7xl font-orbitron font-black text-white mb-4",children:["PRECIOS ",o.jsx("span",{className:"text-nexus-cyan text-glow",children:"INTELIGENTES"})]}),o.jsx("p",{className:"text-lg text-nexus-silver/70 max-w-3xl mx-auto",children:"Planes flexibles segÃºn tamaÃ±o, industria y gremio. Todos incluyen auditorÃ­a inicial y roadmap de adopciÃ³n."})]}),o.jsx("div",{className:"grid lg:grid-cols-3 gap-8 mb-20",children:_i.map((t,e)=>o.jsxs(T.div,{className:"p-8 rounded-3xl border border-white/10 bg-white/5 backdrop-blur-md",initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:e*.1},viewport:{once:!0},children:[o.jsx("div",{className:"text-xs font-orbitron tracking-[0.3em] text-nexus-cyan-glow mb-3 uppercase",children:t.name}),o.jsx("div",{className:"text-3xl font-bold text-white mb-2",children:t.price}),o.jsx("p",{className:"text-sm text-nexus-silver/70 mb-6",children:t.ideal}),o.jsx("ul",{className:"space-y-3 text-sm text-nexus-silver/70",children:t.features.map(s=>o.jsxs("li",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"h-2 w-2 rounded-full bg-nexus-cyan"}),s]},s))})]},t.name))}),o.jsx("div",{id:"gremios",className:"grid lg:grid-cols-3 gap-8",children:Si.map((t,e)=>o.jsxs(T.div,{className:"p-8 rounded-3xl border border-white/10 bg-gradient-to-b from-white/5 to-transparent",initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:e*.1},viewport:{once:!0},children:[o.jsx("div",{className:"text-xs font-orbitron tracking-[0.3em] text-nexus-violet-glow mb-3 uppercase",children:t.name}),o.jsx("div",{className:"text-2xl font-bold text-white mb-2",children:t.price}),o.jsx("p",{className:"text-sm text-nexus-silver/70 mb-6",children:t.note}),o.jsx("ul",{className:"space-y-3 text-sm text-nexus-silver/70",children:t.features.map(s=>o.jsxs("li",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"h-2 w-2 rounded-full bg-nexus-violet"}),s]},s))})]},t.name))})]})]}),ji=()=>{const{scrollYProgress:t}=In(),e=Pn(t,{stiffness:100,damping:30,restDelta:.001});return o.jsx(T.div,{className:"fixed top-0 left-0 right-0 h-[2px] bg-gradient-to-r from-nexus-violet via-nexus-cyan to-nexus-violet origin-left z-[100]",style:{scaleX:e}})},Ei=[{title:"Arquitectura IA Soberana",description:"DiseÃ±amos el nÃºcleo inteligente que gobierna procesos crÃ­ticos con control total de datos y modelos.",icon:$n,bullets:["Modelos privados y gobernanza","OrquestaciÃ³n multi-agente","AuditorÃ­a y explicabilidad"]},{title:"AutomatizaciÃ³n Operativa",description:"Flujos inteligentes que reducen tiempos, eliminan errores y conectan equipos en tiempo real.",icon:Dn,bullets:["RPA + IA contextual","IntegraciÃ³n con ERP/CRM","SLA y monitoreo continuo"]},{title:"Seguridad y Cumplimiento",description:"Capas de seguridad, trazabilidad y cumplimiento regulatorio por industria y paÃ­s.",icon:Ln,bullets:["Zero-trust IA","Data lineage y retenciÃ³n","Cumplimiento sectorial"]},{title:"Inteligencia Comercial",description:"Dashboards y analÃ­tica predictiva para ventas, finanzas y operaciones estratÃ©gicas.",icon:Un,bullets:["KPIs accionables","Forecasting y alertas","Simuladores ROI"]},{title:"Integraciones Extremo a Extremo",description:"Conectamos tu ecosistema digital sin fricciÃ³n con APIs y conectores listos.",icon:Mn,bullets:["Conectores empresariales","APIs seguras","Eventos en tiempo real"]},{title:"CapacitaciÃ³n & Change Management",description:"Alineamos al equipo para adopciÃ³n rÃ¡pida y sostenible con formaciÃ³n por roles.",icon:qn,bullets:["Academia AIGestion","Playbooks por gremio","Soporte premium"]}],Ai=()=>o.jsxs("section",{id:"services",className:"relative py-32 bg-black overflow-hidden",children:[o.jsx("div",{className:"absolute inset-0 bg-radial-at-top from-nexus-violet/10 via-transparent to-transparent"}),o.jsxs("div",{className:"max-w-7xl mx-auto px-6 relative z-10",children:[o.jsxs(T.div,{className:"text-center mb-16",initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.8},viewport:{once:!0},children:[o.jsxs("h2",{className:"text-5xl md:text-7xl font-orbitron font-black text-white mb-4",children:["SERVICIOS ",o.jsx("span",{className:"text-nexus-cyan text-glow",children:"INTEGRALES"})]}),o.jsx("p",{className:"text-lg text-nexus-silver/70 max-w-3xl mx-auto",children:"AIGestion entrega una plataforma completa: estrategia, tecnologÃ­a, automatizaciÃ³n y adopciÃ³n. Cada mÃ³dulo estÃ¡ diseÃ±ado para resultados medibles y escalables."})]}),o.jsx("div",{className:"grid md:grid-cols-2 xl:grid-cols-3 gap-8",children:Ei.map((t,e)=>o.jsxs(T.div,{className:"relative p-8 rounded-3xl border border-white/10 bg-white/5 backdrop-blur-md overflow-hidden",initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:e*.05},viewport:{once:!0},children:[o.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-nexus-violet/10 via-transparent to-nexus-cyan/10 opacity-50"}),o.jsxs("div",{className:"relative z-10 space-y-4",children:[o.jsx("div",{className:"w-12 h-12 rounded-2xl bg-nexus-violet/10 border border-nexus-violet/30 flex items-center justify-center",children:o.jsx(t.icon,{className:"w-6 h-6 text-nexus-cyan-glow"})}),o.jsx("h3",{className:"text-xl font-orbitron text-white font-bold",children:t.title}),o.jsx("p",{className:"text-sm text-nexus-silver/70 leading-relaxed",children:t.description}),o.jsx("ul",{className:"space-y-2 text-xs text-nexus-silver/60",children:t.bullets.map(s=>o.jsxs("li",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-nexus-cyan"}),s]},s))})]})]},t.title))})]})]}),Ti=[{title:"Onboarding AIGestion",query:"aigestiontiene onboarding"},{title:"AutomatizaciÃ³n por Ã¡reas",query:"aigestiontiene automatizacion procesos"},{title:"Casos y demos en vivo",query:"aigestiontiene demo tutorial"}],Ci=()=>o.jsxs("section",{id:"tutoriales",className:"py-32 bg-black relative overflow-hidden",children:[o.jsx("div",{className:"absolute inset-0 bg-radial-at-top from-nexus-cyan/10 via-transparent to-transparent"}),o.jsxs("div",{className:"max-w-7xl mx-auto px-6 relative z-10",children:[o.jsxs(T.div,{className:"text-center mb-16",initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.8},viewport:{once:!0},children:[o.jsxs("h2",{className:"text-5xl md:text-7xl font-orbitron font-black text-white mb-4",children:["TUTORIALES ",o.jsx("span",{className:"text-nexus-cyan text-glow",children:"EN VIDEO"})]}),o.jsx("p",{className:"text-lg text-nexus-silver/70 max-w-3xl mx-auto",children:"Aprende paso a paso con el canal oficial de AIGestion."})]}),o.jsx("div",{className:"grid lg:grid-cols-3 gap-8 mb-12",children:Ti.map(t=>o.jsxs("div",{className:"rounded-3xl overflow-hidden border border-white/10 bg-white/5",children:[o.jsx("div",{className:"aspect-video",children:o.jsx("iframe",{className:"w-full h-full",src:`https://www.youtube.com/embed?listType=search&list=${encodeURIComponent(t.query)}`,title:t.title,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})}),o.jsxs("div",{className:"p-6",children:[o.jsx("h3",{className:"text-lg font-bold text-white",children:t.title}),o.jsx("p",{className:"text-sm text-nexus-silver/70",children:"Basado en el canal @aigestiontiene"})]})]},t.title))}),o.jsx("div",{className:"text-center",children:o.jsx("a",{href:"https://www.youtube.com/@aigestiontiene",target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-3 px-8 py-3 rounded-full bg-nexus-cyan/10 border border-nexus-cyan/30 text-nexus-cyan-glow hover:bg-nexus-cyan/20 transition-all font-orbitron text-[10px] tracking-[0.2em] uppercase",children:"Visitar canal AIGestion"})})]})]}),Ni=({title:t,message:e,type:s="info",onClose:r})=>{const n={info:o.jsx(Vn,{className:"text-nexus-cyan",size:20}),success:o.jsx(zn,{className:"text-green-400",size:20}),warning:o.jsx(Fn,{className:"text-yellow-400",size:20}),error:o.jsx(Bn,{className:"text-red-400",size:20})},i={info:"border-nexus-cyan/30",success:"border-green-500/30",warning:"border-yellow-500/30",error:"border-red-500/30"};return o.jsxs(T.div,{initial:{opacity:0,x:100,scale:.9},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:50,scale:.95,filter:"blur(10px)"},className:`pointer-events-auto min-w-[320px] max-w-md premium-glass p-1 border ${i[s]} rounded-2xl shadow-[0_20px_50px_rgba(0,0,0,0.5)] overflow-hidden group`,children:[o.jsxs("div",{className:"relative p-4 flex gap-4",children:[o.jsx("div",{className:"flex-shrink-0 mt-1",children:n[s]}),o.jsxs("div",{className:"flex-grow",children:[o.jsx("h4",{className:"font-orbitron text-xs font-bold text-white tracking-widest uppercase mb-1 drop-shadow-glow",children:t}),o.jsx("p",{className:"text-nexus-silver/70 text-sm leading-relaxed",children:e})]}),o.jsx("button",{onClick:r,className:"flex-shrink-0 text-white/20 hover:text-white transition-colors",children:o.jsx(Mr,{size:16})}),o.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/0 via-white/5 to-white/0 translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-1000 ease-in-out pointer-events-none"})]}),o.jsx(T.div,{initial:{width:"100%"},animate:{width:"0%"},transition:{duration:5,ease:"linear"},className:`h-[2px] bg-gradient-to-r ${s==="info"?"from-nexus-cyan to-nexus-violet":"from-current to-transparent opacity-50"}`})]})},Fr=v.createContext(void 0),Oi=({children:t})=>{const[e,s]=v.useState([]),{playPop:r}=It(),n=v.useCallback((i,a,l="info")=>{const c=Math.random().toString(36).substr(2,9);r(),s(u=>[...u,{id:c,title:i,message:a,type:l}]),setTimeout(()=>{s(u=>u.filter(d=>d.id!==c))},5e3)},[r]);return o.jsxs(Fr.Provider,{value:{notify:n},children:[t,o.jsx("div",{className:"fixed bottom-8 right-8 z-[9999] flex flex-col gap-4 pointer-events-none",children:o.jsx(Rt,{children:e.map(i=>o.jsx(Ni,{title:i.title,message:i.message,type:i.type,onClose:()=>s(a=>a.filter(l=>l.id!==i.id))},i.id))})})]})},Ri=()=>{const t=v.useContext(Fr);if(!t)throw new Error("useNotification must be used within a NotificationProvider");return t},Ii=({onLogin:t,loading:e,error:s})=>{const[r,n]=v.useState({email:"",password:""}),[i,a]=v.useState(!1),[l,c]=v.useState({}),u=()=>{const f={};return r.email?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r.email)||(f.email="Email invÃ¡lido"):f.email="El email es requerido",r.password?r.password.length<6&&(f.password="La contraseÃ±a debe tener al menos 6 caracteres"):f.password="La contraseÃ±a es requerida",c(f),Object.keys(f).length===0},d=async f=>{if(f.preventDefault(),!!u())try{await t(r.email,r.password)}catch{}},h=f=>{const{name:p,value:m}=f.target;n(g=>({...g,[p]:m})),l[p]&&c(g=>({...g,[p]:void 0}))};return o.jsx("div",{className:"min-h-screen bg-nexus-obsidian flex items-center justify-center px-4",children:o.jsxs(T.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"w-full max-w-md",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx(T.div,{initial:{scale:.8},animate:{scale:1},transition:{duration:.5,delay:.2},className:"w-20 h-20 mx-auto mb-6 rounded-full bg-linear-to-br from-nexus-cyan to-nexus-violet flex items-center justify-center",children:o.jsx("span",{className:"text-2xl font-bold text-white",children:"DA"})}),o.jsx("h1",{className:"text-3xl font-orbitron font-black text-white mb-2",children:"Bienvenido a Daniela"}),o.jsx("p",{className:"text-nexus-silver/60 text-sm",children:"Tu asistente de IA emocional estÃ¡ lista para ayudarte"})]}),o.jsx("div",{className:"p-8 bg-nexus-obsidian/40 backdrop-blur-xl border border-white/10 rounded-lg",children:o.jsxs("form",{onSubmit:d,className:"space-y-6",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-sm font-orbitron text-nexus-cyan",children:"Email"}),o.jsxs("div",{className:"relative",children:[o.jsx(Gn,{className:"absolute left-3 top-3 h-5 w-5 text-nexus-silver/40"}),o.jsx("input",{type:"email",name:"email",value:r.email,onChange:h,placeholder:"tu@email.com",disabled:e,className:"w-full pl-10 pr-4 py-2 bg-nexus-obsidian/60 border border-white/10 rounded-lg text-white placeholder-nexus-silver/40 focus:outline-none focus:border-nexus-cyan disabled:opacity-50"})]}),l.email&&o.jsx("p",{className:"text-red-400 text-sm",children:l.email})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-sm font-orbitron text-nexus-cyan",children:"ContraseÃ±a"}),o.jsxs("div",{className:"relative",children:[o.jsx(Ur,{className:"absolute left-3 top-3 h-5 w-5 text-nexus-silver/40"}),o.jsx("input",{type:i?"text":"password",name:"password",value:r.password,onChange:h,placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",disabled:e,className:"w-full pl-10 pr-10 py-2 bg-nexus-obsidian/60 border border-white/10 rounded-lg text-white placeholder-nexus-silver/40 focus:outline-none focus:border-nexus-cyan disabled:opacity-50"}),o.jsx("button",{type:"button",onClick:()=>a(!i),className:"absolute right-3 top-3 text-nexus-silver/40 hover:text-nexus-silver/60 disabled:opacity-50",disabled:e,children:i?o.jsx(Wn,{className:"h-5 w-5"}):o.jsx(Kn,{className:"h-5 w-5"})})]}),l.password&&o.jsx("p",{className:"text-red-400 text-sm",children:l.password})]}),s&&o.jsx(T.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-red-500/10 border border-red-500/20 rounded-lg p-3",children:o.jsxs("div",{className:"flex items-center text-red-400 text-sm",children:[o.jsx(Hn,{className:"h-4 w-4 mr-2"}),s]})}),o.jsx("button",{type:"submit",disabled:e,className:"w-full py-2 px-4 bg-nexus-violet text-white font-orbitron tracking-widest rounded-lg hover:bg-nexus-violet/80 disabled:opacity-50 transition-colors",children:e?"Iniciando sesiÃ³n...":"Iniciar SesiÃ³n"}),o.jsxs("div",{className:"space-y-3 text-center",children:[o.jsx("button",{type:"button",className:"text-nexus-cyan hover:text-nexus-cyan/80 text-sm transition-colors disabled:opacity-50",disabled:e,children:"Â¿Olvidaste tu contraseÃ±a?"}),o.jsxs("div",{className:"text-nexus-silver/40 text-sm",children:["Â¿Nuevo usuario?"," ",o.jsx("button",{type:"button",className:"text-nexus-violet hover:text-nexus-violet/80 text-sm transition-colors disabled:opacity-50",disabled:e,children:"RegÃ­strate gratis"})]})]})]})}),o.jsx(T.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.5},className:"mt-8 text-center",children:o.jsxs("p",{className:"text-nexus-silver/40 text-xs",children:["Al iniciar sesiÃ³n, aceptas nuestros"," ",o.jsx("button",{className:"text-nexus-cyan hover:text-nexus-cyan/80 underline",children:"tÃ©rminos y condiciones"})]})})]})})},Pi=({onLogin:t,isAuthenticated:e})=>{const[s,r]=v.useState(!1),[n,i]=v.useState(""),a=async(l,c)=>{r(!0),i("");try{await t(l,c)}catch(u){i(u instanceof Error?u.message:"Error al iniciar sesiÃ³n")}finally{r(!1)}};return e?o.jsx(Gt,{to:"/dashboard",replace:!0}):o.jsx("div",{className:"min-h-screen bg-nexus-obsidian flex items-center justify-center",children:o.jsx(Ii,{onLogin:a,loading:s,error:n})})};v.lazy(()=>H(()=>import("./DanielaWebsite-D2wri83W.js"),__vite__mapDeps([0,1,2,3,4])).then(t=>({default:t.DanielaWebsite})));v.lazy(()=>H(()=>import("./Dashboard-2hw_5wIA.js"),__vite__mapDeps([5,1,2,3,6])).then(t=>({default:t.Dashboard})));const $i=v.lazy(()=>H(()=>import("./EnhancedROI-C56tfwDu.js"),__vite__mapDeps([7,1,2,3,6])).then(t=>({default:t.EnhancedROI}))),Di=v.lazy(()=>H(()=>import("./CinematicPresentation-CBoxK1XM.js"),__vite__mapDeps([8,1,2,3,6])).then(t=>({default:t.CinematicPresentation})));v.lazy(()=>H(()=>import("./InteractiveShowcase-BQAseTYN.js"),__vite__mapDeps([9,1,2,3,6])).then(t=>({default:t.InteractiveShowcase})));v.lazy(()=>H(()=>import("./DataVisualization-WC7dDC20.js"),__vite__mapDeps([10,1,2,3,6])).then(t=>({default:t.DataVisualization})));v.lazy(()=>H(()=>import("./DanielaAI-BkM5tVuX.js"),__vite__mapDeps([11,1,2,3,6])).then(t=>({default:t.DanielaAI})));const Li=v.lazy(()=>H(()=>import("./NexusAndroid-DROwc-xU.js"),__vite__mapDeps([12,1,2,3,6])).then(t=>({default:t.NexusAndroid}))),Ui=v.lazy(()=>H(()=>import("./DanielaShowcase-usPFUCbu.js"),__vite__mapDeps([13,1,2,3,6])).then(t=>({default:t.DanielaShowcase}))),Bs=v.lazy(()=>H(()=>import("./DecentralandOffice-Dn5kQF3J.js"),__vite__mapDeps([14,1,2,3])).then(t=>({default:t.DecentralandOffice}))),Fs=v.lazy(()=>H(()=>import("./AdminDashboard-B9NCLx0-.js"),__vite__mapDeps([15,1,2,16,3,6])).then(t=>({default:t.AdminDashboard}))),zs=v.lazy(()=>H(()=>import("./ClientDashboard-BlVZ7ZcN.js"),__vite__mapDeps([17,1,2,16,3,6])).then(t=>({default:t.ClientDashboard}))),Vs=v.lazy(()=>H(()=>import("./DemoDashboard-Bu_76lIp.js"),__vite__mapDeps([18,1,2,16,3,6])).then(t=>({default:t.DemoDashboard}))),Mi=v.lazy(()=>H(()=>import("./WorkbenchLayout-Dl9DUKlb.js"),__vite__mapDeps([19,1,2,3,5,6])).then(t=>({default:t.WorkbenchLayout}))),Gs=v.lazy(()=>H(()=>import("./DanielaDemo-BBU8cJ_n.js"),__vite__mapDeps([20,1,2,0,3,4])).then(t=>({default:t.DanielaDemo}))),qi=v.lazy(()=>H(()=>import("./VirtualOfficePreview-Bz7buQbW.js"),__vite__mapDeps([21,1,2,6,3]))),Bi=v.lazy(()=>H(()=>import("./WeaponDashboard-DxM4Lq9a.js"),__vite__mapDeps([22,1,2,3]))),Pe=()=>o.jsx("div",{className:"min-h-[400px] bg-nexus-obsidian-deep flex items-center justify-center",children:o.jsx("div",{className:"text-nexus-cyan-glow font-orbitron tracking-[0.5em] text-xs animate-pulse",children:"LOADING..."})}),Fi=()=>o.jsxs("footer",{className:"py-32 bg-nexus-obsidian-deep border-t border-white/5 relative overflow-hidden",children:[o.jsx("div",{className:"absolute inset-0 bg-radial-at-bottom from-nexus-violet/5 via-transparent to-transparent pointer-events-none"}),o.jsxs("div",{className:"max-w-7xl mx-auto px-6 grid md:grid-cols-4 gap-16 relative z-10",children:[o.jsx("div",{className:"col-span-1 md:col-span-2",children:o.jsxs(T.div,{initial:{opacity:0,x:-20},whileInView:{opacity:1,x:0},viewport:{once:!0},children:[o.jsx("img",{src:"/images/brand/logo.png",alt:"AIGestion",className:"h-10 mb-8 filter brightness-110 drop-shadow-[0_0_10px_rgba(138,43,226,0.3)]"}),o.jsxs("p",{className:"text-nexus-silver/50 text-lg max-w-sm mb-12 font-light leading-relaxed italic",children:['"Arquitectura de Inteligencia Soberana. ',o.jsx("br",{}),'El nÃºcleo neuronal para las empresas del maÃ±ana."']}),o.jsx("div",{className:"text-[10px] text-nexus-silver/20 font-mono uppercase tracking-[0.4em] mt-12",children:"Â© 2026 AIGestion.net | God Level AI Restored v2.1 (Fixes Applied)"})]})}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-orbitron text-xs text-nexus-cyan-glow mb-8 uppercase tracking-[0.3em] font-bold",children:"Ecosistema"}),o.jsxs("ul",{className:"space-y-6 text-[10px] text-nexus-silver/40 font-orbitron tracking-widest uppercase",children:[o.jsx("li",{className:"hover:text-white transition-colors cursor-pointer hover:translate-x-1 duration-300",children:"Casos de Uso"}),o.jsx("li",{className:"hover:text-white transition-colors cursor-pointer hover:translate-x-1 duration-300",children:"Daniela AI"}),o.jsx("li",{className:"hover:text-white transition-colors cursor-pointer hover:translate-x-1 duration-300",children:"Nodos Globales"})]})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-orbitron text-xs text-nexus-violet-glow mb-8 uppercase tracking-[0.3em] font-bold",children:"Metaverso"}),o.jsxs("ul",{className:"space-y-6 text-[10px] text-nexus-silver/40 font-orbitron tracking-widest uppercase",children:[o.jsx("li",{className:"hover:text-white transition-colors cursor-pointer hover:translate-x-1 duration-300",children:"Sedes Decentraland"}),o.jsx("li",{className:"hover:text-white transition-colors cursor-pointer hover:translate-x-1 duration-300",children:"Virtual Office"}),o.jsx("li",{className:"hover:text-white transition-colors cursor-pointer hover:translate-x-1 duration-300 text-nexus-cyan-glow font-bold",children:"Acceso Terminal"})]})]})]})]}),zi=({loading:t,isAuthenticated:e,currentUser:s,handleLogin:r,handleLogout:n})=>{const{notify:i}=Ri(),a=Lr();return v.useEffect(()=>{document.startViewTransition&&document.startViewTransition(()=>{})},[a.pathname]),v.useEffect(()=>{t||i("SISTEMA ACTIVADO","Protocolos Antigravity God Mode Online","success")},[t,i]),o.jsxs("div",{className:"bg-nexus-obsidian min-h-screen text-white font-sans selection:bg-nexus-violet selection:text-white relative",children:[o.jsx(bi,{}),o.jsx(ji,{}),e?null:o.jsx(wi,{}),o.jsxs(xn,{children:[o.jsx(G,{path:"/login",element:e?o.jsx(Gt,{to:"/dashboard"}):o.jsx(Pi,{onLogin:r,isAuthenticated:e})}),o.jsx(G,{path:"/dashboard",element:e?o.jsx(Mi,{user:s,onLogout:n}):o.jsxs("div",{style:{minHeight:"100vh",padding:"2rem"},children:[o.jsx("h1",{style:{textAlign:"center",fontSize:"3rem",marginBottom:"2rem"},children:"Centro de Control AIGestion"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"2rem"},children:[o.jsxs("a",{href:"/dashboard/admin",style:{background:"rgba(139, 92, 246, 0.1)",padding:"2rem",borderRadius:"12px",textDecoration:"none",color:"white",border:"1px solid rgba(139, 92, 246, 0.3)"},children:[o.jsx("h3",{children:"ðŸ† Panel Administrativo"}),o.jsx("p",{children:"Control administrativo y anÃ¡lisis"})]}),o.jsxs("a",{href:"/dashboard/client",style:{background:"rgba(6, 182, 212, 0.1)",padding:"2rem",borderRadius:"12px",textDecoration:"none",color:"white",border:"1px solid rgba(6, 182, 212, 0.3)"},children:[o.jsx("h3",{children:"ðŸ‘¥ Panel de Cliente"}),o.jsx("p",{children:"Portal de clientes y gestiÃ³n de proyectos"})]}),o.jsxs("a",{href:"/dashboard/demo",style:{background:"rgba(16, 185, 129, 0.1)",padding:"2rem",borderRadius:"12px",textDecoration:"none",color:"white",border:"1px solid rgba(16, 185, 129, 0.3)"},children:[o.jsx("h3",{children:"ðŸŽª Panel de DemostraciÃ³n"}),o.jsx("p",{children:"Demos interactivas y showcases"})]})]}),o.jsx("p",{style:{textAlign:"center",marginTop:"2rem"},children:o.jsx("a",{href:"/login",style:{color:"#667eea"},children:"Iniciar SesiÃ³n para Acceso Completo"})})]})}),o.jsx(G,{path:"/dashboard/admin",element:o.jsx(Fs,{})}),o.jsx(G,{path:"/dashboard/client",element:o.jsx(zs,{})}),o.jsx(G,{path:"/dashboard/demo",element:o.jsx(Vs,{})}),o.jsx(G,{path:"/",element:e?o.jsx(Gt,{to:"/dashboard"}):o.jsxs("main",{children:[o.jsx(v.Suspense,{fallback:o.jsx(Pe,{}),children:o.jsx(Di,{})}),o.jsx(v.Suspense,{fallback:o.jsx(Pe,{}),children:o.jsx(Ui,{})}),o.jsx(v.Suspense,{fallback:o.jsx(Pe,{}),children:o.jsx(Li,{})}),o.jsx(Ai,{}),o.jsx(Xn,{}),o.jsx(v.Suspense,{fallback:o.jsx(Pe,{}),children:o.jsx($i,{})}),o.jsx(ki,{}),o.jsx(gi,{}),o.jsx(Ci,{}),o.jsx(v.Suspense,{fallback:o.jsx(Pe,{}),children:o.jsx(Bs,{})}),o.jsx(pi,{}),o.jsx(v.Suspense,{fallback:o.jsx(Pe,{}),children:o.jsx(ci,{})})]})}),o.jsx(G,{path:"/lab",element:o.jsx("div",{className:"pt-32 pb-20 px-6",children:o.jsx("h1",{className:"text-4xl font-orbitron text-white text-center",children:"Lab Section"})})}),o.jsx(G,{path:"/weapon",element:o.jsx(Bi,{})}),o.jsx(G,{path:"/dashboard",element:o.jsx(Gt,{to:"/dashboard/"})}),o.jsx(G,{path:"/dashboard/",element:o.jsxs("div",{style:{minHeight:"100vh",padding:"2rem"},children:[o.jsx("h1",{style:{textAlign:"center",fontSize:"3rem",marginBottom:"2rem"},children:"AIGestion Dashboard Hub"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"2rem"},children:[o.jsxs("a",{href:"/dashboard/admin",style:{background:"rgba(139, 92, 246, 0.1)",padding:"2rem",borderRadius:"12px",textDecoration:"none",color:"white",border:"1px solid rgba(139, 92, 246, 0.3)"},children:[o.jsx("h3",{children:"ðŸ† Admin Dashboard"}),o.jsx("p",{children:"Administrative control and analytics"})]}),o.jsxs("a",{href:"/dashboard/client",style:{background:"rgba(6, 182, 212, 0.1)",padding:"2rem",borderRadius:"12px",textDecoration:"none",color:"white",border:"1px solid rgba(6, 182, 212, 0.3)"},children:[o.jsx("h3",{children:"ðŸ‘¥ Client Dashboard"}),o.jsx("p",{children:"Client portal and project management"})]}),o.jsxs("a",{href:"/dashboard/demo",style:{background:"rgba(16, 185, 129, 0.1)",padding:"2rem",borderRadius:"12px",textDecoration:"none",color:"white",border:"1px solid rgba(16, 185, 129, 0.3)"},children:[o.jsx("h3",{children:"ðŸŽª Demo Dashboard"}),o.jsx("p",{children:"Interactive demos and showcases"})]})]})]})}),o.jsx(G,{path:"/dashboard/admin",element:o.jsx(Fs,{})}),o.jsx(G,{path:"/dashboard/client",element:o.jsx(zs,{})}),o.jsx(G,{path:"/dashboard/demo",element:o.jsx(Vs,{})}),o.jsx(G,{path:"/daniela",element:o.jsx(Gs,{})}),o.jsx(G,{path:"/daniela/demo",element:o.jsx(Gs,{})}),o.jsx(G,{path:"/virtual-office",element:o.jsx(qi,{})}),o.jsx(G,{path:"/virtual-office/go",element:o.jsx(Bs,{})})]}),o.jsx(Fi,{}),o.jsx(ai,{}),o.jsx(si,{}),o.jsx(hi,{}),o.jsx(Qn,{}),o.jsx(ui,{}),o.jsx(xi,{})]})};class Vi{constructor(){Z(this,"logs",[]);Z(this,"maxLogs",50);Z(this,"endpoint",null);this.endpoint=null,typeof window<"u"&&(window.addEventListener("error",this.handleGlobalError.bind(this)),window.addEventListener("unhandledrejection",this.handleUnhandledRejection.bind(this)))}logError(e,s="error",r){const n={message:e.message,stack:e.stack,timestamp:Date.now(),url:window.location.href,userAgent:navigator.userAgent,level:s,context:r};this.addToLocalLogs(n),this.endpoint&&this.sendToExternalService(n).catch(i=>{console.warn("Failed to send error to logging service:",i)})}logComponentError(e,s,r){const n={message:e.message,stack:e.stack,componentStack:s,timestamp:Date.now(),url:window.location.href,userAgent:navigator.userAgent,level:"error",context:{...r,type:"react-component-error"}};this.addToLocalLogs(n),this.endpoint&&this.sendToExternalService(n).catch(i=>{console.warn("Failed to send component error:",i)})}handleGlobalError(e){this.logError(new Error(e.message),"error",{filename:e.filename,lineno:e.lineno,colno:e.colno})}handleUnhandledRejection(e){const s=e.reason instanceof Error?e.reason:new Error(String(e.reason));this.logError(s,"error",{type:"unhandled-promise-rejection"})}addToLocalLogs(e){this.logs.push(e),this.logs.length>this.maxLogs&&(this.logs=this.logs.slice(-this.maxLogs));try{localStorage.setItem("error-logs",JSON.stringify(this.logs.slice(-10)))}catch{}}async sendToExternalService(e){if(this.endpoint)try{await fetch(this.endpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}catch{}}getRecentLogs(e=10){return this.logs.slice(-e)}clearLogs(){this.logs=[];try{localStorage.removeItem("error-logs")}catch{}}setEndpoint(e){this.endpoint=e}}const Gi=new Vi,Wi=(t,e,s)=>Gi.logComponentError(t,e,s);function zr(t){var e,s,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var n=t.length;for(e=0;e<n;e++)t[e]&&(s=zr(t[e]))&&(r&&(r+=" "),r+=s)}else for(s in t)t[s]&&(r&&(r+=" "),r+=s);return r}function Ki(){for(var t,e,s=0,r="",n=arguments.length;s<n;s++)(t=arguments[s])&&(e=zr(t))&&(r&&(r+=" "),r+=e);return r}const Ns="-",Hi=t=>{const e=Qi(t),{conflictingClassGroups:s,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:a=>{const l=a.split(Ns);return l[0]===""&&l.length!==1&&l.shift(),Vr(l,e)||Ji(a)},getConflictingClassGroupIds:(a,l)=>{const c=s[a]||[];return l&&r[a]?[...c,...r[a]]:c}}},Vr=(t,e)=>{var a;if(t.length===0)return e.classGroupId;const s=t[0],r=e.nextPart.get(s),n=r?Vr(t.slice(1),r):void 0;if(n)return n;if(e.validators.length===0)return;const i=t.join(Ns);return(a=e.validators.find(({validator:l})=>l(i)))==null?void 0:a.classGroupId},Ws=/^\[(.+)\]$/,Ji=t=>{if(Ws.test(t)){const e=Ws.exec(t)[1],s=e==null?void 0:e.substring(0,e.indexOf(":"));if(s)return"arbitrary.."+s}},Qi=t=>{const{theme:e,prefix:s}=t,r={nextPart:new Map,validators:[]};return Xi(Object.entries(t.classGroups),s).forEach(([i,a])=>{fs(a,r,i,e)}),r},fs=(t,e,s,r)=>{t.forEach(n=>{if(typeof n=="string"){const i=n===""?e:Ks(e,n);i.classGroupId=s;return}if(typeof n=="function"){if(Yi(n)){fs(n(r),e,s,r);return}e.validators.push({validator:n,classGroupId:s});return}Object.entries(n).forEach(([i,a])=>{fs(a,Ks(e,i),s,r)})})},Ks=(t,e)=>{let s=t;return e.split(Ns).forEach(r=>{s.nextPart.has(r)||s.nextPart.set(r,{nextPart:new Map,validators:[]}),s=s.nextPart.get(r)}),s},Yi=t=>t.isThemeGetter,Xi=(t,e)=>e?t.map(([s,r])=>{const n=r.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([a,l])=>[e+a,l])):i);return[s,n]}):t,Zi=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,s=new Map,r=new Map;const n=(i,a)=>{s.set(i,a),e++,e>t&&(e=0,r=s,s=new Map)};return{get(i){let a=s.get(i);if(a!==void 0)return a;if((a=r.get(i))!==void 0)return n(i,a),a},set(i,a){s.has(i)?s.set(i,a):n(i,a)}}},Gr="!",ea=t=>{const{separator:e,experimentalParseClassName:s}=t,r=e.length===1,n=e[0],i=e.length,a=l=>{const c=[];let u=0,d=0,h;for(let y=0;y<l.length;y++){let w=l[y];if(u===0){if(w===n&&(r||l.slice(y,y+i)===e)){c.push(l.slice(d,y)),d=y+i;continue}if(w==="/"){h=y;continue}}w==="["?u++:w==="]"&&u--}const f=c.length===0?l:l.substring(d),p=f.startsWith(Gr),m=p?f.substring(1):f,g=h&&h>d?h-d:void 0;return{modifiers:c,hasImportantModifier:p,baseClassName:m,maybePostfixModifierPosition:g}};return s?l=>s({className:l,parseClassName:a}):a},ta=t=>{if(t.length<=1)return t;const e=[];let s=[];return t.forEach(r=>{r[0]==="["?(e.push(...s.sort(),r),s=[]):s.push(r)}),e.push(...s.sort()),e},sa=t=>({cache:Zi(t.cacheSize),parseClassName:ea(t),...Hi(t)}),ra=/\s+/,na=(t,e)=>{const{parseClassName:s,getClassGroupId:r,getConflictingClassGroupIds:n}=e,i=[],a=t.trim().split(ra);let l="";for(let c=a.length-1;c>=0;c-=1){const u=a[c],{modifiers:d,hasImportantModifier:h,baseClassName:f,maybePostfixModifierPosition:p}=s(u);let m=!!p,g=r(m?f.substring(0,p):f);if(!g){if(!m){l=u+(l.length>0?" "+l:l);continue}if(g=r(f),!g){l=u+(l.length>0?" "+l:l);continue}m=!1}const y=ta(d).join(":"),w=h?y+Gr:y,S=w+g;if(i.includes(S))continue;i.push(S);const x=n(g,m);for(let _=0;_<x.length;++_){const O=x[_];i.push(w+O)}l=u+(l.length>0?" "+l:l)}return l};function ia(){let t=0,e,s,r="";for(;t<arguments.length;)(e=arguments[t++])&&(s=Wr(e))&&(r&&(r+=" "),r+=s);return r}const Wr=t=>{if(typeof t=="string")return t;let e,s="";for(let r=0;r<t.length;r++)t[r]&&(e=Wr(t[r]))&&(s&&(s+=" "),s+=e);return s};function aa(t,...e){let s,r,n,i=a;function a(c){const u=e.reduce((d,h)=>h(d),t());return s=sa(u),r=s.cache.get,n=s.cache.set,i=l,l(c)}function l(c){const u=r(c);if(u)return u;const d=na(c,s);return n(c,d),d}return function(){return i(ia.apply(null,arguments))}}const $=t=>{const e=s=>s[t]||[];return e.isThemeGetter=!0,e},Kr=/^\[(?:([a-z-]+):)?(.+)\]$/i,oa=/^\d+\/\d+$/,la=new Set(["px","full","screen"]),ca=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,ua=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,da=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,ha=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,fa=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,pe=t=>tt(t)||la.has(t)||oa.test(t),ve=t=>dt(t,"length",xa),tt=t=>!!t&&!Number.isNaN(Number(t)),ns=t=>dt(t,"number",tt),mt=t=>!!t&&Number.isInteger(Number(t)),pa=t=>t.endsWith("%")&&tt(t.slice(0,-1)),N=t=>Kr.test(t),we=t=>ca.test(t),ma=new Set(["length","size","percentage"]),ga=t=>dt(t,ma,Hr),ba=t=>dt(t,"position",Hr),ya=new Set(["image","url"]),va=t=>dt(t,ya,Sa),wa=t=>dt(t,"",_a),gt=()=>!0,dt=(t,e,s)=>{const r=Kr.exec(t);return r?r[1]?typeof e=="string"?r[1]===e:e.has(r[1]):s(r[2]):!1},xa=t=>ua.test(t)&&!da.test(t),Hr=()=>!1,_a=t=>ha.test(t),Sa=t=>fa.test(t),ka=()=>{const t=$("colors"),e=$("spacing"),s=$("blur"),r=$("brightness"),n=$("borderColor"),i=$("borderRadius"),a=$("borderSpacing"),l=$("borderWidth"),c=$("contrast"),u=$("grayscale"),d=$("hueRotate"),h=$("invert"),f=$("gap"),p=$("gradientColorStops"),m=$("gradientColorStopPositions"),g=$("inset"),y=$("margin"),w=$("opacity"),S=$("padding"),x=$("saturate"),_=$("scale"),O=$("sepia"),C=$("skew"),I=$("space"),J=$("translate"),B=()=>["auto","contain","none"],L=()=>["auto","hidden","clip","visible","scroll"],F=()=>["auto",N,e],D=()=>[N,e],$s=()=>["",pe,ve],$t=()=>["auto",tt,N],Ds=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],Dt=()=>["solid","dashed","dotted","double","none"],Ls=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],ss=()=>["start","end","center","between","around","evenly","stretch"],ft=()=>["","0",N],Us=()=>["auto","avoid","all","avoid-page","page","left","right","column"],fe=()=>[tt,N];return{cacheSize:500,separator:":",theme:{colors:[gt],spacing:[pe,ve],blur:["none","",we,N],brightness:fe(),borderColor:[t],borderRadius:["none","","full",we,N],borderSpacing:D(),borderWidth:$s(),contrast:fe(),grayscale:ft(),hueRotate:fe(),invert:ft(),gap:D(),gradientColorStops:[t],gradientColorStopPositions:[pa,ve],inset:F(),margin:F(),opacity:fe(),padding:D(),saturate:fe(),scale:fe(),sepia:ft(),skew:fe(),space:D(),translate:D()},classGroups:{aspect:[{aspect:["auto","square","video",N]}],container:["container"],columns:[{columns:[we]}],"break-after":[{"break-after":Us()}],"break-before":[{"break-before":Us()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...Ds(),N]}],overflow:[{overflow:L()}],"overflow-x":[{"overflow-x":L()}],"overflow-y":[{"overflow-y":L()}],overscroll:[{overscroll:B()}],"overscroll-x":[{"overscroll-x":B()}],"overscroll-y":[{"overscroll-y":B()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",mt,N]}],basis:[{basis:F()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",N]}],grow:[{grow:ft()}],shrink:[{shrink:ft()}],order:[{order:["first","last","none",mt,N]}],"grid-cols":[{"grid-cols":[gt]}],"col-start-end":[{col:["auto",{span:["full",mt,N]},N]}],"col-start":[{"col-start":$t()}],"col-end":[{"col-end":$t()}],"grid-rows":[{"grid-rows":[gt]}],"row-start-end":[{row:["auto",{span:[mt,N]},N]}],"row-start":[{"row-start":$t()}],"row-end":[{"row-end":$t()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",N]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",N]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...ss()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...ss(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...ss(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[S]}],px:[{px:[S]}],py:[{py:[S]}],ps:[{ps:[S]}],pe:[{pe:[S]}],pt:[{pt:[S]}],pr:[{pr:[S]}],pb:[{pb:[S]}],pl:[{pl:[S]}],m:[{m:[y]}],mx:[{mx:[y]}],my:[{my:[y]}],ms:[{ms:[y]}],me:[{me:[y]}],mt:[{mt:[y]}],mr:[{mr:[y]}],mb:[{mb:[y]}],ml:[{ml:[y]}],"space-x":[{"space-x":[I]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[I]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",N,e]}],"min-w":[{"min-w":[N,e,"min","max","fit"]}],"max-w":[{"max-w":[N,e,"none","full","min","max","fit","prose",{screen:[we]},we]}],h:[{h:[N,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[N,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[N,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[N,e,"auto","min","max","fit"]}],"font-size":[{text:["base",we,ve]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",ns]}],"font-family":[{font:[gt]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",N]}],"line-clamp":[{"line-clamp":["none",tt,ns]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",pe,N]}],"list-image":[{"list-image":["none",N]}],"list-style-type":[{list:["none","disc","decimal",N]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[w]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[w]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Dt(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",pe,ve]}],"underline-offset":[{"underline-offset":["auto",pe,N]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:D()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",N]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",N]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[w]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...Ds(),ba]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",ga]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},va]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[m]}],"gradient-via-pos":[{via:[m]}],"gradient-to-pos":[{to:[m]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[w]}],"border-style":[{border:[...Dt(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[w]}],"divide-style":[{divide:Dt()}],"border-color":[{border:[n]}],"border-color-x":[{"border-x":[n]}],"border-color-y":[{"border-y":[n]}],"border-color-s":[{"border-s":[n]}],"border-color-e":[{"border-e":[n]}],"border-color-t":[{"border-t":[n]}],"border-color-r":[{"border-r":[n]}],"border-color-b":[{"border-b":[n]}],"border-color-l":[{"border-l":[n]}],"divide-color":[{divide:[n]}],"outline-style":[{outline:["",...Dt()]}],"outline-offset":[{"outline-offset":[pe,N]}],"outline-w":[{outline:[pe,ve]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:$s()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[w]}],"ring-offset-w":[{"ring-offset":[pe,ve]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",we,wa]}],"shadow-color":[{shadow:[gt]}],opacity:[{opacity:[w]}],"mix-blend":[{"mix-blend":[...Ls(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":Ls()}],filter:[{filter:["","none"]}],blur:[{blur:[s]}],brightness:[{brightness:[r]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",we,N]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[h]}],saturate:[{saturate:[x]}],sepia:[{sepia:[O]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[s]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[w]}],"backdrop-saturate":[{"backdrop-saturate":[x]}],"backdrop-sepia":[{"backdrop-sepia":[O]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",N]}],duration:[{duration:fe()}],ease:[{ease:["linear","in","out","in-out",N]}],delay:[{delay:fe()}],animate:[{animate:["none","spin","ping","pulse","bounce",N]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[_]}],"scale-x":[{"scale-x":[_]}],"scale-y":[{"scale-y":[_]}],rotate:[{rotate:[mt,N]}],"translate-x":[{"translate-x":[J]}],"translate-y":[{"translate-y":[J]}],"skew-x":[{"skew-x":[C]}],"skew-y":[{"skew-y":[C]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",N]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",N]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":D()}],"scroll-mx":[{"scroll-mx":D()}],"scroll-my":[{"scroll-my":D()}],"scroll-ms":[{"scroll-ms":D()}],"scroll-me":[{"scroll-me":D()}],"scroll-mt":[{"scroll-mt":D()}],"scroll-mr":[{"scroll-mr":D()}],"scroll-mb":[{"scroll-mb":D()}],"scroll-ml":[{"scroll-ml":D()}],"scroll-p":[{"scroll-p":D()}],"scroll-px":[{"scroll-px":D()}],"scroll-py":[{"scroll-py":D()}],"scroll-ps":[{"scroll-ps":D()}],"scroll-pe":[{"scroll-pe":D()}],"scroll-pt":[{"scroll-pt":D()}],"scroll-pr":[{"scroll-pr":D()}],"scroll-pb":[{"scroll-pb":D()}],"scroll-pl":[{"scroll-pl":D()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",N]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[pe,ve,ns]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},ja=aa(ka);function Ea(...t){return ja(Ki(t))}const ps=v.forwardRef(({className:t,variant:e="primary",size:s="md",loading:r=!1,icon:n,iconPosition:i="left",children:a,disabled:l,...c},u)=>{const d=["inline-flex items-center justify-center","font-medium rounded-lg","transition-all duration-200","focus:outline-none focus:ring-2 focus:ring-offset-2","disabled:opacity-50 disabled:cursor-not-allowed"],h={primary:["bg-blue-600 text-white hover:bg-blue-700","focus:ring-blue-500","dark:bg-blue-500 dark:hover:bg-blue-600"],secondary:["bg-gray-600 text-white hover:bg-gray-700","focus:ring-gray-500","dark:bg-gray-700 dark:hover:bg-gray-600"],outline:["border border-gray-300 bg-white text-gray-700 hover:bg-gray-50","focus:ring-blue-500","dark:border-gray-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"],ghost:["text-gray-700 hover:bg-gray-100","focus:ring-gray-500","dark:text-gray-300 dark:hover:bg-gray-800"],destructive:["bg-red-600 text-white hover:bg-red-700","focus:ring-red-500","dark:bg-red-500 dark:hover:bg-red-600"]},f={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg",xl:"px-8 py-4 text-xl"},p=Ea(...d,...h[e],f[s],t),m=()=>r?o.jsx(Jn,{className:"w-4 h-4 animate-spin"}):n,g=()=>n&&i==="right"?o.jsxs(o.Fragment,{children:[a,m()&&o.jsx("span",{className:"ml-2",children:m()})]}):o.jsxs(o.Fragment,{children:[m()&&o.jsx("span",{className:"mr-2",children:m()}),a]});return o.jsx("button",{ref:u,className:p,disabled:l||r,...c,children:g()})});ps.displayName="Button";class Aa extends v.Component{constructor(s){super(s);Z(this,"handleReset",()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0})});this.state={hasError:!1}}static getDerivedStateFromError(s){return{hasError:!0,error:s}}componentDidCatch(s,r){var n,i;console.error("ErrorBoundary caught an error:",s,r),this.setState({error:s,errorInfo:r}),(i=(n=this.props).onError)==null||i.call(n,s,r),Wi(s,r.componentStack,{errorBoundary:!0,timestamp:new Date().toISOString()})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:o.jsxs("div",{className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 text-center",children:[o.jsx("div",{className:"mb-4",children:o.jsx("div",{className:"mx-auto w-16 h-16 bg-red-100 dark:bg-red-900 rounded-full flex items-center justify-center",children:o.jsx("svg",{className:"w-8 h-8 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"})})})}),o.jsx("h1",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:"Oops! Something went wrong"}),o.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"We're sorry, but something unexpected happened. Our team has been notified."}),o.jsxs("div",{className:"space-y-3",children:[o.jsx(ps,{onClick:this.handleReset,className:"w-full",children:"Try Again"}),o.jsx(ps,{variant:"outline",onClick:()=>window.location.reload(),className:"w-full",children:"Reload Page"})]}),!1]})}):this.props.children}}const Ta=v.createContext(void 0),Ca=({children:t})=>{const[e,s]=v.useState(!0),[r,n]=v.useState(!1),{playSuccess:i}=It();v.useEffect(()=>{e?document.body.classList.add("nexus-god-mode"):document.body.classList.remove("nexus-god-mode")},[e]),v.useEffect(()=>{const c=setTimeout(()=>{i()},1e3);return()=>clearTimeout(c)},[]);const a=()=>n(c=>!c),l=Dr.useMemo(()=>({godMode:e,setGodMode:s,reduceMotion:r,toggleReduceMotion:a}),[e,r]);return o.jsx(Ta.Provider,{value:l,children:t})};function Qt(t,e){var s={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(s[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(s[r[n]]=t[r[n]]);return s}function Na(t,e,s,r){function n(i){return i instanceof s?i:new s(function(a){a(i)})}return new(s||(s=Promise))(function(i,a){function l(d){try{u(r.next(d))}catch(h){a(h)}}function c(d){try{u(r.throw(d))}catch(h){a(h)}}function u(d){d.done?i(d.value):n(d.value).then(l,c)}u((r=r.apply(t,e||[])).next())})}const Oa=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class Os extends Error{constructor(e,s="FunctionsError",r){super(e),this.name=s,this.context=r}}class Ra extends Os{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Hs extends Os{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Js extends Os{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var ms;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(ms||(ms={}));class Ia{constructor(e,{headers:s={},customFetch:r,region:n=ms.Any}={}){this.url=e,this.headers=s,this.region=n,this.fetch=Oa(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return Na(this,arguments,void 0,function*(s,r={}){var n;let i,a;try{const{headers:l,method:c,body:u,signal:d,timeout:h}=r;let f={},{region:p}=r;p||(p=this.region);const m=new URL(`${this.url}/${s}`);p&&p!=="any"&&(f["x-region"]=p,m.searchParams.set("forceFunctionRegion",p));let g;u&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",g=u):typeof u=="string"?(f["Content-Type"]="text/plain",g=u):typeof FormData<"u"&&u instanceof FormData?g=u:(f["Content-Type"]="application/json",g=JSON.stringify(u)):u&&typeof u!="string"&&!(typeof Blob<"u"&&u instanceof Blob)&&!(u instanceof ArrayBuffer)&&!(typeof FormData<"u"&&u instanceof FormData)?g=JSON.stringify(u):g=u;let y=d;h&&(a=new AbortController,i=setTimeout(()=>a.abort(),h),d?(y=a.signal,d.addEventListener("abort",()=>a.abort())):y=a.signal);const w=yield this.fetch(m.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),l),body:g,signal:y}).catch(O=>{throw new Ra(O)}),S=w.headers.get("x-relay-error");if(S&&S==="true")throw new Hs(w);if(!w.ok)throw new Js(w);let x=((n=w.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),_;return x==="application/json"?_=yield w.json():x==="application/octet-stream"||x==="application/pdf"?_=yield w.blob():x==="text/event-stream"?_=w:x==="multipart/form-data"?_=yield w.formData():_=yield w.text(),{data:_,error:null,response:w}}catch(l){return{data:null,error:l,response:l instanceof Js||l instanceof Hs?l.context:void 0}}finally{i&&clearTimeout(i)}})}}var Pa=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}},$a=class{constructor(t){var e,s;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(e=t.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=t.signal,this.isMaybeSingle=(s=t.isMaybeSingle)!==null&&s!==void 0?s:!1,t.fetch?this.fetch=t.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=new Headers(this.headers),this.headers.set(t,e),this}then(t,e){var s=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const r=this.fetch;let n=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{let a=null,l=null,c=null,u=i.status,d=i.statusText;if(i.ok){var h,f;if(s.method!=="HEAD"){var p;const w=await i.text();w===""||(s.headers.get("Accept")==="text/csv"||s.headers.get("Accept")&&(!((p=s.headers.get("Accept"))===null||p===void 0)&&p.includes("application/vnd.pgrst.plan+text"))?l=w:l=JSON.parse(w))}const g=(h=s.headers.get("Prefer"))===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),y=(f=i.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");g&&y&&y.length>1&&(c=parseInt(y[1])),s.isMaybeSingle&&s.method==="GET"&&Array.isArray(l)&&(l.length>1?(a={code:"PGRST116",details:`Results contain ${l.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},l=null,c=null,u=406,d="Not Acceptable"):l.length===1?l=l[0]:l=null)}else{var m;const g=await i.text();try{a=JSON.parse(g),Array.isArray(a)&&i.status===404&&(l=[],a=null,u=200,d="OK")}catch{i.status===404&&g===""?(u=204,d="No Content"):a={message:g}}if(a&&s.isMaybeSingle&&(!(a==null||(m=a.details)===null||m===void 0)&&m.includes("0 rows"))&&(a=null,u=200,d="OK"),a&&s.shouldThrowOnError)throw new Pa(a)}return{error:a,data:l,count:c,status:u,statusText:d}});return this.shouldThrowOnError||(n=n.catch(i=>{var a;let l="";const c=i==null?void 0:i.cause;if(c){var u,d,h,f;const m=(u=c==null?void 0:c.message)!==null&&u!==void 0?u:"",g=(d=c==null?void 0:c.code)!==null&&d!==void 0?d:"";l=`${(h=i==null?void 0:i.name)!==null&&h!==void 0?h:"FetchError"}: ${i==null?void 0:i.message}`,l+=`

Caused by: ${(f=c==null?void 0:c.name)!==null&&f!==void 0?f:"Error"}: ${m}`,g&&(l+=` (${g})`),c!=null&&c.stack&&(l+=`
${c.stack}`)}else{var p;l=(p=i==null?void 0:i.stack)!==null&&p!==void 0?p:""}return{error:{message:`${(a=i==null?void 0:i.name)!==null&&a!==void 0?a:"FetchError"}: ${i==null?void 0:i.message}`,details:l,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),n.then(t,e)}returns(){return this}overrideTypes(){return this}},Da=class extends $a{select(t){let e=!1;const s=(t??"*").split("").map(r=>/\s/.test(r)&&!e?"":(r==='"'&&(e=!e),r)).join("");return this.url.searchParams.set("select",s),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:e=!0,nullsFirst:s,foreignTable:r,referencedTable:n=r}={}){const i=n?`${n}.order`:"order",a=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${a?`${a},`:""}${t}.${e?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:s=e}={}){const r=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(r,`${t}`),this}range(t,e,{foreignTable:s,referencedTable:r=s}={}){const n=typeof r>"u"?"offset":`${r}.offset`,i=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${t}`),this.url.searchParams.set(i,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:e=!1,settings:s=!1,buffers:r=!1,wal:n=!1,format:i="text"}={}){var a;const l=[t?"analyze":null,e?"verbose":null,s?"settings":null,r?"buffers":null,n?"wal":null].filter(Boolean).join("|"),c=(a=this.headers.get("Accept"))!==null&&a!==void 0?a:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${c}"; options=${l};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};const Qs=new RegExp("[,()]");var Ye=class extends Da{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}regexMatch(t,e){return this.url.searchParams.append(t,`match.${e}`),this}regexIMatch(t,e){return this.url.searchParams.append(t,`imatch.${e}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}isDistinct(t,e){return this.url.searchParams.append(t,`isdistinct.${e}`),this}in(t,e){const s=Array.from(new Set(e)).map(r=>typeof r=="string"&&Qs.test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(t,`in.(${s})`),this}notIn(t,e){const s=Array.from(new Set(e)).map(r=>typeof r=="string"&&Qs.test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(t,`not.in.(${s})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:s,type:r}={}){let n="";r==="plain"?n="pl":r==="phrase"?n="ph":r==="websearch"&&(n="w");const i=s===void 0?"":`(${s})`;return this.url.searchParams.append(t,`${n}fts${i}.${e}`),this}match(t){return Object.entries(t).forEach(([e,s])=>{this.url.searchParams.append(e,`eq.${s}`)}),this}not(t,e,s){return this.url.searchParams.append(t,`not.${e}.${s}`),this}or(t,{foreignTable:e,referencedTable:s=e}={}){const r=s?`${s}.or`:"or";return this.url.searchParams.append(r,`(${t})`),this}filter(t,e,s){return this.url.searchParams.append(t,`${e}.${s}`),this}},La=class{constructor(t,{headers:e={},schema:s,fetch:r}){this.url=t,this.headers=new Headers(e),this.schema=s,this.fetch=r}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(t,e){const{head:s=!1,count:r}=e??{},n=s?"HEAD":"GET";let i=!1;const a=(t??"*").split("").map(u=>/\s/.test(u)&&!i?"":(u==='"'&&(i=!i),u)).join(""),{url:l,headers:c}=this.cloneRequestState();return l.searchParams.set("select",a),r&&c.append("Prefer",`count=${r}`),new Ye({method:n,url:l,headers:c,schema:this.schema,fetch:this.fetch})}insert(t,{count:e,defaultToNull:s=!0}={}){var r;const n="POST",{url:i,headers:a}=this.cloneRequestState();if(e&&a.append("Prefer",`count=${e}`),s||a.append("Prefer","missing=default"),Array.isArray(t)){const l=t.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);i.searchParams.set("columns",c.join(","))}}return new Ye({method:n,url:i,headers:a,schema:this.schema,body:t,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}upsert(t,{onConflict:e,ignoreDuplicates:s=!1,count:r,defaultToNull:n=!0}={}){var i;const a="POST",{url:l,headers:c}=this.cloneRequestState();if(c.append("Prefer",`resolution=${s?"ignore":"merge"}-duplicates`),e!==void 0&&l.searchParams.set("on_conflict",e),r&&c.append("Prefer",`count=${r}`),n||c.append("Prefer","missing=default"),Array.isArray(t)){const u=t.reduce((d,h)=>d.concat(Object.keys(h)),[]);if(u.length>0){const d=[...new Set(u)].map(h=>`"${h}"`);l.searchParams.set("columns",d.join(","))}}return new Ye({method:a,url:l,headers:c,schema:this.schema,body:t,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(t,{count:e}={}){var s;const r="PATCH",{url:n,headers:i}=this.cloneRequestState();return e&&i.append("Prefer",`count=${e}`),new Ye({method:r,url:n,headers:i,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}delete({count:t}={}){var e;const s="DELETE",{url:r,headers:n}=this.cloneRequestState();return t&&n.append("Prefer",`count=${t}`),new Ye({method:s,url:r,headers:n,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}},Ua=class Jr{constructor(e,{headers:s={},schema:r,fetch:n}={}){this.url=e,this.headers=new Headers(s),this.schemaName=r,this.fetch=n}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new La(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Jr(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,s={},{head:r=!1,get:n=!1,count:i}={}){var a;let l;const c=new URL(`${this.url}/rpc/${e}`);let u;const d=p=>p!==null&&typeof p=="object"&&(!Array.isArray(p)||p.some(d)),h=r&&Object.values(s).some(d);h?(l="POST",u=s):r||n?(l=r?"HEAD":"GET",Object.entries(s).filter(([p,m])=>m!==void 0).map(([p,m])=>[p,Array.isArray(m)?`{${m.join(",")}}`:`${m}`]).forEach(([p,m])=>{c.searchParams.append(p,m)})):(l="POST",u=s);const f=new Headers(this.headers);return h?f.set("Prefer",i?`count=${i},return=minimal`:"return=minimal"):i&&f.set("Prefer",`count=${i}`),new Ye({method:l,url:c,headers:f,schema:this.schemaName,body:u,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}};class Ma{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const s=globalThis.process;if(s){const r=s.versions;if(r&&r.node){const n=r.node,i=parseInt(n.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let s=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(s+=`

Suggested solution: ${e.workaround}`),new Error(s)}static createWebSocket(e,s){const r=this.getWebSocketConstructor();return new r(e,s)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const qa="2.93.3",Ba=`realtime-js/${qa}`,Fa="1.0.0",Qr="2.0.0",Ys=Qr,gs=1e4,za=1e3,Va=100;var _e;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(_e||(_e={}));var z;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(z||(z={}));var ce;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(ce||(ce={}));var bs;(function(t){t.websocket="websocket"})(bs||(bs={}));var De;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(De||(De={}));class Ga{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,s){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return s(this._binaryEncodeUserBroadcastPush(e));let r=[e.join_ref,e.ref,e.topic,e.event,e.payload];return s(JSON.stringify(r))}_binaryEncodeUserBroadcastPush(e){var s;return this._isArrayBuffer((s=e.payload)===null||s===void 0?void 0:s.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var s,r;const n=(r=(s=e.payload)===null||s===void 0?void 0:s.payload)!==null&&r!==void 0?r:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,n)}_encodeJsonUserBroadcastPush(e){var s,r;const n=(r=(s=e.payload)===null||s===void 0?void 0:s.payload)!==null&&r!==void 0?r:{},a=new TextEncoder().encode(JSON.stringify(n)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,a)}_encodeUserBroadcastPush(e,s,r){var n,i;const a=e.topic,l=(n=e.ref)!==null&&n!==void 0?n:"",c=(i=e.join_ref)!==null&&i!==void 0?i:"",u=e.payload.event,d=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},h=Object.keys(d).length===0?"":JSON.stringify(d);if(c.length>255)throw new Error(`joinRef length ${c.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`ref length ${l.length} exceeds maximum of 255`);if(a.length>255)throw new Error(`topic length ${a.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`userEvent length ${u.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`metadata length ${h.length} exceeds maximum of 255`);const f=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+l.length+a.length+u.length+h.length,p=new ArrayBuffer(this.HEADER_LENGTH+f);let m=new DataView(p),g=0;m.setUint8(g++,this.KINDS.userBroadcastPush),m.setUint8(g++,c.length),m.setUint8(g++,l.length),m.setUint8(g++,a.length),m.setUint8(g++,u.length),m.setUint8(g++,h.length),m.setUint8(g++,s),Array.from(c,w=>m.setUint8(g++,w.charCodeAt(0))),Array.from(l,w=>m.setUint8(g++,w.charCodeAt(0))),Array.from(a,w=>m.setUint8(g++,w.charCodeAt(0))),Array.from(u,w=>m.setUint8(g++,w.charCodeAt(0))),Array.from(h,w=>m.setUint8(g++,w.charCodeAt(0)));var y=new Uint8Array(p.byteLength+r.byteLength);return y.set(new Uint8Array(p),0),y.set(new Uint8Array(r),p.byteLength),y.buffer}decode(e,s){if(this._isArrayBuffer(e)){let r=this._binaryDecode(e);return s(r)}if(typeof e=="string"){const r=JSON.parse(e),[n,i,a,l,c]=r;return s({join_ref:n,ref:i,topic:a,event:l,payload:c})}return s({})}_binaryDecode(e){const s=new DataView(e),r=s.getUint8(0),n=new TextDecoder;switch(r){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,s,n)}}_decodeUserBroadcast(e,s,r){const n=s.getUint8(1),i=s.getUint8(2),a=s.getUint8(3),l=s.getUint8(4);let c=this.HEADER_LENGTH+4;const u=r.decode(e.slice(c,c+n));c=c+n;const d=r.decode(e.slice(c,c+i));c=c+i;const h=r.decode(e.slice(c,c+a));c=c+a;const f=e.slice(c,e.byteLength),p=l===this.JSON_ENCODING?JSON.parse(r.decode(f)):f,m={type:this.BROADCAST_EVENT,event:d,payload:p};return a>0&&(m.meta=JSON.parse(h)),{join_ref:null,ref:null,topic:u,event:this.BROADCAST_EVENT,payload:m}}_isArrayBuffer(e){var s;return e instanceof ArrayBuffer||((s=e==null?void 0:e.constructor)===null||s===void 0?void 0:s.name)==="ArrayBuffer"}_pick(e,s){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([r])=>s.includes(r)))}}class Yr{constructor(e,s){this.callback=e,this.timerCalc=s,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=s}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var P;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(P||(P={}));const Xs=(t,e,s={})=>{var r;const n=(r=s.skipTypes)!==null&&r!==void 0?r:[];return e?Object.keys(e).reduce((i,a)=>(i[a]=Wa(a,t,e,n),i),{}):{}},Wa=(t,e,s,r)=>{const n=e.find(l=>l.name===t),i=n==null?void 0:n.type,a=s[t];return i&&!r.includes(i)?Xr(i,a):ys(a)},Xr=(t,e)=>{if(t.charAt(0)==="_"){const s=t.slice(1,t.length);return Qa(e,s)}switch(t){case P.bool:return Ka(e);case P.float4:case P.float8:case P.int2:case P.int4:case P.int8:case P.numeric:case P.oid:return Ha(e);case P.json:case P.jsonb:return Ja(e);case P.timestamp:return Ya(e);case P.abstime:case P.date:case P.daterange:case P.int4range:case P.int8range:case P.money:case P.reltime:case P.text:case P.time:case P.timestamptz:case P.timetz:case P.tsrange:case P.tstzrange:return ys(e);default:return ys(e)}},ys=t=>t,Ka=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},Ha=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},Ja=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t},Qa=(t,e)=>{if(typeof t!="string")return t;const s=t.length-1,r=t[s];if(t[0]==="{"&&r==="}"){let i;const a=t.slice(1,s);try{i=JSON.parse("["+a+"]")}catch{i=a?a.split(","):[]}return i.map(l=>Xr(e,l))}return t},Ya=t=>typeof t=="string"?t.replace(" ","T"):t,Zr=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class is{constructor(e,s,r={},n=gs){this.channel=e,this.event=s,this.payload=r,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,s){var r;return this._hasReceived(e)&&s((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:s}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=s=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=s,this._matchReceive(s)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,s){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:s})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:s}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(s))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Zs;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Zs||(Zs={}));class vt{constructor(e,s){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(s==null?void 0:s.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},n=>{const{onJoin:i,onLeave:a,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=vt.syncState(this.state,n,i,a),this.pendingDiffs.forEach(c=>{this.state=vt.syncDiff(this.state,c,i,a)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},n=>{const{onJoin:i,onLeave:a,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=vt.syncDiff(this.state,n,i,a),l())}),this.onJoin((n,i,a)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:i,newPresences:a})}),this.onLeave((n,i,a)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:i,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,s,r,n){const i=this.cloneDeep(e),a=this.transformState(s),l={},c={};return this.map(i,(u,d)=>{a[u]||(c[u]=d)}),this.map(a,(u,d)=>{const h=i[u];if(h){const f=d.map(y=>y.presence_ref),p=h.map(y=>y.presence_ref),m=d.filter(y=>p.indexOf(y.presence_ref)<0),g=h.filter(y=>f.indexOf(y.presence_ref)<0);m.length>0&&(l[u]=m),g.length>0&&(c[u]=g)}else l[u]=d}),this.syncDiff(i,{joins:l,leaves:c},r,n)}static syncDiff(e,s,r,n){const{joins:i,leaves:a}={joins:this.transformState(s.joins),leaves:this.transformState(s.leaves)};return r||(r=()=>{}),n||(n=()=>{}),this.map(i,(l,c)=>{var u;const d=(u=e[l])!==null&&u!==void 0?u:[];if(e[l]=this.cloneDeep(c),d.length>0){const h=e[l].map(p=>p.presence_ref),f=d.filter(p=>h.indexOf(p.presence_ref)<0);e[l].unshift(...f)}r(l,d,c)}),this.map(a,(l,c)=>{let u=e[l];if(!u)return;const d=c.map(h=>h.presence_ref);u=u.filter(h=>d.indexOf(h.presence_ref)<0),e[l]=u,n(l,u,c),u.length===0&&delete e[l]}),e}static map(e,s){return Object.getOwnPropertyNames(e).map(r=>s(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((s,r)=>{const n=e[r];return"metas"in n?s[r]=n.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):s[r]=n,s},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var er;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(er||(er={}));var wt;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(wt||(wt={}));var ge;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(ge||(ge={}));class et{constructor(e,s={config:{}},r){var n,i;if(this.topic=e,this.params=s,this.socket=r,this.bindings={},this.state=z.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},s.config),this.timeout=this.socket.timeout,this.joinPush=new is(this,ce.join,this.params,this.timeout),this.rejoinTimer=new Yr(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=z.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=z.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=z.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=z.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=z.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ce.reply,{},(a,l)=>{this._trigger(this._replyEventName(l),a)}),this.presence=new vt(this),this.broadcastEndpointURL=Zr(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(n=this.params.config)===null||n===void 0?void 0:n.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,s=this.timeout){var r,n,i;if(this.socket.isConnected()||this.socket.connect(),this.state==z.closed){const{config:{broadcast:a,presence:l,private:c}}=this.params,u=(n=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(p=>p.filter))!==null&&n!==void 0?n:[],d=!!this.bindings[wt.PRESENCE]&&this.bindings[wt.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,h={},f={broadcast:a,presence:Object.assign(Object.assign({},l),{enabled:d}),postgres_changes:u,private:c};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(p=>e==null?void 0:e(ge.CHANNEL_ERROR,p)),this._onClose(()=>e==null?void 0:e(ge.CLOSED)),this.updateJoinPayload(Object.assign({config:f},h)),this.joinedOnce=!0,this._rejoin(s),this.joinPush.receive("ok",async({postgres_changes:p})=>{var m;if(this.socket._isManualToken()||this.socket.setAuth(),p===void 0){e==null||e(ge.SUBSCRIBED);return}else{const g=this.bindings.postgres_changes,y=(m=g==null?void 0:g.length)!==null&&m!==void 0?m:0,w=[];for(let S=0;S<y;S++){const x=g[S],{filter:{event:_,schema:O,table:C,filter:I}}=x,J=p&&p[S];if(J&&J.event===_&&et.isFilterValueEqual(J.schema,O)&&et.isFilterValueEqual(J.table,C)&&et.isFilterValueEqual(J.filter,I))w.push(Object.assign(Object.assign({},x),{id:J.id}));else{this.unsubscribe(),this.state=z.errored,e==null||e(ge.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=w,e&&e(ge.SUBSCRIBED);return}}).receive("error",p=>{this.state=z.errored,e==null||e(ge.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(ge.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,s={}){return await this.send({type:"presence",event:"track",payload:e},s.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,s,r){return this.state===z.joined&&e===wt.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,s,r)}async httpSend(e,s,r={}){var n;if(s==null)return Promise.reject("Payload is required for httpSend()");const i={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(i.Authorization=`Bearer ${this.socket.accessTokenValue}`);const a={method:"POST",headers:i,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:s,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const u=await l.json();c=u.error||u.message||c}catch{}return Promise.reject(new Error(c))}async send(e,s={}){var r,n;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:a}=e,l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const c={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(r=s.timeout)!==null&&r!==void 0?r:this.timeout);return await((n=u.body)===null||n===void 0?void 0:n.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var a,l,c;const u=this._push(e.type,e,s.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(a=this.params)===null||a===void 0?void 0:a.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=z.leaving;const s=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ce.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(n=>{r=new is(this,ce.leave,{},e),r.receive("ok",()=>{s(),n("ok")}).receive("timeout",()=>{s(),n("timed out")}).receive("error",()=>{n("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=z.closed,this.bindings={}}async _fetchWithTimeout(e,s,r){const n=new AbortController,i=setTimeout(()=>n.abort(),r),a=await this.socket.fetch(e,Object.assign(Object.assign({},s),{signal:n.signal}));return clearTimeout(i),a}_push(e,s,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new is(this,e,s,r);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>Va){const s=this.pushBuffer.shift();s&&(s.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${s.event}`,s.payload))}}_onMessage(e,s,r){return s}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,s,r){var n,i;const a=e.toLocaleLowerCase(),{close:l,error:c,leave:u,join:d}=ce;if(r&&[l,c,u,d].indexOf(a)>=0&&r!==this._joinRef())return;let f=this._onMessage(a,s,r);if(s&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(p=>{var m,g,y;return((m=p.filter)===null||m===void 0?void 0:m.event)==="*"||((y=(g=p.filter)===null||g===void 0?void 0:g.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===a}).map(p=>p.callback(f,r)):(i=this.bindings[a])===null||i===void 0||i.filter(p=>{var m,g,y,w,S,x;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in p){const _=p.id,O=(m=p.filter)===null||m===void 0?void 0:m.event;return _&&((g=s.ids)===null||g===void 0?void 0:g.includes(_))&&(O==="*"||(O==null?void 0:O.toLocaleLowerCase())===((y=s.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const _=(S=(w=p==null?void 0:p.filter)===null||w===void 0?void 0:w.event)===null||S===void 0?void 0:S.toLocaleLowerCase();return _==="*"||_===((x=s==null?void 0:s.event)===null||x===void 0?void 0:x.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===a}).map(p=>{if(typeof f=="object"&&"ids"in f){const m=f.data,{schema:g,table:y,commit_timestamp:w,type:S,errors:x}=m;f=Object.assign(Object.assign({},{schema:g,table:y,commit_timestamp:w,eventType:S,new:{},old:{},errors:x}),this._getPayloadRecords(m))}p.callback(f,r)})}_isClosed(){return this.state===z.closed}_isJoined(){return this.state===z.joined}_isJoining(){return this.state===z.joining}_isLeaving(){return this.state===z.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,s,r){const n=e.toLocaleLowerCase(),i={type:n,filter:s,callback:r};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(e,s){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(n=>{var i;return!(((i=n.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&et.isEqual(n.filter,s))})),this}static isEqual(e,s){if(Object.keys(e).length!==Object.keys(s).length)return!1;for(const r in e)if(e[r]!==s[r])return!1;return!0}static isFilterValueEqual(e,s){return(e??void 0)===(s??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(ce.close,{},e)}_onError(e){this._on(ce.error,{},s=>e(s))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=z.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const s={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(s.new=Xs(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(s.old=Xs(e.columns,e.old_record)),s}}const as=()=>{},Ut={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Xa=[1e3,2e3,5e3,1e4],Za=1e4,eo=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class to{constructor(e,s){var r;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=gs,this.transport=null,this.heartbeatIntervalMs=Ut.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=as,this.ref=0,this.reconnectTimer=null,this.vsn=Ys,this.logger=as,this.conn=null,this.sendBuffer=[],this.serializer=new Ga,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=n=>n?(...i)=>n(...i):(...i)=>fetch(...i),!(!((r=s==null?void 0:s.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=s.params.apikey,this.endPoint=`${e}/${bs.websocket}`,this.httpEndpoint=Zr(e),this._initializeOptions(s),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(s==null?void 0:s.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Ma.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const s=e.message;throw s.includes("Node.js")?new Error(`${s}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${s}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,s){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,s??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const s=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),s}async removeAllChannels(){const e=await Promise.all(this.channels.map(s=>s.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,s,r){this.logger(e,s,r)}connectionState(){switch(this.conn&&this.conn.readyState){case _e.connecting:return De.Connecting;case _e.open:return De.Open;case _e.closing:return De.Closing;default:return De.Closed}}isConnected(){return this.connectionState()===De.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,s={config:{}}){const r=`realtime:${e}`,n=this.getChannels().find(i=>i.topic===r);if(n)return n;{const i=new et(`realtime:${e}`,s,this);return this.channels.push(i),i}}push(e){const{topic:s,event:r,payload:n,ref:i}=e,a=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${s} ${r} (${i})`,n),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(s){this.log("error","error in heartbeat callback",s)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(s){this.log("error","error in heartbeat callback",s)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(za,"heartbeat timeout"),setTimeout(()=>{var s;this.isConnected()||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout()},Ut.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(s){this.log("error","error in heartbeat callback",s)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let s=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));s&&(this.log("transport",`leaving duplicate topic "${e}"`),s.unsubscribe())}_remove(e){this.channels=this.channels.filter(s=>s.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,s=>{if(s.topic==="phoenix"&&s.event==="phx_reply"&&s.ref&&s.ref===this.pendingHeartbeatRef){const u=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(s.payload.status==="ok"?"ok":"error",u)}catch(d){this.log("error","error in heartbeat callback",d)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:r,event:n,payload:i,ref:a}=s,l=a?`(${a})`:"",c=i.status||"";this.log("receive",`${c} ${r} ${n} ${l}`.trim(),i),this.channels.filter(u=>u._isMember(r)).forEach(u=>u._trigger(n,i,a)),this._triggerStateCallbacks("message",s)})}_clearTimer(e){var s;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((s=this.reconnectTimer)===null||s===void 0||s.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===_e.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===_e.open||this.conn.readyState===_e.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(s=>{this.log("error","error waiting for auth on connect",s),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=s=>{this.log("worker","worker error",s.message),this._terminateWorker()},this.workerRef.onmessage=s=>{s.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var s;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e);try{this.heartbeatCallback("error")}catch(s){this.log("error","error in heartbeat callback",s)}}_triggerChanError(){this.channels.forEach(e=>e._trigger(ce.error))}_appendParams(e,s){if(Object.keys(s).length===0)return e;const r=e.match(/\?/)?"&":"?",n=new URLSearchParams(s);return`${e}${r}${n}`}_workerObjectUrl(e){let s;if(e)s=e;else{const r=new Blob([eo],{type:"application/javascript"});s=URL.createObjectURL(r)}return s}_setConnectionState(e,s=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=s)}async _performAuth(e=null){let s,r=!1;if(e)s=e,r=!0;else if(this.accessToken)try{s=await this.accessToken()}catch(n){this.log("error","Error fetching access token from callback",n),s=this.accessTokenValue}else s=this.accessTokenValue;r?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=s&&(this.accessTokenValue=s,this.channels.forEach(n=>{const i={access_token:s,version:Ba};s&&n.updateJoinPayload(i),n.joinedOnce&&n._isJoined()&&n._push(ce.access_token,{access_token:s})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(s=>{this.log("error",`Error setting auth in ${e}`,s)})}_triggerStateCallbacks(e,s){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(s)}catch(n){this.log("error",`error in ${e} callback`,n)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new Yr(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Ut.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var s,r,n,i,a,l,c,u,d,h,f,p;switch(this.transport=(s=e==null?void 0:e.transport)!==null&&s!==void 0?s:null,this.timeout=(r=e==null?void 0:e.timeout)!==null&&r!==void 0?r:gs,this.heartbeatIntervalMs=(n=e==null?void 0:e.heartbeatIntervalMs)!==null&&n!==void 0?n:Ut.HEARTBEAT_INTERVAL,this.worker=(i=e==null?void 0:e.worker)!==null&&i!==void 0?i:!1,this.accessToken=(a=e==null?void 0:e.accessToken)!==null&&a!==void 0?a:null,this.heartbeatCallback=(l=e==null?void 0:e.heartbeatCallback)!==null&&l!==void 0?l:as,this.vsn=(c=e==null?void 0:e.vsn)!==null&&c!==void 0?c:Ys,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=e==null?void 0:e.reconnectAfterMs)!==null&&u!==void 0?u:m=>Xa[m-1]||Za,this.vsn){case Fa:this.encode=(d=e==null?void 0:e.encode)!==null&&d!==void 0?d:(m,g)=>g(JSON.stringify(m)),this.decode=(h=e==null?void 0:e.decode)!==null&&h!==void 0?h:(m,g)=>g(JSON.parse(m));break;case Qr:this.encode=(f=e==null?void 0:e.encode)!==null&&f!==void 0?f:this.serializer.encode.bind(this.serializer),this.decode=(p=e==null?void 0:e.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}var xt=class extends Error{constructor(t,e){var s;super(t),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&((s=e.icebergType)==null?void 0:s.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function so(t,e,s){const r=new URL(e,t);if(s)for(const[n,i]of Object.entries(s))i!==void 0&&r.searchParams.set(n,i);return r.toString()}async function ro(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function no(t){const e=t.fetchImpl??globalThis.fetch;return{async request({method:s,path:r,query:n,body:i,headers:a}){const l=so(t.baseUrl,r,n),c=await ro(t.auth),u=await e(l,{method:s,headers:{...i?{"Content-Type":"application/json"}:{},...c,...a},body:i?JSON.stringify(i):void 0}),d=await u.text(),h=(u.headers.get("content-type")||"").includes("application/json"),f=h&&d?JSON.parse(d):d;if(!u.ok){const p=h?f:void 0,m=p==null?void 0:p.error;throw new xt((m==null?void 0:m.message)??`Request failed with status ${u.status}`,{status:u.status,icebergType:m==null?void 0:m.type,icebergCode:m==null?void 0:m.code,details:p})}return{status:u.status,headers:u.headers,data:f}}}}function Mt(t){return t.join("")}var io=class{constructor(t,e=""){this.client=t,this.prefix=e}async listNamespaces(t){const e=t?{parent:Mt(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(r=>({namespace:r}))}async createNamespace(t,e){const s={namespace:t.namespace,properties:e==null?void 0:e.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:s})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Mt(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Mt(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Mt(t.namespace)}`}),!0}catch(e){if(e instanceof xt&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(t,e){try{return await this.createNamespace(t,e)}catch(s){if(s instanceof xt&&s.status===409)return;throw s}}};function Ge(t){return t.join("")}var ao=class{constructor(t,e="",s){this.client=t,this.prefix=e,this.accessDelegation=s}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ge(t.namespace)}/tables`})).data.identifiers}async createTable(t,e){const s={};return this.accessDelegation&&(s["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ge(t.namespace)}/tables`,body:e,headers:s})).data.metadata}async updateTable(t,e){const s=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ge(t.namespace)}/tables/${t.name}`,body:e});return{"metadata-location":s.data["metadata-location"],metadata:s.data.metadata}}async dropTable(t,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Ge(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String((e==null?void 0:e.purge)??!1)}})}async loadTable(t){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ge(t.namespace)}/tables/${t.name}`,headers:e})).data.metadata}async tableExists(t){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Ge(t.namespace)}/tables/${t.name}`,headers:e}),!0}catch(s){if(s instanceof xt&&s.status===404)return!1;throw s}}async createTableIfNotExists(t,e){try{return await this.createTable(t,e)}catch(s){if(s instanceof xt&&s.status===409)return await this.loadTable({namespace:t.namespace,name:e.name});throw s}}},oo=class{constructor(t){var r;let e="v1";t.catalogName&&(e+=`/${t.catalogName}`);const s=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=no({baseUrl:s,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=(r=t.accessDelegation)==null?void 0:r.join(","),this.namespaceOps=new io(this.client,e),this.tableOps=new ao(this.client,e,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,e){return this.namespaceOps.createNamespace(t,e)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,e){return this.tableOps.createTable(t,e)}async updateTable(t,e){return this.tableOps.updateTable(t,e)}async dropTable(t,e){await this.tableOps.dropTable(t,e)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,e){return this.namespaceOps.createNamespaceIfNotExists(t,e)}async createTableIfNotExists(t,e){return this.tableOps.createTableIfNotExists(t,e)}},Yt=class extends Error{constructor(t,e="storage",s,r){super(t),this.__isStorageError=!0,this.namespace=e,this.name=e==="vectors"?"StorageVectorsError":"StorageError",this.status=s,this.statusCode=r}};function Xt(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}var qt=class extends Yt{constructor(t,e,s,r="storage"){super(t,r,e,s),this.name=r==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=e,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},en=class extends Yt{constructor(t,e,s="storage"){super(t,s),this.name=s==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=e}};const lo=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),co=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},vs=t=>{if(Array.isArray(t))return t.map(s=>vs(s));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([s,r])=>{const n=s.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[n]=vs(r)}),e},uo=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t);function _t(t){"@babel/helpers - typeof";return _t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_t(t)}function ho(t,e){if(_t(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,e);if(_t(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fo(t){var e=ho(t,"string");return _t(e)=="symbol"?e:e+""}function po(t,e,s){return(e=fo(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function tr(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),s.push.apply(s,r)}return s}function E(t){for(var e=1;e<arguments.length;e++){var s=arguments[e]!=null?arguments[e]:{};e%2?tr(Object(s),!0).forEach(function(r){po(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):tr(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}const sr=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},mo=async(t,e,s,r)=>{if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!(s!=null&&s.noResolveJson)){const n=t,i=n.status||500;if(typeof n.json=="function")n.json().then(a=>{const l=(a==null?void 0:a.statusCode)||(a==null?void 0:a.code)||i+"";e(new qt(sr(a),i,l,r))}).catch(()=>{if(r==="vectors"){const a=i+"";e(new qt(n.statusText||`HTTP ${i} error`,i,a,r))}else{const a=i+"";e(new qt(n.statusText||`HTTP ${i} error`,i,a,r))}});else{const a=i+"";e(new qt(n.statusText||`HTTP ${i} error`,i,a,r))}}else e(new en(sr(t),t,r))},go=(t,e,s,r)=>{const n={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||t==="HEAD"||!r?E(E({},n),s):(co(r)?(n.headers=E({"Content-Type":"application/json"},e==null?void 0:e.headers),n.body=JSON.stringify(r)):n.body=r,e!=null&&e.duplex&&(n.duplex=e.duplex),E(E({},n),s))};async function bt(t,e,s,r,n,i,a){return new Promise((l,c)=>{t(s,go(e,r,n,i)).then(u=>{if(!u.ok)throw u;if(r!=null&&r.noResolveJson)return u;if(a==="vectors"){const d=u.headers.get("content-type");if(u.headers.get("content-length")==="0"||u.status===204)return{};if(!d||!d.includes("application/json"))return{}}return u.json()}).then(u=>l(u)).catch(u=>mo(u,c,r,a))})}function tn(t="storage"){return{get:async(e,s,r,n)=>bt(e,"GET",s,r,n,void 0,t),post:async(e,s,r,n,i)=>bt(e,"POST",s,n,i,r,t),put:async(e,s,r,n,i)=>bt(e,"PUT",s,n,i,r,t),head:async(e,s,r,n)=>bt(e,"HEAD",s,E(E({},r),{},{noResolveJson:!0}),n,void 0,t),remove:async(e,s,r,n,i)=>bt(e,"DELETE",s,n,i,r,t)}}const bo=tn("storage"),{get:St,post:ie,put:ws,head:yo,remove:Rs}=bo,te=tn("vectors");var ht=class{constructor(t,e={},s,r="storage"){this.shouldThrowOnError=!1,this.url=t,this.headers=e,this.fetch=lo(s),this.namespace=r}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(t){var e=this;try{return{data:await t(),error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(Xt(s))return{data:null,error:s};throw s}}},vo=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e}then(t,e){return this.execute().then(t,e)}async execute(){var t=this;try{return{data:(await t.downloadFn()).body,error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(Xt(e))return{data:null,error:e};throw e}}};let sn;sn=Symbol.toStringTag;var wo=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e,this[sn]="BlobDownloadBuilder",this.promise=null}asStream(){return new vo(this.downloadFn,this.shouldThrowOnError)}then(t,e){return this.getPromise().then(t,e)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var t=this;try{return{data:await(await t.downloadFn()).blob(),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(Xt(e))return{data:null,error:e};throw e}}};const xo={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},rr={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var _o=class extends ht{constructor(t,e={},s,r){super(t,e,r,"storage"),this.bucketId=s}async uploadOrUpdate(t,e,s,r){var n=this;return n.handleOperation(async()=>{let i;const a=E(E({},rr),r);let l=E(E({},n.headers),t==="POST"&&{"x-upsert":String(a.upsert)});const c=a.metadata;typeof Blob<"u"&&s instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),c&&i.append("metadata",n.encodeMetadata(c)),i.append("",s)):typeof FormData<"u"&&s instanceof FormData?(i=s,i.has("cacheControl")||i.append("cacheControl",a.cacheControl),c&&!i.has("metadata")&&i.append("metadata",n.encodeMetadata(c))):(i=s,l["cache-control"]=`max-age=${a.cacheControl}`,l["content-type"]=a.contentType,c&&(l["x-metadata"]=n.toBase64(n.encodeMetadata(c))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!a.duplex&&(a.duplex="half")),r!=null&&r.headers&&(l=E(E({},l),r.headers));const u=n._removeEmptyFolders(e),d=n._getFinalPath(u),h=await(t=="PUT"?ws:ie)(n.fetch,`${n.url}/object/${d}`,i,E({headers:l},a!=null&&a.duplex?{duplex:a.duplex}:{}));return{path:u,id:h.Id,fullPath:h.Key}})}async upload(t,e,s){return this.uploadOrUpdate("POST",t,e,s)}async uploadToSignedUrl(t,e,s,r){var n=this;const i=n._removeEmptyFolders(t),a=n._getFinalPath(i),l=new URL(n.url+`/object/upload/sign/${a}`);return l.searchParams.set("token",e),n.handleOperation(async()=>{let c;const u=E({upsert:rr.upsert},r),d=E(E({},n.headers),{"x-upsert":String(u.upsert)});return typeof Blob<"u"&&s instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",s)):typeof FormData<"u"&&s instanceof FormData?(c=s,c.append("cacheControl",u.cacheControl)):(c=s,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType),{path:i,fullPath:(await ws(n.fetch,l.toString(),c,{headers:d})).Key}})}async createSignedUploadUrl(t,e){var s=this;return s.handleOperation(async()=>{let r=s._getFinalPath(t);const n=E({},s.headers);e!=null&&e.upsert&&(n["x-upsert"]="true");const i=await ie(s.fetch,`${s.url}/object/upload/sign/${r}`,{},{headers:n}),a=new URL(s.url+i.url),l=a.searchParams.get("token");if(!l)throw new Yt("No token returned by API");return{signedUrl:a.toString(),path:t,token:l}})}async update(t,e,s){return this.uploadOrUpdate("PUT",t,e,s)}async move(t,e,s){var r=this;return r.handleOperation(async()=>await ie(r.fetch,`${r.url}/object/move`,{bucketId:r.bucketId,sourceKey:t,destinationKey:e,destinationBucket:s==null?void 0:s.destinationBucket},{headers:r.headers}))}async copy(t,e,s){var r=this;return r.handleOperation(async()=>({path:(await ie(r.fetch,`${r.url}/object/copy`,{bucketId:r.bucketId,sourceKey:t,destinationKey:e,destinationBucket:s==null?void 0:s.destinationBucket},{headers:r.headers})).Key}))}async createSignedUrl(t,e,s){var r=this;return r.handleOperation(async()=>{let n=r._getFinalPath(t),i=await ie(r.fetch,`${r.url}/object/sign/${n}`,E({expiresIn:e},s!=null&&s.transform?{transform:s.transform}:{}),{headers:r.headers});const a=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{signedUrl:encodeURI(`${r.url}${i.signedURL}${a}`)}})}async createSignedUrls(t,e,s){var r=this;return r.handleOperation(async()=>{const n=await ie(r.fetch,`${r.url}/object/sign/${r.bucketId}`,{expiresIn:e,paths:t},{headers:r.headers}),i=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return n.map(a=>E(E({},a),{},{signedUrl:a.signedURL?encodeURI(`${r.url}${a.signedURL}${i}`):null}))})}download(t,e){const s=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",r=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),n=r?`?${r}`:"",i=this._getFinalPath(t),a=()=>St(this.fetch,`${this.url}/${s}/${i}${n}`,{headers:this.headers,noResolveJson:!0});return new wo(a,this.shouldThrowOnError)}async info(t){var e=this;const s=e._getFinalPath(t);return e.handleOperation(async()=>vs(await St(e.fetch,`${e.url}/object/info/${s}`,{headers:e.headers})))}async exists(t){var e=this;const s=e._getFinalPath(t);try{return await yo(e.fetch,`${e.url}/object/${s}`,{headers:e.headers}),{data:!0,error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Xt(r)&&r instanceof en){const n=r.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:r}}throw r}}getPublicUrl(t,e){const s=this._getFinalPath(t),r=[],n=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";n!==""&&r.push(n);const i=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",a=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});a!==""&&r.push(a);let l=r.join("&");return l!==""&&(l=`?${l}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${s}${l}`)}}}async remove(t){var e=this;return e.handleOperation(async()=>await Rs(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:t},{headers:e.headers}))}async list(t,e,s){var r=this;return r.handleOperation(async()=>{const n=E(E(E({},xo),e),{},{prefix:t||""});return await ie(r.fetch,`${r.url}/object/list/${r.bucketId}`,n,{headers:r.headers},s)})}async listV2(t,e){var s=this;return s.handleOperation(async()=>{const r=E({},t);return await ie(s.fetch,`${s.url}/object/list-v2/${s.bucketId}`,r,{headers:s.headers},e)})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}};const So="2.93.3",Pt={"X-Client-Info":`storage-js/${So}`};var ko=class extends ht{constructor(t,e={},s,r){const n=new URL(t);r!=null&&r.useNewHostname&&/supabase\.(co|in|red)$/.test(n.hostname)&&!n.hostname.includes("storage.supabase.")&&(n.hostname=n.hostname.replace("supabase.","storage.supabase."));const i=n.href.replace(/\/$/,""),a=E(E({},Pt),e);super(i,a,s,"storage")}async listBuckets(t){var e=this;return e.handleOperation(async()=>{const s=e.listBucketOptionsToQueryString(t);return await St(e.fetch,`${e.url}/bucket${s}`,{headers:e.headers})})}async getBucket(t){var e=this;return e.handleOperation(async()=>await St(e.fetch,`${e.url}/bucket/${t}`,{headers:e.headers}))}async createBucket(t,e={public:!1}){var s=this;return s.handleOperation(async()=>await ie(s.fetch,`${s.url}/bucket`,{id:t,name:t,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:s.headers}))}async updateBucket(t,e){var s=this;return s.handleOperation(async()=>await ws(s.fetch,`${s.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:s.headers}))}async emptyBucket(t){var e=this;return e.handleOperation(async()=>await ie(e.fetch,`${e.url}/bucket/${t}/empty`,{},{headers:e.headers}))}async deleteBucket(t){var e=this;return e.handleOperation(async()=>await Rs(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}))}listBucketOptionsToQueryString(t){const e={};return t&&("limit"in t&&(e.limit=String(t.limit)),"offset"in t&&(e.offset=String(t.offset)),t.search&&(e.search=t.search),t.sortColumn&&(e.sortColumn=t.sortColumn),t.sortOrder&&(e.sortOrder=t.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},jo=class extends ht{constructor(t,e={},s){const r=t.replace(/\/$/,""),n=E(E({},Pt),e);super(r,n,s,"storage")}async createBucket(t){var e=this;return e.handleOperation(async()=>await ie(e.fetch,`${e.url}/bucket`,{name:t},{headers:e.headers}))}async listBuckets(t){var e=this;return e.handleOperation(async()=>{const s=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&s.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&s.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&s.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&s.set("sortOrder",t.sortOrder),t!=null&&t.search&&s.set("search",t.search);const r=s.toString(),n=r?`${e.url}/bucket?${r}`:`${e.url}/bucket`;return await St(e.fetch,n,{headers:e.headers})})}async deleteBucket(t){var e=this;return e.handleOperation(async()=>await Rs(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}))}from(t){var e=this;if(!uo(t))throw new Yt("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const s=new oo({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),r=this.shouldThrowOnError;return new Proxy(s,{get(n,i){const a=n[i];return typeof a!="function"?a:async(...l)=>{try{return{data:await a.apply(n,l),error:null}}catch(c){if(r)throw c;return{data:null,error:c}}}}})}},Eo=class extends ht{constructor(t,e={},s){const r=t.replace(/\/$/,""),n=E(E({},Pt),{},{"Content-Type":"application/json"},e);super(r,n,s,"vectors")}async createIndex(t){var e=this;return e.handleOperation(async()=>await te.post(e.fetch,`${e.url}/CreateIndex`,t,{headers:e.headers})||{})}async getIndex(t,e){var s=this;return s.handleOperation(async()=>await te.post(s.fetch,`${s.url}/GetIndex`,{vectorBucketName:t,indexName:e},{headers:s.headers}))}async listIndexes(t){var e=this;return e.handleOperation(async()=>await te.post(e.fetch,`${e.url}/ListIndexes`,t,{headers:e.headers}))}async deleteIndex(t,e){var s=this;return s.handleOperation(async()=>await te.post(s.fetch,`${s.url}/DeleteIndex`,{vectorBucketName:t,indexName:e},{headers:s.headers})||{})}},Ao=class extends ht{constructor(t,e={},s){const r=t.replace(/\/$/,""),n=E(E({},Pt),{},{"Content-Type":"application/json"},e);super(r,n,s,"vectors")}async putVectors(t){var e=this;if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return e.handleOperation(async()=>await te.post(e.fetch,`${e.url}/PutVectors`,t,{headers:e.headers})||{})}async getVectors(t){var e=this;return e.handleOperation(async()=>await te.post(e.fetch,`${e.url}/GetVectors`,t,{headers:e.headers}))}async listVectors(t){var e=this;if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return e.handleOperation(async()=>await te.post(e.fetch,`${e.url}/ListVectors`,t,{headers:e.headers}))}async queryVectors(t){var e=this;return e.handleOperation(async()=>await te.post(e.fetch,`${e.url}/QueryVectors`,t,{headers:e.headers}))}async deleteVectors(t){var e=this;if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return e.handleOperation(async()=>await te.post(e.fetch,`${e.url}/DeleteVectors`,t,{headers:e.headers})||{})}},To=class extends ht{constructor(t,e={},s){const r=t.replace(/\/$/,""),n=E(E({},Pt),{},{"Content-Type":"application/json"},e);super(r,n,s,"vectors")}async createBucket(t){var e=this;return e.handleOperation(async()=>await te.post(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{})}async getBucket(t){var e=this;return e.handleOperation(async()=>await te.post(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:t},{headers:e.headers}))}async listBuckets(t={}){var e=this;return e.handleOperation(async()=>await te.post(e.fetch,`${e.url}/ListVectorBuckets`,t,{headers:e.headers}))}async deleteBucket(t){var e=this;return e.handleOperation(async()=>await te.post(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{})}},Co=class extends To{constructor(t,e={}){super(t,e.headers||{},e.fetch)}from(t){return new No(this.url,this.headers,t,this.fetch)}async createBucket(t){var e=()=>super.createBucket,s=this;return e().call(s,t)}async getBucket(t){var e=()=>super.getBucket,s=this;return e().call(s,t)}async listBuckets(t={}){var e=()=>super.listBuckets,s=this;return e().call(s,t)}async deleteBucket(t){var e=()=>super.deleteBucket,s=this;return e().call(s,t)}},No=class extends Eo{constructor(t,e,s,r){super(t,e,r),this.vectorBucketName=s}async createIndex(t){var e=()=>super.createIndex,s=this;return e().call(s,E(E({},t),{},{vectorBucketName:s.vectorBucketName}))}async listIndexes(t={}){var e=()=>super.listIndexes,s=this;return e().call(s,E(E({},t),{},{vectorBucketName:s.vectorBucketName}))}async getIndex(t){var e=()=>super.getIndex,s=this;return e().call(s,s.vectorBucketName,t)}async deleteIndex(t){var e=()=>super.deleteIndex,s=this;return e().call(s,s.vectorBucketName,t)}index(t){return new Oo(this.url,this.headers,this.vectorBucketName,t,this.fetch)}},Oo=class extends Ao{constructor(t,e,s,r,n){super(t,e,n),this.vectorBucketName=s,this.indexName=r}async putVectors(t){var e=()=>super.putVectors,s=this;return e().call(s,E(E({},t),{},{vectorBucketName:s.vectorBucketName,indexName:s.indexName}))}async getVectors(t){var e=()=>super.getVectors,s=this;return e().call(s,E(E({},t),{},{vectorBucketName:s.vectorBucketName,indexName:s.indexName}))}async listVectors(t={}){var e=()=>super.listVectors,s=this;return e().call(s,E(E({},t),{},{vectorBucketName:s.vectorBucketName,indexName:s.indexName}))}async queryVectors(t){var e=()=>super.queryVectors,s=this;return e().call(s,E(E({},t),{},{vectorBucketName:s.vectorBucketName,indexName:s.indexName}))}async deleteVectors(t){var e=()=>super.deleteVectors,s=this;return e().call(s,E(E({},t),{},{vectorBucketName:s.vectorBucketName,indexName:s.indexName}))}},Ro=class extends ko{constructor(t,e={},s,r){super(t,e,s,r)}from(t){return new _o(this.url,this.headers,t,this.fetch)}get vectors(){return new Co(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new jo(this.url+"/iceberg",this.headers,this.fetch)}};const rn="2.93.3",Xe=30*1e3,xs=3,os=xs*Xe,Io="http://localhost:9999",Po="supabase.auth.token",$o={"X-Client-Info":`gotrue-js/${rn}`},_s="X-Supabase-Api-Version",nn={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Do=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Lo=10*60*1e3;class kt extends Error{constructor(e,s,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=s,this.code=r}}function k(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class Uo extends kt{constructor(e,s,r){super(e,s,r),this.name="AuthApiError",this.status=s,this.code=r}}function Mo(t){return k(t)&&t.name==="AuthApiError"}class Le extends kt{constructor(e,s){super(e),this.name="AuthUnknownError",this.originalError=s}}class ye extends kt{constructor(e,s,r,n){super(e,r,n),this.name=s,this.status=r}}class ee extends ye{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function ls(t){return k(t)&&t.name==="AuthSessionMissingError"}class We extends ye{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Bt extends ye{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ft extends ye{constructor(e,s=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function qo(t){return k(t)&&t.name==="AuthImplicitGrantRedirectError"}class nr extends ye{constructor(e,s=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Bo extends ye{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Ss extends ye{constructor(e,s){super(e,"AuthRetryableFetchError",s,void 0)}}function cs(t){return k(t)&&t.name==="AuthRetryableFetchError"}class ir extends ye{constructor(e,s,r){super(e,"AuthWeakPasswordError",s,"weak_password"),this.reasons=r}}class ks extends ye{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Wt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ar=` 	
\r=`.split(""),Fo=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<ar.length;e+=1)t[ar[e].charCodeAt(0)]=-2;for(let e=0;e<Wt.length;e+=1)t[Wt[e].charCodeAt(0)]=e;return t})();function or(t,e,s){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;s(Wt[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;s(Wt[r]),e.queuedBits-=6}}function an(t,e,s){const r=Fo[t];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)s(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function lr(t){const e=[],s=a=>{e.push(String.fromCodePoint(a))},r={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},i=a=>{Go(a,r,s)};for(let a=0;a<t.length;a+=1)an(t.charCodeAt(a),n,i);return e.join("")}function zo(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function Vo(t,e){for(let s=0;s<t.length;s+=1){let r=t.charCodeAt(s);if(r>55295&&r<=56319){const n=(r-55296)*1024&65535;r=(t.charCodeAt(s+1)-56320&65535|n)+65536,s+=1}zo(r,e)}}function Go(t,e,s){if(e.utf8seq===0){if(t<=127){s(t);return}for(let r=1;r<6;r+=1)if(!(t>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&s(e.codepoint)}}function st(t){const e=[],s={queue:0,queuedBits:0},r=n=>{e.push(n)};for(let n=0;n<t.length;n+=1)an(t.charCodeAt(n),s,r);return new Uint8Array(e)}function Wo(t){const e=[];return Vo(t,s=>e.push(s)),new Uint8Array(e)}function Ue(t){const e=[],s={queue:0,queuedBits:0},r=n=>{e.push(n)};return t.forEach(n=>or(n,s,r)),or(null,s,r),e.join("")}function Ko(t){return Math.round(Date.now()/1e3)+t}function Ho(){return Symbol("auth-callback")}const K=()=>typeof window<"u"&&typeof document<"u",Re={tested:!1,writable:!1},on=()=>{if(!K())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Re.tested)return Re.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Re.tested=!0,Re.writable=!0}catch{Re.tested=!0,Re.writable=!1}return Re.writable};function Jo(t){const e={},s=new URL(t);if(s.hash&&s.hash[0]==="#")try{new URLSearchParams(s.hash.substring(1)).forEach((n,i)=>{e[i]=n})}catch{}return s.searchParams.forEach((r,n)=>{e[n]=r}),e}const ln=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Qo=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Ze=async(t,e,s)=>{await t.setItem(e,JSON.stringify(s))},Ie=async(t,e)=>{const s=await t.getItem(e);if(!s)return null;try{return JSON.parse(s)}catch{return s}},W=async(t,e)=>{await t.removeItem(e)};class Zt{constructor(){this.promise=new Zt.promiseConstructor((e,s)=>{this.resolve=e,this.reject=s})}}Zt.promiseConstructor=Promise;function zt(t){const e=t.split(".");if(e.length!==3)throw new ks("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!Do.test(e[r]))throw new ks("JWT not in base64url format");return{header:JSON.parse(lr(e[0])),payload:JSON.parse(lr(e[1])),signature:st(e[2]),raw:{header:e[0],payload:e[1]}}}async function Yo(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function Xo(t,e){return new Promise((r,n)=>{(async()=>{for(let i=0;i<1/0;i++)try{const a=await t(i);if(!e(i,null,a)){r(a);return}}catch(a){if(!e(i,a)){n(a);return}}})()})}function Zo(t){return("0"+t.toString(16)).substr(-2)}function el(){const e=new Uint32Array(56);if(typeof crypto>"u"){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=s.length;let n="";for(let i=0;i<56;i++)n+=s.charAt(Math.floor(Math.random()*r));return n}return crypto.getRandomValues(e),Array.from(e,Zo).join("")}async function tl(t){const s=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",s),n=new Uint8Array(r);return Array.from(n).map(i=>String.fromCharCode(i)).join("")}async function sl(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const s=await tl(t);return btoa(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ke(t,e,s=!1){const r=el();let n=r;s&&(n+="/PASSWORD_RECOVERY"),await Ze(t,`${e}-code-verifier`,n);const i=await sl(r);return[i,r===i?"plain":"s256"]}const rl=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function nl(t){const e=t.headers.get(_s);if(!e||!e.match(rl))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function il(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function al(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const ol=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function He(t){if(!ol.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function us(){const t={};return new Proxy(t,{get:(e,s)=>{if(s==="__isUserNotAvailableProxy")return!0;if(typeof s=="symbol"){const r=s.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${s}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function ll(t,e){return new Proxy(t,{get:(s,r,n)=>{if(r==="__isInsecureUserWarningProxy")return!0;if(typeof r=="symbol"){const i=r.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(s,r,n)}return!e.value&&typeof r=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(s,r,n)}})}function cr(t){return JSON.parse(JSON.stringify(t))}const $e=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),cl=[502,503,504];async function ur(t){var e;if(!Qo(t))throw new Ss($e(t),0);if(cl.includes(t.status))throw new Ss($e(t),t.status);let s;try{s=await t.json()}catch(i){throw new Le($e(i),i)}let r;const n=nl(t);if(n&&n.getTime()>=nn["2024-01-01"].timestamp&&typeof s=="object"&&s&&typeof s.code=="string"?r=s.code:typeof s=="object"&&s&&typeof s.error_code=="string"&&(r=s.error_code),r){if(r==="weak_password")throw new ir($e(s),t.status,((e=s.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new ee}else if(typeof s=="object"&&s&&typeof s.weak_password=="object"&&s.weak_password&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.reasons.reduce((i,a)=>i&&typeof a=="string",!0))throw new ir($e(s),t.status,s.weak_password.reasons);throw new Uo($e(s),t.status||500,r)}const ul=(t,e,s,r)=>{const n={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),n.body=JSON.stringify(r),Object.assign(Object.assign({},n),s))};async function j(t,e,s,r){var n;const i=Object.assign({},r==null?void 0:r.headers);i[_s]||(i[_s]=nn["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const a=(n=r==null?void 0:r.query)!==null&&n!==void 0?n:{};r!=null&&r.redirectTo&&(a.redirect_to=r.redirectTo);const l=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",c=await dl(t,e,s+l,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(c):{data:Object.assign({},c),error:null}}async function dl(t,e,s,r,n,i){const a=ul(e,r,n,i);let l;try{l=await t(s,Object.assign({},a))}catch(c){throw console.error(c),new Ss($e(c),0)}if(l.ok||await ur(l),r!=null&&r.noResolveJson)return l;try{return await l.json()}catch(c){await ur(c)}}function ne(t){var e;let s=null;pl(t)&&(s=Object.assign({},t),t.expires_at||(s.expires_at=Ko(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:s,user:r},error:null}}function dr(t){const e=ne(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((s,r)=>s&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Se(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function hl(t){return{data:t,error:null}}function fl(t){const{action_link:e,email_otp:s,hashed_token:r,redirect_to:n,verification_type:i}=t,a=Qt(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:s,hashed_token:r,redirect_to:n,verification_type:i},c=Object.assign({},a);return{data:{properties:l,user:c},error:null}}function hr(t){return t}function pl(t){return t.access_token&&t.refresh_token&&t.expires_in}const ds=["global","local","others"];class ml{constructor({url:e="",headers:s={},fetch:r}){this.url=e,this.headers=s,this.fetch=ln(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,s=ds[0]){if(ds.indexOf(s)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${ds.join(", ")}`);try{return await j(this.fetch,"POST",`${this.url}/logout?scope=${s}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(k(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,s={}){try{return await j(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:s.data},headers:this.headers,redirectTo:s.redirectTo,xform:Se})}catch(r){if(k(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:s}=e,r=Qt(e,["options"]),n=Object.assign(Object.assign({},r),s);return"newEmail"in r&&(n.new_email=r==null?void 0:r.newEmail,delete n.newEmail),await j(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:fl,redirectTo:s==null?void 0:s.redirectTo})}catch(s){if(k(s))return{data:{properties:null,user:null},error:s};throw s}}async createUser(e){try{return await j(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Se})}catch(s){if(k(s))return{data:{user:null},error:s};throw s}}async listUsers(e){var s,r,n,i,a,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await j(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(s=e==null?void 0:e.page)===null||s===void 0?void 0:s.toString())!==null&&r!==void 0?r:"",per_page:(i=(n=e==null?void 0:e.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:hr});if(d.error)throw d.error;const h=await d.json(),f=(a=d.headers.get("x-total-count"))!==null&&a!==void 0?a:0,p=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(m=>{const g=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(m.split(";")[1].split("=")[1]);u[`${y}Page`]=g}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(k(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){He(e);try{return await j(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Se})}catch(s){if(k(s))return{data:{user:null},error:s};throw s}}async updateUserById(e,s){He(e);try{return await j(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:s,headers:this.headers,xform:Se})}catch(r){if(k(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,s=!1){He(e);try{return await j(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:s},xform:Se})}catch(r){if(k(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){He(e.userId);try{const{data:s,error:r}=await j(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:s,error:r}}catch(s){if(k(s))return{data:null,error:s};throw s}}async _deleteFactor(e){He(e.userId),He(e.id);try{return{data:await j(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(s){if(k(s))return{data:null,error:s};throw s}}async _listOAuthClients(e){var s,r,n,i,a,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await j(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(s=e==null?void 0:e.page)===null||s===void 0?void 0:s.toString())!==null&&r!==void 0?r:"",per_page:(i=(n=e==null?void 0:e.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:hr});if(d.error)throw d.error;const h=await d.json(),f=(a=d.headers.get("x-total-count"))!==null&&a!==void 0?a:0,p=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(m=>{const g=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(m.split(";")[1].split("=")[1]);u[`${y}Page`]=g}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(k(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(e){try{return await j(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(k(s))return{data:null,error:s};throw s}}async _getOAuthClient(e){try{return await j(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(k(s))return{data:null,error:s};throw s}}async _updateOAuthClient(e,s){try{return await j(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:s,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(k(r))return{data:null,error:r};throw r}}async _deleteOAuthClient(e){try{return await j(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(s){if(k(s))return{data:null,error:s};throw s}}async _regenerateOAuthClientSecret(e){try{return await j(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(k(s))return{data:null,error:s};throw s}}}function fr(t={}){return{getItem:e=>t[e]||null,setItem:(e,s)=>{t[e]=s},removeItem:e=>{delete t[e]}}}const Je={debug:!!(globalThis&&on()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class cn extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class gl extends cn{}async function bl(t,e,s){Je.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Je.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async n=>{if(n){Je.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,n.name);try{return await s()}finally{Je.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,n.name)}}else{if(e===0)throw Je.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new gl(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Je.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await s()}}))}function yl(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function un(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function vl(t){return parseInt(t,16)}function wl(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,r=>r.toString(16).padStart(2,"0")).join("")}function xl(t){var e;const{chainId:s,domain:r,expirationTime:n,issuedAt:i=new Date,nonce:a,notBefore:l,requestId:c,resources:u,scheme:d,uri:h,version:f}=t;{if(!Number.isInteger(s))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${s}`);if(!r)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(a&&a.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${a}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(f!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${f}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const p=un(t.address),m=d?`${d}://${r}`:r,g=t.statement?`${t.statement}
`:"",y=`${m} wants you to sign in with your Ethereum account:
${p}

${g}`;let w=`URI: ${h}
Version: ${f}
Chain ID: ${s}${a?`
Nonce: ${a}`:""}
Issued At: ${i.toISOString()}`;if(n&&(w+=`
Expiration Time: ${n.toISOString()}`),l&&(w+=`
Not Before: ${l.toISOString()}`),c&&(w+=`
Request ID: ${c}`),u){let S=`
Resources:`;for(const x of u){if(!x||typeof x!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${x}`);S+=`
- ${x}`}w+=S}return`${y}
${w}`}class q extends Error{constructor({message:e,code:s,cause:r,name:n}){var i;super(e,{cause:r}),this.__isWebAuthnError=!0,this.name=(i=n??(r instanceof Error?r.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=s}}class Kt extends q{constructor(e,s){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s,message:e}),this.name="WebAuthnUnknownError",this.originalError=s}}function _l({error:t,options:e}){var s,r,n;const{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new q({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((s=i.authenticatorSelection)===null||s===void 0?void 0:s.requireResidentKey)===!0)return new q({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((r=i.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new q({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((n=i.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new q({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new q({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new q({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return i.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new q({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new q({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const a=window.location.hostname;if(dn(a)){if(i.rp.id!==a)return new q({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new q({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new q({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new q({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new q({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function Sl({error:t,options:e}){const{publicKey:s}=e;if(!s)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new q({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new q({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const r=window.location.hostname;if(dn(r)){if(s.rpId!==r)return new q({message:`The RP ID "${s.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new q({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new q({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new q({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class kl{createNewAbortSignal(){if(this.controller){const s=new Error("Cancelling existing WebAuthn API call for new one");s.name="AbortError",this.controller.abort(s)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const jl=new kl;function El(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:s,excludeCredentials:r}=t,n=Qt(t,["challenge","user","excludeCredentials"]),i=st(e).buffer,a=Object.assign(Object.assign({},s),{id:st(s.id).buffer}),l=Object.assign(Object.assign({},n),{challenge:i,user:a});if(r&&r.length>0){l.excludeCredentials=new Array(r.length);for(let c=0;c<r.length;c++){const u=r[c];l.excludeCredentials[c]=Object.assign(Object.assign({},u),{id:st(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return l}function Al(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:s}=t,r=Qt(t,["challenge","allowCredentials"]),n=st(e).buffer,i=Object.assign(Object.assign({},r),{challenge:n});if(s&&s.length>0){i.allowCredentials=new Array(s.length);for(let a=0;a<s.length;a++){const l=s[a];i.allowCredentials[a]=Object.assign(Object.assign({},l),{id:st(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return i}function Tl(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const s=t;return{id:t.id,rawId:t.id,response:{attestationObject:Ue(new Uint8Array(t.response.attestationObject)),clientDataJSON:Ue(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=s.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function Cl(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const s=t,r=t.getClientExtensionResults(),n=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:Ue(new Uint8Array(n.authenticatorData)),clientDataJSON:Ue(new Uint8Array(n.clientDataJSON)),signature:Ue(new Uint8Array(n.signature)),userHandle:n.userHandle?Ue(new Uint8Array(n.userHandle)):void 0},type:"public-key",clientExtensionResults:r,authenticatorAttachment:(e=s.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function dn(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function pr(){var t,e;return!!(K()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function Nl(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Kt("Browser returned unexpected credential type",e)}:{data:null,error:new Kt("Empty credential response",e)}}catch(e){return{data:null,error:_l({error:e,options:t})}}}async function Ol(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Kt("Browser returned unexpected credential type",e)}:{data:null,error:new Kt("Empty credential response",e)}}catch(e){return{data:null,error:Sl({error:e,options:t})}}}const Rl={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},Il={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Ht(...t){const e=n=>n!==null&&typeof n=="object"&&!Array.isArray(n),s=n=>n instanceof ArrayBuffer||ArrayBuffer.isView(n),r={};for(const n of t)if(n)for(const i in n){const a=n[i];if(a!==void 0)if(Array.isArray(a))r[i]=a;else if(s(a))r[i]=a;else if(e(a)){const l=r[i];e(l)?r[i]=Ht(l,a):r[i]=Ht(a)}else r[i]=a}return r}function Pl(t,e){return Ht(Rl,t,e||{})}function $l(t,e){return Ht(Il,t,e||{})}class Dl{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:s,friendlyName:r,signal:n},i){var a;try{const{data:l,error:c}=await this.client.mfa.challenge({factorId:e,webauthn:s});if(!l)return{data:null,error:c};const u=n??jl.createNewAbortSignal();if(l.webauthn.type==="create"){const{user:d}=l.webauthn.credential_options.publicKey;if(!d.name){const h=r;if(h)d.name=`${d.id}:${h}`;else{const p=(await this.client.getUser()).data.user,m=((a=p==null?void 0:p.user_metadata)===null||a===void 0?void 0:a.name)||(p==null?void 0:p.email)||(p==null?void 0:p.id)||"User";d.name=`${d.id}:${m}`}}d.displayName||(d.displayName=d.name)}switch(l.webauthn.type){case"create":{const d=Pl(l.webauthn.credential_options.publicKey,i==null?void 0:i.create),{data:h,error:f}=await Nl({publicKey:d,signal:u});return h?{data:{factorId:e,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:h}},error:null}:{data:null,error:f}}case"request":{const d=$l(l.webauthn.credential_options.publicKey,i==null?void 0:i.request),{data:h,error:f}=await Ol(Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:d,signal:u}));return h?{data:{factorId:e,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:h}},error:null}:{data:null,error:f}}}}catch(l){return k(l)?{data:null,error:l}:{data:null,error:new Le("Unexpected error in challenge",l)}}}async _verify({challengeId:e,factorId:s,webauthn:r}){return this.client.mfa.verify({factorId:s,challengeId:e,webauthn:r})}async _authenticate({factorId:e,webauthn:{rpId:s=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},i){if(!s)return{data:null,error:new kt("rpId is required for WebAuthn authentication")};try{if(!pr())return{data:null,error:new Le("Browser does not support WebAuthn",null)};const{data:a,error:l}=await this.challenge({factorId:e,webauthn:{rpId:s,rpOrigins:r},signal:n},{request:i});if(!a)return{data:null,error:l};const{webauthn:c}=a;return this._verify({factorId:e,challengeId:a.challengeId,webauthn:{type:c.type,rpId:s,rpOrigins:r,credential_response:c.credential_response}})}catch(a){return k(a)?{data:null,error:a}:{data:null,error:new Le("Unexpected error in authenticate",a)}}}async _register({friendlyName:e,webauthn:{rpId:s=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},i){if(!s)return{data:null,error:new kt("rpId is required for WebAuthn registration")};try{if(!pr())return{data:null,error:new Le("Browser does not support WebAuthn",null)};const{data:a,error:l}=await this._enroll({friendlyName:e});if(!a)return await this.client.mfa.listFactors().then(d=>{var h;return(h=d.data)===null||h===void 0?void 0:h.all.find(f=>f.factor_type==="webauthn"&&f.friendly_name===e&&f.status!=="unverified")}).then(d=>d?this.client.mfa.unenroll({factorId:d==null?void 0:d.id}):void 0),{data:null,error:l};const{data:c,error:u}=await this._challenge({factorId:a.id,friendlyName:a.friendly_name,webauthn:{rpId:s,rpOrigins:r},signal:n},{create:i});return c?this._verify({factorId:a.id,challengeId:c.challengeId,webauthn:{rpId:s,rpOrigins:r,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:u}}catch(a){return k(a)?{data:null,error:a}:{data:null,error:new Le("Unexpected error in register",a)}}}}yl();const Ll={url:Io,storageKey:Po,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:$o,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function mr(t,e,s){return await s()}const Qe={};class jt{get jwks(){var e,s;return(s=(e=Qe[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&s!==void 0?s:{keys:[]}}set jwks(e){Qe[this.storageKey]=Object.assign(Object.assign({},Qe[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,s;return(s=(e=Qe[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&s!==void 0?s:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Qe[this.storageKey]=Object.assign(Object.assign({},Qe[this.storageKey]),{cachedAt:e})}constructor(e){var s,r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},Ll),e);if(this.storageKey=i.storageKey,this.instanceID=(s=jt.nextInstanceID[this.storageKey])!==null&&s!==void 0?s:0,jt.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&K()){const a=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(a),this.logDebugMessages&&console.trace(a)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new ml({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=ln(i.fetch),this.lock=i.lock||mr,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,this.lockAcquireTimeout=i.lockAcquireTimeout,i.lock?this.lock=i.lock:this.persistSession&&K()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=bl:this.lock=mr,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new Dl(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:on()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=fr(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=fr(this.memoryStorage)),K()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a);try{await this._notifyAllSubscribers(a.data.event,a.data.session,!1)}catch(l){this._debug("#broadcastChannel","error",l)}})}this.initialize().catch(a=>{this._debug("#initialize()","error",a)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${rn}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let s={},r="none";if(K()&&(s=Jo(window.location.href),this._isImplicitGrantCallback(s)?r="implicit":await this._isPKCECallback(s)&&(r="pkce")),K()&&this.detectSessionInUrl&&r!=="none"){const{data:n,error:i}=await this._getSessionFromURL(s,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),qo(i)){const c=(e=i.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return{error:i}}const{session:a,redirectType:l}=n;return this._debug("#_initialize()","detected session in URL",a,"redirect type",l),await this._saveSession(a),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(s){return k(s)?this._returnResult({error:s}):this._returnResult({error:new Le("Unexpected error during initialization",s)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var s,r,n;try{const i=await j(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.captchaToken}},xform:ne}),{data:a,error:l}=i;if(l||!a)return this._returnResult({data:{user:null,session:null},error:l});const c=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(i){if(k(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(e){var s,r,n;try{let i;if("email"in e){const{email:d,password:h,options:f}=e;let p=null,m=null;this.flowType==="pkce"&&([p,m]=await Ke(this.storage,this.storageKey)),i=await j(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:d,password:h,data:(s=f==null?void 0:f.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:p,code_challenge_method:m},xform:ne})}else if("phone"in e){const{phone:d,password:h,options:f}=e;i=await j(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},channel:(n=f==null?void 0:f.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:ne})}else throw new Bt("You must provide either an email or phone number and a password");const{data:a,error:l}=i;if(l||!a)return await W(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:l});const c=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(i){if(await W(this.storage,`${this.storageKey}-code-verifier`),k(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(e){try{let s;if("email"in e){const{email:i,password:a,options:l}=e;s=await j(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:dr})}else if("phone"in e){const{phone:i,password:a,options:l}=e;s=await j(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:dr})}else throw new Bt("You must provide either an email or phone number and a password");const{data:r,error:n}=s;if(n)return this._returnResult({data:{user:null,session:null},error:n});if(!r||!r.session||!r.user){const i=new We;return this._returnResult({data:{user:null,session:null},error:i})}return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),this._returnResult({data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:n})}catch(s){if(k(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithOAuth(e){var s,r,n,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(s=e.options)===null||s===void 0?void 0:s.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:s}=e;switch(s){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${s}"`)}}async signInWithEthereum(e){var s,r,n,i,a,l,c,u,d,h,f;let p,m;if("message"in e)p=e.message,m=e.signature;else{const{chain:g,wallet:y,statement:w,options:S}=e;let x;if(K())if(typeof y=="object")x=y;else{const B=window;if("ethereum"in B&&typeof B.ethereum=="object"&&"request"in B.ethereum&&typeof B.ethereum.request=="function")x=B.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(S!=null&&S.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");x=y}const _=new URL((s=S==null?void 0:S.url)!==null&&s!==void 0?s:window.location.href),O=await x.request({method:"eth_requestAccounts"}).then(B=>B).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!O||O.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const C=un(O[0]);let I=(r=S==null?void 0:S.signInWithEthereum)===null||r===void 0?void 0:r.chainId;if(!I){const B=await x.request({method:"eth_chainId"});I=vl(B)}const J={domain:_.host,address:C,statement:w,uri:_.href,version:"1",chainId:I,nonce:(n=S==null?void 0:S.signInWithEthereum)===null||n===void 0?void 0:n.nonce,issuedAt:(a=(i=S==null?void 0:S.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&a!==void 0?a:new Date,expirationTime:(l=S==null?void 0:S.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=S==null?void 0:S.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(u=S==null?void 0:S.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(d=S==null?void 0:S.signInWithEthereum)===null||d===void 0?void 0:d.resources};p=xl(J),m=await x.request({method:"personal_sign",params:[wl(p),C]})}try{const{data:g,error:y}=await j(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:p,signature:m},!((h=e.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:ne});if(y)throw y;if(!g||!g.session||!g.user){const w=new We;return this._returnResult({data:{user:null,session:null},error:w})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:Object.assign({},g),error:y})}catch(g){if(k(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async signInWithSolana(e){var s,r,n,i,a,l,c,u,d,h,f,p;let m,g;if("message"in e)m=e.message,g=e.signature;else{const{chain:y,wallet:w,statement:S,options:x}=e;let _;if(K())if(typeof w=="object")_=w;else{const C=window;if("solana"in C&&typeof C.solana=="object"&&("signIn"in C.solana&&typeof C.solana.signIn=="function"||"signMessage"in C.solana&&typeof C.solana.signMessage=="function"))_=C.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!(x!=null&&x.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");_=w}const O=new URL((s=x==null?void 0:x.url)!==null&&s!==void 0?s:window.location.href);if("signIn"in _&&_.signIn){const C=await _.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},x==null?void 0:x.signInWithSolana),{version:"1",domain:O.host,uri:O.href}),S?{statement:S}:null));let I;if(Array.isArray(C)&&C[0]&&typeof C[0]=="object")I=C[0];else if(C&&typeof C=="object"&&"signedMessage"in C&&"signature"in C)I=C;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in I&&"signature"in I&&(typeof I.signedMessage=="string"||I.signedMessage instanceof Uint8Array)&&I.signature instanceof Uint8Array)m=typeof I.signedMessage=="string"?I.signedMessage:new TextDecoder().decode(I.signedMessage),g=I.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in _)||typeof _.signMessage!="function"||!("publicKey"in _)||typeof _!="object"||!_.publicKey||!("toBase58"in _.publicKey)||typeof _.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");m=[`${O.host} wants you to sign in with your Solana account:`,_.publicKey.toBase58(),...S?["",S,""]:[""],"Version: 1",`URI: ${O.href}`,`Issued At: ${(n=(r=x==null?void 0:x.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((i=x==null?void 0:x.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${x.signInWithSolana.notBefore}`]:[],...!((a=x==null?void 0:x.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${x.signInWithSolana.expirationTime}`]:[],...!((l=x==null?void 0:x.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${x.signInWithSolana.chainId}`]:[],...!((c=x==null?void 0:x.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${x.signInWithSolana.nonce}`]:[],...!((u=x==null?void 0:x.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${x.signInWithSolana.requestId}`]:[],...!((h=(d=x==null?void 0:x.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||h===void 0)&&h.length?["Resources",...x.signInWithSolana.resources.map(I=>`- ${I}`)]:[]].join(`
`);const C=await _.signMessage(new TextEncoder().encode(m),"utf8");if(!C||!(C instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=C}}try{const{data:y,error:w}=await j(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:m,signature:Ue(g)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:ne});if(w)throw w;if(!y||!y.session||!y.user){const S=new We;return this._returnResult({data:{user:null,session:null},error:S})}return y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),this._returnResult({data:Object.assign({},y),error:w})}catch(y){if(k(y))return this._returnResult({data:{user:null,session:null},error:y});throw y}}async _exchangeCodeForSession(e){const s=await Ie(this.storage,`${this.storageKey}-code-verifier`),[r,n]=(s??"").split("/");try{if(!r&&this.flowType==="pkce")throw new Bo;const{data:i,error:a}=await j(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:ne});if(await W(this.storage,`${this.storageKey}-code-verifier`),a)throw a;if(!i||!i.session||!i.user){const l=new We;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:n??null}),error:a})}catch(i){if(await W(this.storage,`${this.storageKey}-code-verifier`),k(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(e){try{const{options:s,provider:r,token:n,access_token:i,nonce:a}=e,l=await j(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:n,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},xform:ne}),{data:c,error:u}=l;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!c||!c.session||!c.user){const d=new We;return this._returnResult({data:{user:null,session:null},error:d})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:u})}catch(s){if(k(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithOtp(e){var s,r,n,i,a;try{if("email"in e){const{email:l,options:c}=e;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await Ke(this.storage,this.storageKey));const{error:h}=await j(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(s=c==null?void 0:c.data)!==null&&s!==void 0?s:{},create_user:(r=c==null?void 0:c.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}if("phone"in e){const{phone:l,options:c}=e,{data:u,error:d}=await j(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(a=c==null?void 0:c.channel)!==null&&a!==void 0?a:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d})}throw new Bt("You must provide either an email or phone number.")}catch(l){if(await W(this.storage,`${this.storageKey}-code-verifier`),k(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(e){var s,r;try{let n,i;"options"in e&&(n=(s=e.options)===null||s===void 0?void 0:s.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:a,error:l}=await j(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:ne});if(l)throw l;if(!a)throw new Error("An error occurred on token verification.");const c=a.session,u=a.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(n){if(k(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithSSO(e){var s,r,n,i,a;try{let l=null,c=null;this.flowType==="pkce"&&([l,c]=await Ke(this.storage,this.storageKey));const u=await j(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(s=e.options)===null||s===void 0?void 0:s.redirectTo)!==null&&r!==void 0?r:void 0}),!((n=e==null?void 0:e.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:hl});return!((i=u.data)===null||i===void 0)&&i.url&&K()&&!(!((a=e.options)===null||a===void 0)&&a.skipBrowserRedirect)&&window.location.assign(u.data.url),this._returnResult(u)}catch(l){if(await W(this.storage,`${this.storageKey}-code-verifier`),k(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:s},error:r}=e;if(r)throw r;if(!s)throw new ee;const{error:n}=await j(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:s.access_token});return this._returnResult({data:{user:null,session:null},error:n})})}catch(e){if(k(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const s=`${this.url}/resend`;if("email"in e){const{email:r,type:n,options:i}=e,{error:a}=await j(this.fetch,"POST",s,{headers:this.headers,body:{email:r,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:a})}else if("phone"in e){const{phone:r,type:n,options:i}=e,{data:a,error:l}=await j(this.fetch,"POST",s,{headers:this.headers,body:{phone:r,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:l})}throw new Bt("You must provide either an email or phone number and a type")}catch(s){if(k(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async s=>s))}async _acquireLock(e,s){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await r,await s()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=s();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const s=await this.__loadSession();return await e(s)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const s=await Ie(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",s),s!==null&&(this._isValidSession(s)?e=s:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<os:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const a=await Ie(this.userStorage,this.storageKey+"-user");a!=null&&a.user?e.user=a.user:e.user=us()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const a={value:this.suppressGetSessionWarning};e.user=ll(e.user,a),a.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:n},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const s=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return s.data.user&&(this.suppressGetSessionWarning=!0),s}async _getUser(e){try{return e?await j(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Se}):await this._useSession(async s=>{var r,n,i;const{data:a,error:l}=s;if(l)throw l;return!(!((r=a.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ee}:await j(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0,xform:Se})})}catch(s){if(k(s))return ls(s)&&(await this._removeSession(),await W(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:s});throw s}}async updateUser(e,s={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,s))}async _updateUser(e,s={}){try{return await this._useSession(async r=>{const{data:n,error:i}=r;if(i)throw i;if(!n.session)throw new ee;const a=n.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await Ke(this.storage,this.storageKey));const{data:u,error:d}=await j(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:s==null?void 0:s.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:a.access_token,xform:Se});if(d)throw d;return a.user=u.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),this._returnResult({data:{user:a.user},error:null})})}catch(r){if(await W(this.storage,`${this.storageKey}-code-verifier`),k(r))return this._returnResult({data:{user:null},error:r});throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new ee;const s=Date.now()/1e3;let r=s,n=!0,i=null;const{payload:a}=zt(e.access_token);if(a.exp&&(r=a.exp,n=r<=s),n){const{data:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});i={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:r-s,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(s){if(k(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async s=>{var r;if(!e){const{data:a,error:l}=s;if(l)throw l;e=(r=a.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new ee;const{data:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):n?this._returnResult({data:{user:n.user,session:n},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(s){if(k(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async _getSessionFromURL(e,s){try{if(!K())throw new Ft("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ft(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(s){case"implicit":if(this.flowType==="pkce")throw new nr("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ft("Not a valid implicit grant flow url.");break;default:}if(s==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new nr("No code detected.");const{data:S,error:x}=await this._exchangeCodeForSession(e.code);if(x)throw x;const _=new URL(window.location.href);return _.searchParams.delete("code"),window.history.replaceState(window.history.state,"",_.toString()),{data:{session:S.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:n,access_token:i,refresh_token:a,expires_in:l,expires_at:c,token_type:u}=e;if(!i||!l||!a||!u)throw new Ft("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(l);let f=d+h;c&&(f=parseInt(c));const p=f-d;p*1e3<=Xe&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${h}s`);const m=f-h;d-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,f,d):d-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,f,d);const{data:g,error:y}=await this._getUser(i);if(y)throw y;const w={provider_token:r,provider_refresh_token:n,access_token:i,expires_in:h,expires_at:f,refresh_token:a,token_type:u,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:w,redirectType:e.type},error:null})}catch(r){if(k(r))return this._returnResult({data:{session:null,redirectType:null},error:r});throw r}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const s=await Ie(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&s)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async s=>{var r;const{data:n,error:i}=s;if(i&&!ls(i))return this._returnResult({error:i});const a=(r=n.session)===null||r===void 0?void 0:r.access_token;if(a){const{error:l}=await this.admin.signOut(a,e);if(l&&!(Mo(l)&&(l.status===404||l.status===401||l.status===403)||ls(l)))return this._returnResult({error:l})}return e!=="others"&&(await this._removeSession(),await W(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const s=Ho(),r={id:s,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",s),this.stateChangeEmitters.delete(s)}};return this._debug("#onAuthStateChange()","registered callback with id",s),this.stateChangeEmitters.set(s,r),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(s)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async s=>{var r,n;try{const{data:{session:i},error:a}=s;if(a)throw a;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,s={}){let r=null,n=null;this.flowType==="pkce"&&([r,n]=await Ke(this.storage,this.storageKey,!0));try{return await j(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:n,gotrue_meta_security:{captcha_token:s.captchaToken}},headers:this.headers,redirectTo:s.redirectTo})}catch(i){if(await W(this.storage,`${this.storageKey}-code-verifier`),k(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var e;try{const{data:s,error:r}=await this.getUser();if(r)throw r;return this._returnResult({data:{identities:(e=s.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(s){if(k(s))return this._returnResult({data:null,error:s});throw s}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var s;try{const{data:r,error:n}=await this._useSession(async i=>{var a,l,c,u,d;const{data:h,error:f}=i;if(f)throw f;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await j(this.fetch,"GET",p,{headers:this.headers,jwt:(d=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(n)throw n;return K()&&!(!((s=e.options)===null||s===void 0)&&s.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),this._returnResult({data:{provider:e.provider,url:r==null?void 0:r.url},error:null})}catch(r){if(k(r))return this._returnResult({data:{provider:e.provider,url:null},error:r});throw r}}async linkIdentityIdToken(e){return await this._useSession(async s=>{var r;try{const{error:n,data:{session:i}}=s;if(n)throw n;const{options:a,provider:l,token:c,access_token:u,nonce:d}=e,h=await j(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(r=i==null?void 0:i.access_token)!==null&&r!==void 0?r:void 0,body:{provider:l,id_token:c,access_token:u,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:ne}),{data:f,error:p}=h;return p?this._returnResult({data:{user:null,session:null},error:p}):!f||!f.session||!f.user?this._returnResult({data:{user:null,session:null},error:new We}):(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("USER_UPDATED",f.session)),this._returnResult({data:f,error:p}))}catch(n){if(await W(this.storage,`${this.storageKey}-code-verifier`),k(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}})}async unlinkIdentity(e){try{return await this._useSession(async s=>{var r,n;const{data:i,error:a}=s;if(a)throw a;return await j(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&n!==void 0?n:void 0})})}catch(s){if(k(s))return this._returnResult({data:null,error:s});throw s}}async _refreshAccessToken(e){const s=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{const r=Date.now();return await Xo(async n=>(n>0&&await Yo(200*Math.pow(2,n-1)),this._debug(s,"refreshing attempt",n),await j(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:ne})),(n,i)=>{const a=200*Math.pow(2,n);return i&&cs(i)&&Date.now()+a-r<Xe})}catch(r){if(this._debug(s,"error",r),k(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}finally{this._debug(s,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,s){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:s.redirectTo,scopes:s.scopes,queryParams:s.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",s,"url",r),K()&&!s.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,s;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await Ie(this.storage,this.storageKey);if(n&&this.userStorage){let a=await Ie(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:n.user},await Ze(this.userStorage,this.storageKey+"-user",a)),n.user=(e=a==null?void 0:a.user)!==null&&e!==void 0?e:us()}else if(n&&!n.user&&!n.user){const a=await Ie(this.storage,this.storageKey+"-user");a&&(a!=null&&a.user)?(n.user=a.user,await W(this.storage,this.storageKey+"-user"),await Ze(this.storage,this.storageKey,n)):n.user=us()}if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}const i=((s=n.expires_at)!==null&&s!==void 0?s:1/0)*1e3-Date.now()<os;if(this._debug(r,`session has${i?"":" not"} expired with margin of ${os}s`),i){if(this.autoRefreshToken&&n.refresh_token){const{error:a}=await this._callRefreshToken(n.refresh_token);a&&(console.error(a),cs(a)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:l}=await this._getUser(n.access_token);!l&&(a!=null&&a.user)?(n.user=a.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(r,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var s,r;if(!e)throw new ee;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new Zt;const{data:i,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!i.session)throw new ee;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={data:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(n,"error",i),k(i)){const a={data:null,error:i};return cs(i)||await this._removeSession(),(s=this.refreshingDeferred)===null||s===void 0||s.resolve(a),a}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,s,r=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",s,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:s});const i=[],a=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,s)}catch(c){i.push(c)}});if(await Promise.all(a),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await W(this.storage,`${this.storageKey}-code-verifier`);const s=Object.assign({},e),r=s.user&&s.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&s.user&&await Ze(this.userStorage,this.storageKey+"-user",{user:s.user});const n=Object.assign({},s);delete n.user;const i=cr(n);await Ze(this.storage,this.storageKey,i)}else{const n=cr(s);await Ze(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await W(this.storage,this.storageKey),await W(this.storage,this.storageKey+"-code-verifier"),await W(this.storage,this.storageKey+"-user"),this.userStorage&&await W(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&K()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(s){console.error("removing visibilitychange callback failed",s)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Xe);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e);const s=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=s,s&&typeof s=="object"&&typeof s.unref=="function"?s.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(s)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const s=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,s&&clearTimeout(s)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async s=>{const{data:{session:r}}=s;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((r.expires_at*1e3-e)/Xe);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${Xe}ms, refresh threshold is ${xs} ticks`),n<=xs&&await this._callRefreshToken(r.refresh_token)})}catch(s){console.error("Auto refresh tick failed with error. This is likely a transient error.",s)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof cn)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!K()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(e){this._debug("#visibilityChangedCallback","error",e)}},window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const s=`#_onVisibilityChanged(${e})`;this._debug(s,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(s,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,s,r){const n=[`provider=${encodeURIComponent(s)}`];if(r!=null&&r.redirectTo&&n.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&n.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,a]=await Ke(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(a)}`});n.push(l.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);n.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&n.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async s=>{var r;const{data:n,error:i}=s;return i?this._returnResult({data:null,error:i}):await j(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token})})}catch(s){if(k(s))return this._returnResult({data:null,error:s});throw s}}async _enroll(e){try{return await this._useSession(async s=>{var r,n;const{data:i,error:a}=s;if(a)return this._returnResult({data:null,error:a});const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:c,error:u}=await j(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return u?this._returnResult({data:null,error:u}):(e.factorType==="totp"&&c.type==="totp"&&(!((n=c==null?void 0:c.totp)===null||n===void 0)&&n.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(s){if(k(s))return this._returnResult({data:null,error:s});throw s}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async s=>{var r;const{data:n,error:i}=s;if(i)return this._returnResult({data:null,error:i});const a=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?Tl(e.webauthn.credential_response):Cl(e.webauthn.credential_response)})}:{code:e.code}),{data:l,error:c}=await j(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:a,headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(s){if(k(s))return this._returnResult({data:null,error:s});throw s}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async s=>{var r;const{data:n,error:i}=s;if(i)return this._returnResult({data:null,error:i});const a=await j(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token});if(a.error)return a;const{data:l}=a;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:El(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:Al(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(s){if(k(s))return this._returnResult({data:null,error:s});throw s}})}async _challengeAndVerify(e){const{data:s,error:r}=await this._challenge({factorId:e.factorId});return r?this._returnResult({data:null,error:r}):await this._verify({factorId:e.factorId,challengeId:s.id,code:e.code})}async _listFactors(){var e;const{data:{user:s},error:r}=await this.getUser();if(r)return{data:null,error:r};const n={all:[],phone:[],totp:[],webauthn:[]};for(const i of(e=s==null?void 0:s.factors)!==null&&e!==void 0?e:[])n.all.push(i),i.status==="verified"&&n[i.factor_type].push(i);return{data:n,error:null}}async _getAuthenticatorAssuranceLevel(e){var s,r,n,i;if(e)try{const{payload:p}=zt(e);let m=null;p.aal&&(m=p.aal);let g=m;const{data:{user:y},error:w}=await this.getUser(e);if(w)return this._returnResult({data:null,error:w});((r=(s=y==null?void 0:y.factors)===null||s===void 0?void 0:s.filter(_=>_.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(g="aal2");const x=p.amr||[];return{data:{currentLevel:m,nextLevel:g,currentAuthenticationMethods:x},error:null}}catch(p){if(k(p))return this._returnResult({data:null,error:p});throw p}const{data:{session:a},error:l}=await this.getSession();if(l)return this._returnResult({data:null,error:l});if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:c}=zt(a.access_token);let u=null;c.aal&&(u=c.aal);let d=u;((i=(n=a.user.factors)===null||n===void 0?void 0:n.filter(p=>p.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(d="aal2");const f=c.amr||[];return{data:{currentLevel:u,nextLevel:d,currentAuthenticationMethods:f},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async s=>{const{data:{session:r},error:n}=s;return n?this._returnResult({data:null,error:n}):r?await j(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:r.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new ee})})}catch(s){if(k(s))return this._returnResult({data:null,error:s});throw s}}async _approveAuthorization(e,s){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;if(i)return this._returnResult({data:null,error:i});if(!n)return this._returnResult({data:null,error:new ee});const a=await j(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return a.data&&a.data.redirect_url&&K()&&!(s!=null&&s.skipBrowserRedirect)&&window.location.assign(a.data.redirect_url),a})}catch(r){if(k(r))return this._returnResult({data:null,error:r});throw r}}async _denyAuthorization(e,s){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;if(i)return this._returnResult({data:null,error:i});if(!n)return this._returnResult({data:null,error:new ee});const a=await j(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return a.data&&a.data.redirect_url&&K()&&!(s!=null&&s.skipBrowserRedirect)&&window.location.assign(a.data.redirect_url),a})}catch(r){if(k(r))return this._returnResult({data:null,error:r});throw r}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:s},error:r}=e;return r?this._returnResult({data:null,error:r}):s?await j(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,xform:n=>({data:n,error:null})}):this._returnResult({data:null,error:new ee})})}catch(e){if(k(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async s=>{const{data:{session:r},error:n}=s;return n?this._returnResult({data:null,error:n}):r?(await j(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new ee})})}catch(s){if(k(s))return this._returnResult({data:null,error:s});throw s}}async fetchJwk(e,s={keys:[]}){let r=s.keys.find(l=>l.kid===e);if(r)return r;const n=Date.now();if(r=this.jwks.keys.find(l=>l.kid===e),r&&this.jwks_cached_at+Lo>n)return r;const{data:i,error:a}=await j(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=n,r=i.keys.find(l=>l.kid===e),!r)?null:r}async getClaims(e,s={}){try{let r=e;if(!r){const{data:p,error:m}=await this.getSession();if(m||!p.session)return this._returnResult({data:null,error:m});r=p.session.access_token}const{header:n,payload:i,signature:a,raw:{header:l,payload:c}}=zt(r);s!=null&&s.allowExpired||il(i.exp);const u=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,s!=null&&s.keys?{keys:s.keys}:s==null?void 0:s.jwks);if(!u){const{error:p}=await this.getUser(r);if(p)throw p;return{data:{claims:i,header:n,signature:a},error:null}}const d=al(n.alg),h=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,h,a,Wo(`${l}.${c}`)))throw new ks("Invalid JWT signature");return{data:{claims:i,header:n,signature:a},error:null}}catch(r){if(k(r))return this._returnResult({data:null,error:r});throw r}}}jt.nextInstanceID={};const Ul=jt,Ml="2.93.3";let yt="";typeof Deno<"u"?yt="deno":typeof document<"u"?yt="web":typeof navigator<"u"&&navigator.product==="ReactNative"?yt="react-native":yt="node";const ql={"X-Client-Info":`supabase-js-${yt}/${Ml}`},Bl={headers:ql},Fl={schema:"public"},zl={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Vl={};function Et(t){"@babel/helpers - typeof";return Et=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Et(t)}function Gl(t,e){if(Et(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,e);if(Et(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wl(t){var e=Gl(t,"string");return Et(e)=="symbol"?e:e+""}function Kl(t,e,s){return(e=Wl(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function gr(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),s.push.apply(s,r)}return s}function M(t){for(var e=1;e<arguments.length;e++){var s=arguments[e]!=null?arguments[e]:{};e%2?gr(Object(s),!0).forEach(function(r){Kl(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):gr(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}const Hl=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Jl=()=>Headers,Ql=(t,e,s)=>{const r=Hl(s),n=Jl();return async(i,a)=>{var l;const c=(l=await e())!==null&&l!==void 0?l:t;let u=new n(a==null?void 0:a.headers);return u.has("apikey")||u.set("apikey",t),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),r(i,M(M({},a),{},{headers:u}))}};function Yl(t){return t.endsWith("/")?t:t+"/"}function Xl(t,e){var s,r;const{db:n,auth:i,realtime:a,global:l}=t,{db:c,auth:u,realtime:d,global:h}=e,f={db:M(M({},c),n),auth:M(M({},u),i),realtime:M(M({},d),a),storage:{},global:M(M(M({},h),l),{},{headers:M(M({},(s=h==null?void 0:h.headers)!==null&&s!==void 0?s:{}),(r=l==null?void 0:l.headers)!==null&&r!==void 0?r:{})}),accessToken:async()=>""};return t.accessToken?f.accessToken=t.accessToken:delete f.accessToken,f}function Zl(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Yl(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var ec=class extends Ul{constructor(t){super(t)}},tc=class{constructor(t,e,s){var r,n;this.supabaseUrl=t,this.supabaseKey=e;const i=Zl(t);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const a=`sb-${i.hostname.split(".")[0]}-auth-token`,l={db:Fl,realtime:Vl,auth:M(M({},zl),{},{storageKey:a}),global:Bl},c=Xl(s??{},l);if(this.storageKey=(r=c.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(n=c.global.headers)!==null&&n!==void 0?n:{},c.accessToken)this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(d,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}});else{var u;this.auth=this._initSupabaseAuthClient((u=c.auth)!==null&&u!==void 0?u:{},this.headers,c.global.fetch)}this.fetch=Ql(e,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(M({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(d=>this.realtime.setAuth(d)).catch(d=>console.warn("Failed to set initial Realtime auth token:",d)),this.rest=new Ua(new URL("rest/v1",i).href,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),this.storage=new Ro(this.storageUrl.href,this.headers,this.fetch,s==null?void 0:s.storage),c.accessToken||this._listenForAuthEvents()}get functions(){return new Ia(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},s={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,e,s)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t=this,e,s;if(t.accessToken)return await t.accessToken();const{data:r}=await t.auth.getSession();return(e=(s=r.session)===null||s===void 0?void 0:s.access_token)!==null&&e!==void 0?e:t.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:s,storage:r,userStorage:n,storageKey:i,flowType:a,lock:l,debug:c,throwOnError:u},d,h){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new ec({url:this.authUrl.href,headers:M(M({},f),d),storageKey:i,autoRefreshToken:t,persistSession:e,detectSessionInUrl:s,storage:r,userStorage:n,flowType:a,lock:l,debug:c,throwOnError:u,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(p=>p.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new to(this.realtimeUrl.href,M(M({},t),{},{params:M(M({},{apikey:this.supabaseKey}),t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,e)=>{this._handleTokenChanged(t,"CLIENT",e==null?void 0:e.access_token)})}_handleTokenChanged(t,e,s){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==s?(this.changedAccessToken=s,this.realtime.setAuth(s)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const sc=(t,e,s)=>new tc(t,e,s);function rc(){if(typeof window<"u")return!1;const t=globalThis.process;if(!t)return!1;const e=t.version;if(e==null)return!1;const s=e.match(/^v(\d+)\./);return s?parseInt(s[1],10)<=18:!1}rc()&&console.warn("âš ï¸  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const nc="https://nbymcxvlcfyhebzjurml.supabase.co",ic="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5ieW1jeHZsY2Z5aGViemp1cm1sIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk1NzU1MDAsImV4cCI6MjA4NTE1MTUwMH0.naLyb4Fc2o0-c4K2S_D7rEXasUN-xu7zcBtX-nVHldA",re=sc(nc,ic),br=["admin@aigestion.net","nemisanalex@gmail.com"],ac="https://admin.aigestion.net";function oc(){const[t,e]=v.useState({session:null,user:null,loading:!0,isAuthenticated:!1,isAdmin:!1,isMobileApp:!1}),s=v.useCallback(()=>window.location.hostname==="localhost"||window.location.protocol.includes("capacitor")||window.location.protocol==="file:"||window.location.port==="",[]),r=v.useCallback(d=>{const h=d.user_metadata||{};return{email:d.email,name:h.name||d.email.split("@")[0],subscription:h.subscription||"free",role:h.role||"client",avatar:h.avatar}},[]),n=v.useCallback(d=>{const h=br.includes(d.email)||d.role==="admin",f=s();return h&&!f?(window.location.href=ac,!0):!1},[s]),i=v.useCallback(async d=>{e(h=>({...h,loading:!0}));try{if(d!=null&&d.user){const h=r(d.user);if(n(h))return;e({session:d,user:h,loading:!1,isAuthenticated:!0,isAdmin:br.includes(h.email)||h.role==="admin",isMobileApp:s()})}else e({session:null,user:null,loading:!1,isAuthenticated:!1,isAdmin:!1,isMobileApp:s()})}catch(h){console.error("Session handling error:",h),e(f=>({...f,loading:!1,isAuthenticated:!1,user:null,session:null}))}},[r,n,s]),a=v.useCallback(async(d,h)=>{var f;if(e(p=>({...p,loading:!0})),!re){console.warn("Supabase not configured. Login simulation."),setTimeout(()=>{e(p=>({...p,loading:!1,isAuthenticated:!0,user:{email:d,name:d.split("@")[0],subscription:"free",role:"client"},session:{}}))},1e3);return}try{const{data:p,error:m}=await re.auth.signInWithPassword({email:d,password:h});if(m)throw m;(f=p.session)!=null&&f.user&&await i(p.session)}catch(p){throw e(m=>({...m,loading:!1})),p}},[i]),l=v.useCallback(async()=>{if(e(d=>({...d,loading:!0})),!re){e({session:null,user:null,loading:!1,isAuthenticated:!1,isAdmin:!1,isMobileApp:s()});return}try{await re.auth.signOut(),await i(null)}catch(d){console.error("Logout error:",d),e({session:null,user:null,loading:!1,isAuthenticated:!1,isAdmin:!1,isMobileApp:s()})}},[i,s]),c=v.useCallback(async()=>{if(re)try{const{data:d,error:h}=await re.auth.refreshSession();if(h)throw h;await i(d.session)}catch(d){console.error("Session refresh error:",d),await i(null)}},[i]),u=v.useCallback(async d=>{if(!t.user||!t.session)throw new Error("No authenticated user");if(!re){console.warn("Supabase not configured. User update simulated.");return}e(h=>({...h,loading:!0}));try{const{error:h}=await re.auth.updateUser({data:d});if(h)throw h;await c()}catch(h){throw e(f=>({...f,loading:!1})),h}},[t.user,t.session,c]);return v.useEffect(()=>{if(!re){console.warn("Supabase not configured; using demo mode"),e(h=>({...h,loading:!1}));return}re.auth.getSession().then(({data:{session:h}})=>i(h)).catch(h=>{console.error("Initial session error:",h),e(f=>({...f,loading:!1}))});const{data:{subscription:d}}=re.auth.onAuthStateChange((h,f)=>{i(f)});return()=>d.unsubscribe()},[i]),{...t,login:a,logout:l,refreshSession:c,updateUser:u}}var es=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},lc={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},ke,Cs,Ar,cc=(Ar=class{constructor(){R(this,ke,lc);R(this,Cs,!1)}setTimeoutProvider(t){A(this,ke,t)}setTimeout(t,e){return b(this,ke).setTimeout(t,e)}clearTimeout(t){b(this,ke).clearTimeout(t)}setInterval(t,e){return b(this,ke).setInterval(t,e)}clearInterval(t){b(this,ke).clearInterval(t)}},ke=new WeakMap,Cs=new WeakMap,Ar),js=new cc;function uc(t){setTimeout(t,0)}var ts=typeof window>"u"||"Deno"in globalThis;function ae(){}function dc(t,e){return typeof t=="function"?t(e):t}function hc(t){return typeof t=="number"&&t>=0&&t!==1/0}function fc(t,e){return Math.max(t+(e||0)-Date.now(),0)}function Es(t,e){return typeof t=="function"?t(e):t}function pc(t,e){return typeof t=="function"?t(e):t}function yr(t,e){const{type:s="all",exact:r,fetchStatus:n,predicate:i,queryKey:a,stale:l}=t;if(a){if(r){if(e.queryHash!==Is(a,e.options))return!1}else if(!Tt(e.queryKey,a))return!1}if(s!=="all"){const c=e.isActive();if(s==="active"&&!c||s==="inactive"&&c)return!1}return!(typeof l=="boolean"&&e.isStale()!==l||n&&n!==e.state.fetchStatus||i&&!i(e))}function vr(t,e){const{exact:s,status:r,predicate:n,mutationKey:i}=t;if(i){if(!e.options.mutationKey)return!1;if(s){if(At(e.options.mutationKey)!==At(i))return!1}else if(!Tt(e.options.mutationKey,i))return!1}return!(r&&e.state.status!==r||n&&!n(e))}function Is(t,e){return((e==null?void 0:e.queryKeyHashFn)||At)(t)}function At(t){return JSON.stringify(t,(e,s)=>As(s)?Object.keys(s).sort().reduce((r,n)=>(r[n]=s[n],r),{}):s)}function Tt(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(s=>Tt(t[s],e[s])):!1}var mc=Object.prototype.hasOwnProperty;function hn(t,e){if(t===e)return t;const s=wr(t)&&wr(e);if(!s&&!(As(t)&&As(e)))return e;const n=(s?t:Object.keys(t)).length,i=s?e:Object.keys(e),a=i.length,l=s?new Array(a):{};let c=0;for(let u=0;u<a;u++){const d=s?u:i[u],h=t[d],f=e[d];if(h===f){l[d]=h,(s?u<n:mc.call(t,d))&&c++;continue}if(h===null||f===null||typeof h!="object"||typeof f!="object"){l[d]=f;continue}const p=hn(h,f);l[d]=p,p===h&&c++}return n===a&&c===n?t:l}function wr(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function As(t){if(!xr(t))return!1;const e=t.constructor;if(e===void 0)return!0;const s=e.prototype;return!(!xr(s)||!s.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function xr(t){return Object.prototype.toString.call(t)==="[object Object]"}function gc(t){return new Promise(e=>{js.setTimeout(e,t)})}function bc(t,e,s){return typeof s.structuralSharing=="function"?s.structuralSharing(t,e):s.structuralSharing!==!1?hn(t,e):e}function yc(t,e,s=0){const r=[...t,e];return s&&r.length>s?r.slice(1):r}function vc(t,e,s=0){const r=[e,...t];return s&&r.length>s?r.slice(0,-1):r}var Ps=Symbol();function fn(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===Ps?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function wc(t,e,s){let r=!1,n;return Object.defineProperty(t,"signal",{enumerable:!0,get:()=>(n??(n=e()),r||(r=!0,n.aborted?s():n.addEventListener("abort",s,{once:!0})),n)}),t}var Me,je,rt,Tr,xc=(Tr=class extends es{constructor(){super();R(this,Me);R(this,je);R(this,rt);A(this,rt,e=>{if(!ts&&window.addEventListener){const s=()=>e();return window.addEventListener("visibilitychange",s,!1),()=>{window.removeEventListener("visibilitychange",s)}}})}onSubscribe(){b(this,je)||this.setEventListener(b(this,rt))}onUnsubscribe(){var e;this.hasListeners()||((e=b(this,je))==null||e.call(this),A(this,je,void 0))}setEventListener(e){var s;A(this,rt,e),(s=b(this,je))==null||s.call(this),A(this,je,e(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(e){b(this,Me)!==e&&(A(this,Me,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(s=>{s(e)})}isFocused(){var e;return typeof b(this,Me)=="boolean"?b(this,Me):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},Me=new WeakMap,je=new WeakMap,rt=new WeakMap,Tr),pn=new xc;function _c(){let t,e;const s=new Promise((n,i)=>{t=n,e=i});s.status="pending",s.catch(()=>{});function r(n){Object.assign(s,n),delete s.resolve,delete s.reject}return s.resolve=n=>{r({status:"fulfilled",value:n}),t(n)},s.reject=n=>{r({status:"rejected",reason:n}),e(n)},s}var Sc=uc;function kc(){let t=[],e=0,s=l=>{l()},r=l=>{l()},n=Sc;const i=l=>{e?t.push(l):n(()=>{s(l)})},a=()=>{const l=t;t=[],l.length&&n(()=>{r(()=>{l.forEach(c=>{s(c)})})})};return{batch:l=>{let c;e++;try{c=l()}finally{e--,e||a()}return c},batchCalls:l=>(...c)=>{i(()=>{l(...c)})},schedule:i,setNotifyFunction:l=>{s=l},setBatchNotifyFunction:l=>{r=l},setScheduler:l=>{n=l}}}var X=kc(),nt,Ee,it,Cr,jc=(Cr=class extends es{constructor(){super();R(this,nt,!0);R(this,Ee);R(this,it);A(this,it,e=>{if(!ts&&window.addEventListener){const s=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",s,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",r)}}})}onSubscribe(){b(this,Ee)||this.setEventListener(b(this,it))}onUnsubscribe(){var e;this.hasListeners()||((e=b(this,Ee))==null||e.call(this),A(this,Ee,void 0))}setEventListener(e){var s;A(this,it,e),(s=b(this,Ee))==null||s.call(this),A(this,Ee,e(this.setOnline.bind(this)))}setOnline(e){b(this,nt)!==e&&(A(this,nt,e),this.listeners.forEach(r=>{r(e)}))}isOnline(){return b(this,nt)}},nt=new WeakMap,Ee=new WeakMap,it=new WeakMap,Cr),Jt=new jc;function Ec(t){return Math.min(1e3*2**t,3e4)}function mn(t){return(t??"online")==="online"?Jt.isOnline():!0}var Ts=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function gn(t){let e=!1,s=0,r;const n=_c(),i=()=>n.status!=="pending",a=g=>{var y;if(!i()){const w=new Ts(g);f(w),(y=t.onCancel)==null||y.call(t,w)}},l=()=>{e=!0},c=()=>{e=!1},u=()=>pn.isFocused()&&(t.networkMode==="always"||Jt.isOnline())&&t.canRun(),d=()=>mn(t.networkMode)&&t.canRun(),h=g=>{i()||(r==null||r(),n.resolve(g))},f=g=>{i()||(r==null||r(),n.reject(g))},p=()=>new Promise(g=>{var y;r=w=>{(i()||u())&&g(w)},(y=t.onPause)==null||y.call(t)}).then(()=>{var g;r=void 0,i()||(g=t.onContinue)==null||g.call(t)}),m=()=>{if(i())return;let g;const y=s===0?t.initialPromise:void 0;try{g=y??t.fn()}catch(w){g=Promise.reject(w)}Promise.resolve(g).then(h).catch(w=>{var C;if(i())return;const S=t.retry??(ts?0:3),x=t.retryDelay??Ec,_=typeof x=="function"?x(s,w):x,O=S===!0||typeof S=="number"&&s<S||typeof S=="function"&&S(s,w);if(e||!O){f(w);return}s++,(C=t.onFail)==null||C.call(t,s,w),gc(_).then(()=>u()?void 0:p()).then(()=>{e?f(w):m()})})};return{promise:n,status:()=>n.status,cancel:a,continue:()=>(r==null||r(),n),cancelRetry:l,continueRetry:c,canStart:d,start:()=>(d()?m():p().then(m),n)}}var qe,Nr,bn=(Nr=class{constructor(){R(this,qe)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),hc(this.gcTime)&&A(this,qe,js.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(ts?1/0:5*60*1e3))}clearGcTimeout(){b(this,qe)&&(js.clearTimeout(b(this,qe)),A(this,qe,void 0))}},qe=new WeakMap,Nr),Be,at,se,Fe,V,Ct,ze,oe,me,Or,Ac=(Or=class extends bn{constructor(e){super();R(this,oe);R(this,Be);R(this,at);R(this,se);R(this,Fe);R(this,V);R(this,Ct);R(this,ze);A(this,ze,!1),A(this,Ct,e.defaultOptions),this.setOptions(e.options),this.observers=[],A(this,Fe,e.client),A(this,se,b(this,Fe).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,A(this,Be,Sr(this.options)),this.state=e.state??b(this,Be),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=b(this,V))==null?void 0:e.promise}setOptions(e){if(this.options={...b(this,Ct),...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const s=Sr(this.options);s.data!==void 0&&(this.setState(_r(s.data,s.dataUpdatedAt)),A(this,Be,s))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&b(this,se).remove(this)}setData(e,s){const r=bc(this.state.data,e,this.options);return Q(this,oe,me).call(this,{data:r,type:"success",dataUpdatedAt:s==null?void 0:s.updatedAt,manual:s==null?void 0:s.manual}),r}setState(e,s){Q(this,oe,me).call(this,{type:"setState",state:e,setStateOptions:s})}cancel(e){var r,n;const s=(r=b(this,V))==null?void 0:r.promise;return(n=b(this,V))==null||n.cancel(e),s?s.then(ae).catch(ae):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(b(this,Be))}isActive(){return this.observers.some(e=>pc(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Ps||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>Es(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!fc(this.state.dataUpdatedAt,e)}onFocus(){var s;const e=this.observers.find(r=>r.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(s=b(this,V))==null||s.continue()}onOnline(){var s;const e=this.observers.find(r=>r.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(s=b(this,V))==null||s.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),b(this,se).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(s=>s!==e),this.observers.length||(b(this,V)&&(b(this,ze)?b(this,V).cancel({revert:!0}):b(this,V).cancelRetry()),this.scheduleGc()),b(this,se).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Q(this,oe,me).call(this,{type:"invalidate"})}async fetch(e,s){var c,u,d,h,f,p,m,g,y,w,S,x;if(this.state.fetchStatus!=="idle"&&((c=b(this,V))==null?void 0:c.status())!=="rejected"){if(this.state.data!==void 0&&(s!=null&&s.cancelRefetch))this.cancel({silent:!0});else if(b(this,V))return b(this,V).continueRetry(),b(this,V).promise}if(e&&this.setOptions(e),!this.options.queryFn){const _=this.observers.find(O=>O.options.queryFn);_&&this.setOptions(_.options)}const r=new AbortController,n=_=>{Object.defineProperty(_,"signal",{enumerable:!0,get:()=>(A(this,ze,!0),r.signal)})},i=()=>{const _=fn(this.options,s),C=(()=>{const I={client:b(this,Fe),queryKey:this.queryKey,meta:this.meta};return n(I),I})();return A(this,ze,!1),this.options.persister?this.options.persister(_,C,this):_(C)},l=(()=>{const _={fetchOptions:s,options:this.options,queryKey:this.queryKey,client:b(this,Fe),state:this.state,fetchFn:i};return n(_),_})();(u=this.options.behavior)==null||u.onFetch(l,this),A(this,at,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((d=l.fetchOptions)==null?void 0:d.meta))&&Q(this,oe,me).call(this,{type:"fetch",meta:(h=l.fetchOptions)==null?void 0:h.meta}),A(this,V,gn({initialPromise:s==null?void 0:s.initialPromise,fn:l.fetchFn,onCancel:_=>{_ instanceof Ts&&_.revert&&this.setState({...b(this,at),fetchStatus:"idle"}),r.abort()},onFail:(_,O)=>{Q(this,oe,me).call(this,{type:"failed",failureCount:_,error:O})},onPause:()=>{Q(this,oe,me).call(this,{type:"pause"})},onContinue:()=>{Q(this,oe,me).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0}));try{const _=await b(this,V).start();if(_===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(_),(p=(f=b(this,se).config).onSuccess)==null||p.call(f,_,this),(g=(m=b(this,se).config).onSettled)==null||g.call(m,_,this.state.error,this),_}catch(_){if(_ instanceof Ts){if(_.silent)return b(this,V).promise;if(_.revert){if(this.state.data===void 0)throw _;return this.state.data}}throw Q(this,oe,me).call(this,{type:"error",error:_}),(w=(y=b(this,se).config).onError)==null||w.call(y,_,this),(x=(S=b(this,se).config).onSettled)==null||x.call(S,this.state.data,_,this),_}finally{this.scheduleGc()}}},Be=new WeakMap,at=new WeakMap,se=new WeakMap,Fe=new WeakMap,V=new WeakMap,Ct=new WeakMap,ze=new WeakMap,oe=new WeakSet,me=function(e){const s=r=>{switch(e.type){case"failed":return{...r,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...Tc(r.data,this.options),fetchMeta:e.meta??null};case"success":const n={...r,..._r(e.data,e.dataUpdatedAt),dataUpdateCount:r.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return A(this,at,e.manual?n:void 0),n;case"error":const i=e.error;return{...r,error:i,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...e.state}}};this.state=s(this.state),X.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),b(this,se).notify({query:this,type:"updated",action:e})})},Or);function Tc(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:mn(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function _r(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Sr(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,s=e!==void 0,r=s?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:s?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:s?"success":"pending",fetchStatus:"idle"}}function kr(t){return{onFetch:(e,s)=>{var d,h,f,p,m;const r=e.options,n=(f=(h=(d=e.fetchOptions)==null?void 0:d.meta)==null?void 0:h.fetchMore)==null?void 0:f.direction,i=((p=e.state.data)==null?void 0:p.pages)||[],a=((m=e.state.data)==null?void 0:m.pageParams)||[];let l={pages:[],pageParams:[]},c=0;const u=async()=>{let g=!1;const y=x=>{wc(x,()=>e.signal,()=>g=!0)},w=fn(e.options,e.fetchOptions),S=async(x,_,O)=>{if(g)return Promise.reject();if(_==null&&x.pages.length)return Promise.resolve(x);const I=(()=>{const F={client:e.client,queryKey:e.queryKey,pageParam:_,direction:O?"backward":"forward",meta:e.options.meta};return y(F),F})(),J=await w(I),{maxPages:B}=e.options,L=O?vc:yc;return{pages:L(x.pages,J,B),pageParams:L(x.pageParams,_,B)}};if(n&&i.length){const x=n==="backward",_=x?Cc:jr,O={pages:i,pageParams:a},C=_(r,O);l=await S(O,C,x)}else{const x=t??i.length;do{const _=c===0?a[0]??r.initialPageParam:jr(r,l);if(c>0&&_==null)break;l=await S(l,_),c++}while(c<x)}return l};e.options.persister?e.fetchFn=()=>{var g,y;return(y=(g=e.options).persister)==null?void 0:y.call(g,u,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},s)}:e.fetchFn=u}}}function jr(t,{pages:e,pageParams:s}){const r=e.length-1;return e.length>0?t.getNextPageParam(e[r],e,s[r],s):void 0}function Cc(t,{pages:e,pageParams:s}){var r;return e.length>0?(r=t.getPreviousPageParam)==null?void 0:r.call(t,e[0],e,s[0],s):void 0}var Nt,ue,Y,Ve,de,xe,Rr,Nc=(Rr=class extends bn{constructor(e){super();R(this,de);R(this,Nt);R(this,ue);R(this,Y);R(this,Ve);A(this,Nt,e.client),this.mutationId=e.mutationId,A(this,Y,e.mutationCache),A(this,ue,[]),this.state=e.state||Oc(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){b(this,ue).includes(e)||(b(this,ue).push(e),this.clearGcTimeout(),b(this,Y).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){A(this,ue,b(this,ue).filter(s=>s!==e)),this.scheduleGc(),b(this,Y).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){b(this,ue).length||(this.state.status==="pending"?this.scheduleGc():b(this,Y).remove(this))}continue(){var e;return((e=b(this,Ve))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var a,l,c,u,d,h,f,p,m,g,y,w,S,x,_,O,C,I,J,B;const s=()=>{Q(this,de,xe).call(this,{type:"continue"})},r={client:b(this,Nt),meta:this.options.meta,mutationKey:this.options.mutationKey};A(this,Ve,gn({fn:()=>this.options.mutationFn?this.options.mutationFn(e,r):Promise.reject(new Error("No mutationFn found")),onFail:(L,F)=>{Q(this,de,xe).call(this,{type:"failed",failureCount:L,error:F})},onPause:()=>{Q(this,de,xe).call(this,{type:"pause"})},onContinue:s,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>b(this,Y).canRun(this)}));const n=this.state.status==="pending",i=!b(this,Ve).canStart();try{if(n)s();else{Q(this,de,xe).call(this,{type:"pending",variables:e,isPaused:i}),await((l=(a=b(this,Y).config).onMutate)==null?void 0:l.call(a,e,this,r));const F=await((u=(c=this.options).onMutate)==null?void 0:u.call(c,e,r));F!==this.state.context&&Q(this,de,xe).call(this,{type:"pending",context:F,variables:e,isPaused:i})}const L=await b(this,Ve).start();return await((h=(d=b(this,Y).config).onSuccess)==null?void 0:h.call(d,L,e,this.state.context,this,r)),await((p=(f=this.options).onSuccess)==null?void 0:p.call(f,L,e,this.state.context,r)),await((g=(m=b(this,Y).config).onSettled)==null?void 0:g.call(m,L,null,this.state.variables,this.state.context,this,r)),await((w=(y=this.options).onSettled)==null?void 0:w.call(y,L,null,e,this.state.context,r)),Q(this,de,xe).call(this,{type:"success",data:L}),L}catch(L){try{await((x=(S=b(this,Y).config).onError)==null?void 0:x.call(S,L,e,this.state.context,this,r))}catch(F){Promise.reject(F)}try{await((O=(_=this.options).onError)==null?void 0:O.call(_,L,e,this.state.context,r))}catch(F){Promise.reject(F)}try{await((I=(C=b(this,Y).config).onSettled)==null?void 0:I.call(C,void 0,L,this.state.variables,this.state.context,this,r))}catch(F){Promise.reject(F)}try{await((B=(J=this.options).onSettled)==null?void 0:B.call(J,void 0,L,e,this.state.context,r))}catch(F){Promise.reject(F)}throw Q(this,de,xe).call(this,{type:"error",error:L}),L}finally{b(this,Y).runNext(this)}}},Nt=new WeakMap,ue=new WeakMap,Y=new WeakMap,Ve=new WeakMap,de=new WeakSet,xe=function(e){const s=r=>{switch(e.type){case"failed":return{...r,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...r,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:e.error,failureCount:r.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=s(this.state),X.batch(()=>{b(this,ue).forEach(r=>{r.onMutationUpdate(e)}),b(this,Y).notify({mutation:this,type:"updated",action:e})})},Rr);function Oc(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var be,le,Ot,Ir,Rc=(Ir=class extends es{constructor(e={}){super();R(this,be);R(this,le);R(this,Ot);this.config=e,A(this,be,new Set),A(this,le,new Map),A(this,Ot,0)}build(e,s,r){const n=new Nc({client:e,mutationCache:this,mutationId:++Lt(this,Ot)._,options:e.defaultMutationOptions(s),state:r});return this.add(n),n}add(e){b(this,be).add(e);const s=Vt(e);if(typeof s=="string"){const r=b(this,le).get(s);r?r.push(e):b(this,le).set(s,[e])}this.notify({type:"added",mutation:e})}remove(e){if(b(this,be).delete(e)){const s=Vt(e);if(typeof s=="string"){const r=b(this,le).get(s);if(r)if(r.length>1){const n=r.indexOf(e);n!==-1&&r.splice(n,1)}else r[0]===e&&b(this,le).delete(s)}}this.notify({type:"removed",mutation:e})}canRun(e){const s=Vt(e);if(typeof s=="string"){const r=b(this,le).get(s),n=r==null?void 0:r.find(i=>i.state.status==="pending");return!n||n===e}else return!0}runNext(e){var r;const s=Vt(e);if(typeof s=="string"){const n=(r=b(this,le).get(s))==null?void 0:r.find(i=>i!==e&&i.state.isPaused);return(n==null?void 0:n.continue())??Promise.resolve()}else return Promise.resolve()}clear(){X.batch(()=>{b(this,be).forEach(e=>{this.notify({type:"removed",mutation:e})}),b(this,be).clear(),b(this,le).clear()})}getAll(){return Array.from(b(this,be))}find(e){const s={exact:!0,...e};return this.getAll().find(r=>vr(s,r))}findAll(e={}){return this.getAll().filter(s=>vr(e,s))}notify(e){X.batch(()=>{this.listeners.forEach(s=>{s(e)})})}resumePausedMutations(){const e=this.getAll().filter(s=>s.state.isPaused);return X.batch(()=>Promise.all(e.map(s=>s.continue().catch(ae))))}},be=new WeakMap,le=new WeakMap,Ot=new WeakMap,Ir);function Vt(t){var e;return(e=t.options.scope)==null?void 0:e.id}var he,Pr,Ic=(Pr=class extends es{constructor(e={}){super();R(this,he);this.config=e,A(this,he,new Map)}build(e,s,r){const n=s.queryKey,i=s.queryHash??Is(n,s);let a=this.get(i);return a||(a=new Ac({client:e,queryKey:n,queryHash:i,options:e.defaultQueryOptions(s),state:r,defaultOptions:e.getQueryDefaults(n)}),this.add(a)),a}add(e){b(this,he).has(e.queryHash)||(b(this,he).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const s=b(this,he).get(e.queryHash);s&&(e.destroy(),s===e&&b(this,he).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){X.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return b(this,he).get(e)}getAll(){return[...b(this,he).values()]}find(e){const s={exact:!0,...e};return this.getAll().find(r=>yr(s,r))}findAll(e={}){const s=this.getAll();return Object.keys(e).length>0?s.filter(r=>yr(e,r)):s}notify(e){X.batch(()=>{this.listeners.forEach(s=>{s(e)})})}onFocus(){X.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){X.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},he=new WeakMap,Pr),U,Ae,Te,ot,lt,Ce,ct,ut,$r,Pc=($r=class{constructor(t={}){R(this,U);R(this,Ae);R(this,Te);R(this,ot);R(this,lt);R(this,Ce);R(this,ct);R(this,ut);A(this,U,t.queryCache||new Ic),A(this,Ae,t.mutationCache||new Rc),A(this,Te,t.defaultOptions||{}),A(this,ot,new Map),A(this,lt,new Map),A(this,Ce,0)}mount(){Lt(this,Ce)._++,b(this,Ce)===1&&(A(this,ct,pn.subscribe(async t=>{t&&(await this.resumePausedMutations(),b(this,U).onFocus())})),A(this,ut,Jt.subscribe(async t=>{t&&(await this.resumePausedMutations(),b(this,U).onOnline())})))}unmount(){var t,e;Lt(this,Ce)._--,b(this,Ce)===0&&((t=b(this,ct))==null||t.call(this),A(this,ct,void 0),(e=b(this,ut))==null||e.call(this),A(this,ut,void 0))}isFetching(t){return b(this,U).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return b(this,Ae).findAll({...t,status:"pending"}).length}getQueryData(t){var s;const e=this.defaultQueryOptions({queryKey:t});return(s=b(this,U).get(e.queryHash))==null?void 0:s.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),s=b(this,U).build(this,e),r=s.state.data;return r===void 0?this.fetchQuery(t):(t.revalidateIfStale&&s.isStaleByTime(Es(e.staleTime,s))&&this.prefetchQuery(e),Promise.resolve(r))}getQueriesData(t){return b(this,U).findAll(t).map(({queryKey:e,state:s})=>{const r=s.data;return[e,r]})}setQueryData(t,e,s){const r=this.defaultQueryOptions({queryKey:t}),n=b(this,U).get(r.queryHash),i=n==null?void 0:n.state.data,a=dc(e,i);if(a!==void 0)return b(this,U).build(this,r).setData(a,{...s,manual:!0})}setQueriesData(t,e,s){return X.batch(()=>b(this,U).findAll(t).map(({queryKey:r})=>[r,this.setQueryData(r,e,s)]))}getQueryState(t){var s;const e=this.defaultQueryOptions({queryKey:t});return(s=b(this,U).get(e.queryHash))==null?void 0:s.state}removeQueries(t){const e=b(this,U);X.batch(()=>{e.findAll(t).forEach(s=>{e.remove(s)})})}resetQueries(t,e){const s=b(this,U);return X.batch(()=>(s.findAll(t).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const s={revert:!0,...e},r=X.batch(()=>b(this,U).findAll(t).map(n=>n.cancel(s)));return Promise.all(r).then(ae).catch(ae)}invalidateQueries(t,e={}){return X.batch(()=>(b(this,U).findAll(t).forEach(s=>{s.invalidate()}),(t==null?void 0:t.refetchType)==="none"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??"active"},e)))}refetchQueries(t,e={}){const s={...e,cancelRefetch:e.cancelRefetch??!0},r=X.batch(()=>b(this,U).findAll(t).filter(n=>!n.isDisabled()&&!n.isStatic()).map(n=>{let i=n.fetch(void 0,s);return s.throwOnError||(i=i.catch(ae)),n.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(ae)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const s=b(this,U).build(this,e);return s.isStaleByTime(Es(e.staleTime,s))?s.fetch(e):Promise.resolve(s.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(ae).catch(ae)}fetchInfiniteQuery(t){return t.behavior=kr(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(ae).catch(ae)}ensureInfiniteQueryData(t){return t.behavior=kr(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return Jt.isOnline()?b(this,Ae).resumePausedMutations():Promise.resolve()}getQueryCache(){return b(this,U)}getMutationCache(){return b(this,Ae)}getDefaultOptions(){return b(this,Te)}setDefaultOptions(t){A(this,Te,t)}setQueryDefaults(t,e){b(this,ot).set(At(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...b(this,ot).values()],s={};return e.forEach(r=>{Tt(t,r.queryKey)&&Object.assign(s,r.defaultOptions)}),s}setMutationDefaults(t,e){b(this,lt).set(At(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...b(this,lt).values()],s={};return e.forEach(r=>{Tt(t,r.mutationKey)&&Object.assign(s,r.defaultOptions)}),s}defaultQueryOptions(t){if(t._defaulted)return t;const e={...b(this,Te).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=Is(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===Ps&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...b(this,Te).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){b(this,U).clear(),b(this,Ae).clear()}},U=new WeakMap,Ae=new WeakMap,Te=new WeakMap,ot=new WeakMap,lt=new WeakMap,Ce=new WeakMap,ct=new WeakMap,ut=new WeakMap,$r),$c=v.createContext(void 0),Dc=({client:t,children:e})=>(v.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),o.jsx($c.Provider,{value:t,children:e}));function Lc({children:t}){const[e]=v.useState(()=>new Pc({defaultOptions:{queries:{staleTime:3e5,retry:(s,r)=>{if(r&&typeof r=="object"&&"status"in r){const n=r.status;if(n>=400&&n<500)return!1}return s<3},refetchOnWindowFocus:!1,refetchOnReconnect:!0},mutations:{retry:1}}}));return o.jsx(Dc,{client:e,children:t})}function Uc(){return o.jsx(Aa,{children:o.jsx(Lc,{children:o.jsx(_n,{children:o.jsx(ri,{children:o.jsx(Ca,{children:o.jsx(Oi,{children:o.jsx(Mc,{})})})})})})})}function Mc(){const{loading:t,isAuthenticated:e,user:s,login:r,logout:n}=oc();return t?o.jsx(Pe,{}):o.jsx(zi,{loading:t,isAuthenticated:e,currentUser:s,handleLogin:r,handleLogout:n})}const qc=v.createContext(void 0),Bc=({children:t})=>{const[e,s]=v.useState(!1),[r,n]=v.useState(null),i={isLoading:e,setIsLoading:s,error:r,setError:n};return o.jsx(qc.Provider,{value:i,children:t})},Er=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),hs=document.getElementById("root");if(!hs)console.error("Root element not found!");else try{wn.createRoot(hs).render(o.jsx(Dr.StrictMode,{children:o.jsx(Bc,{children:o.jsx(Uc,{})})})),Er&&console.log("ðŸ“± Mobile device detected - App loaded successfully")}catch(t){console.error("âŒ Failed to render React app:",t),Er&&(hs.innerHTML=`
        <div style="padding: 20px; text-align: center; color: white; font-family: system-ui;">
          <h2>ðŸŒŒ AIGestion / NEXUS V1</h2>
          <p>Cargando aplicaciÃ³n optimizada para mÃ³vil...</p>
          <button onclick="window.location.reload()" style="
            background: #7c3aed;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            margin-top: 10px;
          ">Recargar</button>
        </div>
      `)}"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js",{scope:"/"}).then(t=>{console.log("âœ… Service Worker registered successfully:",t.scope),t.addEventListener("updatefound",()=>{const e=t.installing;e&&e.addEventListener("statechange",()=>{e.state==="installed"&&navigator.serviceWorker.controller&&console.log("ðŸ”„ New content available; please refresh.")})})}).catch(t=>{console.warn("âš ï¸ Service Worker registration failed:",t)})});export{ps as B,li as G,yi as M,ei as a,di as b,Ea as c,It as d,ti as u};
//# sourceMappingURL=index-D1aR6wIK.js.map
