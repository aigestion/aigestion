{
  "version": 2,
  "buildCommand": "npm run build",
  "outputDirectory": "dist",
  "framework": "vite",
  "installCommand": "pnpm install",
  "regions": ["iad1", "sfo1", "hnd1", "fra1", "sin1"],
  "functions": {
    "api/**/*.ts": { "runtime": "nodejs22.x", "maxDuration": 30, "memory": 1024 },
    "api/ai/**/*.ts": { "runtime": "nodejs22.x", "maxDuration": 60, "memory": 2048 },
    "api/realtime/**/*.ts": { "runtime": "edge", "maxDuration": 10, "memory": 512 }
  },
  "rewrites": [
    { "source": "/api/analytics/:path*", "destination": "/api/analytics/:path*" },
    { "source": "/api/auth/:path*", "destination": "/api/auth/:path*" },
    { "source": "/api/ai/:path*", "destination": "/api/ai/:path*" },
    { "source": "/api/voice/:path*", "destination": "/api/voice/:path*" },
    { "source": "/api/crm/:path*", "destination": "/api/crm/:path*" },
    { "source": "/api/email/:path*", "destination": "/api/email/:path*" },
    { "source": "/api/calendar/:path*", "destination": "/api/calendar/:path*" },
    { "source": "/api/alexa/:path*", "destination": "/api/alexa/:path*" },
    { "source": "/(.*)", "destination": "/index.html" }
  ],
  "redirects": [
    { "source": "/home", "destination": "/", "permanent": true },
    { "source": "/dashboard", "destination": "/admin", "permanent": true },
    { "source": "/app", "destination": "/client", "permanent": true },
    { "source": "/try", "destination": "/demo", "permanent": true },
    { "source": "/docs", "destination": "https://docs.aigestion.net", "permanent": true },
    { "source": "/blog", "destination": "https://blog.aigestion.net", "permanent": true },
    { "source": "/support", "destination": "https://help.aigestion.net", "permanent": true },
    { "source": "/api/v1/:path*", "destination": "/api/:path*", "permanent": true }
  ],
  "headers": [
    {
      "source": "/(.*)",
      "headers": [
        { "key": "X-DNS-Prefetch-Control", "value": "on" },
        {
          "key": "Strict-Transport-Security",
          "value": "max-age=31536000; includeSubDomains; preload"
        },
        { "key": "X-Frame-Options", "value": "DENY" },
        { "key": "X-Content-Type-Options", "value": "nosniff" },
        { "key": "X-XSS-Protection", "value": "1; mode=block" },
        { "key": "Referrer-Policy", "value": "strict-origin-when-cross-origin" },
        {
          "key": "Permissions-Policy",
          "value": "camera=(), microphone=(), geolocation=(), interest-cohort=()"
        }
      ]
    },
    {
      "source": "/api/(.*)",
      "headers": [
        {
          "key": "Access-Control-Allow-Origin",
          "value": "https://aigestion.net, https://www.aigestion.net"
        },
        {
          "key": "Access-Control-Allow-Methods",
          "value": "GET, POST, PUT, DELETE, PATCH, OPTIONS"
        },
        {
          "key": "Access-Control-Allow-Headers",
          "value": "X-Requested-With, Content-Type, Authorization, Cache-Control"
        }
      ]
    },
    {
      "source": "/(.*\\.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot))",
      "headers": [
        { "key": "Cache-Control", "value": "max-age=31536000, immutable" },
        { "key": "X-Content-Type-Options", "value": "nosniff" }
      ]
    },
    {
      "source": "/sw.js",
      "headers": [
        { "key": "Cache-Control", "value": "max-age=0, must-revalidate" },
        { "key": "Service-Worker-Allowed", "value": "/" }
      ]
    }
  ],
  "env": {
    "NODE_ENV": "production",
    "NEXT_PUBLIC_APP_URL": "https://aigestion.net",
    "NEXT_PUBLIC_API_URL": "https://aigestion.net/api",
    "NEXT_PUBLIC_WS_URL": "wss://aigestion.net",
    "NEXT_PUBLIC_VERCEL_URL": "https://aigestion.net",
    "VERCEL_ENV": "production"
  },
  "crons": [
    { "path": "/api/cleanup/sessions", "schedule": "0 2 * * *" },
    { "path": "/api/analytics/daily", "schedule": "0 3 * * *" },
    { "path": "/api/backup/database", "schedule": "0 4 * * *" },
    { "path": "/api/health/check", "schedule": "*/15 * * * *" },
    { "path": "/api/cache/clear", "schedule": "0 1 * * 0" },
    { "path": "/api/performance/metrics", "schedule": "0 */6 * * *" }
  ],
  "analytics": { "enabled": true },
  "experimental": { "runtime": "edge", "allowPrerendering": true },
  "autoAssignCustomDomains": true,
  "github": { "silent": true }
}
